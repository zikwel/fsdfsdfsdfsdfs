/*! For license information please see common.e460b23c69500e4f3c99.js.LICENSE.txt */
(self.webpackChunkvk=self.webpackChunkvk||[]).push([[8592],{57545:function(){window.Informer={close:function(e){hide(e)}}},65855:function(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(85863),_mobile_lib_Url__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15247),_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20848),_mobile_lib_AlLoading__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(94365),_mobile_skins_base_SVGIcon__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(52822),_mobile_lib_Dollars__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(71437),_mobile_lib_befall__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(75105),_mobile_components_common_Counters__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(13370),_mobile_skins_inline_svg_loading40__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(48328),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(19331),_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(71516),_shared_lib_site__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(61540),_mobile_lib_utils_effector__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(41313),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(45582),QuickSearchCache={};function QuickSearch(e){var t,n,o,a;QuickSearch.getQueryREs=Z;var i,r,s,l,c,d,u,_,p,m,f,v,g,h=!1,w=[],y={},k={},b={},S={},C=!1,E=null,T=null,I=null,M=0,P=[],L=null,B=null,A=null,O=!1,x=!1,R=10,N=[],D=!0,F=!1,U=!1,H=!1,j={},$=[],V=!1,W="",K=!1,q=null,G=0,z=0,Q=!1,Y={},X=e&&"AudioSectionSearch_field"===e.field,J=Wd.elem({class:["show_next_wrap","show_next_wrap_transparent"],inner:{class:"show_more_loading",inner:{tag:"i",class:"i_loading",inner:""}}});function Z(e){var t,n,o;e=e.replace(_shared_lib_site__WEBPACK_IMPORTED_MODULE_9__.VK_ORIGIN_REGEX,"");for(var a=x,i=[e,n=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.parseRusKeys)(e,a)||e,o=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.parseLatKeys)(e,a)||e,(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.parseLat)(n),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.parseCyr)(o)],r={},s=[],l=0,c=i.length;l<c;l++)i[l]&&!r[i[l]]&&(r[i[l]]=!0,t=(t=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.escapeRE)(i[l])).replace(/[её]/gi,"[её]").replace(/(e|yo)/gi,"(?:e|yo)"),s.push(new RegExp("(^|\\s|\\(|>)("+t+")","gi")));return s}function ee(e){return void 0===e&&(e=""),"_"+e+(j&&(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.len)(j)?JSON.stringify(j):"")}function te(e,t,n,o){var a;if(clearTimeout(T),!n)return T=setTimeout((function(){te(e,t,!0)}),10),!1;var r=(null==(a=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.val)(e))?void 0:a.trim())||"";if(E===r&&!o)return!1;var s,l=ee(r),c=k[l],d=Z(r);if(!X&&!c&&r.length>2&&k["_"+r.slice(0,-2)]){var p="_"+r.slice(0,-2);k[p]&&S[p]&&!k[p].length&&(!H||H&&!b[p])&&(S[l]=!0,c=k[l]=[],H&&(b[l]=""))}o&&(delete S[l],delete k[l],delete b[l]);var f=0;if(!c){c=[];if(qsearch.isCachedPage)f=((0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("_si_container",i)||i).childNodes.length;if(!r&&w.length)for(var v=M,g=M+Math.min(Math.max(R,f),w.length);v<g;v++)c.push([w[v]]);else{var h={},I=0;for(v=0,g=w.length;v<g;v++){var P=w[v];if(y[P]){if(h[P]=!0,(s=re(d,y[P][0]))&&(c.push([P,s]),++I>=30))break;0}}if(I<30)for(var P in y)if(!h[P]&&(s=re(d,y[P][0]))){if(c.push([P,s]),++I>=30)break;0}}S[l]=S[l]||!r&&w.length||c.length>2*R,S[l]=S[l]||H&&c.length>R}var L=!_||!!r;(!S[l]&&(D||H)||o)&&!u&&L&&ne(e,r),k[l]=c;var B=E!==r;if(E=r,se(c,b[l]),"string"==typeof m?Wd.handle2([m],null,r,i):m&&m(r,i),(U||!E||B)&&(G=Math.max(R,f)),V&&C){var A=(0,_mobile_lib_Url__WEBPACK_IMPORTED_MODULE_0__.parseURL)(nav.cur),O=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.qs2obj)(A.search.replace("?","")),x=Object.keys(O).reduce(((e,t)=>($.includes(t)?e[t]=j[t]:$.includes(t)||(e[t]=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.isUndefined)(e[t])?O[t]:e[t]),e)),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.extend)((0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.copy)(j),{q:r})),N=_mobile_lib_Url__WEBPACK_IMPORTED_MODULE_0__.default.make(nav.path,(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_12__.default)({act:x.act},x)),F=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.extend)(nav.page_get(nav.cur)||{},{page:(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.ge)("m"),state:page.stash(),cur:window.cur,options:{replacePrevPage:!0}});nav.set({replace:!0,nav:(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.extend)({},nav,{cur:nav.path,path:nav.path||"",push:N||"",params:(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.obj2qs)(x).replace("?","")||""})}),page.save(N,F)}return(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.onBodyScrollForce)(),!1}function ne(e,n,a){if(!o){var r=X?800:200;if(clearTimeout(I),!a)return I=setTimeout((function(){ne(e,n,!0)}),r),!1;(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__.partConfigEnabled)("mvk_quick_search_canceled_requests")&&null!==q&&(ae("aborted",n),q.abort()),q=window.ajax.post(t,(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.extend)({_ajax:1,q:n},j),{onDone:function(t,o,a){"string"==typeof p?Wd.handle2([p],null,...arguments,n,i):p&&p(...arguments,n,i);for(var r,s=ee(n),l=k[s]||[],c={},u=Z(n),_=0;_<l.length;_++)c[l[_][0]]=!0;for(var m=0;m<o.length;m++){var f=o[m];c[f]||((r=re(u,t[f][0]))||O||!n)&&l.push([f,r])}S[s]=!0,k[s]=l,H&&(b[s]=a||""),y=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.extend)(t,y),Y._cache=y,D=!F||(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.len)(y)<F,E===n?(se(l,b[s]),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.onBodyScrollForce)(),(0,_mobile_components_common_Counters__WEBPACK_IMPORTED_MODULE_6__.updateCounters)()):delete k[s],D||(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.removeClass)("input_loading",e),d&&(D=!1,F=Object.keys(y).length),ae("successful",n),q=null},onFail:function(){var t=ee(n);delete k[t],(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.removeClass)("input_loading",e),ae("failed",n)}}),ae("sent",n),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("al_loading",i)||(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.addClass)("input_loading",e)}}function oe(e){void 0===e&&(e="");var t=e.length;if(t<10)return t.toString();var n=10**(t.toString().length-1),o=Math.floor(t/n)*n;return o+" - "+(o+n)}function ae(e,t){void 0===t&&(t=""),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_7__.partConfigEnabled)("mvk_quick_search_canceled_requests_stats")&&(0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_8__.saveStatlogEvents)({name:"mvk_quick_search_requests",value:window.vk.id,keys:[e,oe(t),W,window.cur.module]})}function ie(){var e=i&&i.querySelector(".show_next_wrap");e&&e.remove()}function re(e,t){if(!t)return!1;"string"!=typeof t&&(t=t.toString());var n=[t],o=/([№])/gi;-1!==t.search(o)&&n.push(t.replace(o,""));for(var a=0;a<n.length;a++)for(var i=0,r=e.length;i<r;i++)if(-1!==n[a].search(e[i]))return e[i];return!1}function se(e,t,n){var o="";if(B&&i){var a=Object.keys(N).filter((e=>!!N[e])).map((e=>e+""));a.length&&""===E&&(e=e.filter((e=>!a.includes(String(e[0])))),a.forEach((t=>{e.unshift([t,!1])})));for(var s=function(t){var[n,a]=e[t];if(!y[n])return"continue";var i=y[n].slice(1);if(a)for(var r in P){var s=P[r];i[s]&&(i[s]=i[s].replace(a,'$1<em class="found">$2</em>'))}o+=B.apply({id:n,q:E,highlight:function(e){if("string"!=typeof e)throw new Error("Highlighting expected string but got "+typeof e);return e.replace(a,'$1<em class="found">$2</em>')},template:function(e,t){return e.replace(/%(\d+)%|#(\d+)#/g,((e,n,o)=>o&&t[o-1]?this.highlight(t[o-1]):n&&t[n-1]?t[n-1]:""))}},i)},d=0;d<e.length;d++)s(d);if(!o&&!S[ee(E)]&&(D||H)&&!u){ie(),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.removeClass)("_si_container_loading",i);var _=Wd.html({class:"al_loading qs_loading",inner:(0,_mobile_skins_base_SVGIcon__WEBPACK_IMPORTED_MODULE_3__.default)((0,_mobile_skins_inline_svg_loading40__WEBPACK_IMPORTED_MODULE_13__.getLoading40Icon)())});o=E?_:'<div id="al_loading"></div>'}if(!o&&A&&(o=A(E)),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.removeClass)("input_loading",r),n&&(o+=n),t||o!==g||K){var p=L?L(o,E,U,t):o+(t||"");(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.val)(i,p)}if(g=o,l){var m=(0,_mobile_lib_Dollars__WEBPACK_IMPORTED_MODULE_4__.$)('[data-prefix="'+W+'"]');m&&m.classList.toggle("qs_with_clear",!!E)}c&&(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.toggle)(c,!!E),!E&&(0,_mobile_lib_AlLoading__WEBPACK_IMPORTED_MODULE_2__.alLoadingFix)(),(0,_mobile_lib_Dollars__WEBPACK_IMPORTED_MODULE_4__.$)(".al_loading",i)&&(Q=!0),f&&f(E)}}(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.extend)(this,{go:function(e){return!r||(te(r,e,!0,!0),r.blur(),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.cancelEvent)(e),!1)},redraw:function(){var e=ee(E);se(k[e],b[e]),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.onBodyScrollForce)()},clear:function(e,t){return(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.val)(r,""),t?(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.elfocus)(r):(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.elblur)(r),this.setSearchParams({}),this.go(e),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.cancelEvent)(e),!1},blur:function(){(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.elblur)(r)},toggleAttach(e,t){N[e]=t},setSearchParams(e){var t=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.copy)(j);if(isArray(e)){var n=nav.getQuery()||{};j=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.extend)(j,e.reduce(((e,t)=>{var o=n[t];return o&&(e[t]=o),e}),{}))}else j=e;var o=JSON.stringify(t)!==JSON.stringify(j);this.onSearchParamsChange(j,t,o);var a=(0,_mobile_lib_Dollars__WEBPACK_IMPORTED_MODULE_4__.$)('[data-prefix="'+W+'"]');if(a){var i=(0,_mobile_lib_Dollars__WEBPACK_IMPORTED_MODULE_4__.$)(".filter_btn",a);i&&((0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.toggle)(i,!!E),C&&o&&(y={}))}},getSearchParams:()=>j,onSearchParamsChange:(0,_mobile_lib_befall__WEBPACK_IMPORTED_MODULE_5__.default)(),removeFromCache:(e,t)=>{for(var n of Object.keys(QuickSearchCache))if(new RegExp(e).test(n)){var o=QuickSearchCache[n];(null==o?void 0:o._cache[t])&&(null==o||delete o._cache[t]);break}},init:function(e){if(e=e||{},i=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.ge)(e.container)||null,r=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.ge)(e.field)||null,s=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.ge)(e.btn)||null,l=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.ge)(e.clear_btn)||null,c=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.ge)(e.filter_btn)||null,E=null,!e.init_once||!(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.attr)(i,"data-qsearch-inited")){if(!C||t!=e.action||!e.init_once){k={},b={},S={},t=e.action||"",h=null!==e.next_from,a=e.next_from,n=e.al_action||t,o=e.local_only||!1,w=e.top_items||[],y=e._cache||{},K=e.forceRerender||!1,P=e.hl_fields||[],L=e.tpl||null,B=e.item_tpl||null,A=e.null_tpl||null,O=e.soft_filter||!1,x=e.need_invalid_keys||!1,R=e.top_len||10,F=e.load_limit||!1,p=e.onLoaded||!1,m=e.onFiltered||!1,f=e.onRendered||!1,v=e.onFocusChanged||!1,U=e.al_need||!1,M=!U&&e.init_offset||0,H=e.global_search||!1,u=e.no_search_query||!1,_=e.search_non_empty_query||!1,d=e.load_once||!1,V=e.updateQuery||!1,$=e.availableSearchParams||[],W=e.prefix||"";var g=e.action+e.container;QuickSearchCache[g]?Y=QuickSearchCache[g]:(Y._cache=y,Y.top_items=w,QuickSearchCache[g]=Y),qsearch.isCachedPage&&(w=Y.top_items,y=Y._cache,a=Y.next_from),$.length&&(this.setSearchParams($),window.onDOMReady((()=>{this.setSearchParams($),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.onBodyResize)((()=>{this.setSearchParams($)}))})))}var T=null;t&&i&&r&&B&&(D=!0!==t&&(!F||(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.len)(y)<F),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.addEvent)(r,"focus",(function(e){e&&e.preventDefault();clearTimeout(T),v&&v.call({q:E},!0),function t(n){!n&&te(r,e,!0),T=setTimeout(t,100)}(!0)})),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.addEvent)(r,"keydown keypress change blur",(function(e){"blur"==e.type&&(clearTimeout(T),v&&v.call({q:E},!1)),te(r,e,"keydown"!=e.type&&"keypress"!=e.type)})),e._new||s&&!(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.attr)(s,"onclick")&&(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.attr)(s,"onclick","return qsearch.go(event);"),!U||C&&e.init_once||(G=R,z=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.len)(y),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.initAutoScroll)((function(){var e=((0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("_si_container",i)||i).childNodes;return e[G]||e[e.length-1]}),(function(){var e=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("_si_container",i)||i;if(!Q&&!E)if(h?!!a:G+R>z&&D)Q=!0,i&&i.append(J),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.addClass)(e,"_si_container_loading"),window.ajax.post(n,{_ajax:1,offset:z,next_from:a,q:E},{onDone:function(n,o,i,r){a=i;var s=r?r.needLoad:void 0,l=r&&r.html||"";"string"==typeof p?Wd.handle2([p],null,...arguments):p&&p(...arguments);var c=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.len)(n);if(Q=!1,ie(),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.removeClass)(e,"_si_container_loading"),F||(w=w.slice(0,z).concat(o),Y.top_items=w),z+=c,y=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.extend)(n,y),Y._cache=y,Y.next_from=a,D=!0!==t&&(!F&&c||(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.len)(y)<F),!1===s&&(D=!1),!E){G+=R;for(var d=[],u=0,_=Math.min(G,w.length);u<_;u++)d.push([w[u]]);se(d,b._,l),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.onBodyScrollForce)()}},onFail:function(){Q=!1,ie(),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.removeClass)(e,"_si_container_loading")}});else if(G<w.length){G+=R;for(var o=[],r=0,s=Math.min(G,w.length);r<s;r++)o.push([w[r]]);se(o,b._),(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.onBodyScrollForce)()}}))),e.common_cache&&(e.common_cache&&e.common_cache._gq_cache&&(b=e.common_cache._gq_cache),e.common_cache._q_loaded&&(S=e.common_cache._q_loaded)),!e.skip_init_filter&&te(r,null,!0),e.init_once&&(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.attr)(i,"data-qsearch-inited",!0),C=!0)}}}),e&&this.init(e)}window.QuickSearch=QuickSearch,window.QuickSearchCache=QuickSearchCache,window.qsearch=new QuickSearch,(0,_mobile_lib_utils_effector__WEBPACK_IMPORTED_MODULE_10__.onServerEvent)("QuickSearch/init").watch((_ref=>{var{options,values:_valuesStr,id}=_ref;window.clog("[QuickSearch] init "+id);var values=null,valuesEvalString="(function(){return "+_valuesStr+"})()";try{values=eval(valuesEvalString)}catch(e){console.error(e),(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_11__.logEvalError)(e,valuesEvalString)}var result=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.safeSet)(window,id,new QuickSearch((0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_12__.default)({},options,{},values)));result||window.clog("[QuickSearch] failed to init "+id)}))},18331:function(){var e=function(){var t=null,n=!1,o=!1,a={},i=[],r=0,s=null,l="",c="";function d(e,t){return!t&&h(e)}function u(e){o=!1;var t=ge("medias_map"),a=ge("attached_wrap");t||(t=ce("div",{id:"medias_map",className:"pi_medias"}),append(t,a));var i=+e[1]||0,r=e[3]||"",s=e[4]||"",l=e[5]||"",c=(+e[6].lat||0)+"_"+(+e[6].lng||0),d=geByClass1("medias_map",t),u='<div class="medias_map_close" onclick="checkin.remove();"><i class="i_close">&nbsp;</i></div><div class="medias_map_label" onclick="checkin.changePlace();">'+r+(l?", "+l:s?", "+s:"")+"</div>",_='<input type="hidden" name="place_id" value="'+i+'"><input type="hidden" name="place" value="'+c+'">';if(d)val(d,u+_);else{u='<div class="medias_map">'+u+_+"</div>";val(t,u)}addClass("cp_geo_btn_sel","geo_btn"),n=!0,show(t)}function _(e){return h(t)}function p(){val("place_add_box",""),hide("place_add_box"),show("places_box")}function m(e,n){f();var o=a[n];o&&(t={latitude:+o[6].lat||0,longitude:+o[6].lng||0},n?u(o):v(t,o))}function f(e){if(!s)return!0;val("m",s),s=null,scrollToEl(geByClass1("create_post_extra","mcont"));var t=nav.path+(nav.params?"?"+nav.params:"");return nav.go(t,null,{push_only:!0,no_push:e}),!1}function v(e,t){o=!0;var a=ge("medias_map"),i=ge("attached_wrap");a||(a=ce("div",{id:"medias_map",className:"pi_medias"}),i.appendChild(a));var r=e.latitude,s=e.longitude,l=(window.devicePixelRatio,t&&t[4]||!1),c=geByClass1("medias_map",a),d=l?'<div class="medias_map_close" onclick="checkin.remove();"><i class="i_close">&nbsp;</i></div><div class="medias_map_label" onclick="checkin.changePlace();">'+l+"</div>":"",u='<input type="hidden" name="map" value="'+(r+"_"+s+"_0")+'">';c?val(c,d+""+u):val(a,'<div class="medias_map">'+d+u+"</div>");n=!0,addClass("cp_geo_btn_sel","geo_btn"),show(a)}function g(){t=null,a={},i=[],r=0,ajax.post(c,{_ajax:1}),remove("medias_map")}function h(e){var{al:t}=window;remove("feed_extra_field");var n=Math.round(1e8*e.latitude)/1e8,o=Math.round(1e8*e.longitude)/1e8,a=gpeByTag("form","geo_btn"),i=ce("input",{id:"feed_extra_field",type:"hidden",name:"add_place",value:n+","+o});if(!a)return nav.go(nav.path+"?act=places&lat="+n+"&lng="+o);var r=!1;return each(a,(function(e,t){if("submit"===t.type)return r=t,!1})),r?(append(i,a),window.al&&t.ver?nav.go(r,null,{removeAfterNextResponse:!1}):a.submit()):void 0}function w(e){e&&e.coords&&d(t={latitude:+e.coords.latitude||0,longitude:+e.coords.longitude||0})}function y(t){e.remove(),hide("geo_waiting")}return{toggle:function(){n?e.remove():e.add()},addNewPlace:function(){var e=val("place_name_fld"),n=val("place_address_fld");return e?(lockButton("place_add_btn"),ajax.post("/places.php",{_ajax:1,act:"add_place",latitude:t.latitude,longitude:t.longitude,title:e,address:n,hash:l},{onDone:function(e,t){if(unlockButton("place_add_btn"),e){var n={};n[e]=t,extend(a,n),i.splice(i[0]?0:1,0,e),p(),m(null,e)}},onFail:function(){unlockButton("place_add_btn");var e=Array.prototype.slice.call(arguments),t=e.shift(),n=ge("place_add_form");if(2===t)n&&n.submit()}}),!1):(elfocus("place_name_fld"),!1)},addPlaceShow:function(e,n){var{lang:o}=window,a="/places.php"+obj2qs({act:"add_place",latitude:t.latitude,longitude:t.longitude,hash:l});val("place_add_box",'<h3 class="sub_header">'+o.mobile_geo_new_place_header+'</h3><div class="form_item fi_fat"><form id="place_add_form" action="'+a+'" method="post"><dl class="fi_row"><dt class="fi_label">'+o.mobile_geo_place_name_label+'</dt><dd class="iwrap"><input type="text" class="textfield" id="place_name_fld" name="title" /></dd></dl><dl class="fi_row"><dt class="fi_label">'+o.mobile_geo_place_address_label+'</dt><dd class="iwrap"><input type="text" class="textfield" id="place_address_fld" name="address" /></dd></dl><dl class="fi_row"><dd><input class="button" type="submit" id="place_add_btn" value="'+o.mobile_geo_place_add_btn+'" onclick="return checkin.addNewPlace(this);" /><a class="near_btn" onclick="checkin.addPlaceCancel(); return false;">'+o.mobile_cancel+"</a></dd></dl></form></div>"),val("place_name_fld",unescapeAttr(e)||""),val("place_address_fld",unescapeAttr(n)||""),hide("places_box"),show("place_add_box"),e?elfocus("place_address_fld"):elfocus("place_name_fld")},addPlaceCancel:p,selectPlace:m,changePlace:_,back:f,refreshCurrentPosition:function(){geo.getCurrentPosition(w,y)},getCurrentAddress:function(){return a[0]&&a[0][5]||""},savePlaces:function(e){extend(a,e)},add:function(e){if(!e&&n)return _();e&&(e.latitude||e.longitude)&&e.place?(t={latitude:+e.latitude||0,longitude:+e.longitude||0},e.place[1]?u(e.place):v(t,e.place),d(t,!0)):(geo.getCurrentPosition(w,y),show("geo_waiting"))},add_place:function(e){if(!e&&n)return _();e&&(e.latitude||e.longitude)&&e.place?(t={latitude:+e.latitude||0,longitude:+e.longitude||0},e.place[1]?u(e.place):v(t,e.place),d(t,!0)):(geo.getCurrentPosition(w,y),show("geo_waiting"))},remove:function(){n=!1,removeClass("cp_geo_btn_sel","geo_btn"),g()},stash:function(e){if(!e)return[t,n,o,a,i,r,s];t=e[0],n=e[1],o=e[2],a=e[3],i=e[4],r=e[5],s=e[6]},init:function(d,u,_){return hide("geo_waiting"),t=null,n=!1,o=!1,a={},i=[],r=0,s=null,l=u||"",c=_||"",d&&e.add(d),geo.init()}}}();window.checkin=e},72825:function(){window.FeedAssistance={hide:function(n,i,r){var s=domCA(n,o),l=hasClass(s,a);remove(s),l||function(n,o,a){var i=FeedAssistanceStats.getFromRef(n);ajax.post(e,{_ajax:1,type:o,hash:a,act:t,from:i})}(n,i,r);return!1},setFilled:function(e){var t=hasClass(e,n)?e:domCA(e,o);addClass(a,t)}};var e="/feed",t="hide_assistance",n="feedAssistance",o=".feedAssistance",a="feedAssistance_filled"},74982:function(){window.FeedAssistanceExploreBait={onSubscribeLinkClick:function(o,i,r,s,l,c){var d=hasClass(o,e),u=d?s:r,_=d?getLang("mobile_groups_public_subscribe"):getLang("mobile_groups_you_are_in_public"),p=!d,m=(f=o,v=domCA(f,n),intval(domData(v,"block-id")));var f,v;attr(o,"aria-label",escapeAttr(_)),toggleClass(e,o,p),"group"===l?function(e,n,o,i){var r=o?Groups.leave:Groups.enter,s=o?FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE;i&&a(s),r.call(Groups,e,n,t)}(i,u,d,c):function(e,n,o,i,r){var s=o?Friends.decline:Friends.accept,l=o?FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE;r&&a(l),s.call(Friends,e,n,t,i)}(i,u,d,m,c);return!1}},FeedAssistanceStats.registerTrackingCls("post_exploreBait"),FeedAssistanceStats.onStartViewElement((function(e){if(FeedAssistanceStats.getElementType(e)===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_EXPLORE_BAIT){if(e._exploreBaitClickHandlerAdded)return;o=!0,addEvent(e,"click",(e=>{!function(e){var t=e.target;for(var n of i)if(!0===n.call(null,t))return}(e)})),e._exploreBaitClickHandlerAdded=!0}})),nav.onBeforeGo((function(e){if(!o)return;if(!function(e){return e.tagName&&"explore-bait"===domData(e,"post-type")}(e))return;!function(e){var t=["pi_text_more","wi_date","pi_text","i_replies","v_replies","item_replies"];for(var n of t)if(hasClass(n,e))return a(FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPENED),!0}(e)}));var e="post__subscribeBtn_unsubscribe",t="feed",n=".post_exploreBait",o=!1;function a(e){FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_EXPLORE_BAIT,data:FeedAssistanceStats.serializeEventData(FeedAssistanceStats.EVENTS.EVENT_EXPLORE_BAIT_SUB,e)})}var i=[function(e){if(domData(e,"post-owner-type"))return a("user"===domData(e,"post-owner-type")?FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPEN_USER:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPEN_GROUP),!0},function(e){var t={report:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_REPORT,hide:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_HIDE}[domData(e,"post-action")];if(t)return a(t),!0}]},29752:function(){window.FeedAssistanceImportContacts={importContacts:function(t,n,o){if(!window.XMLHttpRequest||o)return;var a=domData(t,"service-id");return window.open(n),e[a]=t,!1}};var e={},t="feedAssistanceImportContacts__desc",n="mobile_join_friends_found_count",o=!1;FeedAssistanceStats.registerTrackingCls("feedAssistance_importContacts"),FeedAssistanceStats.onStartViewElement((function(e){FeedAssistanceStats.getElementType(e)===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_IMPORT_CONTACTS&&(o=!0)})),Friends.onImportSuccess((function(){var a=arguments[0],i=arguments[2],r=e[a];if(r){var s=geByClass1(t,r);s.textContent=getLang(n,i)}o&&FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_FEED_ASSISTANCE,data:FeedAssistanceStats.serializeEventData(FeedAssistanceStats.EVENTS.EVENT_FEED_ASSISTANCE,r,"m_mp",FeedAssistanceStats.EVENTS.SUB_EVENT_FILLED)})})),Friends.onImportFailed((function(n){var o=e[n];o&&(geByClass1(t,o).textContent=getLang("mobile_friends_import_error"))}))},5870:function(){FeedAssistanceStats.registerTrackingCls("feedAssistance_profilePhoto")},20033:function(){FeedAssistanceStats.registerTrackingCls("feedAssistance_promoButton"),FeedAssistanceStats.onStartViewElement((function(e){if(FeedAssistanceStats.getElementType(e)===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_PROMO_BUTTON){if(e._promoButtonClickHandlerAdded)return;var t=geByClass1("feedAssistancePromoButtonInstallApp__button",e),n=t?"install_app":"";addEvent(t||e,"click",(()=>{!function(e,t,n){FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_PROMO_BUTTON,data:FeedAssistanceStats.serializeEventData(FeedAssistanceStats.EVENTS.EVENT_PROMO_BUTTON_SUB,e,t,n)})}(e,FeedAssistanceStats.EVENTS.SUB_EVENT_PROMO_BUTTON_CLICK,n)})),e._promoButtonClickHandlerAdded=!0}}))},24102:function(){FeedAssistanceStats.registerTrackingCls("feedAssistance_recommendedFriends"),FeedAssistanceStats.onStartViewElement((function(e){if(FeedAssistanceStats.getElementType(e)!==FeedAssistanceStats.BLOCKS.BLOCK_TYPE_RECOMMENDED_SLIDER||e._friendsSliderHandlersAdded)return;e._friendsSliderHandlersAdded=!0,window.FriendsRecommendedSlider.init()}))},15099:function(){var e={init(e){this.store?addEvent(window,"scroll touchstart",this._onScrollHandler):(this.store=extend({},e),this.loadCount=20,this.store.offset=this.store.offset?this.store.offset:this.loadCount,this.isLoading=!1,this.elems={wrap:geByClass1("author-page"),nav:geByClass1("author-page-nav",this.wrap),header:geByClass1("author-page-header",this.wrap),content:geByClass1("author-page__inner",this.wrap),spinner:geByClass1("author-page__spinner",this.wrap)},this._onScrollHandler=this._onScrollHandler.bind(this),addEvent(window,"scroll touchstart",this._onScrollHandler),e.isStandalone&&(window.al=!1),window.cur.destroy.push((()=>{removeEvent(window,"scroll touchstart",this._onScrollHandler)})))},_getLoadOffset(){return this.store.offset},_showLoader(){this.isLoading=!0,addClass(this.elems.spinner,"active")},_hideLoader(){this.isLoading=!1,removeClass(this.elems.spinner,"active")},_onScrollHandler(){var{nav:e,header:t,content:n}=this.elems,o=this.store.totalCount>this._getLoadOffset();toggleClass(e,"author-page-nav_shown",t.getBoundingClientRect().bottom-e.clientHeight<0),o&&window.scrollTop()+2*window.innerHeight>n.offsetHeight&&this._loadMore(this.store.sortBy,this._getLoadOffset(),(e=>{this.elems.content.innerHTML+=e}))},_loadMore(e,t,n){void 0===e&&(e=!1),void 0===t&&(t=!1),this.isLoading||(e&&(this.store.sortBy=e),isFunction(n)||(n=()=>{}),this._showLoader(),ajax.post("author_page.php",{act:"load_more",author_id:this.store.authorId,sort_by:e||this.store.sortBy,count:this.loadCount,offset:void 0!==t?t:this._getLoadOffset()},{onFail:()=>{this._hideLoader()},onDone:e=>{this._hideLoader(),this.store.offset+=20,e&&n(e)}}))},subscribe(e,t,n){ajax.post("author_page.php",{act:"subscribe",author_id:t,hash:n},{onDone:(t,n)=>{toggleClass(e,"Btn_theme_link",t),e.innerHTML=n}})},sortBy(e,t){e.preventDefault(),Unfold.setActive(e.target.parentNode),this._closeUnfold(e),t!==this.store.sortBy&&this.updateList(t)},updateList(e,t){void 0===t&&(t=!1),e=e||this.store.sortBy,addClass(this.elems.content,"loading"),t&&Unfold.setActive(geByClass1("Unfold__item")),this._loadMore(e,0,(e=>{this.elems.content.innerHTML=e,this.store.offset=this.loadCount,removeClass(this.elems.content,"loading")}))},_closeUnfold(e){if(e){var t=e.target.closest(".Unfold");t&&removeClass(t,"Unfold_open")}},addToBookmark(e,t,n,o,a){e.preventDefault(),this._closeUnfold(e);var i=+domData(t,"is-bookmarked"),r=i?"bookmark_remove":"bookmark_add",s=geByClass1("Unfold__itemText",t);ajax.post("bookmarks.php",{_ajax:1,act:r,item_type:5,item_oid:n,item_id:o,hash:a},{onDone:(e,n,o)=>{domData(t,"is-bookmarked",i?0:1),i?s&&(s.innerHTML=lang.mobile_bookmarks_actions_add):s&&(s.innerHTML=lang.mobile_bookmarks_actions_remove),o&&Bookmarks.showSuccessSnack(o)}})},pinArticle(e,t,n,o,a){e.preventDefault(),this._closeUnfold(e),ajax.post("author_page.php",{act:"pin_article",article_owner_id:t,article_id:n,do_pin:o?0:1,hash:a},{onDone:()=>{this.updateList("date",!0)}})},hideArticle(e,t,n,o){e.preventDefault(),this._closeUnfold(e),ajax.post("author_page.php",{act:"hide_article",article_owner_id:t,article_id:n,hash:o},{onDone:()=>{this.updateList()}})}};window.AuthorPage=e},64527:function(){var e,t=need("Control"),n=need("Popup"),o=(e="adultConfirm__submit_disabled",{init:function(){var n=geByClass1("_adultConfirm"),o=geByClass1("_adultConfirm__submit",n),a=geByClass1("adultConfirm__checkbox",n);toggleClass(e,o,!t.isChecked(a))},toggle:function(t){var n=gpeByClass("_adultConfirm",t.$control),o=geByClass1("_adultConfirm__submit",n);toggleClass(e,o,!t.checked)},submit:function(t,o){if(cancelEvent(t),!hasClass(e,o)){var a=gpeByClass("_adultConfirm",o),i=geByClass1("_adultConfirm__form",a),r={_ajax:1};each(geByTag("input",i),(function(e,t){var n=t.type.toLowerCase(),o=t.name.toLowerCase();"hidden"!==n&&"checkbox"!==n&&"radio"!==n||(r[o]=t.value)}));var s=attr(i,"action");ajax.post(s,r),n.close()}},back:function(e){cancelEvent(e),window.history?window.history.back():window.location="/"}});window.AdultConfirm=o},13370:function(e,t,n){"use strict";n.d(t,{updateCounters:function(){return a}});var o=n(40962);function a(){var e=nav.cur||window.location.pathname||"",t=location.protocol+"//"+location.host+e,n=window.page.lastTrackedPage&&window.page.lastTrackedPage!==t?location.protocol+"//"+location.host+window.page.lastTrackedPage:"";window.page.lastTrackedPage=e,(0,o.updateCounters)(t,n)}},58901:function(){var e="dropdown_open",t={_onTogglerClick(t,n){preventEvent(t),stopEvent(t);var o=gpeByClass("dropdown",n);if(toggleClass(o,e),!1!==o.isFirstClick){o.isFirstClick=!1;var a=()=>{removeClass(o,e)};addEvent(window,"click",a),window.cur.destroy.push((()=>{removeEvent(window,"click",a),o.isFirstClick=!0}))}}};window.Dropdown=t},80452:function(){var e,t=(e=document.getElementsByClassName("gift_create_post_counter"),{counter:function(t){var n=e[0];if(n){var o=t.value.length,a=t.maxLength;if(o>a)t.value=t.value.substr(0,a);else if(o>a/2){var i=Math.max(a-o,0);n.innerText=langNumeric(i,lang.text_N_symbols_remain),show(n)}else hide(n)}}});window.GiftsSendFormCounter=t},21190:function(){var e,t,n=(e="_locked",t={1:"SEND_EMAIL",2:"CALL_PHONE",6:"OPEN_GROUP_APP"},{processButton:function(n,o,a,i,r,s){if(void 0===s&&(s=!1),n.classList.contains(e))return!1;var l=!0;return t[o]&&(l=!1),n.classList.add(e),ajax.post("/groups",{_ajax:1,act:"proxy_cta_button",action:o,resource:a,group_id:i,hash:r},{onDone:function(){if(n.classList.remove(e),s)s();else if(l){var t=attr(n,"href");nav.go(t)}}}),!l}});window.GroupActionButton=n},56626:function(){var e=function(){function e(e){var t=e.closest(".si_body");return{buttons:$(".si_links",t),message:$(".si_msg",t)}}return{sendRequest:function(t,n){t&&t.preventDefault();var o=n.getAttribute("href");ActionMenu.closeMenu();var a=e(n);ajax.post(o,{_ajax:1},{onDone(e){!function(e){hide(e.buttons),show(e.message)}(a),val(a.message,e)}})},cancelRequest:function(t,n){t&&t.preventDefault();var o=n.getAttribute("href"),a=e(n);ajax.post(o,{_ajax:1},{onDone(e){}}),function(e){hide(e.message),show(e.buttons)}(a)}}}();window.GroupsInvite=e},10708:function(e,t,n){"use strict";n.d(t,{showHeader:function(){return y},getHeaderHeight:function(){return k}});var o,a,i,r,s,l=n(20848),c="basis__header_noshadowAnim",d="basis__header_noTransition",u="basis__header_hidden",_="BottomMenu__updateButton_offset",p="basis__header_nohide",m=!1,f=(0,l.scrollTop)(),v=56,g=!1,h=!1,w=[];function y(e){void 0===e&&(e=E());var t=document.body;t&&"fixed"===(0,l.getStyle)(t,"position")||e.classList.remove(u)}function k(e){return void 0===e&&(e=E()),e.offsetHeight}function b(){var e=(0,l.scrollTop)();if(o){C(o,e);var t=(0,l.ge)("mcont");if(t){var n=$(".BottomMenu__updateButton"),a=Math.max(t.scrollHeight,parseInt((0,l.getStyle)(t,"height"),10));if(h&&e)return;if(Math.abs(f-e)<=v)return;o.classList.contains(p)||(e>f+20&&e>v?(!function(e){void 0===e&&(e=E()),e.classList.add(u)}(o),n&&n.classList.add(_),h=!0,setTimeout((()=>{h=!1}),200)):e+window.innerHeight<a&&(y(o),n&&n.classList.remove(_)))}var i=document.body;i&&"fixed"!==(0,l.getStyle)(i,"position")&&(f=e)}}function S(){if(m&&(clearInterval(s),(0,l.onBodyScroll)("__clear",a),removeEvent(window,"touchend",i),w.forEach((e=>{removeEvent(e,"blur",i)})),m=!1),!m){o=E(),v=parseInt((0,l.getStyle)(o,"height"),10),f=(0,l.scrollTop)();var e=$(".BottomMenu__updateButton");o&&(o.classList.add(d),y(o),e&&e.classList.remove(_)),C(o,(0,l.scrollTop)()),a=()=>{g=!0},i=()=>{clearInterval(r),r=setTimeout((()=>{var t=(0,l.ge)("mcont");if(t){var n=Math.max(t.scrollHeight,parseInt((0,l.getStyle)(t,"height"),10));window.innerHeight>n&&n&&(y(o),e&&e.classList.remove(_))}}),100)},setTimeout((()=>{g=!1}),0),setTimeout((()=>{o&&o.classList.remove(d)}),200),m||(s=setInterval((function(){g&&(b(),g=!1)}),250),(0,l.onBodyScroll)(a),addEvent(window,"touchend",i,{passive:!0}),(w=Array.from($$("input, textarea")||[])).forEach((e=>{addEvent(e,"blur",i)})),m=!0)}}function C(e,t){e&&e.classList.contains(p)||(t<=5&&e&&e.classList.contains("basis__header_noshadow")?e.classList.add(c):e&&e.classList.remove(c))}function E(){return $(".basis__header")}function T(){(o=E())&&(y(o),C(o,(0,l.scrollTop)()))}onDOMReady((()=>{S(),window.page.onChange(S),onBodyResize(T),addEvent(window,"orientationchange",T),addEvent(window,"blur",T)}))},61982:function(e,t,n){"use strict";var o=n(20848),a={cachedProgress:{}},i={init(e,t){return void 0===e&&(e=(0,o.srand)()),void 0===t&&(t=20),this.radius=t,{component:this._getLoader(e,a.cachedProgress[e]),id:e}},update(e,t){var n=$('[data-loader-id="'+e+'"] circle');if(n){var o=this.radius,i=Math.PI*(2*o);a.cachedProgress[e]=t;var r=(100-Math.max(5,t))/100*i;n.setAttribute("stroke-dashoffset",r)}},ready(e){var t=$('[data-loader-id="'+e+'"]');re(t)},_getLoader(e,t){void 0===t&&(t=0);var n=this.radius,o=Math.PI*(2*n);return{class:"Loader",inner:[{class:"Loader__progress","data-loader-id":e,inner:{tag:"svg",viewPort:"0 0 100 100",inner:{tag:"circle",r:n,cx:"30",cy:"30","stroke-dashoffset":(100-Math.max(5,t))/100*o,"stroke-dasharray":o}}}]}}};t.default=i},22875:function(){var e={show(t,n){window.grecaptcha?grecaptcha.reset():(window.recaptchaCallback=function(){e.onCallback(t)},document.body.appendChild(ce("script",{type:"text/javascript",src:"https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit&hl="+n})))},onResponse(e){ge("field_recaptcha").value=e,ge("recaptcha_form").submit()},onCallback(t){if(grecaptcha&&t){var n=geByClass1("recaptcha_box"),o=geByClass1("recaptcha",n);o&&(val(o,""),grecaptcha.render(o,{sitekey:t,callback:e.onResponse}))}}};window.ReCaptcha=e},22422:function(){var e={OPEN_CLASS:"reply_owner_show",OPEN_BOTTOM_CLASS:"reply_owner_open_bottom",NO_LIMIT_CLASS:"reply_owner_picker_nolimit",CONTAINER_CLASS:"reply_owner_picker_container",PICKER_CLASS:"reply_owner_picker",PICKER_ITEM_CLASS:"reply_owner_option",LOADING_CLASS:"reply_owner_loading",IMAGE_CLASS:"_reply_owner_image",SELECTED_IMAGE_CLASS:"_reply_owner_selected_image",SELECTED_IMAGE_CONTAINER_CLASS:"reply_owner_selected_image",OPTION_CLASS:"reply_owner_option",PICKER_MAX_HEIGHT:null,LOADING_SHOW_TIME:300,container:null,picker:null,clickEvent:"ontouchend"in document.documentElement?"touchend":"click",clickHandler:null,requestHandler:null,request:null,loading:!1,setElements(e){this.container=gpeByClass(this.CONTAINER_CLASS,e),this.picker=geByClass1(this.PICKER_CLASS,this.container),this.clickHandler=this.clickHandler||bind(this.onDocumentClick,this),this.requestHandler=this.requestHandler||bind(this.onDocumentClickBeforeLoad,this)},unsetElements(){removeEvent(document.body,this.clickEvent,this.clickHandler),removeEvent(document.body,this.clickEvent,this.requestHandler),this.container=this.picker=null},show(e){this.setElements(e),addClass(this.OPEN_CLASS,this.container),this.calcPosition()},hide(){removeClass(this.OPEN_CLASS,this.container),removeClass(this.OPEN_BOTTOM_CLASS,this.container),this.unsetElements()},toggle(){toggleClass(this.OPEN_CLASS,this.container),this.calcPosition(),hasClass(this.OPEN_CLASS,this.container)?(this.scrollToSelected(),addEvent(document.body,this.clickEvent,this.clickHandler)):(this.hide(),this.unsetElements())},calcPosition(){var e=ge("mhead").offsetHeight,t=this.picker.getBoundingClientRect(),n=domClosestOverflowHidden(this.picker),o=!0;n&&n.getBoundingClientRect().bottom<this.container.getBoundingClientRect().bottom+this.PICKER_MAX_HEIGHT?o=!1:hasClass(this.LOADING_CLASS,this.container)?o=t.top-e-this.PICKER_MAX_HEIGHT+t.height<0:hasClass(this.OPEN_BOTTOM_CLASS,this.container)||(o=t.top-e<0),toggleClass(this.OPEN_BOTTOM_CLASS,this.container,o)},onDocumentClick(e){var t=e.target;t===this.container||gpeByClass(this.CONTAINER_CLASS,t)||this.hide()},onDocumentClickBeforeLoad(e){var t=e.target;t===this.container||gpeByClass(this.CONTAINER_CLASS,t)||this.cancelRequest()},cancelRequest(){this.request&&(this.request.abort(),this.unsetElements())},getList(){if(!this.loading){this.PICKER_MAX_HEIGHT=parseInt(getStyle(this.picker,"maxHeight"),10);var e=geBySel1('input[name="from_oid"]',this.container).value,t=geBySel1('input[name="post_oid"]',this.container).value;this.loading=!0;var n=setTimeout((()=>{addClass(this.LOADING_CLASS,this.container),this.calcPosition()}),this.LOADING_SHOW_TIME);addEvent(document.body,this.clickEvent,this.requestHandler),this.request=ajax.post("/wall.php",{act:"get_reply_clubs_list",oid:e,post_oid:t},{onDone:e=>{clearTimeout(n),this.picker.innerHTML=e,this.onLoadEnd(),this.toggle(this.picker)},onFail:()=>{this.onLoadEnd()}})}},onLoadEnd(){this.loading=!1,removeClass(this.LOADING_CLASS,this.container),removeEvent(document.body,this.clickEvent,this.requestHandler)},onChange(e){var t=gpeByClass(this.OPTION_CLASS,e),n=geByClass1(this.IMAGE_CLASS,t).src;each(geByClass(this.SELECTED_IMAGE_CLASS),(function(){this.src=n})),attr(geByClass1("al"+this.SELECTED_IMAGE_CLASS),"href",attr(t,"data-href")),this.hide()},onClick(e){this.setElements(e),geByClass(this.PICKER_ITEM_CLASS,this.picker).length?this.toggle():this.getList()},scrollToSelected(){var e=gpeByClass(this.OPTION_CLASS,geBySel1(":checked",this.picker));this.PICKER_MAX_HEIGHT||(this.PICKER_MAX_HEIGHT=parseInt(getStyle(this.picker,"maxHeight"),10)),e&&(this.picker.scrollTop=e.offsetTop-this.PICKER_MAX_HEIGHT/2+e.offsetHeight/2)}};window.replyOwnerPicker=e},73210:function(){window.SubscribeBtn={onClick:function(t,n,o,a,i,r){try{var s=r+"_unsubscribe",l=r+"Icon",c=r+"Icon_unsubscribe",d=r+"Icon_subscribe",u=hasClass(t,s),_=u?a:o,p=u?getLang("mobile_groups_public_subscribe"):getLang("mobile_groups_you_are_in_public"),m=!u,f=geByClass1(l,t),v=function(t){var n=intval(domData(t,"block-id"));if(!n){var o=domCA(t,e);n=intval(domData(o,"block-id"))||null}return n}(t),g=domData(t,"from")||null;f&&(toggleClass(c,f,m),toggleClass(d,f,!m)),attr(t,"aria-label",escapeAttr(p)),toggleClass(s,t,m),"group"===i?function(e,t,n,o){(n?Groups.leave:Groups.enter).call(Groups,e,t,o)}(n,_,u):function(e,t,n,o,a){(n?Friends.decline:Friends.accept).call(Friends,e,t,o,a)}(n,_,u,g,v)}catch(e){console.trace(e)}return!1}};var e=".feedAssistance"},18782:function(e,t,n){"use strict";n.d(t,{default:function(){return U}});var o=n(59066),a=n(87531),i=n(71231),r=n(62641);function s(e){return void 0===e&&(e={}),(0,o.Circle)({class:"SkeletonAvatar",style:e.style})}function l(e){var t=(0,r.stylesObjectToString)({opacity:e?e.opacity:1});return{inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[s({style:t})],auto:!0}),(0,i.SkeletonCol)({inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})],grow:3}),(0,i.SkeletonCol)({grow:4})]}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({small:!0,style:t})]}),(0,i.SkeletonCol)({grow:3})]})],flexColumn:!0})]}),(0,i.SkeletonOffset)(),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})],grow:4}),(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})],grow:3})]}),(0,i.SkeletonOffset)(),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})],grow:4}),(0,i.SkeletonCol)({grow:1})]}),(0,i.SkeletonOffset)(),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})],grow:4}),(0,i.SkeletonCol)({grow:3})]}),(0,i.SkeletonOffset)(),(0,i.SkeletonOffset)(),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,o.Circle)({size:24,style:t})],auto:!0}),(0,i.SkeletonOffset)(),(0,i.SkeletonCol)({inner:[(0,o.Circle)({size:24,style:t})],auto:!0}),(0,i.SkeletonOffset)(),(0,i.SkeletonCol)({inner:[(0,o.Circle)({size:24,style:t})],auto:!0}),(0,i.SkeletonCol)({grow:1}),(0,i.SkeletonCol)({inner:[(0,o.Circle)({size:24,style:t})],auto:!0})]})],class:"SkeletonWallBlock Post__rowPadding",tag:"div"}}var c=n(64485);function d(e){void 0===e&&(e={});var t=(0,r.getRandomId)("skeleton-search"),n=(0,r.stylesObjectToString)({})+(e.style||"");return{id:t,"data-skeleton-el":"true",class:["SkeletonComponent","SkeletonComponent__item",c.default.class("SkeletonSearch",{small:e.small,header:e.header}),e.class].filter((e=>e)).join(" "),style:n,tag:"div"}}function u(){return{inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[d({header:!0})]}),(0,i.SkeletonOffset)({small:!0}),(0,i.SkeletonCol)({inner:[(0,o.Circle)({class:"SkeletonSearchHeader__icon",header:!0,size:28})],auto:!0})]})],flexColumn:!0})]})],class:"SkeletonSearchHeader",tag:"div"}}var _=n(59336);var p=function(){for(var e=(0,r.getClientSizes)().height,t=e?Math.ceil((e-56)/210):10,n=[],o=0;o<t;o++)n.push(l({opacity:1}));return{inner:[u(),(0,_.Separator)(),n],class:"SkeletonComponent__page SkeletonRecommended Skeleton",tag:"div"}};function m(e){void 0===e&&(e={});var t=(0,r.stylesObjectToString)({opacity:e.opacity});return{inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,o.Circle)({size:50,style:t})],auto:!0}),(0,i.SkeletonCol)({inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})],grow:3}),(0,i.SkeletonCol)({grow:4}),(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})]})],justify:"center"}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})]}),(0,i.SkeletonCol)({inner:[(0,a.Line)({style:t})],grow:5}),(0,i.SkeletonCol)({grow:3,style:t})]})],flexColumn:!0})]})],class:"SkeletonChatBlock Post__rowPadding",tag:"div"}}function f(e){void 0===e&&(e={});var t={};e.hideIcon&&(t.visibility="hidden");var n=(0,r.stylesObjectToString)(t);return{inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({header:!0})],grow:5}),(0,i.SkeletonCol)({grow:5}),(0,i.SkeletonCol)({inner:[(0,o.Circle)({class:"SkeletonHeader__icon",header:!0,size:28,style:n})],auto:!0})]})],flexColumn:!0})]})],class:"SkeletonHeader Post__rowPadding",tag:"div"}}function v(e){return{inner:[d()],class:"SkeletonSearchBlock Post__rowPadding",tag:"div"}}var g=n(13933);function h(e){for(var t=Math.ceil((window.innerHeight-g.HEADER_HEIGHT)/70),n=[],o=0;o<t;o++)n.push(m());return{inner:[f(),v(),n],class:"SkeletonComponent__page SkeletonMessages Skeleton",tag:"div"}}function w(e){void 0===e&&(e={opacity:1});var t=e.opacity||1,n=(0,r.stylesObjectToString)({opacity:t});return{inner:[(0,o.Circle)({class:"SkeletonStory__avatar",size:56,style:n}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)({small:!0}),(0,i.SkeletonCol)({inner:[(0,a.Line)({small:!0,style:n})]}),(0,i.SkeletonOffset)({small:!0})]})],class:"SkeletonStory",tag:"div"}}function y(e){void 0===e&&(e={});for(var t=(0,r.getClientSizes)().width,n=t?Math.ceil(t/80):10,o=[],a=0;a<n;a++)o.push((0,i.SkeletonCol)({inner:[w()],auto:!0}));var s=(0,r.classNames)("SkeletonStoriesBlock Post__rowPadding Pad",{"SkeletonStoriesBlock--vkui":e.vkui});return{inner:[(0,i.SkeletonRow)({inner:[o]})],class:s,id:e.id,tag:"div"}}var k=function(){return{inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,o.Circle)({size:40})],auto:!0}),(0,i.SkeletonCol)({inner:[d()]})],justify:"center"})],class:"SkeletonNewPostBlock Post__rowPadding Pad",tag:"div"}};var b=function(){for(var e=(0,r.getClientSizes)().height,t=e?Math.ceil((e-56-180)/210):10,n=[],o=0;o<t;o++)n.push(l({opacity:1}));return{inner:[f({hideIcon:!0}),k(),y(),n],class:"SkeletonComponent__page SkeletonFeed Skeleton",tag:"div"}};function S(e){void 0===e&&(e={});var t=(0,r.getRandomId)("skeleton-line"),n=(0,r.stylesObjectToString)({width:e.size+"px",height:e.size+"px"})+(e.style||"");return{id:t,"data-skeleton-el":"true",class:["SkeletonComponent","SkeletonComponent__item",c.default.class("SkeletonSquare"),e.class].filter((e=>e)).join(" "),style:n,tag:"div"}}function C(e){return{inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,o.Circle)({size:48}),(0,o.Circle)({size:20,class:"SkeletonNotificationBlock__badge"})],auto:!0,class:"SkeletonNotificationBlock__avatar"}),(0,i.SkeletonCol)({inner:[(0,i.SkeletonOffset)({small:!0}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)()]})]}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)()],grow:2}),(0,i.SkeletonCol)()]}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({small:!0})]}),(0,i.SkeletonCol)({grow:5})]})],grow:6}),(0,i.SkeletonCol)(),(0,i.SkeletonCol)({inner:[S({size:48})],auto:!0})],align:"flex-start"}),(0,i.SkeletonOffset)(),(0,i.SkeletonOffset)(),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,o.Circle)({size:48})],auto:!0}),(0,i.SkeletonCol)({inner:[(0,i.SkeletonOffset)({small:!0}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)()]})]}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({small:!0})]}),(0,i.SkeletonCol)({grow:5})]}),(0,i.SkeletonOffset)()],grow:4}),(0,i.SkeletonCol)({inner:[(0,i.SkeletonOffset)()]})],align:"flex-start"})],class:"SkeletonNotificationBlock Post__rowPadding",tag:"div"}}var E=n(19228);function T(e){for(var t=Math.ceil((window.innerHeight-g.HEADER_HEIGHT)/170),n=[],o=0;o<t;o++)n.push(C());return{inner:[f({hideIcon:!0}),(0,E.Separator)(),{inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)()],grow:3}),(0,i.SkeletonCol)({grow:2}),(0,i.SkeletonCol)({inner:[(0,a.Line)()],grow:2})]})],class:"SkeletonNotifications__info Post__rowPadding",tag:"div"},n],class:"SkeletonComponent__page SkeletonNotifications Skeleton",tag:"div"}}function I(){for(var e=[],t=0;t<3;t++)e.push([(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)(),(0,o.Circle)({size:48}),(0,i.SkeletonCol)({inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)(),(0,i.SkeletonCol)({inner:[(0,a.Line)(),(0,i.SkeletonOffset)({small:!0}),(0,a.Line)()]})]})]}),(0,i.SkeletonOffset)()]}),(0,i.SkeletonOffset)({class:"SearchCatalogBlockSkeleton__offset"})]);return{inner:[(0,i.SkeletonCol)({inner:[e]})],class:"SearchCatalogBlockSkeleton",tag:"div"}}function M(e){void 0===e&&(e={});var t=(0,r.classNames)("SearchCatalogBlockHeaderSkeleton__line",{"SearchCatalogBlockHeaderSkeleton__line--short":e.shortLine});return[(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)(),(0,i.SkeletonCol)({inner:[(0,i.SkeletonRow)({inner:[(0,a.Line)({class:"SearchCatalogBlockHeaderSkeleton__line"}),(0,a.Line)({class:t})],class:"SearchCatalogBlockHeaderSkeleton__headerRow"})]}),(0,i.SkeletonOffset)()],class:"SearchCatalogBlockHeaderSkeleton"})]}function P(){return{inner:[(0,i.SkeletonCol)({inner:[(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)({class:"SearchCatalogSeparatorSkeleton__offset"}),{class:"SearchCatalogSeparatorSkeleton__separatorLine",tag:"div"},(0,i.SkeletonOffset)({class:"SearchCatalogSeparatorSkeleton__offset"})]})]})],class:"SearchCatalogSeparatorSkeleton",tag:"div"}}function L(e){void 0===e&&(e={squareAvatar:!1});for(var t=(0,r.getClientSizes)().width,n=t?Math.ceil(t/80):10,s=[],l=0;l<n;l++)s.push((0,i.SkeletonCol)({inner:[{inner:[e.squareAvatar?S({class:"SearchCatalogRecentSkeleton__avatar SearchCatalogRecentSkeleton__avatar--square",size:64}):(0,o.Circle)({class:"SearchCatalogRecentSkeleton__avatar",size:64}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)({small:!0}),(0,i.SkeletonCol)({inner:[(0,a.Line)({small:!0,class:"SearchCatalogRecentSkeleton__line"})]}),(0,i.SkeletonOffset)({small:!0})]})],tag:"div"}],auto:!0}));return(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)(),{inner:[(0,i.SkeletonRow)({inner:[s]})],class:"SearchCatalogRecentSkeleton__inner",tag:"div"},(0,i.SkeletonOffset)()],class:"SearchCatalogRecentSkeleton"})}function B(){for(var e=(0,r.getClientSizes)().width,t=e?Math.ceil(e/80):10,n=[],o=0;o<t;o++)n.push((0,i.SkeletonCol)({inner:[{inner:[S({class:"SearchCatalogMarketItemsSkeleton__avatar",size:135}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({small:!0,class:"SearchCatalogMarketItemsSkeleton__line"})]})]}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({small:!0,class:"SearchCatalogMarketItemsSkeleton__line"})]})]}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonCol)({inner:[(0,a.Line)({small:!0,class:"SearchCatalogMarketItemsSkeleton__line"})]})]})],tag:"div"}],auto:!0}));return(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)(),{inner:[(0,i.SkeletonRow)({inner:[n]})],class:"SearchCatalogMarketItemsSkeleton__block",tag:"div"},(0,i.SkeletonOffset)()],class:"SearchCatalogMarketItemsSkeleton"})}function A(){for(var e=[],t=0;t<4;t++)e.push((0,i.SkeletonCol)({inner:[(0,i.SkeletonRow)({inner:[(0,a.Line)({class:"SearchTabSkeleton__tabLine"})]})],class:"SearchTabSkeleton"}));return{inner:[(0,i.SkeletonOffset)(),(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)(),e,(0,i.SkeletonOffset)()],class:"SearchTabsSkeleton__tabsRow"}),{inner:[P()],class:"SearchTabsSkeleton__tabsSeparator",tag:"div"}],class:"SearchTabsSkeleton",tag:"div"}}function O(e){void 0===e&&(e={});var t=[M({shortLine:!0}),L()];return e.q&&(t=""),{inner:[{inner:[A(),{inner:[(0,i.SkeletonOffset)({class:"SearchInputSkeleton__offset"}),(0,i.SkeletonRow)({inner:[(0,i.SkeletonOffset)({class:"SearchInputSkeleton__offset"}),(0,a.Line)({class:"SearchInputSkeleton__line"}),(0,i.SkeletonOffset)({class:"SearchInputSkeleton__offset"})],class:"SearchInputSkeleton__inputRow"}),(0,i.SkeletonOffset)({class:"SearchInputSkeleton__offset"})],class:"SearchInputSkeleton",tag:"div"}],"data-id":"search_catalog_header",class:"SearchCatalogHeaderSkeleton",tag:"div"},{"data-id":"search_catalog_root",tag:"div"},{inner:[t,P(),M(),I(),P(),M(),I(),P(),M(),B(),P(),M(),L({squareAvatar:!0})],"data-id":"search_catalog_skeleton",tag:"div"}],"data-id":"search_catalog_container",class:"SearchCatalogRootSkeleton",tag:"div"}}var x=n(94365),R=n(52822),N=n(89558),D=n(53602),F=function(){var e="BottomMenu__counter",t="BottomMenu__updateButton",n="vk_tabbar_hidden",o="data-tabbar",a="feed",i="recommend",r="search",s="messages",l="notification",c="menu",d=Math.max(window.innerHeight,window.innerWidth),u="",_={},m={[a]:0,[i]:0,[r]:0,[s]:0,[l]:0,[c]:0};function f(e){var t=geBySel1('[data-tabbar="'+e+'"]');return attr(t,"data-default")}function v(t){each(geBySel("[data-tabbar]"),((n,a)=>{var i=geByClass1("_BottomMenu__icon_js",a),r=geByClass1(e,i),s=attr(a,"data-counter"),l=attr(a,o);t({i:n,tabId:l,counter:s,$link:a,$icon:i,$counter:r})}))}function w(){v((t=>{var{$counter:n,$icon:o,$link:a,tabId:i}=t,r=m[i],s=o.outerHTML.includes("Tooltip");if(r&&0!==r||s)if(n&&!s)val(n,r);else{var l,c=ceFromString(o.outerHTML),d=ce("div",{className:e,innerHTML:r});if(s)val(o,null==(l=$(".Tooltip",c))?void 0:l.outerHTML);r&&append(d,o)}else val(o,"")}))}function y(e){setTimeout((()=>{k()}),0);var t=Wd.html({class:"pcont bl_cont",inner:{id:"al_loading",class:"BottomMenu__preloader"}});val(geByClass1("mcont",e),t)}function k(){var e=$("."+t);remove(e)}return{setCurrentId:function(e){u=e},setHistory:function(e){_=extend({},e)},setCounter:function(e,t){m[e]=t?parseInt(t,10):0,w()},getCurrentId:function(){return u},getDefaultURL:f,getHeight:function(){var{bodyNode:e}=window,t=geBySel1(".BottomMenu");return e.classList.contains("vk_tabbar_bottom")?t.firstElementChild.offsetHeight:t.offsetHeight},getTabCounter:function(e){return m[e]?m[e]:0},drawUI:function(){v((e=>{var{$icon:t,$link:n,tabId:o}=e,a=_[o];if(a){var i=a.filter((e=>!0===e.current))||[];i.length&&o!==s&&attr(n,"href",i[0].a);var r=attr(n,"href");o!==u||!i.length||i[0].a!==r&&i[0].d!==r||attr(n,"href",f(o))}toggleClass("BottomMenu__icon_active",t,o===u)})),w()},drawUICounters:w,drawLoader:y,drawSkeletonLoader:function(e,t){var n,o;if(hasClass(document.querySelector(".vk"),"vk_flex_yes")){switch(setTimeout((()=>{k()}),0),t){case a:$(".mcont",e).innerHTML=Wd.html(b());break;case s:$(".mcont",e).innerHTML=Wd.html(h());break;case l:$(".mcont",e).innerHTML=Wd.html(T());break;case i:$(".mcont",e).innerHTML=Wd.html(p());break;case r:null==(n=$(".mcont",e))||null==(o=n.classList)||o.add("basis__content--noPadding"),$(".mcont",e).innerHTML=Wd.html((void 0===c&&(c={}),{inner:[O({q:!!c.q})],class:"SearchCatalogRoot",tag:"div"}));break;default:y(e)}var c;(0,g.processSkeletonElements)()}else y(e)},showUpdateButton:function(e){var{lang:n}=window,o=Wd.html({class:t,inner:{class:"BottomMenu__updateButton_container",inner:{class:"BottomMenu__updateButton_wrap",onclick:["nav.updateCurrentPage"],inner:[{class:"BottomMenu__updateButton_icon",inner:(0,R.default)((0,N.getUpUpdate16Icon)())},{class:"BottomMenu__updateButton_text",inner:n.mobile_menu_refresh_button}]}}}),a=e.$(".upanel");a.$("."+t)||a.insertBefore(ceFromString(o),a.firstChild)},removeUpdateButton:k,onFocusIn:function(e){var t=geBySel1(".BottomMenu"),o=e&&e.target;if(o&&t&&browser.android){var a=!1;"textarea"===o.tagName.toLowerCase()&&(a=!0),"input"!==o.tagName.toLowerCase()||["checkbox","radio"].includes(o.type)||(a=!0),"select"===o.tagName.toLowerCase()&&(a=!0),a&&t.classList.add(n)}},onFocusOut:function(){var e=geBySel1(".BottomMenu");e&&e.classList.remove(n)},onResize:function(){var{bodyNode:e}=window;(0,D.getCurrentLayout)()>=D.LAYOUT.DESKTOP&&$(".Skeleton")&&($(".mcont").innerHTML='<div class="pcont bl_cont"><div id="al_loading"></div></div>',(0,x.alLoadingFix)()),e&&e.classList.contains("vk_tabbar_bottom")&&0===Math.abs(window.orientation)&&d-180>window.innerHeight?e.classList.add(n):e&&e.classList.remove(n)},setDefaultCounters:function(){v((e=>{var{tabId:t,counter:n}=e;m[t]=n?parseInt(n,10):0})),w()},isFixedToTop:function(){var{bodyNode:e}=window;return e&&e.classList.contains("vk_tabbar_top")},isFixedToBottom:function(){var{bodyNode:e}=window;return e&&e.classList.contains("vk_tabbar_bottom")},TAB_ID_FEED:a,TAB_ID_RECOMMEND:i,TAB_ID_SEARCH:r,TAB_ID_MESSAGES:s,TAB_ID_NOTIFICATION:l,TAB_ID_MENU:c,TAB_IDS:[a,i,r,s,l,c]}}();window.Tabbar=F;var U=F;window.page&&page.onRestore(F.drawUI),window.page&&page.onChange(F.drawUI),onDOMReady((()=>{var e;F.setDefaultCounters(),addEvent(window,"resize",(()=>{F.onResize(),clearTimeout(e),e=setTimeout((()=>{F.onResize()}),300)}))}))},61969:function(){function e(e){(e=ge(e))&&(addClass(e,"profileEdit_selected"),setTimeout((function(){addClass(e,"profileEdit_animated"),setTimeout((function(){removeClass(e,"profileEdit_selected"),removeClass(e,"profileEdit_animated")}),1e3)}),1500))}function t(t){(t=ge(t))&&setTimeout((function(){var n=getXY(t)[1],o=getSize("mhead")[1],a=scrollGetY(),i=getCh();n<o+a||n>a+i?setTimeout((()=>{scrollTo(0,n-o),e(t)}),0):e(t)}),0)}window.ProfileEditor={init:function(){var e=(qs2obj(nav.params)||{}).hl;e&&t(geByClass1("_"+e))},highlightRow:e,scrollHighlightRow:t}},40111:function(){function e(e,o){var{$select:a,value:i}=o;a.closest(t.email).classList.toggle(n.groupsVisible,e.includes(i)||e.includes(Number(i)))}window.SettingsEmail={},SettingsEmail._onFrequencyChange=e;var t={email:".settingsEmail"},n={groupsVisible:"settingsEmail_groupsVisible"}},74141:function(){window.SettingsNotifyGroup={},SettingsNotifyGroup._onChange=n;var e=".settingsNotifyGroup",t=".settingsNotifyGroup__description";function n(n,o){var{$control:a}=o;a.closest(e).$(t).innerHTML=n}},19704:function(){function e(e){return t=>{var{$control:a}=t;a.closest(n.sms).classList.toggle(o[e])}}function t(e,t){var{$select:a,value:i}=t;a.closest(n.sms).classList.toggle(o.pmUsersVisible,e.includes(i)||e.includes(Number(i)))}window.SettingsSms={},SettingsSms._onEnabledChange=e("enabled"),SettingsSms._onTimeLimitedChange=e("timeLimited"),SettingsSms._onFrequencyChange=t;var n={sms:".settingsSms"},o={enabled:"settingsSms_enabled",timeLimited:"settingsSms_timeLimited",pmUsersVisible:"settingsSms_pmUsersVisible"}},54755:function(){var e="";window.DonutDuration={init:function(t){e=t.select_url||""},selectDuration:function(t){var n=document.querySelector("#value_link");if(n){var o=e.replace("{value}",t);n.setAttribute("href",o)}}}},34109:function(e,t,n){"use strict";n.d(t,{getKeyboardState:function(){return l},getKeyboardType:function(){return c},setKeyboardType:function(){return d},clearCallbackButtons:function(){return _},stopCallbackButtonWaiting:function(){return p},registerCallbackButtonEvent:function(){return m},loadDrafts:function(){return f},getPeerDraft:function(){return v},setPeerDraft:function(){return g},pushPeerAttachments:function(){return h},popPeerAttachments:function(){return w},setPeerTyping:function(){return y},removePeerTypingUser:function(){return k},filterPeerTypingUser:function(){return b},replacePeer:function(){return C},removePeer:function(){return E},addPeer:function(){return T},addPendingMsg:function(){return I},getPendingMsg:function(){return M},removePendingMsg:function(){return P},removeFailedMsg:function(){return L},failAllPendingMsgs:function(){return B},queueToPresendMsgs:function(){return A},saveFolderScroll:function(){return O},restoreFolderScroll:function(){return x}});var o=n(85863),a=(n(48572),n(12344)),i=n(81294),r=n(40906),s=n(20848);function l(e){var{keyboards:t}=store.mail.cur,n=t[e];return n||(n=t[e]={}),n}function c(){return store.mail.cur&&store.mail.cur.keyboardType||""}function d(e){store.mail.cur&&(store.mail.cur.keyboardType=e)}var u={};function _(e,t){void 0===t&&(t=!1),store.mail.cur.pressedButtons&&(t?delete store.mail.cur.pressedButtons.msgs[t]:delete store.mail.cur.pressedButtons.peers[e])}function p(e){var t=u[e];if(t){var n,{peerId:o,msgId:a,position:r,button:s,inline:l}=t;if(l?store.mail.cur.pressedButtons.msgs[a]&&delete store.mail.cur.pressedButtons.msgs[a][r.join(",")]:store.mail.cur.pressedButtons.peers[o]&&delete store.mail.cur.pressedButtons.peers[o][r.join(",")],delete u[e],!bodyNode.contains(s))(n=l?$(".msg_id_"+a+" .BotsKeyboard__main"):$(".uMailWrite__keyboard .BotsKeyboard__main"))&&(s=$('.BotsKeyboard__button[data-position="'+r.join(",")+'"]',n));s&&i.default.setLoading(s,!1)}}function m(e,t,n,o,a){var l=((0,s.domData)(t,"position")||"").split(",");if(!l)return i.default.setLoading(t,!1),clog("Can't find button position for callback event"),!1;if(u[n]={time:(0,r.vkNow)(),peerId:e,msgId:o,button:t,position:l,inline:!!o},store.mail.cur.pressedButtons||(store.mail.cur.pressedButtons={peers:{},msgs:{}}),l[0]&&l[1])if(o){var c="";a&&(c=a+"|"),store.mail.cur.pressedButtons.msgs[o]||(store.mail.cur.pressedButtons.msgs[o]={}),store.mail.cur.pressedButtons.msgs[o][c+l.join(",")]=n}else store.mail.cur.pressedButtons.peers[e]||(store.mail.cur.pressedButtons.peers[e]={}),store.mail.cur.pressedButtons.peers[e][l.join(",")]=n;setTimeout((()=>{p(n)}),6e4)}function f(e){var{drafts:t}=store.mail.cur;return t||(t=lsGet("mail_drafts_"+e),t=store.mail.cur.drafts=t||{}),t}function v(e,t){var n=f(e);return n[t]||(n[t]={})}function g(e,t,n,a){var{drafts:i}=store.mail.cur;if(i||(i=store.mail.cur.drafts=i||{}),a){var r=i[t],s=r&&r.editing&&r.editing.id===a?r.editing:void 0;i[t]=(0,o.default)({},r,{editing:(0,o.default)({},s,{},n,{id:a})})}else i[t]=(0,o.default)({},i[t],{},n,{editing:void 0});lsSet("mail_drafts_"+e,i)}function h(e,t){var n=store.mail.peers[e];n.attachmentsStack.push(n.attachmentsHTML),n.attachmentsHTML=t}function w(e){var t=store.mail.peers[e],n=t.attachmentsStack.pop();n||(n=Brick({mix:"cp_attached_wrap",attrs:'id="attached_wrap"'})),t.attachmentsHTML=n}function y(e,t){var n=store.mail.cur.typings[e];if(n||(n=store.mail.cur.typings[e]={}),"text"!==t.type&&"audio"!==t.type||(t.count?n[t.type]=t:n[t.type]=null),n.text&&n.audio){var o=S(n.text,n.audio);n.mixed=o.count>1?o:null}else n.mixed=null}function k(e,t){var n=store.mail.cur.typings[e];if(n){var o=n.audio,a=n.text;if(o&&((o=b(o,t)).count?n.audio=o:n.audio=null),a&&((a=b(a,t)).count?n.text=a:n.text=null),n.text&&n.audio){var i=S(n.text,n.audio);n.mixed=i.count>1?i:null}else n.mixed=null}}function b(e,t){var n=e.users.filter((e=>e!==t));return n.length!==e.users.length&&(e.count=e.count-(e.users.length-n.length),e.users=n),e}function S(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>(e.count+=t.count,t.users.reduce(((e,t)=>(-1===e.users.indexOf(t)?e.users.push(t):e.count--,e)),e))),{users:[],count:0,type:"mixed"})}function C(e,t){var{mail:n}=store,o=n.scraps.folder,a=o.indexOf(e);-1!==a&&(t?o.splice(a,1,t):o.splice(a,1)),Object.keys(n.rolls.folder).forEach((o=>{var a=n.rolls.folder[o],i=a.indexOf(e);-1!==i&&(t?a.splice(i,1,t):a.splice(i,1))})),t&&(n.rolls.peer[t]=n.rolls.peer[e],n.reached.peer.before[t]=n.reached.peer.before[e],n.reached.peer.after[t]=n.reached.peer.after[e]),e!==t&&(n.rolls.peer[e]&&n.rolls.peer[e].forEach((o=>{var a=n.msgs[o];a&&(t?(a.peerId=t,a.authorId===e&&(a.authorId=t)):delete n.msgs[o])})),delete n.rolls.peer[e],delete n.reached.peer.before[e],delete n.reached.peer.after[e],delete n.members[e],delete n.peers[e])}function E(e,t){void 0===t&&(t={});var{mail:n}=store;if(!1!==t.lists){var o=n.scraps.folder,a=o.indexOf(e);-1!==a&&o.splice(a,1),Object.keys(n.rolls.folder).forEach((t=>{var o=n.rolls.folder[t],a=o.indexOf(e);-1!==a&&o.splice(a,1)}))}!1!==t.msgs&&n.rolls.peer[e]&&n.rolls.peer[e].forEach((e=>{n.msgs[e]&&delete n.msgs[e]})),!1!==t.lists&&(delete n.rolls.peer[e],delete n.reached.peer.before[e],delete n.reached.peer.after[e]),!1!==t.data&&(delete n.members[e],delete n.peers[e])}function T(e,t){void 0===t&&(t={});var{mail:n}=store;if(t.msgs){var o=t.msgs;n.rolls.peer[e]=o,n.reached.peer.before[e]=!1,n.reached.peer.after[e]=!1}else n.rolls.peer[e]||(n.rolls.peer[e]=[],n.reached.peer.before[e]=!1,n.reached.peer.after[e]=!1);var a=n.msgs[n.rolls.peer[e][0]];n.rolls.folder.all.unshift(e),n.cur.folder&&n.scraps.folder.unshift(e),a&&(a.isUnread&&n.rolls.folder.unread.unshift(e),a.isImportant&&n.rolls.folder.important.unshift(e))}function I(e){var{presend:t}=store.mail;t.pending[e.peerId]||(t.pending[e.peerId]=[]),t.msgs[e.sendId]=e,t.pending[e.peerId].push(e.sendId)}function M(e,t){var{presend:n}=store.mail;return n.pending[t]?n.msgs[e]:null}function P(e){var{presend:t}=store.mail;if(t.pending[e.peerId]){var n=e.sendId;delete t.msgs[n],t.pending[e.peerId]=t.pending[e.peerId].filter((e=>e!==n))}}function L(e){var{presend:t}=store.mail;if(t.failed[e.peerId]){var n=e.sendId;delete t.msgs[n],t.failed[e.peerId]=t.failed[e.peerId].filter((e=>e!==n))}}function B(){var{presend:e}=store.mail,t={};Object.keys(e.msgs).forEach((n=>{var o=e.msgs[n];o.pending=!1,o.failed=!0,t[o.peerId]||(t[o.peerId]=[]),t[o.peerId].push(n)}),{}),e.pending={},e.failed=t}function A(e){var t={};Object.keys(e.items).forEach((n=>{var o=e.items[n];t[n]=(0,a.sendDataToMessage)(o.data.data,-1!==e.failed.indexOf(n))}));var n={};e.pending.forEach((e=>{var o=t[e];n[o.peerId]||(n[o.peerId]=[]),n[o.peerId].push(e)}),{});var o={};e.failed.forEach((e=>{var n=t[e];o[n.peerId]||(o[n.peerId]=[]),o[n.peerId].push(e)}),{}),store.mail.presend={msgs:t,pending:n,failed:o}}function O(e,t){var{cur:n}=store.mail;n&&(n.folderScroll||(n.folderScroll={}),n.folderScroll[e]=t)}function x(e){var{cur:t}=store.mail;if(t){t.folderScroll||(t.folderScroll={});var n=t.folderScroll[e]||0;return t.folderScroll[e]=0,n}}},93252:function(){window.Friends={onImportSuccess:befall("serviceId","friendsHtml","total"),onImportFailed:befall("serviceId"),accept:function(t,n,o,a,i,r,l,c){void 0===o&&(o="");void 0===a&&(a=null);void 0===i&&(i="");void 0===r&&(r="");void 0===l&&(l=e);void 0===c&&(c=e);s("accept",t,n,o,a,i,r,l,c)},decline:function(t,n,o,a,i,r,l,c){void 0===o&&(o="");void 0===a&&(a=null);void 0===i&&(i="");void 0===r&&(r="");void 0===l&&(l=e);void 0===c&&(c=e);s("decline",t,n,o,a,i,r,l,c)},makeImportRequest:function(e,s,c){if(!window.XMLHttpRequest)return void(window.location=e);ajax.plainpost(e,{_ajax:1},(e=>function(e,s,c){var d=parseJSON(e),u=d.user,_=d.user_hash,p=d.contacts,m=t+c;d.error?l(c):ajax.post(m,{_ajax:1,user:u,userhash:_,hash:s,contacts:p},{onDone:(e,t)=>function(e,t,s){var l=geByClass1(n),c=geByClass1(a);addClass(o,l),c&&(c.innerHTML=t,addClass(i,c)),autoScroll((()=>geByClass1(r)),ImportedFriends,{no_cache:!0}),Friends.onImportSuccess(e,t,s),window.opener&&window.opener.Friends.onImportSuccess(e,t,s)}(c,e,t),onFail:()=>l(c)})}(e,s,c)),(()=>l(c)),!0)}};var e=null,t="/friends.php?act=save_contacts&type=",n="friendsImport__loading",o=n+"_hidden",a="friendsImport__result",i=a+"_shown",r="friendsList__footerBtn_showMore";function s(e,t,n,o,a,i,r,s,l){var c={act:e,hash:n,id:t};o&&(c.from=o),a&&(c.block_id=a),i&&(c.ref=i),r&&(c.track_code=r);var d="/friends"+obj2qs(c);ajax.post(d,{_ajax:1},{onDone:s,onFail:l})}function l(e){Friends.onImportFailed(e),window.opener&&(window.opener.Friends.onImportFailed(e),window.close())}},63527:function(e,t,n){"use strict";n(10721);var o=n(20848),a=n(94365),i=n(11417),r=n(63848),s=n(41467),l=n(64485),c=n(75105),d=n(39871);window.Wd=d.default;var u=n(79573),_=n(50805),p=n(80580),m=n(54958),f=n(36461);window.CookiePolicy=function(e){return(0,_.jsx)("div",(0,u.__assign)({id:"CookiePolicyWrap",className:"CookiePolicy"},{children:(0,_.jsxs)("div",(0,u.__assign)({className:"CookiePolicy__content"},{children:[(0,_.jsxs)("div",(0,u.__assign)({className:"CookiePolicy__inner-content"},{children:[(0,_.jsxs)("div",(0,u.__assign)({className:"CookiePolicy__text-container"},{children:[(0,_.jsx)("div",{className:"CookiePolicy__icon"},void 0),(0,_.jsx)("div",(0,u.__assign)({className:"CookiePolicy__text"},{children:p.wrap(e.text)}),void 0)]}),void 0),e.is_box_banner_version?(0,_.jsx)(m.Btn,(0,u.__assign)({theme:"tertiary",size:"small",mix:"CookiePolicy__accept_button",className:"CookiePolicy__acceptAllButton",use_native_onclick:!0,onClick:"CookiePolicy._showCookieBanner(false, true)"},{children:(0,_.jsx)("span",{children:e.accept_all_button_text},void 0)}),void 0):"",e.is_box_banner_version?(0,_.jsx)(m.Btn,(0,u.__assign)({theme:"tertiary",size:"small",mix:"CookiePolicy__accept_button",use_native_onclick:!0,onClick:"CookiePolicy._showCookieBanner(false, false)"},{children:(0,_.jsx)("span",{children:e.accept_button_text},void 0)}),void 0):(0,_.jsx)(m.Btn,(0,u.__assign)({theme:"small",mix:"CookiePolicy__accept_button",use_native_onclick:!0,onClick:"CookiePolicy._onHideClick(event, this)",url:e.hide_url},{children:(0,_.jsx)("span",{children:e.accept_button_text},void 0)}),void 0)]}),void 0),e.is_box_banner_version?"":(0,_.jsx)("a",(0,u.__assign)({className:"CookiePolicy__hide",href:e.hide_url,onClick:"CookiePolicy._onHideClick(event, this)"},{children:(0,_.jsx)("div",(0,u.__assign)({className:"CookiePolicy__hideIcon"},{children:(0,_.jsx)(f.Icon20Cancel,{},void 0)}),void 0)}),void 0)]}),void 0)}),void 0)};var v=n(66021),g=n(84316);Object.assign(v.ItemsList,g.ItemsList),v.ItemsList._onClose=g._onClose,v.ItemsList._goToItem=g._goToItem,v.ItemsList._toggleFave=g._toggleFave,v.ItemsList._openItemsPopup=g._openItemsPopup,window.ItemsList=v.ItemsList;var h,w,y=n(47023),k=n(34757),b=n(49846),S=n(79654),C=n(40517);!function(e){e.PAYMENT_FORM="payment_form",e.PAYMENT_FORM_CLICK_OFFER="payment_form_click_offer",e.PAYMENT_FORM_CLICK_PAY="payment_form_click_pay",e.PAYMENT_FORM_CLICK_CLOSE="payment_form_click_close",e.PAYMENT_FORM_CHANGE_CLICK_CHANGE="payment_form_change_click_change",e.CLICK_SHOW_MORE="click_show_more",e.WIDGET_VIEW="widget_view",e.DESCRIPTION_VIEW="description_view"}(h||(h={})),function(e){e.PAYMENT_START="payment_start",e.DATA_ACCESS="data_access",e.RESULT_PAYMENT_SUCCESS_OK="result_payment_success_ok",e.RESULT_PAYMENT_SUCCESS_WAITING="result_payment_success_waiting",e.RESULT_PAYMENT_SUCCESS_WAITING_TIMEOUT="result_payment_success_waiting_timeout",e.RESULT_RESUB_SUCCESS_WAITING="result_resub_success_waiting",e.RESULT_RESUB_SUCCESS_WAITING_OK="result_resub_success_waiting_ok",e.RESULT_PAYMENT_UNAVAILABLE="result_payment_unavailable",e.RESULT_PAYMENT_CANCEL="result_payment_cancel",e.RESULT_ERROR="result_error",e.CHANGE_START="change_start",e.RESULT_CHANGE_ERROR="result_change_error",e.RESULT_CHANGE_SUCCESS_OK="result_change_success_ok",e.RESULT_CHANGE_SUCCESS_WAITING="result_change_success_waiting",e.RESULT_CHANGE_SUCCESS_WAITING_TIMEOUT="result_change_success_waiting_timeout",e.RESULT_CHANGE_UNAVAILABLE="result_change_unavailable",e.UNKNOWN="donut_payment_screen_unknown"}(w||(w={}));var E=new(function(){function e(){this.productionStatCollector=new S.ProductionStatCollector,this.actionStatCollector=new S.ActionStatCollector(this.productionStatCollector),this.navStatCollector=new S.NavigationStatCollector(this.productionStatCollector)}return e.prototype.logEventAction=function(t){return this.actionStatCollector.logEvent(e.createDonutActionStatEvent(t))},e.prototype.logEventActionView=function(e){return this.logEventAction((0,u.__assign)((0,u.__assign)({},e),{event_type:h.PAYMENT_FORM}))},e.prototype.logEventDescriptionClick=function(t){this.navStatCollector.logEvent((0,u.__assign)((0,u.__assign)({},e.createNavStatEventBase()),e.createDescriptionClickStatEvent(t)))},e.createDonutActionStatEvent=function(e){var t;return(t={type:C.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM})[C.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM]=e,t},e.createNavStatEventBase=function(){return{screen:"wall",subtype:C.NavigationProductionStatEventTypes.GO}},e.createDescriptionClickStatEvent=function(t){var n;return(n={item:e.processClickParamsToEventItem(t),type:C.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM})[C.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM]={},n},e.processClickParamsToEventItem=function(e){return{type:C.EventItemType.BROWSER,owner_id:e.ownerId,track_code:e.trackCode}},e}()),T=n(45582),I=n(9509);function M(e,t){var n=function(e){try{return JSON.parse(e)}catch(n){var t={environment:"parseJsonError",breadcrumb:{message:"Uncaught json parse error",data:{json:e},category:I.customBreadcrumbCategory}};return(0,T.logError)(n,t),{}}}(e),o=n.type,a=n.type_property,i=n.params;a===C.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM?E.logEventAction({event_type:i.event_type,source:i.source,owner_id:i.owner_id}):t&&o===C.ProductionStatEventTypes.TYPE_NAVGO&&function(e,t){var n=t.params;if(t.typeProperty===C.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM){var o=n.owner_id,a=n.track_code;if(!n||"number"!=typeof o||"string"!=typeof a)return;E.logEventDescriptionClick({ownerId:o,trackCode:a})}}(0,{typeProperty:a,params:i})}var P=n(65256),L=n(12344);window.SAKIntegration=P.SAKIntegration,window.SAKIntegrationInit=function(e){e.isNewMail=(0,L.isNewMailPage)(location.pathname,location.search),P.SAKIntegration.init(e)};var B=n(97170),A=n(19331),O=n(16426),x=n(24530),R=(0,A.partConfigEnabled)("measure_module_navigation_stats_mvk")?new O.ModuleNavigationStatCollector(x.NetworkStatCollectorInstance):void 0;B.default.onChanged((function(){b.navigationStat.addStatEvent(b.navigationStat.getModule(),S.NavigationProductionStatEventTypes.GO),null==R||R.logEvent()}));var N=n(79957),D=n(57274),F=n(10965),U=(n(9458),n(61508)),H=n(49265),j=(n(2375),n(79764)),V=n(52822),W=n(57141),K=n(71437),q=n(30585),G=function(e){function t(t){var n=e.call(this,t)||this;return n.uploadStorage=function(e,t){return new Promise((function(a,i){var r;(0,o.uploadFile)(n.options.upload_url,(0,u.__assign)(((r={})[n.options.fileName||"photo"]=e,r),n.options.upload_params||{}),{onComplete:a,onError:i,onProgress:t})}))},n.saveFile=function(e,t){return n.isTaskExist(e.id)?new Promise((function(e,o){j.default.post(n.options.done_url,(0,u.__assign)({_ajax:1,_query:JSON.stringify(t)},n.options.done_params||{}),{onDone:function(t){return t.error?o(t.error):e(t)},onFail:function(e){return o(e),!1}})})):Promise.reject()},n.options=t,n}return(0,u.__extends)(t,e),t.prototype.onStorageUploadProgress=function(e,t){var n=e.total,o=e.loaded,a=t.file,i=t.id;this.isTaskExist(i)&&this.onProgress({id:i,file:a,total:n,loaded:o})},t.prototype.processUploadStorage=function(e){var t=this;return this.uploadStorage(e.file,(function(n){return t.onStorageUploadProgress(n,e)})).then(this.parseStorageResponse)},t.prototype.processSaveFile=function(e,t){return this.saveFile(e,t)},t.prototype.parseStorageResponse=function(e){var t;try{var n=(0,o.parseJSON)(null===(t=e.target)||void 0===t?void 0:t.responseText);if(n.error)throw new Error(n.error);return n}catch(e){return Promise.reject(new Error("ERR_CLIENT_BAD_RESPONSE: bad request response"))}},t}(n(5488).BaseUploadStrategy),z={isUploading:!1,onBeforeRemove:(0,c.default)(),onRemove:(0,c.default)("removeElem"),onStart:(0,c.default)(),onError:(0,c.default)("response"),onComplete:(0,c.default)("response"),_uploadData:{},_uploadQueue:[],_readerQueue:[],_processReaderQueue:!1,_isFakeUploading:!1,fallback:function(e,t){var{post:n}=window;return e&&n.add_attach(e,t),!1},init:()=>{z.isUploading=!1,Object.values(z._uploadData).forEach((e=>{var t;null==(t=e.strategy)||t.destroy()})),z._uploadData={},z._uploadQueue=[],z._readerQueue=[],z._processReaderQueue=!1,z._isFakeUploading=!1},getLastAttachId:function(){if(!ge("attached_wrap"))return 0;var e,t=0;return each(geByTag("input"),(function(){if(e=this.name.match(/^attach(\d+)_type$/i)){var n=intval(e[1]);t<n&&(t=n)}})),t},refreshAttachIds:function(e){var t=ge("attached_wrap");if(t){var n,o=gpeByClass("mr_x_wrap",e),a=geByTag1("input",o),i=intval((a&&a.name.match(/^attach(\d+)(_type)?$/i)||[])[1]);if(gpeByClass("mr_timer",e)){var r=attr("add_post_btn","data-value");r&&val("add_post_btn",r)}else i&&each(geByTag("input",t),(function(){if(n=this.name.match(/^attach(\d+)(_type)?$/i)){var e=intval(n[1]);e==i?this.disabled=!0:e>i&&(this.name="attach"+(e-1)+(n[2]||""))}}))}},startFakeUploading:()=>{z._isFakeUploading=!0,z.onStart()},finishFakeUploading:()=>{z._isFakeUploading=!1,z.onComplete()},getAttachesCount:function(e){void 0===e&&(e=!0);var t=0;return window.ThumbsEdit&&window.ThumbsEdit.initialized&&e&&(t=ThumbsEdit.getThumbsCount()),t+=geByClass("mr_x_wrap","attached_wrap").length},refreshUploadState:function(e){isUndefined(e)&&(e=z.getAttachesCount(!0));var t=ge("attached_wrap"),n=geByClass1("mr_timer",t),o=geByClass1("pi_medias",t),a=ge("attach_photo_btn");if(toggle(o,e>0||isVisible(n)),toggleClass("attached_wrap_empty",t,e<=0),a){toggleClass("cp_attachBtnEl_sel",a,e>0);var i=geByClass1("inline_upload",a);if(i||(i=geByClass1("inline_upload",a.parentNode)),i){var r=attr(i,"data-max-attaches")||10;i.disabled=e>=r}}show("attached_options"),show("attached_flush")},checkUploading:function(e){return!(z.isUploading&&z._uploadQueue.length||z._isFakeUploading)||cancelEvent(e)},attachedPhotoTpl:function(e){var t=[{id:"upload_item_"+e,class:"medias_thumb thumb_item mr_x_wrap thumb_upload",inner:[{id:"upload_image_"+e,class:"tu_img"},{id:"item_progress_wrap_"+e,class:"tu_progress_wrap",inner:[{id:"item_progress_"+e,class:"tu_progress"}]},{id:"item_cancel_wrap_"+e,class:"tu_cancel_wrap",onclick:"return mediaUpload.reset(this, event, '"+e+"');",inner:[{id:"item_cancel_"+e,class:"tu_progress"}]}]}];return ceFromString(d.default.html(t))},attachedTpl(e){void 0===e&&(e={});var{id:t,type:n}=e,o=["medias_row","mr_x_wrap","thumb_upload"];n&&o.push("attachment_type_"+n);var a=(0,q.getDocument24Icon)(),i={inner:[{inner:[{inner:[{inner:[(0,V.default)({icon:a})],class:"medias_link_icon",tag:"span"}],class:"medias_link_icon",tag:"span"},{inner:[{inner:[e.label],class:"medias_link_labeled medias_link_title",tag:"span"}],class:"medias_link_texts",tag:"span"}],class:"mr_label medias_link",tag:"span"},{inner:[{class:"tu_progress",id:"item_progress_"+t,tag:"div"}],class:"tu_progress_wrap",id:"item_progress_wrap_"+t,tag:"div"},{inner:[{class:"tu_progress",id:"item_cancel_"+t,tag:"div"}],class:"tu_cancel_wrap",id:"item_cancel_wrap_"+t,onclick:"return mediaUpload.reset(this, event, '"+t+"');",tag:"div"}],id:"upload_item_"+t,class:o,tag:"div"};return ceFromString(d.default.html([i]))},onUploadProgress:function(e){var{id:t,total:n,loaded:o}=e;if(window.ThumbsEdit&&ThumbsEdit.initialized)ThumbsEdit.onUploadProgress(t,o/n*100);else{var a=document.getElementById("item_progress_"+t);setStyle(a,{width:o/n*100+"%",visibility:"visible"})}},onUploadDone:function(e){var{task_id:t,data:n}=e,o=z._uploadData[t];if(o){var a,i=ge("item_progress_wrap_"+o.id),r=z.getLastAttachId()+1,s=ge("upload_item_"+o.id);s&&s.classList.add("thumb_uploaded");var{isThumbsEdit:l}=o;if(l?(ThumbsEdit.replaceTemp(o.id,n.id,n.list||"",n.sizes),a=(0,K.$)('[data-media="phototemp_'+o.id+'"]')):a=ge("upload_image_"+o.id),a)if(n.src)var c=ce("img",{id:"upload_image_"+o.id,className:"ph_img",onload:function(){if(l&&(a.src=n.src,a.classList.remove("Thumb__wrap--temp"),a.setAttribute("data-media","photo"+n.id),a.setAttribute("data-upload",o.id)),replace(c,a),o.iw&&o.ih){if(o.iw>o.ih==c.width>c.height)var e=Math.min(130,Math.floor(75/o.ih*o.iw));else e=Math.min(130,Math.floor(75/o.iw*o.ih));setStyle(c,"width",e)}reflow(c),setStyle(c,"opacity",1)},src:n.src});else{var d=ge("upload_image_"+o.id);setStyle(d,"opacity",1)}var u=o.attach_type||"photo",_=(n.hash,n.id);o.attach_type&&"photo"!==o.attach_type&&(_=n.owner_id+"_"+n.id),s&&(s.appendChild(ce("input",{type:"hidden",name:"attach"+r,value:_})),s.appendChild(ce("input",{type:"hidden",name:"attach"+r+"_type",value:u}))),setStyle(i,"opacity",0),delete o.strategy,o.attached=!0,o.delete_url=n.delete_url}},readFile:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){readFile(e.file,(function(t){var n=ge("upload_image_"+e.id);if(n)var o=ce("img",{id:"upload_image_"+e.id,className:"ph_img",onload:function(){replace(o,n),e.iw=o.width,e.ih=o.height},src:t});z.readerQueueNext()}))})),showFile:function(e){var t,n=ge("attached_wrap"),o=geByClass1("pi_medias",n),a=o?geByClass("medias_thumb",o):[],i=o?geByClass1("medias_row",o):null,r=a[a.length-1],s=e.attach_type||"photo";if(t="photo"===s?z.attachedPhotoTpl(e.id):z.attachedTpl({id:e.id,type:s,label:e.file?e.file.name:""}),n){if(window.ThumbsEdit&&ThumbsEdit.initialized)ThumbsEdit.addTempPreview(e.id,e.file);else{if(!o){var l=geByClass1("AddedAttach",n);o=ce("div",{className:"pi_medias"}),append(o,l||n)}r?after(t,r):i?before(t,i):append(t,o)}z._processReaderQueue||z.readerQueueNext()}},readerQueueNext:function(){clog("next reader"),z._processReaderQueue=!0;var e=z.readerQueueRemove();if(!e)return clog("empty reader"),void(z._processReaderQueue=!1);z.readFile(e)},queueInsert:function(e){var{id:t}=e;return z._uploadData[t]=e,z._uploadQueue.push(t),z._readerQueue.push(t),z.queueCheck(),z._uploadData[t]},queueCheck(){this.isUploading=0!==z._uploadQueue.length},uploadQueueRemove:function(e){var t=z._uploadQueue.indexOf(e);return!!e&&(z._uploadQueue.splice(t,1),z.queueCheck(),z.getUploadDataById(e))},readerQueueRemove:function(){var e=z._readerQueue.shift();return!!e&&z.getUploadDataById(e)},getUploadDataById:function(e){return z._uploadData[e]||!1},delUploadDataById:function(e){delete z._uploadData[e]},start:function(e,t){var n;if(!e||!canUploadFile())return z.fallback(e,t);var o=e.files,a=e.form||gpeByTag("form",e),i=submitBtn(a),r=ge("attach_photo_btn"),{uploadUrl:s,uploadParams:l,fileAttrName:c,attachType:d,doneUrl:u,maxAttaches:_=10}=e.dataset,p=z.getAttachesCount();if(!s||!u)return z.fallback(e,t);var m=null==(n=window.ThumbsEdit)?void 0:n.initialized,f=new G({upload_url:s,done_url:u,limit:intval(_),done_params:{te:intval(m)},upload_params:l,fileName:c});return f.emitter.on("progress",(e=>{z.onUploadProgress(e)})),f.emitter.on("complete",(e=>{z.onUploadDone(e),z.uploadQueueRemove(e.task_id)})),f.emitter.on("error",(e=>{var{task_id:t,error:n}=e,o="blog"===cur.module?lang.mobile_jobs_upload_error:lang.mobile_unknown_error;"string"==typeof n&&(o=n),Snackbar.init({text:o,type:W.SNACKBAR_TYPE_ERROR}),z.reset(null,null,t),z.onError(n)})),f.emitter.on("start",(()=>{z.queueCheck()})),f.emitter.on("end",(e=>{f.destroy(),e&&z.onComplete(e.data),z.queueCheck()})),Array.from(o).forEach((e=>{if(p++>=intval(_))return!1;var t={id:f.addFile(e),strategy:f,file:e,isThumbsEdit:m,attach_type:d};z.queueInsert(t),z.showFile(t)})),e.value="",removeEvent(a,"submit",z.checkUploading),addEvent(a,"submit",z.checkUploading),removeEvent(i,"click",z.checkUploading),addEvent(i,"click",z.checkUploading),removeEvent(r,"click",z.checkUploading),addEvent(r,"click",z.checkUploading),z.refreshUploadState(p),replace(clone(e),e),f.start(),window.isNewMail&&z.onStart(),!1},reset:function(e,t,n,o){var a;if(cancelEvent(t),window.isNewMail&&z.onBeforeRemove(e),"/"==n[0]){ajax.post(n,{_ajax:1}),z.refreshAttachIds(e);var i=gpeByClass("mr_x_wrap",e)||gpeByClass("mr_timer",e);o?o():remove(i)}else{var r,s=n,l=z.getUploadDataById(s);if(!l)return!1;if(l.attached)l.delete_url&&(ajax.post(l.delete_url,{_ajax:1}),z.refreshAttachIds(e));else null==(r=l.strategy)||r.removeFile(l.id);o?o():remove("upload_item_"+s),z.delUploadDataById(s),z.uploadQueueRemove(s)}return z.refreshUploadState(),window.isNewMail&&z.onRemove(e),null==(a=window.Replies)||a.abortTimer("editing"),!1},onUnfoldItemClick:(e,t)=>{var n=(0,K.$)('[type="file"]',t);e.target!==n&&n.click()}};window.mediaUpload=z;n(43253);var Q=n(83194),Y=n(77123),X=n(55971),J="supportedFeatures";var Z=n(12315),ee=n(81290),te=n(89414),ne=n(71014),oe=n(42493),ae=n(58755),ie=n(64904),se=n(91253),le={onDone:function(e,t,n,a){var i=(0,o.ge)(e)||(0,o.geByClass1)("like_box","z")||(0,o.geByClass1)("like_box")||(0,o.geByClass1)("wall_item_for_like_"+e);if(i&&e){var r,s,l=(0,o.geByClass1)("item_repost",i);if((0,o.hasClass)("wall_item",i)||i.parentNode.classList.contains("MarketItem")||i.parentNode.classList.contains("PhotoviewPage")||i.parentNode.classList.contains("VideoPage")?s=(0,o.geByClass1)("wi_like_wrap",i)||(null==i.querySelector?void 0:i.querySelector("._wi_likes_bar_wrap")):(0,o.hasClass)("ReplyItem",i)?r=(0,o.geByClass1)("ReplyItem__likeWrap",i):s=(0,o.geByClass1)("item_like",i),r||(r=null==i.querySelector?void 0:i.querySelector(".like_wrap, ._post_bottom_like_wrap")),s&&(s.innerHTML=t||"",(0,o.toggleClass)("is_empty",s,!t),(0,o.toggle)(s,t)),l&&(l.innerHTML=n||"",(0,o.toggle)(l,n)),r){var c=(0,o.ceFromString)(a);c.classList.contains("like_wrap")||c.classList.contains("_post_bottom_like_wrap")?(0,o.replace)(c,r):(0,o.val)(r,a||"");var d=(0,ne.marketItemIdToObject)(e);if(d){var u=r.querySelector(".item_like");u&&(0,oe.trackMarketEvent)({event:u.classList.contains("item_sel")?ae.ECommGoodsEvent.LIKE_ITEM:ae.ECommGoodsEvent.UNLIKE_ITEM,ownerId:d.ownerId,itemId:d.itemId,instant:!0,platform:se.PLATFORM_MVK})}}}},onFail:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(2===t)nav.hard_go(e[0])}},de=n(49464),ue="ajaxEvents",_e="WALL_AJAX_OBJECT_LOAD_SUCCESS",pe=function(e){if(void 0===e&&(e=window.Wall),"object"==typeof e&&e&&ue in e)return e.ajaxEvents},me=n(16144);function fe(e){var t=!1,n={onStart:function(){(0,o.addClass)("wia_item--loading",this.link)},onDone:function(){var a=e.onDone&&e.onDone.apply(this,arguments);if(a){var{wdHTML:i,data:r,onDoneEnd:s}=a;if(i){var l=d.default.elem(i);(0,o.replace)(l,this.link.parentNode),r&&!t&&Snackbar.init({text:r.title,action:{url:r.href,text:r.undo_title,callback:(e,o)=>{var{id:a}=o;e.preventDefault(),t=!0,ajax.click(l.querySelector("a"),n),Snackbar.close(a)}}}),t=!1}s&&s()}}};return n}var ve,he,we={onDone:function(e,t,n,a,i){if(le.onDone.apply(this,arguments),this.photo_id){var r=me.$photos.getState()[e.replace("photo","")];if(r){(0,o.ce)("div",{innerHTML:t});var s,l=(0,o.ce)("div",{innerHTML:a});r.likes_cnt=(0,o.intval)(((null==l.querySelector||null==(s=l.querySelector("[data-like_count]"))?void 0:s.getAttribute("data-like_count"))||"").replace(/\D+/g,"")),r.likes_me=i,r.liked_people=t,r.like_buttons=a;var c=(0,o.ce)("div",{innerHTML:r.actions}),d=(0,o.geByClass1)("like_wrap",c);(0,o.val)(d,a),(0,me.upsertPhoto)(r)}}},onFail:le.onFail},ye={onDone:function(e){var{photo:t}=window;if(this.photo_id){if(!e.error){var n={};"confirm"===e.type?n={type:W.SNACKBAR_TYPE_SUCCESS,text:getLang("mobile_msg_photos_tag_confirmed")}:"delete"===e.type&&(n={type:W.SNACKBAR_TYPE_SUCCESS,text:getLang("mobile_msg_photos_tag_deleted")}),Snackbar.init(n)}var a=t.get(this.photo_id);a&&(a.tag_info="",t.save(a));var i=(0,o.geByClass1)("photo_view"),r=(0,o.geByClass1)("pv_tag_wrap",i);(0,o.val)(r,"")}}},ke=fe({onDone:(e,t,n,o)=>((0,me.removePhoto)(t),Popup.close((0,K.$)(".Popup_open")),{wdHTML:e,data:o})}),be={onDone:function(e,t){var n=window.isNewMail&&(0,K.$)(".messenger")&&this.link.closest(".msg");if((0,o.val)(e,t),n){var a=Number(n.className.match(/msg_id_(\d+)/)[1]);store.mail.msgs[a].textFull=n.$(".msg__text").innerHTML}}},Se={onDone:function(e){this.link&&((0,o.after)(cdf(e),(0,o.gpeByClass)("pic_body_wrap",this.link)),(0,o.hide)(this.link))}},Ce=fe({onStart:function(){(0,o.addClass)("cm_item_loading",this.link)},onDone:function(e,t,n){if(!e)return{wdHTML:t,data:n};this.link&&(0,o.val)(this.link.parentNode,e)}}),Ee={onDone:function(e,t,n){if(void 0===n&&(n={}),e){var{photo:a}=window;(0,o.remove)(e+"_msg");var i=(0,o.ge)(e);if(i){if(n.remove)re(i),re(e+"_msg");else if(t){var r=(0,o.ce)("div",{id:e+"_msg",className:(i.className||"")+" post_message_item"}),s=n.no_wrap?t:'<div class="pi_cont">'+t+"</div>";(0,o.val)(r,s),(0,o.after)(r,i),(0,o.hide)(i),(0,o.geByClass1)("rtm_reply_wrap",i)&&window.reply&&window.reply.edithide()}else(0,o.show)(e);if(this.photo_id){var l=a.get(this.photo_id);if(l){var c=(0,o.geByClass1)("photoview"),d=(0,o.geByClass1)("comments_wrap",c);l.comments_html=(0,o.val)(d)}}}}}},Te={onDone:function(e,t,n,a){if(e){(0,o.remove)(e+"_msg");var i=(0,o.ge)(e);if(i)if(t){var r=(/^([a-z]+)_item$/i.exec(n||"")||[])[1]||"inline",s=(0,o.ce)("div",{id:e+"_msg",className:r+"_item "+r+"_message_item"}),l=a||"message_item_cont";(0,o.val)(s,'<div class="'+l+'">'+t+"</div>"),(0,o.after)(s,i),(0,o.hide)(i)}else!1===t?(i.classList.add("_deleted"),(0,o.hide)(i)):(0,o.show)(i)}}},Ie={onDone:function(e,t,n){if(e){var a=(0,o.ge)(e),i=(0,o.getY)(a)||(0,o.getY)(e+"_msg"),r=(0,o.getH)(a)||(0,o.getH)(e+"_msg"),s=i+(d<320?r:0)-(0,o.scrollTop)();if((0,o.remove)(e+"_msg"),a){var l=(0,o.hasClass)("wall_item",a)||(0,o.hasClass)("post",a)?"wall":"post";if(n){var c=(0,o.ce)("div",{id:e+"_msg",className:l+"_item post_message_item"});(0,o.val)(c,'<div class="pi_cont">'+n+"</div>"),(0,o.after)(c,a)}if(t){(0,o.each)((0,o.geByClass)(l+"_item"),(function(){var e=!!this.id&&this.id.match(/^wall((-?\d+)_(-?\d+)(_\d+)?)$/),a=(0,o.attr)(this,"data-copy"),i=!!a&&a.match(/^(-?\d+)_(-?\d+)$/);if(!e)return!0;(!e[4]&&e[2]==t||e[4]&&e[3]==t||i&&i[1]==t)&&(0,o.toggleClass)("post_item_ignored",this,n)}));var d=(0,o.getCw)(),u=(i=(0,o.getY)(a)||(0,o.getY)(e+"_msg"),r=(0,o.getH)(a)||(0,o.getH)(e+"_msg"),i+(d<320?r:0)-s);(0,o.geByClass1)("wall_item")===a&&(u=0),(0,o.scrollTop)(u);var _=(0,K.$)(".ContextMenu",a);_&&te.default.close(_)}}}}},Me={onDone:function(e,t){if(e){var n=(0,o.ge)(e);if((0,o.remove)(e+"_msg"),n&&t){var a=(0,o.hasClass)("wall_item",n)||(0,o.hasClass)("post",n)?"wall":"post",i=(0,o.ce)("div",{id:e+"_msg",className:a+"_item post_message_item"});(0,o.val)(i,'<div class="pi_cont">'+t+"</div>"),(0,o.after)(i,n)}(0,o.toggleClass)("post_item_ignored",n,t)}}},Pe={onDone:function(e,t,n){if(e){var a=(0,o.ge)(e);if((0,o.remove)(e+"_msg"),a){if(n){var i=(0,o.ce)("div",{id:e+"_msg",className:"wall_item post_message_item"});(0,o.val)(i,'<div class="pi_cont">'+n+"</div>"),(0,o.after)(i,a)}(0,o.toggleClass)("post_item_ignored",a)}}}},Le={[ue]:(ve=window.Wall,he=pe(ve),he||new U.default),onStart:function(){var e=(0,o.gpeByClass)("show_more_wrap",this.link),t=(0,o.geByClass1)("show_more",e)||this.link,n=(0,o.ce)("div",{id:"show_more_loading",className:"show_more_loading show_more_loading--spinner",innerHTML:d.default.html((0,ee.default)({spinner:!0}))}),a=(0,o.ce)("div",{id:"show_more_wrap",className:"show_next_wrap show_next_wrap_transparent"});(0,o.attr)(n,"data-href",(0,o.getHref)(t)),a.appendChild(n),(0,o.before)(a,e),(0,o.remove)(e)},onDone:function(e){var{cur:t}=window;ajax.tAlProcess=(new Date).getTime();var n=(0,o.ge)("show_more_wrap"),a=new Set;document.querySelectorAll(".wall_item").forEach((e=>{var t=e.id;t&&a.add(t)}));var i,r=cdf(e);Array.from($$(".wall_item",r)).forEach((e=>{e.id&&a.has(e.id)&&(clog("Remove existing post "+e.id),e.remove())})),(0,o.before)(r,n),(0,o.remove)(n),ajax.prepare_click("mcont"),(0,o.onBodyScrollForce)(100),ajax.tAlModule=t.module,ajax.tAlRender=(new Date).getTime(),ajax.onPostsLoad(),Gif.onUpdate(),window.UnauthorizedFeed&&UnauthorizedFeed.onUpdate(),(0,F.resizePosters)(),(i=pe())?i.emit(_e):console.warn(new Error("Missing wall ajax events emitter"))}},Be={onStart:Le.onStart,onDone:function(e){Le.onDone.apply(null,arguments),(0,ie.cutTextToHighlight)(".SearchItemServicesInfo__textMatch")}},Ae={onStart:Le.onStart,onDone:function(e,t){Le.onDone.apply(null,arguments),Bookmarks.pushItemsToStore(t)}},Oe={onStart:Le.onStart,onDone:function(e,t){var{cur:n}=window;ajax.tAlProcess=(new Date).getTime();var a=(0,o.geByClass1)("photos_page","mcont"),i=(0,o.ge)("show_more_wrap"),r=cdf(t);e=e.replace(/<img src="([^"]+)" class="/gi,'<img data-src="$1" class="_image ');var s=cdf(e);a&&a.appendChild(s),(0,o.before)(r,i),(0,o.remove)(i),ajax.prepare_click("mcont"),(0,o.onBodyScrollForce)(100),ajax.tAlModule=n.module,ajax.tAlRender=(new Date).getTime(),(0,F.resizePosters)()}},xe=fe({onDone:function(e,t,n){if(!e)return{wdHTML:t,data:n};var a=(0,o.ge)(e);a&&a.parentNode&&t&&(0,o.replace)(cdf(t),a.parentNode)}}),Re=fe({onDone:(e,t,n)=>(void 0===n&&(n={}),n.snackbar&&Snackbar.init(n.snackbar),{wdHTML:e,data:t})}),Ne={onStart:function(){var e=this.link,t=(0,o.gpeByClass)("notify_lite",e);if(t)return(0,o.remove)(t);for(;e=e.parentNode;)if((0,o.hasClass)("notify_item",e)){(0,o.hasClass)("notify_panel",e.parentNode)?(0,o.remove)(e.parentNode):(0,o.remove)(e);break}}},De={onStart:function(){var e=(0,o.geByClass)("pagination","mcont");(0,o.each)(e,(function(e,t){(0,o.before)((0,o.ce)("div",{className:"summary_loading",innerHTML:'<i class="i_loading"></i>'}),t.firstChild)}))},onDone:function(e,t,n){var{mail:a}=window,i=(0,o.ge)("messages"+t);i&&((0,o.val)(i,e),a.onMessagesRepainted(!0),!this.save&&(0,o.scrollToEl)()),this.save&&a.saveDialog({messages:e},t),this.clear&&((0,o.val)((0,o.geByTag1)("textarea","write_form"),""),(0,o.remove)((0,o.geByClass1)("pi_medias","write_form"))),(0,o.removeClass)("cp_attach_btn_sel",(0,o.geByClass1)("cp_attach_btn")),window.isNewMail&&MailScrap.clearSystemMessage2(),n&&n.play_animation_msg_id&&StickersSettings.getAutoplay()&&StickersAnimation.loadStickerInMvkIMAndPlay(n.play_animation_msg_id)},onFail:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(2===t)this.link.form&&this.link.form.submit()}},Fe={onStart:function(){var e=(0,o.geByClass)("pagination","mcont");(0,o.each)(e,(function(e,t){(0,o.before)((0,o.ce)("div",{className:"summary_loading",innerHTML:'<i class="i_loading"></i>'}),t.firstChild)}))},onDone:function(e,t){var{mail:n}=window,a=(0,o.ge)("dialogs");a&&((0,o.val)(a,e),!this.no_scroll&&(0,o.scrollToEl)(),n.cacheDialogsPage()),n.save(t)}},Ue={onFail(e,t){if(e===ajax.RESPONSE_CAPTCHA){var n=this.link&&this.link.form;t+="&code="+(n&&n.code?n.code.value:""),nav.hard_go(t)}}},He={onStart:function(){var e=(0,o.gpeByClass)("friendsList__showMoreBtnWrap",this.link),t=(0,o.geByClass1)("friendsList__showMoreBtn",e)||this.link,n=(0,o.ce)("div",{id:"show_more_loading",className:"show_more_loading",innerHTML:'<i class="i_loading">&nbsp;</i>'}),a=(0,o.ce)("div",{id:"show_more_wrap",className:"show_next_wrap show_next_wrap_transparent friendsList__showMoreBtnWrap"});(0,o.attr)(n,"data-href",(0,o.getHref)(t)),a.appendChild(n),(0,o.before)(a,e),(0,o.remove)(e)},onFail:function(){var e=this.link.getAttribute("data-href")||this.link.getAttribute("href");setTimeout((()=>{ajax.post(e,{_ajax:1},{onDone:He.onDone.bind(this),onFail:He.onFail.bind(this)})}),500)},onDone:Le.onDone},je=fe({onDone:function(e,t,n){if(!e)return{wdHTML:t,data:n};var a=(0,o.ge)(e);a&&a.parentNode&&t&&(0,o.replace)(cdf(t),a.parentNode)}}),$e=fe({onDone:function(e,t,n){if(!e)return{wdHTML:t,data:n};var a=(0,o.geByClass)(e);if(a.length&&t)for(var i=0,r=a.length;i<r;i++)a[i].parentNode&&(0,o.replace)(cdf(t),a[i].parentNode)}}),Ve={onDone:function(e,t,n,a,i){if(e){var r=(0,o.geByClass)(e);if(r.length&&t)for(var s=0,l=r.length;s<l;s++)r[s].parentNode&&(0,o.replace)(cdf(t),r[s].parentNode);Share.setBookmarkState(a,i),n&&Bookmarks.showSuccessSnack(n);var c=(0,ne.parseBookmarkedProductClass)(e);c&&(0,oe.trackMarketEvent)({event:i?ae.ECommGoodsEvent.ADD_ITEM_TO_BOOKMARKS:ae.ECommGoodsEvent.REMOVE_ITEM_FROM_BOOKMARKS,ownerId:c.ownerId,itemId:c.itemId,instant:!0}),n&&31===n.item_type&&i&&(0,de.sendNarrativeAnalytic)(de.NarrativeAnalyticEventType.addToBookmarks,{ownerId:n.item_oid,id:n.item_id},de.NarrativeAnalyticNavScreen.other)}}},We=fe({onDone:function(e,t,n,a,i,r){if(!e)return{wdHTML:i,data:r};var s=(0,o.ge)(e);if(!s)return{wdHTML:i,data:r};var l=(0,o.geByClass1)("wia_close",s);if(l&&((0,o.val)(l,n),l.href=t),!(0,o.hasClass)("single_wall_item",s))return{wdHTML:i,data:r};var c=(0,o.ge)("nc_form"),d=(0,o.geByClass1)("wall_replies");return c?(0,o.toggle)(c,!!a):a&&(d?domInsert(d,a):(domInsertAfter((0,o.ce)("div",{innerHTML:a}),s),d=(0,o.geByClass1)("wall_replies"))),(0,o.toggleClass)("closed_comments",d,!a),{wdHTML:i,data:r}}}),Ke={onStart:function(){var e=domPN(this.link),t=(0,o.geByClass1)("Loading",e);t||(t=d.default.html((0,ee.default)()),append(t,e)),(0,o.addClass)("RepliesThreadNext_loading",e)},onDone:function(e,t,n,a){var i,r=domPN(this.link),s=(0,o.hasClass)("RepliesThreadNext_prev",r),l=0,c=cdf(e);if(domChildren(c).forEach((e=>{(0,o.ge)(e.id)&&re(e)})),s?(i=(0,o.gpeByClass)("wall_replies",r),l=(0,o.getH)(i),(0,o.after)(c,r)):(0,o.before)(c,r),a?(this.link.href=a,(0,o.removeClass)("RepliesThreadNext_loading",r)):re(r),Gif.onUpdate(),(0,F.resizePosters)(),n&&(cur.replyNames=(0,o.extend)(cur.replyNames||{},n)),t&&t.length&&Mention.addItems(t),s){var d=(0,o.getH)(i)-l;(0,o.scrollTop)((0,o.scrollTop)()+d)}(0,o.onBodyScrollForce)()},onFail:function(){var e=domPN(this.link),t=(0,o.geByClass1)("i_loading",e);(0,o.hide)(t),(0,o.show)(this.link),(0,o.removeClass)("RepliesThreadNext_loading",e)}},qe={onDone:function(e,t,n){var a=(0,o.geByClass1)("RepliesWrap");a.innerHTML=e,Gif.onUpdate(),(0,F.resizePosters)(),n&&(0,o.extend)(cur.replyNames,n),t&&t.length&&Mention.addItems(t),(0,o.scrollTop)((0,o.getH)(a)+(0,o.getY)(a))}},Ge={onDone:function(e,t,n,a){if(e){var i=(0,o.ge)(e);if(i){if(a)(0,o.geByClass)("ReplyItem__message_type_"+a,i).forEach((e=>{re(e)}));var r=(0,o.geByClass1)("ReplyItem__wrap",i),s=(0,o.geByClass)("ReplyItem__message",i),l=s.pop();if(t){var c=cdf(t);(0,o.hide)(l||r),(0,o.after)(c,l||r),(0,o.geByClass1)("rtm_reply_wrap",i)&&window.reply&&window.reply.edithide()}else a||(re(l),l=s.pop()),(0,o.show)(l||r);if(n){var d=(0,o.ge)("RepliesThread"+n);d&&(0,o.toggle)(d,!t)}}}}},ze={onStart:function(){Btn.setLoading(document.querySelector("#email_soft_bouncing a.Btn"),!0)},onDone:function(e){1===e&&document.getElementById("email_soft_bouncing").remove(),Btn.setLoading(document.querySelector("#email_soft_bouncing a.Btn"),!1)}};window.Like=le,window.PhotoLike=we,window.PhotoTag=ye,window.PhotoDelete=ke,window.Poll=be,window.CopyHistory=Se,window.ToggleMenu=Ce,window.Comment=Ee,window.ItemDelete=Te,window.FeedIgnore=Ie,window.FeedIgnoreItem=Me,window.FeedIgnoreComments=Pe,window.Wall=Le,window.SearchServices=Be,window.Bookmark=Ae,window.BookmarkToggle=Ve,window.Photos=Oe,window.FixPost=xe,window.ContextMenuCommonAction=Re,window.Notify=Ne,window.Dialog=De,window.Dialogs=Fe,window.LoginCheckAuthCodePage=Ue,window.WallSubscribe=je,window.FeedSubscribe=$e,window.ImportedFriends=He,window.CloseComments=We,window.RepliesNext=Ke,window.RepliesLast=qe,window.ReplyAction=Ge,window.MiniAppsCatalogResetRecent=function(e){if(e.dataset.section){var t={act:"mini_apps_reset_recent",hash:e.dataset.hash||""};ajax.post("/apps.php",t,{onDone:function(){var t=(0,o.ge)("mini_apps_"+e.dataset.section);t&&t.remove()}})}},window.ResetEmailSoftBounce=ze;n(78938),n(76988),n(9149);var Qe=n(73706),Ye=n(464),Xe=n(12449),Je=!1,Ze={NEED_MENU_PARAM:"_nlm",NEED_MENU:1,FORCE_NEED_MENU:2,enabled:function(e){return!1},opened:function(){return(0,o.hasClass)("lm_opened",window.bodyNode)},toggle:function(e,t){return(0,o.checkEvent)(e),!0},open:function(e){var{zlayer:t}=window;return(0,o.checkEvent)(e),!0},close:function(e){return(0,o.checkEvent)(e),!0},fix_size:function(e){var t=(0,o.ge)("l"),n=(0,o.ge)("m"),a=(0,o.ge)("mhead"),i=a&&a.offsetHeight||0,r=Ze._st||0;t&&n&&(e?n.style.minHeight="0":(r=r>i?r:0,n.style.minHeight=t.offsetHeight+r+"px"),!Ze.fixed||(0,o.getCw)()<320?e?n.style.marginTop="0":(t.style.minHeight=(0,o.getCh)()+"px",n.style.marginTop=-r+"px"):t.style.minHeight="0")},clear_hover:function(){thover.clear()},hasMenu:function(){return window.al&&window.al.menu},isMenuHasItems:function(){return Ze.hasMenu()&&(0,o.isArray)(window.al.menu)&&window.al.menu.length||(0,o.isObject)(window.al.menu)&&Object.keys(window.al.menu).length},refreshCounters:function(e){if(!Ze.hasMenu())return!0;if(!e)return!0;if((0,o.isArray)(e)&&!e.length)return!0;if((0,o.isObject)(e)&&!Object.keys(e).length)return!0;if((0,o.isArray)(e)&&!(0,o.isArray)(window.al.menu))return!1;if((0,o.isObject)(e)&&!(0,o.isObject)(window.al.menu))return!1;if((0,o.isArray)(e)&&e.length!=window.al.menu.length)return!1;if((0,o.isObject)(e)&&Object.keys(e).length!=Object.keys(window.al.menu).length)return!1;void 0!==e[Xe.COUNTERS_POS_NOTIFICATIONS]&&Tabbar.setCounter(Tabbar.TAB_ID_NOTIFICATION,e[Xe.COUNTERS_POS_NOTIFICATIONS]),void 0!==e[Xe.COUNTERS_POS_MESSAGES]&&Tabbar.setCounter(Tabbar.TAB_ID_MESSAGES,e[Xe.COUNTERS_POS_MESSAGES]);var t=e[Xe.COUNTERS_POS_NOTIFICATIONS];"number"==typeof t&&isFinite(t)&&(Bell.setCount(t),window.store&&(store.notificationsCount=t));var{al:n}=window,a=(0,K.$)(".main_menu",document.getElementById("l"));return Object.entries(e).forEach((e=>{var[t,i]=e;if(void 0===i)return!0;var r=n.menu[t],s=(0,K.$)(".mmi_"+r[0],a),l=(0,K.$)(".mm_item",s),c=(0,K.$)(".mmi_wrap",s),d=(0,K.$)(".mm_counter",c);(0,o.attr)(l,"data-href",!1),i?(r[3]&&(0,o.attr)(l,"href",r[3]),d?(0,o.val)(d,i):(0,o.append)((0,o.ce)("em",{className:"mm_counter",innerHTML:i}),c)):(r[2]&&(0,o.attr)(l,"href",r[2]),(0,o.remove)(d)),ajax.prepare_click(l)})),!0},refreshSingleCounter:(e,t)=>{var n;Ze.hasMenu()&&((0,o.isArray)(window.al.menu)&&((n=new Array(al.menu.length))[e]=t),(0,o.isObject)(window.al.menu)&&(n={},Object.entries(window.al.menu).forEach((o=>{var[a,i]=o;parseInt(i,10)===parseInt(e,10)?n[i]=t:n[i]=void 0}))),Ze.refreshCounters(n))},refreshNotifications:e=>{window.store&&(store.menuNotifications=e);var t=(0,K.$)(".mmi_apps .mmi_wrap");if(t){var n=(0,K.$)('[data-id="menu-apps-notification"]',t);!e[Xe.COUNTERS_POS_APPS]&&n&&n.remove(),e[Xe.COUNTERS_POS_APPS]&&!n&&(t.innerHTML+=d.default.render((0,Ye.default)({id:"menu-apps-notification"})))}},refresh:function(e){e=e||{},ajax.refreshLinks(e.fv_link,e.app_link),void 0!==e.pp&&!1!==e.pp&&(0,o.val)("lm_prof_panel",e.pp),void 0!==e.tn&&!1!==e.tn&&(0,o.val)("lm_top_notify",e.tn),void 0!==e.bn&&!1!==e.bn&&(0,o.val)("lm_bottom_notify",e.bn),e.lm&&(0,o.val)("l",e.lm),e.counters&&Ze.refreshCounters(e.counters),e.notifications&&Ze.refreshNotifications(e.notifications),e.tab&&Tabbar.setCurrentId(e.tab),e.topbar||(0,o.remove)("vk_topbar")},initEvents:function(){var e=Ze.getStickedScrollingHandler();e&&((0,o.onBodyScroll)(e),e((0,o.scrollGetY)())),(0,o.onBodyResize)((function(){var t=(0,o.ge)("vk_wrap"),n=t&&t.offsetWidth,a=(0,o.hasClass)("_hfixed",window.bodyNode);n>=882&&Ze.close(),Ze.fix_size(!Ze.opened(),a),e&&e((0,o.scrollGetY)())}))},init:function(){Ze.fixed=(0,o.hasClass)("_hfixed",window.bodyNode),Ze.initEvents(),(0,o.addEvent)(window,"orientationchange",(function(){var e=(0,o.ge)("vk_wrap").offsetWidth,t=Ze._st||0;e>=882&&t>44&&Ze.close()}));var e=(0,K.$)(".leftMenu__content");e&&(0,Qe.setScrollView)(e,{topBanner:!!H.default.ipad&&void 0,overscrollY:!1,standalone:!0})},blockScroll:function(e){var t=(0,o.ge)("vk_wrap");Ze.opened()&&(0,o.getW)(t)<882&&(0,o.preventEvent)(e)},qsOpened:!1,qsOpen:function(){Ze.qsOpened||(Ze.qsOpenedOnce||(0,Q.trackEvent)("global_search_open",null,cur.gsearch_hash),Ze.qsOpenedOnce=!0,Ze.qs_st=(0,o.scrollTop)(),(0,o.addClass)("qs_opened","vk_wrap"),(0,o.addClass)("qs_opened",window.bodyNode),(0,o.getW)("vk_wrap")<882&&(0,o.scrollTop)(0),Ze.qsOpened=!0)},qsClose:function(){Ze.qsOpened&&((0,o.removeClass)("qs_opened","vk_wrap"),(0,o.removeClass)("qs_opened",window.bodyNode),(0,o.getW)("vk_wrap")<882&&(0,o.scrollTop)(Ze.qs_st||0),Ze.qsOpened=!1)},initSearch:function(){Je||(Je=!0,(0,o.addEvent)("lm_search_items","mousedown touchstart",(function(e){e.stopPropagation()}),{passive:!0}),(0,o.addEvent)((0,K.$)(".head_search",document.getElementById("l")),"mousedown touchstart",(function(e){e.stopPropagation()}),{passive:!0}),(0,o.addEvent)(document,"mousedown touchstart",(function(e){(0,o.ge)("vk_wrap");Ze.qsOpened&&(Ze.qsClose(),(0,o.elblur)("lm_search_field"))}),{passive:!0}))},closeSearch:function(){return!0},cancelSearch:function(){return!0},headerAction:function(e,t){return(0,o.getW)("vk_wrap")>=882?nav.go(e,t):Ze.toggle()},getStickedScrollingHandler:()=>{var e=(0,K.$)(".leftMenu__content"),t=document.body;if(e&&t&&t.classList.contains("_hfixed")&&!t.classList.contains("_touch")){var n,a=(0,o.scrollGetY)(),i=(0,o.scrollGetY)(),r=!1,s=function(t,n){void 0===n&&(n=0),e.style.position=t,e.style.top=n+"px",e.style.bottom=""},l=document.getElementById("mcont");return function(t){if(!(t<0||t>0&&t+window.innerHeight>=document.body.scrollHeight||(0,o.getCw)()<882)){var c=e.getBoundingClientRect(),d=Math.round(c.top),u=Math.floor(c.height);if(0!==u){var _=document.documentElement;if(u>=(l&&0!==l.offsetHeight||(l=document.getElementById("mcont")),(0,o.getH)(l)))s("absolute");else if(!(u>_.scrollHeight)){if((t>a||t===a&&t>0)&&(n="down"),t<a&&(n="up"),a=t,u+56<window.innerHeight)return s("fixed"),void(i=t+d-56);switch(n){case"down":r=u+d<=window.innerHeight;break;case"up":r=0<=d-56}var p,m;r?("down"===n?(p="fixed",void 0===m&&(m=0),e.style.position=p,e.style.top="",e.style.bottom=m+"px"):s("fixed"),i=t+Math.round(e.getBoundingClientRect().top)-56):s("absolute",i)}}else s("absolute")}}}}};window.menu=Ze;var et=n(67196),tt=n(20594),nt=function(){var e={},t={},n=null,a=!1,i={},r={},s={},l=null;function c(){if(n){var t=[],o=!1;if(each(geByClass("_unread"),(function(){var e=+attr(this,"data-id");e&&t.push(e),o=nt.getPeerByMsg(e),replaceClass("_unread","_read",this)})),o){var a=ge("messages"+o);a&&e[o]&&(e[o].messages=val(a))}if(t.length)nt.sendMarkAsRead(n,t);else{var i=e[n].last_msg;nt.sendMarkAsRead(n,i?[i]:[]),nt.updateMarkAsUnread(n,!1)}}}function d(e,t){t?(addClass("lvi",e),toggleClass("mlvi",e,!!H.mobPlatforms[t])):(removeClass("lvi",e),removeClass("mlvi",e))}function u(e){(0,e.updater)(document.body),each(e.caches,(function(t,n){var o=n.storage,a=n.getter,i=function(e,t){var n,o=t.split("."),a=o.length,i=e;for(n=0;n<a;n++)if(!(i=i[o[n]]))return null;return i}(o,a);if(i){var r="string"==typeof i;r&&(i=ce("div",{innerHTML:i})),e.updater(i),function(e,t,n){var o,a,i=t.split("."),r=i.length-1,s=e;for(a=0;a<r;a++)s=s[o=i[a]]||(s[o]={});s[i[r]]=n}(o,a,r?i.innerHTML:i)}}))}return!window.isNewMail&&window.nav&&window.nav.onBeforeGo(((e,t,n)=>{if(nav.getQuery("community")&&(!n||!n.ignore_cur_process)&&"/mail"===("string"==typeof e?e:attr(e,"href")||attr(e,"data-href")))return nav.go(e,t,{ignore_cur_process:!0}),!0})),!window.isNewMail&&window.nav&&window.nav.onBeforeGo((()=>{if(nav.getQuery("community"))var e=ajax.post("/",{_ajax:1,act:"ping"},{onDone(){try{var t=JSON.parse(e.response),n=t&&t[1]&&t[1][2];nt.actualizeMessagesCornerCounter(n)}catch(e){}}})})),{wrapLinks:et.wrapLinks,wrapMention:at,onShowDialogFromCache:(0,o.se)(),onShowWritePageFromCache:(0,o.se)(),onShowDialogsPageFromCache:(0,o.se)(),onMessagesRepainted:(0,o.se)(),init:function(t,o){var{im:i}=window;window.cur.destroy.push((()=>{var e;null==(e=window.AudioMessagePlayer)||e.detachPlayer()})),o&&(cur.ref=o.ref,cur.refSource=o.ref_source),t&&(n=t,o&&(nt.saveDialog(o,t),e[t])),a||(a=!0,addEvent(document,H.isTouch?"touchstart":"mousedown",c)),setTimeout((()=>{i.on()}))},unpinMessage(t){u({caches:[{storage:e,getter:t+".write_form"}],updater:function(e){e.$$(".cm_unpin").forEach(hide),e.$$(".head_actions_wrap").forEach((e=>e.classList.remove("head_actions_has_pinned"))),e.$$(".pinnedMsg_peer_"+t).forEach((e=>e.classList.add("pinnedMsg_hidden")))}})},pinMessage(t,n){u({caches:[{storage:e,getter:t+".write_form"}],updater:function(e){e.$$(".cm_unpin").forEach(show),e.$$(".head_actions_wrap").forEach((e=>e.classList.add("head_actions_has_pinned"))),$$(".pinnedMsg_peer_"+t).forEach((e=>e.outerHTML=n))}})},clear:function(){nav.clear();var{im:o}=window;e={},t={},i={},n=null,removeEvent(document,H.isTouch?"touchstart":"mousedown",c),a=!1,o.off()},send:function(e,t){if(mediaUpload&&!mediaUpload.checkUploading())return!1;var n=ajax.click(e,extend({clear:!0,save:!0},Dialog),{lock:!0,url_params:{ref_source:cur.refSource,ref:cur.ref}});return cur.ref=void 0,cur.refSource=void 0,n},save:function(t){each(t,(function(t,n){e[t]&&n.last_msg==e[t].last_msg&&delete n.messages,nt.saveDialog(n,t)}))},saveDialog:function(t,n){e[n]||(e[n]={});var o=e[n];extend(o,t),o.msgs&&each(o.msgs,(function(e,t){i[t]=n}))},getPeerByMsg:function(e){return i[e]||!1},cacheDialogsPage:function(){nav.getQuery("community")&&nav.getQuery("tab")||(t.page=val("m"),nav.getQuery().act?t.link=ot("/mail"):t.link=nav.cur)},keyup:function(e,t,n){var o=l||"",a=e.value||"";o.length==a.length&&o==a||(nt.myTyping(t,n),l=a)},myTyping:function(e,t){if(!(e<=-2e9)){var n=vkNow();s[e]&&n-s[e]<5e3||(s[e]=n,ajax.post("/mail",{_ajax:1,act:"typing",peer:e,hash:t,community:nav.getQuery("community")}))}},typing:function(e,t){t=t||e;e>2e9?(r[e]||(r[e]={}),r[e][t]=vkNow()):r[e]=vkNow(),nt.updateTyping(e)},updateTyping:function(e){var t=(e,t)=>e.getAttribute&&e.getAttribute(t),{lang:n}=window,o=ge("dialog_near"+e),a=geByClass1("di_current_peer",o),i=geByClass1("di_typing",o);if(o){var s=[],l=vkNow();if(e>2e9)each(r[e]||{},(function(e,n){t(i,"data-u"+e)&&n&&l-n<6e3&&s.push(e)}));else{var c=r[e];t(i,"data-u"+e)&&c&&l-c<6e3&&s.push(e)}if(s.length){if(1==s.length){var d=s[0],u=t(i,"data-u"+d),_=t(i,"data-s"+d);val(i,'<i class="i_typing"></i>'+(n.mobile_mail_typing[_]||"").replace("{user}",u))}else{each(s,(function(e,n){s[e]=t(i,"data-u"+n)}));var p=s.pop();val(i,'<i class="i_typing"></i>'+(n.mobile_mail_multi_typing||"").replace("{users}",s.join(", ")).replace("{last_user}",p))}a.offsetWidth&&setStyle(i,"minWidth",a.offsetWidth),addClass("di_typing_now",o),setTimeout((function(){addClass("di_typing_animated",o)}),10),setTimeout((function(){nt.updateTyping(e)}),2e3)}else val(i,""),setStyle(i,"minWidth",0),removeClass("di_typing_animated",o),removeClass("di_typing_now",o)}},updateOnline:function(t,n){var o=ge("messages"+t);if(o&&remove(geByClass1("di_activity",o)),each(geByClass("_lv"+t,"mcont"),(function(e,t){d(t,n)})),e[t]){if(e[t].write_form){var a=ce("div",{innerHTML:e[t].write_form});each(geByClass("_lv"+t,a),(function(e,t){d(t,n)})),e[t].write_form=val(a)}if(e[t].messages){a=ce("div",{innerHTML:e[t].messages});remove(geByClass1("di_activity",a)),e[t].messages=val(a)}}},updateImportantMessages:function(n,o,a){u({caches:[{storage:t,getter:"page"},{storage:nav.page_get(ot("/mail")),getter:"html"}],updater:function(e){var t=geByClass1("dialogs_filter_button_important",e);if(t){var n=intval(val(t))+a;val(t,n),toggleClass("dialogs_filter_without_important",geByClass1("dialogs_filter",e),0===n)}}}),u({caches:[{storage:e,getter:n+".messages"}],updater:function(e){var t=geByClass1("_msg"+o,e);t&&toggleClass("msg_item_important",t,1===a)}})},updateImportantDialog:function(e,n){nav.getQuery("community")&&u({caches:[{storage:t,getter:"page"},{storage:nav.page_get(ot("/mail")),getter:"html"}],updater:function(t){var o=geByClass1("_peer"+e,t);o&&toggleClass("dialog_item_important",o,n)}})},markAsListened:function(t){var o=+t.getAttribute("data-msg");if(o&&n){var a=e[n];a&&a.hash&&ajax.post("/mail",{_ajax:1,act:"listen_audiomsg",msg_id:o,hash:a.hash},{onDone:()=>{var e=$$('.audio-msg-track[data-msg="'+o+'"]');if(e&&(e.forEach((e=>{e.closest(".im_msg_audiomsg").classList.add("im_msg_audiomsg_listened")})),a&&a.messages)){var t=ce("div",{innerHTML:a.messages}),n=geByClass1("_msg"+o,t),i=$('.audio-msg-track[data-msg="'+o+'"]',n);i&&i.closest(".im_msg_audiomsg").classList.add("im_msg_audiomsg_listened"),a.messages=val(t)}}})}},sendMarkAsRead:function(t,n){isArray(n)||(n=[n]);var o=e[t];o&&o.hash&&ajax.post("/mail",{_ajax:1,act:"mark_read",peer:t,msgs:n.join(","),mark_conversation_as_read:0===n.length,hash:o.hash,community:nav.getQuery("community")},{onDone:function(e){e&&each(n,(function(e,n){nt.markAsRead(t,n)}))}})},markAsRead:function(t,n){var{im:o}=window,a=ge("messages"+t);if(a){var i=geByClass1("_msg"+n,a);hasClass("_read",i)||removeClass("mi_unread",i);var r=e[t];if(r&&r.messages){var s=ce("div",{innerHTML:r.messages});i=geByClass1("_msg"+n,s);hasClass("_read",i)||removeClass("mi_unread",i),r.messages=val(s)}}},markPeerAsRead:function(n,o,a){var i=ge("messages"+n);if(i&&(each(geByClass("msg_item",i),(function(){if(!a==!hasClass("_unread",this))return!0;+attr(this,"data-id")<=o&&!hasClass("_read",this)&&removeClass("mi_unread",this)})),(c=e[n])&&c.messages)){var r=ce("div",{innerHTML:c.messages});each(geByClass("msg_item",r),(function(){if(!a==!hasClass("_unread",this))return!0;+attr(this,"data-id")<=o&&!hasClass("_read",this)&&removeClass("mi_unread",this)})),c.messages=val(r)}var s=ge("dialogs"),l=a?"di_unread_outbox":"di_unread_inbox";if(s)(c=geByClass1("_peer"+n,s))&&hasClass(l,c)&&(removeClass(l,c),remove(geByClass1("di_unread_cnt",c)));else if(t.page){var c;r=ce("div",{innerHTML:t.page});(c=geByClass1("_peer"+n,r))&&hasClass(l,c)&&(removeClass(l,c),remove(geByClass1("di_unread_cnt",c))),t.page=val(r)}u({caches:[{storage:nav.page_get(ot("/mail")),getter:"html"}],updater:function(e){var t=geByClass1("_peer"+n,e);t&&hasClass(l,t)&&(removeClass(l,t),remove(geByClass1("di_unread_cnt",t)))}})},markAsDeleted:function(t,n){var o=ge("messages"+t);if(o){remove(geByClass1("_msg"+n,o));var a=e[t];if(a&&a.messages){var i=ce("div",{innerHTML:a.messages});remove(geByClass1("_msg"+n,i)),a.messages=val(i)}}ajax.click(ot(nav.path),extend({no_scroll:!0},Dialogs))},updateMarkAsUnread:function(e,t){u({caches:[{storage:nav.page_get(ot("/mail")),getter:"html"}],updater:function(n){var o=$("._peer"+e,n);if(o){o.classList.toggle("di_unread_inbox",t);var a=$(".di_head",o);if(t){var i=$(".di_chat_user",o),r=document.createElement("span");r.classList.add("di_unread_cnt"),r.innerHTML="&nbsp;",a.insertBefore(r,i)}else{var s=$(".di_unread_cnt",o);s&&s.remove()}}}})},addMessage:function(t,n,o,a){if(t<2e9?delete r[t]:r[t]&&delete r[t][o],nt.updateTyping(t),!0!==a){if(t&&n&&(i[n]=t),!geByClass1("_msg"+n)){var s=e[t];if(s&&s.messages){s.msgs&&s.msgs.push(n);var l=ce("div",{innerHTML:s.messages});(d=geByClass1("di_activity",l))?(after(cdf(a),d),s.messages=val(l)):s.messages=a+s.messages,(c=ge("messages"+t))&&(val(c,s.messages),nt.onMessagesRepainted(!0))}else{var c,d;if(c=ge("messages"+t))(d=geByClass1("di_activity",c))?after(cdf(a),d):val(c,a+val(c))}}}else if(ge("dialogs")&&"/mail"==nav.path){var u=nav.getQuery();u.act||u.offset||u.q||ajax.click(ot(nav.path),extend({no_scroll:!0},Dialogs))}},replaceMessage:function(t,n,o,a){var i=ge("messages"+t),r=e[t];if(r&&r.messages){var s=ce("div",{innerHTML:r.messages}),l=geByClass1("_msg"+n,s);l&&(l.outerHTML=a),r.messages=val(s),val(i,r.messages)}else geByClass1("_msg"+n).outerHTML=a},getMsgHTML:function(t,n,o,a,i,r,s,l){var{vk:c,lang:d}=window,u=2&n?c.id:s&&s.from||o;if(!u)return!1;if(!ge("messages"+o))return!0;if(s.attach1||s.fwd||s.geo||s.emoji)return!1;if(s.source_act)return!1;if(!e[o]||!e[o].hash)return!1;var _="_u"+u,p=geByClass1(_,"mcont","a"),m=stripTags(attr(p,"data-name")||val(p)||""),f=getHref(p),v=geByClass1(_,"mcont","img"),g=v&&v.src||"";if(!m||!f||!g)return!1;o=intval(o),t=intval(t),i=i&&-1==i.toString().indexOf(" ... ")&&o<2e9?i:"";var h,w,y,k=1&n?" mi_unread":"";return!(2&n)&&1&n&&(k+=k?" _unread":""),r=nt.wrapLinks(r,n),r=nt.wrapMention(r),('<a name="msg{{msgId}}"></a><div  class="msg_item _msg{{msgId}}{{msgClass}}"  data-id="{{msgId}}"  onclick="return MessagesActions.onMessageClick(event);">  <div class="mi_iwrap">    <a class="al{{cl}}" href="{{href}}">      <img src="{{photo}}" class="mi_img {{cl}}" />    </a>  </div>  <div class="mi_cont">    <div class="mi_head">      <a class="mi_date" href="'+ot("/mail?act=msg&id={{msgId}}").replace(/\&/g,"&amp;")+'">        {{time}}      </a>      {{edited}}\n      <a class="mi_author al{{cl}} {{cl}}" href="{{href}}" data-name="{{dataName}}">        {{name}}      </a>    </div>    <div class="mi_body">      {{mi_title}}      <div class="mi_text">{{text}}</div>    </div>  </div></div>').replace(/{{msgId}}/g,t).replace(/{{cl}}/g,_).replace(/{{href}}/g,f).replace("{{msgClass}}",k).replace("{{edited}}",l?'<span class="mi_edited">'+d.mobile_mail_edited+"</span>":"").replace("{{photo}}",g).replace("{{time}}",(h=new Date(1e3*a),w=h.getHours(),y=h.getMinutes(),w+":"+(y<10?"0":"")+y)).replace("{{dataName}}",escapeAttr(m)).replace("{{name}}",m.split(" ").shift()).replace("{{mi_title}}",i?'<div class="mi_title">'+i+"</div>":"").split("{{text}}").join(r)},updateStickers:function(){var{cur:t}=window,{post:o}=window,a=e[n];if(a){var i=a.write_form?(tt.default.getStickerPanel()||"").split("mail-0").join("mail"+n):"",r=ge("stickers_panel");r&&(replace(cdf(i),r),r=null,o.stickersInit())}},showDialog:function(o,a,i){var{cur:r}=window,{MessagesActions:s,Mention:c,Dialog:d}=window,{post:u}=window;if(s.hasFwdMessages())return s.attachFwdMessages(a),!1;t.scroll_top=scrollTop();var _=e[a];if(_){var p=ce("div",{innerHTML:val("m")}),m=geByClass1("mhb_back",p);if(m&&_.header){var f=ce("div");val(f,_.header),before(f.firstElementChild,m),remove(m)}var v=_.write_form?(tt.default.getStickerPanel()||"").split("mail-0").join("mail"+a):"";val(geByClass1("pcont",geByClass1("mcont",p)),_.write_form+v+(a?'<div id="messages'+a+'" class="messages bl_cont">'+(_.messages||"")+'<div id="al_loading"></div></div>':"")),val("m",p.innerHTML),u.stickersInit(),ajax.refreshLinks(_.fv_link,_.app_link),alLoadingFix(),n=a,_;var g=getHref(o);nav.go(g,null,{push_only:!0,no_push:i}),a?(l=null,nt.updateTyping(a),ajax.click(g,extend({save:a},d),{scroll:!0})):nt.onShowWritePageFromCache(!0),nt.onShowDialogFromCache(!0),scrollTop(0,10)}else nav.al_go(_&&_.cur_link||getHref(o)||nav.cur);nav.getQuery("community")&&"unread"===nav.getQuery("ctab")&&removeClass("al_back",geByClass1("mhb_back"));var h=geByClass1("MentionContainer"),w=parseJSON(attr(h,"data-mentions"))||[];return w.length&&c.init({url:!1,appendTo:h,defaultItems:w,items:w,preferDomain:!0}),window.AudioMessagePlayer.events.on("listened",nt.markAsListened),!1},backToDialogs:function(e){if(t.page)nav.go(t.link,null,{push_only:!0,no_push:e}),ajax.click(t.link,extend({no_scroll:!0},Dialogs)),val("m",t.page),ajax.refreshLinks(attr("fv_link","href")||attr("fv_link","data-href"),"vk://vk.com/mail"),n=null,scrollTop(t.scroll_top||0),nt.onShowDialogsPageFromCache(!0);else{var o=ot(t.link||"/mail");nav.go(o,null,{push_only:!0,no_push:e}),nav.al_go(o)}},actualizeMessagesCornerCounter(e){u({caches:[{storage:t,getter:"page"},{storage:nav.page_get(ot("/mail")),getter:"html"}],updater(t){var n=geByClass1("mhi_notify",t),o=geByClass1("mh_notify_counter",n);o||(o=ce("em",{className:"mh_notify_counter"}),append(o,n)),e?o.innerText=e:n.innerHTML="&nbsp;"}})}}}();function ot(e){var{community:t,ctab:n}=window.nav.getQuery(),o=t&&-1===e.indexOf("community=")?"community="+t:"",a=t&&n&&-1===e.indexOf("ctab=")?"&ctab="+n:"";return o?e+(e.indexOf("?")>=0?"&":"?")+o+a:e}function at(e){return e.replace(/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,(function(e,t,n,o,a){return'<a href="/'+(t+n)+'" class="mem_link">'+a+"</a>"}))}window.mail=nt,window.makeUrl=ot,window.Scroller=function(e,t){var n,o,a,i,r,s=t&&t.ignoreMouseWheel,l=t&&t.noAutoScroll,c=!isUndefined(document.ontouchmove),d=!0,u=!1,_=!1,p=!1,m=!1,f=0,v=0,g=!1,h=0,w=!1,y=!1,k=!1,b=!1;function S(e){var t=e.touches,n=getX(o),a=getY(o);return{x:((t&&t[0]?t[0].pageX:e.pageX)||0)-n,y:((t&&t[0]?t[0].pageY:e.pageY)||0)-a}}function C(e){g||(g=[]),g.push([vkNow(),e]),g=g.slice(-20)}function E(){g=!1}function T(){if(!g||g.length<2)return[0,0,0];for(var e=vkNow(),t=!1,n=g.pop(),o=g.length-1;o>=0;o--){if((a=e-g[o][0])>150)break;t=g[o]}if(!t||!n)return[0,0,0];var a,i=n[1].x-t[1].x,r=n[1].y-t[1].y,s=Math.sqrt(i*i+r*r);return(a=n[0]-t[0])?[s/a,i/a,r/a]:[0,0,0]}function I(e){"touchstart"==e.type?d=!e.touches||1==e.touches.length:"touchmove"==e.type?d=!1:"click"==e.type&&(d||(cancelEvent(e),d=!0))}function M(e){if(!(window.isNewMail&&e.target.closest(".stickers_panel")&&e.target.closest(".messenger")||b&&e.touches&&e.touches.length>1)){if(E(),_){if(v<=1)return}else if(getW(o)-getW(a)>=0)return;p=S(e),C(m=p),k=!0,setStyle.animate(a)}}function P(e){if(p&&(b||k)){thover&&thover.cancel(e);var t=S(e);if(C(m=t),k){var n=p.x-t.x,i=p.y-t.y;if(Math.abs(n)>=Math.abs(i)&&(cancelEvent(e),b=!0),k=!1,b){var r=getY(o),s=getH(o),c=scrollTop(),d=getCh();!l&&(r-7<c?scrollTop(r-7):r+s+7>c+d&&scrollTop(r+s+7-d))}}if(b)if(cancelEvent(e),_){var g=getW(o);n=p.x-t.x;(f<=0&&n<0||f>=v-1&&n>0)&&(n/=3);var w=-f-n/g,y=u?100*w+"%":w*g;setStyle.transform(a,{translate:[y,0]})}else{var E=getW(o)-getW(a);n=p.x-t.x;if(E>0&&(E=0),(w=h-n)<E)y=E-(E-w)/3;else if(w>0)y=0+(w-0)/3;else y=h-n;O(y),setStyle.transform(a,{translate:[y,0]})}}}function L(e){if(p&&b){if(cancelEvent(e),_){var t=4.7*T()[1],n=p.x-m.x,i=getW(o),r=Math.abs(n)>=i/2;(f>0&&(r&&n<0||t>1)||f<v-1&&(r&&n>0||t<-1))&&(f+=n>0?1:-1);var s=-f,l=u?100*s+"%":s*i;p=!1,E(),x(),setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[l,0]})}else{var c=function(){if(!g)return!1;var e=T(),t=e[0],n=e[1];if(E(),!t)return!1;var o=t/4.7,a=n*o-4.7*o*o/2;return o*=530,a*=140,clog("dx",a,"t",o),!(t<.1||!a)&&{dx:a,t:o}}(),d=getW(o)-getW(a);n=p.x-m.x,s=h-n;c&&(s+=c.dx),d>0&&(d=0),h=s<d?d:s>0?0:s;var w={duration:200,func:"ease"};c&&(w={duration:c.t,func:"cubic-bezier(0, 1, 1, 1)"}),O(h),setStyle.animate(a,"transform",w),setStyle.transform(a,{translate:[h,0]})}b=!1}}function B(e){if(!(s||window.isNewMail&&e.target.closest(".stickers_panel")&&e.target.closest(".messenger"))){if(preventEvent(e),_){if(v<=1)return}else if((n=getW(o)-getW(a))>=0)return;var t=(e.detail?e.detail:e.wheelDelta)>0?3:-3;if(!1===w&&(w=0),w+=t,!_){var n=getW(o)-getW(a),i=h-w;if(n>0&&(n=0),i<n)var r=n-(n-i)/3;else if(i>0)r=0+(i-0)/3;else r=h-w;O(r),setStyle.transform(a,{translate:[r,0]})}clearTimeout(y),y=setTimeout((function(){if(_){(f>0&&w<0||f<v-1&&w>0)&&(f+=w>0?1:-1);var e=-f,t=getW(o),n=u?100*e+"%":e*t;x(),setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[n,0]})}else{var i=getW(o)-getW(a);i>0&&(i=0),(e=h-w)<i?h=i:e>0?h=0:h-=w,O(n),setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[h,0]})}w=!1}),200)}}function A(e){if(_){var t=f;if(e&&e.target){var n=hasClass("sp_ppt",e.target)?e.target:gpeByClass("sp_ppt",e.target),i=+attr(n,"data-i");f=i<0?0:i>v-1?v-1:i}p=!1,E(),b=!1;var r=getW(o),s=-f,l=u?100*s+"%":s*r;x(),t!=f&&setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[l,0]})}}function O(e){if(!_){e=e||h;var t=getW(o)-getW(a);toggleClass("sw_left",o,e<0),toggleClass("sw_right",o,e>t)}}function x(){if(_){var e=geByClass1("sp_ppt_sel",n);e&&e===r[f]||(removeClass("sp_ppt_sel",e),addClass("sp_ppt_sel",r[f]))}}extend(this,{init:function(){o=geByClass1("scroller_wrap",n),a=geByClass1("scroller_cont",o),_?(i=geByClass1("sp_pages_pts",n),r=geByClass("sp_ppt",i),v=(geByClass("scroller_page",a)||[]).length,f=0,x()):O(h=0),g=!1,setStyle.transform(a,{translate:[0,0]}),c?(addEvent(o,"touchstart touchmove click",I),addEvent(o,"touchstart",M),addEvent(o,"touchmove",P),addEvent(o,"touchend touchcancel",L)):(addEvent(o,"mousewheel",B),addEvent(i,"click",A)),u||onBodyResize(A)},destroy:function(){c?(removeEvent(o,"touchstart touchmove click",I),removeEvent(o,"touchstart",M),removeEvent(o,"touchmove",P),removeEvent(o,"touchend touchcancel",L)):(removeEvent(o,"mousewheel",B),removeEvent(i,"click",A)),u||onBodyResize("__clear",A)},onShow:function(){_?x():O(h)},canClick:function(){return d}}),n=e,(t=t||{}).byPage?(_=!0,u=!H.default.android):(_=!1,u=!1,this.showElem=function(e){if(!_){var t=getX(e)-getX(o),n=t+h,i=n+getW(e),r=getW(o),s=!1;n<0?s=0-t+20:i>r&&(s=r-getW(e)-t-20);var l=getW(o)-getW(a);l>0&&(l=0),s<l?s=l:s>0&&(s=0),clog(t,h,n,i,0,r,s),!1!==s&&(O(h=s),setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[h,0]}))}})};var it=n(95415),rt=function(){var e=null,t={},n=1,o=null,a=!1,i=!1;function r(){n<64&&(n*=2)}function s(e,t){!1===e&&(e=getNotify()+(t||1)),setNotify(e),menu.refreshSingleCounter(Xe.COUNTERS_POS_MESSAGES,e)}function l(e){return Object.keys(e).some((e=>-1!==e.indexOf("attach")))||e.fwd||e.emoji||e.geo}function d(e,t,n){var o=toInt(e.from_admin)||null,a=toInt(nav.getQuery("community"));return o&&a?a:2&t?window.vk.id:toInt(e.from)||n}function u(){return Number(nav.getQuery("offset"))>0}function _(e){try{return JSON.parse(e)}catch(e){return null}}return{onNewMsg:(0,c.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags, isService }"),onEditMsg:(0,c.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags }"),onMsgReadByMe:(0,c.default)("msgId","dialogId"),onMsgReadByOther:(0,c.default)("msgId","dialogId"),onOnlineChange:(0,c.default)("{ userId, isOnline, onlinePlatform, lastActionTime }"),onTyping:(0,c.default)("dialogId","authorId"),onMultiTyping:(0,c.default)("peerId","userIds","totalCount"),onMsgImportantRemove:(0,c.default)("msgId"),onMsgImportantAdd:(0,c.default)("msgId"),onMsgRemove:(0,c.default)("msgId"),onMsgRestore:(0,c.default)("msgId"),onPeerKeyboard:(0,c.default)("peerId"),onPeerBanner:(0,c.default)("peerId"),onDialogImportant:(0,c.default)("peerId","isImportant"),onDialogMarkedUnread:(0,c.default)("peerId","isMarkedUnread"),onDialogPin:(0,c.default)("peerId"),onDialogUnpin:(0,c.default)("peerId"),onUnreadCount:(0,c.default)("event"),onResync:(0,c.default)(),isLongPollingEnabled:function(){return!!a},init:function(t){e||((0,it.setDocumentDomain)(),e=ce("iframe",{src:t.frameUrl},{display:"none"}),onDOMReady((function(){append(e,window.bodyNode),!0}))),rt.refreshParams(t),setTimeout(rt.check,1e3)},on:function(){clog("[longpoll] start"),a=!0,setTimeout(rt.check,1e3)},off:function(){clog("[longpoll] pause"),a=!1},refreshParams:function(e){extend(t,e||{}),extend(rt,t)},getKey:function(){if(o)try{o.abort()}catch(e){}o=ajax.post("/mail",{_ajax:1,act:"im_get_key",community:nav.getQuery("community")},{onDone:function(e){/[0-9a-f]{40}/i.test(e)?(rt.refreshParams({key:e}),rt.check()):clog("[longpoll] invalid key")},onFail:function(e){setTimeout(rt.getKey,1e3*n),clog("[longpoll] from getKey delaying getKey for "+n+"secs"),r()}})},check:function(){if(a&&!i)if(rt.makeRequest)try{rt.makeRequest((function(e,t){if(i=!1,a){var{vk:o}=window;if(o.__debug)rt.checked(parseJSON(t))&&(rt.check(),n=1);else try{rt.checked(parseJSON(t))&&(rt.check(),n=1)}catch(e){try{clog("[longpoll] error",e.message||"no message",e.type||"no type",e.stack||"no stack")}catch(e){}setTimeout(rt.check,1e3*n),r()}}}),(function(){i=!1,setTimeout(rt.check,1e3*n),r()})),i=!0}catch(e){clog("[longpoll] makeRequest failed")}else setTimeout(rt.check,1e3)},checked:function(e){var o,a,i,c=e.failed;if(1==c||t.ts>=e.ts+256){if(rt.refreshParams({ts:e.ts}),c)return!0}else{if(2==c)return clog("[longpoll] delaying getKey for "+n+"secs"),setTimeout(rt.getKey,1e3*n),r(),!1;if(c)return void clog("[longpoll]",e)}if(rt.refreshParams({ts:e.ts}),e.updates){var p=[],m=!1;for(var f in e.updates){if(116==e.updates[f][0])var v=e.updates[f][1],g=[e.updates[f][0],v.id,v.flags,v.peer_id,v.date,v.title||"",v.message,v.kludges,v.random_id];else g=e.updates[f];var h=intval(g[0]),w=intval(g[1]),y=intval(g[2]),k=intval(g[3]);if(1===y){if(10===h){mail.updateImportantDialog(w,!1);continue}if(12===h){mail.updateImportantDialog(w,!0);continue}}if(y&1<<20){if(10===h){mail.updateMarkAsUnread(w,!1);continue}if(12===h){mail.updateMarkAsUnread(w,!0);continue}}if(8&y){if(2===h){if(window.isNewMail){rt.onMsgImportantAdd(w);continue}mail.updateImportantMessages(k,w,1);continue}if(3===h){if(window.isNewMail){rt.onMsgImportantRemove(w);continue}mail.updateImportantMessages(k,w,-1);continue}}if(51!=h)if(61!=h)if(62!=h)if(8!=h)if(9!=h)if(6!=h&&7!=h)if(80!=h||!w||nav.getQuery("community"))if(52!=h){if(k)if(4!=h&&5!=h&&116!=h)if(0!=h)if(2!=h);else{if(128&y){if(window.isNewMail){rt.onMsgRemove(w);continue}mail.markAsDeleted(k,w)}window.isNewMail&&64&y&&rt.onMsgRemove(w)}else{if(window.isNewMail){rt.onMsgRemove(w);continue}mail.markAsDeleted(w)}else{var b=5==h||116==h;if(window.isNewMail){var[,S,,C,E,,T,I={},M]=g,P=l(I),L=(o=void 0,a=void 0,i=void 0,o=new Date(1e3*E),a=o.getHours(),i=o.getMinutes(),a+":"+(i<10?"0":"")+i),B=toInt(I.from_admin)||null,A=(toInt(nav.getQuery("community")),d(I,y,C)),O=!!I.source_act,x=I.keyboard?_(I.keyboard):null;if(b){var R={peerId:C,msgId:S,authorId:A,text:T,date:L,hasAttachments:P,flags:y,adminId:B,randomId:M};116==h?R.refreshed=1:R.edited=Math.floor(Date.now()/1e3),rt.onEditMsg(R)}else rt.onNewMsg({peerId:C,msgId:S,authorId:A,text:T,date:L,hasAttachments:P,flags:y,adminId:B,randomId:M,isService:O,keyboard:x});continue}var{vk:N}=window,D=2&y?N.id:g[7]&&g[7].from||k,F=g[7]&&g[7].source_act;m||(m=!!need("PinnedMsg").getByMsgId(w));var U=g[7].from_admin||F||m?null:mail.getMsgHTML(w,y,k,g[4],g[5],g[6],g[7],116!=h?b:"");if(U&&(b?mail.replaceMessage(k,w,D,U):u()||mail.addMessage(k,w,D,U),2&y||nav.getQuery("community")||s(!1,1)),"chat_kick_user"===F&&g[7].source_mid==N.id){var H=g[3];mail.unpinMessage(H)}U&&"chat_pin_message"!==F&&"chat_unpin_message"!==F||p.push({peer:k,msg_id:w,from_id:D,source_act:F,edited:b})}}else{var[,j,$]=g;if(!window.isNewMail)continue;11==j&&rt.onPeerKeyboard($),10==j&&rt.onPeerBanner($)}else s(w);else{if(window.isNewMail){var V=g[1],W=g[2];6===h?rt.onMsgReadByMe(W,V):rt.onMsgReadByOther(W,V);continue}mail.markPeerAsRead(w,y,7==h)}else{if(window.isNewMail){rt.onOnlineChange({userId:-w,isOnline:!1,lastActionTime:k});continue}mail.updateOnline(-w,0)}else{if(window.isNewMail){rt.onOnlineChange({userId:-w,isOnline:!0,onlinePlatform:7===(y||7)?"desktop":"mobile"});continue}mail.updateOnline(-w,y||7)}else{if(window.isNewMail){var K=2e9+y,q=w;rt.onTyping(K,q);continue}mail.typing(2e9+y,w)}else{if(window.isNewMail){var G=w,z=w;rt.onTyping(G,z);continue}mail.typing(w)}}if(p.length){var Q=[];each(p,(function(e,t){Q.push(t.msg_id)}));var Y={_ajax:1,act:"get_messages",msgs:Q.join(","),community:nav.getQuery("community")};m&&(Y.force_pinned=1),ajax.post("/mail",Y,{onDone:function(e,t){var{cur:n}=window,o=u();each(p,(function(t,n){var a=e[n.msg_id],i=n.peer;a.text&&!o&&(n.edited?mail.replaceMessage(n.peer,n.msg_id,n.from_id,a.text):mail.addMessage(n.peer,n.msg_id,n.from_id,a.text)),a.unpin&&mail.unpinMessage(i),a.pinned&&mail.pinMessage(i,a.pinned)})),t&&(t.play_animation_msg_id&&StickersAnimation?StickersAnimation.loadStickerInMvkIMAndPlay(t.play_animation_msg_id):(extend(n,t),mail.updateStickers()))}})}}return!0}}}(),st=rt,lt=n(1576);window.isNewLongpoll?window.im=lt.default:window.im=st;n(38920),n(18331),n(65855);var ct={onClose:(0,c.default)(),inited:!1,width:!1,height:!1,onResize:null,_lastNav:!1,_opened:!1,_destroy:!1,init:function(){ct.inited||(ct.inited=!0,ct.initEvents())},initEvents:function(){var e=function(e){ct.fixHeight(vkNow()+2e3,e)};addEvent(window,"orientationchange",e),onBodyResize(e),e(!0)},opened:function(){return hasClass("z_opened",window.bodyNode)!==ct.opened&&toggleClass("z_opened",window.bodyNode,ct._opened),ct._opened},toggle:function(e,t){return!!checkEvent(e)||(ct.opened()?ct.close(e,t):ct.open(e,t),!1)},open:function(e,t){return!!checkEvent(e)||(ct.opened()||(thover.clear(),ct.init(),ct._st=scrollTop(),ct._lastNav=!1,addClass("z_opened",window.bodyNode),ct._opened=!0,ct.fixHeight(vkNow()+2e3,!0),scrollTop(0)),!1)},close:function(e,t){return!!checkEvent(e)||!!ct.opened()&&(thover.clear(),val("z",""),removeClass("z_opened",window.bodyNode),ct._lastNav={cur:nav.cur,path:nav.path,params:nav.params,hash:nav.hash},ct._opened=!1,ct._destroy&&(ct._destroy(),ct._destroy=!1),scrollTop(ct._st,1),ct._st=!1,ct.onResize=null,ct.onClose(),!1)},updateSize:function(){var e=ge("z");e&&e.offsetWidth&&e.offsetHeight&&(ct.width=e.offsetWidth,ct.height=e.offsetHeight,ct.onResize&&ct.onResize())},fixHeight:function(e,t){if((ct._opened||t)&&(e&&!(vkNow()>e)||t)){var n=getCw(),o=getCh();(ct._lastWidth!=n||ct._lastHeight!=o||t)&&(ct._lastWidth=n,ct._lastHeight=o,setStyle("z","height",o),ct.updateSize(),scrollTop()||scrollTop(0)),clearTimeout(ct._fixTo),ct._fixTo=setTimeout(ct.fixHeight,50,e)}},create:function(e,t){val("z",e),ct._destroy=t}};window.zlayer=ct;n(57545);var dt=n(76567);window.FeedNotifications={webActionsAcceptHandlers:{reveal_bdya:function(e,t,n,o,a){var i=gpeByClass("_block",e);return ajax.post("profileEdit.php",{act:"reveal_birthday",from:"feed_assistance",hash:a},{onDone:function(e){var{Snackbar:t}=window;t&&t.init&&t.init({text:e.msg}),remove(i)}}),!0}},webActionsDeclineHandlers:{},withoutNavActions:["enable_browser_notifications","reveal_bdya"],hide:function(e){function t(t,n,o,a,i,r,s,l){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,o,a,i,r,s){var l={_ajax:1,act:"hide_internal_notification",reason:o,id:t,hash:n},c={},d=gpeByClass("_block",e),u=!0;if("decline"==o){var _=this.webActionsDeclineHandlers[i];u=this.runActionHandler(_,e,l,c,r,n),hide(d)}else{var p=this.webActionsAcceptHandlers[i];u=this.runActionHandler(p,e,l,c,r,n),lockButton(e),"add_custom_newsfeed"==i&&((0,dt.setCookie)("remixcustom_feed_added",r),l.action=i,l.action_section=r.section,l.action_hash=r.hash)}return c.onDone=function(){"compact"===s&&"accept"===o||cur.destroy.push((()=>remove(d))),~this.withoutNavActions.indexOf(i)||nav.go(e,a)}.bind(this),c.onFail=function(){unlockButton(e)},Promise.resolve(u).then((e=>{(e||isUndefined(e))&&ajax.post("/index.php",l,c)})),!1})),runActionHandler:function(e,t,n,o,a,i){return!isFunction(e)||e(t,n,o,a,i)},addWebActionAcceptHandler(e,t){this.webActionsAcceptHandlers[e]=t},addWebActionDeclineHandler(e,t){this.webActionsDeclineHandlers[e]=t}},function(){function e(){if(geByClass1("tabs_block_hideable")){var e=geByClass1("tabs_block");geByClass1("tabs_list").offsetHeight>geByClass1("tabs_list_more").offsetHeight?removeClass("tabs_block_without_show_more",e):addClass("tabs_block_without_show_more",e)}}onDOMReady(e),onBodyResize(e),window.Tabs={actualizeShowMoreVisibility:e,toggle:function(e){var t=gpeByClass("tabs_block",e);hasClass("tabs_block_opened",t)?(0,dt.setCookie)("remixm_tabs_expanded","",-1):(0,dt.setCookie)("remixm_tabs_expanded",1),toggleClass("tabs_block_opened",t)}}}();var ut=n(49598);window.Podcast={toggleFave:(e,t,n)=>{var o="snippet__favorite_active",a=hasClass(e,o);ajax.post("fave.php",{act:"fave_podcast",add:!a,hash:n,audio_id:t,ref:cur.module}),attr(e,"aria-label",a?lang.mobile_bookmarks_actions_add:lang.mobile_bookmarks_actions_remove),a?removeClass(e,o):addClass(e,o)},onOpenClick:(e,t)=>{var n=$(".snippet__popup",e.closest(".snippet")),o="";cur&&cur.module?o=cur.module:nav&&"/feed"===nav.cur?o="feed":!nav||"/feed?section=podcasts"!==nav.cur&&"/feed/podcasts"!==nav.cur||(o="feed_podcasts"),statlogsValueEvent("mvk_podcasts_actions","mvk_open_popup",t,o),ut.default.open(n,!0)}};var _t=n(85863),pt=n(16800),mt=n(81294),ft=n(7846),vt=browser.meizu||browser.mi||browser.uc_mini||0!==browser.ios&&browser.ios<10||browser.chrome&&browser.version.split(".")[0]<53,gt=!vt&&!!s.default.getFlag(s.FLAG_MP4),ht={gifs:[],currentAutoplayElement:null,ignore:[]},wt={isBadBrowser:vt,isMp4Supports:()=>gt,openPopup(e,t,n){if(void 0===n&&(n={}),this.autoplayTest(),e&&cancelEvent(e),function(e){cur.loadedGifs||(cur.loadedGifs={});return!cur.loadedGifs[e.raw]}(n)&&n.needConfirm){var a=function(e){return(0,o.ceFromString)(d.default.html((0,pt.default)({scrollable:!0,header:{title:getLang("mobile_wall_gif_size_warning_popup_title")},content:[getLang("mobile_wall_gif_size_warning").replace("{size}",e.size),{class:"Popup__buttons",inner:[(0,mt.default)({onClick:'Gif.confirm(this, "'+e.raw+'")',use_native_onclick:!0,class:"Popup__button",theme:"regular",inner:d.default.wrap(getLang("mobile_continue"))}),(0,mt.default)({onClick:"Popup.close(this)",use_native_onclick:!0,class:"Popup__button",theme:"secondary",inner:d.default.wrap(getLang("mobile_cancel"))})]}]})))}(n,t.getAttribute("data-media"));return domInsertBefore(a,t),void pt.default.open(a,!0)}wt.openMediaView(n.raw,n.hash,{hasVideo:n.hasVideo,no_push:n.no_push})},openMediaView(e,t,n){void 0===n&&(n={});var a=makeUrl("/doc"+e+(n.hasVideo?"?mp4":""),{hash:t});(0,ft.fetchMediaView)().then((i=>{var{open:r,actionBridge:s,setItems:l}=i;(0,o.statlogsValueEvent)(Xe.STATLOG_MEDIAVIEW_EVENT,"init","gif");var c=s.handle("visibilityChanged",(a=>{if(a.state){var i=nav.getQuery(),r=(0,_t.default)({},i,{z:"doc"+e+"/"+(t||"")}),s=!!i.z,l=nav.path+(0,o.obj2qs)(r)+nav.hash;nav.go(l,null,{no_push:n.no_push,push_only:!0,replace:s})}else{c();var d=qs2obj(nav.params);if(!!d.z&&history.length>1)return history.back(),clog("History back done"),!1;var u=nav.path+(0,o.obj2qs)(d)+nav.hash;nav.backToTabHistory(null,{href:u,replace:!0,restore:!0})}}));l([{type:2,id:e,gifType:n.hasVideo?"video":"image",src:a}]),r()})).catch((()=>{window.open(a,"_blank")}))},close(){var e=(0,_t.default)({},nav.getQuery());delete e.z;var t=nav.path+(0,o.obj2qs)(e)+nav.hash;nav.go(t,null,{push_only:!1,nav_incr:!0})},confirm(e,t){cur.loadedGifs[t]=!0,pt.default.close(e),(0,o.geBySel1)('[data-media="'+t+'"]').click()},autoplayTest(){s.default.detectAutoplay().then((e=>{gt=s.default.getFeatures().mp4&&e&&s.default.getFlag(s.FLAG_MP4)&&!vt}))},activateGIF(){if("/mail"!==nav.path){var e=scrollTop(),t=e+window.innerHeight,n=e+window.innerHeight/2,o={};Array.from(ht.gifs||[]).forEach((a=>{var i=getXY(a)[1],r=i>=e&&i<=t,s=Math.abs(n-i);r&&(o[s]=a)}));var a=o[Math.min(...Object.keys(o))];a?a.classList.contains("current_gif")||-1===ht.ignore.indexOf(a)&&(post.toggleGif(a,!1,!1,!0),ht.currentAutoplayElement=a):post.hidePlayingGifs(!1,!0)}},onUpdate(){s.default.getFlag(s.FLAG_GIF_AUTOPLAY)&&(ht.gifs=[...Array.from($$(".doc_preview_rows_1 .doc_preview_gif")||[])],onBodyScroll((0,o.throttle)(wt.activateGIF,200)))},getState:()=>ht,setState(e,t){ht[e]=t}};onDOMReady((()=>{null==wt||wt.onUpdate(),page.onChange((()=>{null==wt||wt.onUpdate()}))})),window.Gif=wt;var yt=n(62641),kt=n(90893);function bt(e,t){var n=(0,o.ge)("select-copyright"),a=(0,K.$)('input[name="copyright"]'),i=(0,K.$)(".create_post__source-option"),r=(0,K.$)(".Btn__text",i);e?(n.style.display="inline-block",n.onclick=n=>window.posting.openCopyright(n,!0,t,encodeURIComponent(e)),i.onclick=n=>window.posting.openCopyright(n,!0,t,encodeURIComponent(e)),r.innerHTML=(0,yt.getLang)("mobile_wall_post_copyright_edit_button")):(i.onclick=n=>window.posting.openCopyright(n,!1,t,encodeURIComponent(e)),(0,o.setStyle)(i,"display","table"),r.innerHTML=(0,yt.getLang)("mobile_wall_post_copyright_add_button"),(0,o.hide)(n)),(0,o.val)(a,e),window.post.checkCopyright()}var St={open:function(e,t,n){void 0===e&&(e=!1),void 0===n&&(n="");var a=new RegExp("{link}(.*){/link}"),i=a.exec((0,yt.getLang)("mobile_wall_post_copyright_mb_text"))[1],r="/@adminsclub-citation?from="+encodeURIComponent(nav.cur),s=(0,yt.getLang)("mobile_wall_post_copyright_mb_text").replace(a,"<a onclick=\"Popup.close(this); nav.go('"+r+'\', null)" href="'+r+'">'+i+"</a>"),l=(0,pt.default)({class:"AddCopyrightPopup",header:{title:e?(0,yt.getLang)("mobile_wall_post_copyright_mb_title_text_edit"):(0,yt.getLang)("mobile_wall_post_copyright_mb_title_text")},content:{inner:[!e&&{tag:"span",inner:Wd.wrap(s)},(0,kt.default)({class:"AddCopyrightPopup__input",placeholder:(0,yt.getLang)("mobile_post_copyright_input_placeholder"),value:decodeURIComponent(n),spellcheck:!1,on_key_down:["posting.saveSource",t]}),{class:"AddCopyrightPopup__error",style:"display: none;"},{class:"Popup__buttons",inner:[(0,mt.default)({class:"Popup__button",inner:e?(0,yt.getLang)("mobile_wall_post_copyright_edit_button"):(0,yt.getLang)("mobile_wall_post_copyright_add_button"),theme:"regular",use_native_onclick:!0,on_click:'posting.saveSource("'+t+'", this)'}),e?(0,mt.default)({class:"Popup__button",inner:(0,yt.getLang)("mobile_delete"),theme:"secondary",use_native_onclick:!0,on_click:'posting.deleteSource(event, this, "'+t+'")'}):{}]}]}});pt.default.open(Wd.elem(l),!0);var c=(0,K.$)(".AddCopyrightPopup__input input");c&&(0,o.elfocus)(c)},submit:function(e,t,n){var a=(0,K.$)(".Btn",n.parentNode);a.disabled=!0,window.ajax.post("/wall?act=check_copyright_link",{_ajax:1,link:e},{onDone(i){var r=(0,K.$)(".AddCopyrightPopup__error");i.status?(n.classList.remove("TextInput_error"),(0,o.hide)(r),bt(e,t),pt.default.close(n)):(n.classList.add("TextInput_error"),(0,o.show)(r),(0,o.val)(r,i.error)),window.post.saveDraft(null,t),a.disabled=!1}})},remove:function(e,t){t&&pt.default.close(t),bt("",e),e&&window.post.saveDraft(null,e)}};window.AddCopyrightPopup=St;var Ct=St,Et={getHash(){var e=(0,K.$)("#feed_add_form"),t=qs2obj(e.action.split("?")[1]);return e.getAttribute("data-hash")||t.hash},openCopyright(e,t,n,o){cancelEvent(e);var a=!1;if("BUTTON"===e.target.tagName)a=e.target.disabled;else if("LABEL"===e.target.tagName){a=(0,K.$)("button",e.target).disabled}a||Ct.open(t,n,o)},saveSource(e,t){if(t.target){if(13!==t.keyCode)return;t=t.target}var n=(0,K.$)(".AddCopyrightPopup__input",t.closest(".AddCopyrightPopup")),o=n.querySelector("input");Ct.submit(o.value,e,n)},deleteSource(e,t,n){var o=(0,K.$)(".AddCopyrightPopup__input",t.closest(".AddCopyrightPopup"));event&&cancelEvent(e),Ct.remove(n,o)},deleteObject(e){e&&cancelEvent(e);var{params:t}=nav,n=qs2obj(t);delete n.object,delete n.list,n.delete_object=1,post.saveDraft(null,Et.getHash(),""+nav.path+obj2qs(n))}};window.posting=Et;n(65497);var Tt=n(70162),It={},Mt=(e,t,n,o)=>{delete It[t],1===o?Emoji.favorite.addFavoriteSticker(e,t,n):-1===o&&Emoji.favorite.deleteFavoriteSticker(e,t,n)};var Pt,Lt={toggleFavorite:function(e,t,n){if(t&&t.stopPropagation(),!e.classList.contains("on")&&Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS].stickers.length>=Emoji.favoriteLimit&&!Emoji.favoriteLimitNoticed){var o=(0,Tt.langStr)(getLang("purchases_stickers_favorite_limit_notice"),"%s",Emoji.favoriteLimit);return setTimeout(window.showFastBox(getLang("global_error"),o).hide,3e3),ajax.post("stickers.php",{act:"favorite_limit_noticed",value:1}),Emoji.favoriteLimitNoticed=!0,!1}var a=e.getAttribute("data-sticker-id"),i=e.getAttribute("data-hash");return!(!a||!i)&&(!It[a]&&(It[a]=1,e.classList.toggle("on"),void ajax.post("/stickers.php",{act:"toggle_favorite",sticker_id:a,hash:i},{onDone:Mt.pbind(n,a,e)})))},getStickerUrl:function(e,t){var n=String(t);if(i.colorScheme.isDarkScheme()&&(n=n.replace(/b$/,"")+"b"),window.Emoji){var o,a,r,s=null==(o=Emoji.stickersById)||null==(a=o[e])||null==(r=a.sticker[Emoji.STICKER_FIELD_IMAGES])?void 0:r[n];if(s)return s}var l={id:e,size:n};if(window.isMVK){if(window.stickers_cache){var c=window.stickers_cache.getStickerImage(e,n);if(c)return c}return window.store.stickers&&window.rs(window.store.stickers.url_template,{id:e,size:n})}return window.getTemplate("stickers_sticker_url",l)}},Bt=function(){var e,t,n,o=!1,a=!1,i={},r={},s={},l={};function c(e){var t=_(e),n=1;if(t){hasClass(e,"animation_play")||(hide(geByClass1("sticker_img",e)),addClass(e,"animation_play")),t.play();var o=attr(e,"data-loop-count");o=parseInt(o),isNaN(o)&&(o=3),-1!==o&&(!t._cbs.loopComplete||t._cbs.loopComplete&&0===t._cbs.loopComplete.length)&&t.addEventListener("loopComplete",(function a(i){n++;var r=!0;o>=n&&(r=!1),r&&(u(e,!1),""!==t._cbs.loopComplete&&t.removeEventListener("loopComplete",a),t.stop())}))}}function d(e){var t=attr(e,"data-uid");return t||(t=attr(e,"data-uid",Math.random().toString(32).substr(2))),t}function u(e,t){l[d(e)]=t}function _(e){var t=attr(e,"data-uniq-id");if(!geByClass1("svg_sticker_animation",e))return!1;var n=r[t];return n||!1}function p(e,t){var o=_(e);if(o)"function"==typeof t&&t(o);else{var a=attr(e,"data-uniq-id");if(!l[d(e)]){u(e,!0);var s=attr(e,"data-animation-path"),c=attr(e,"data-sticker-id"),p=!1;if(c&&(p=(i[c]||s)&&f(e)),p){var m=attr(e,"data-animation-class")||"",v={container:e,renderer:"svg",loop:!0,autoplay:!1,name:a,rendererSettings:{scaleMode:"noScale",progressiveLoad:!0,hideOnTransparent:!0,className:"svg_sticker_animation "+m}};i[c]?v.animationData=i[c]:v.path=s;var g=geByClass1("svg_sticker_animation",e);if(g&&re(g),o=n.loadAnimation(v),!i[c])return void o.addEventListener("data_ready",(function(){i[c]=o.animationData,r[a]=o,"function"==typeof t&&t(o)}))}"function"==typeof t&&(r[a]=o,"function"==typeof t&&t(o))}}}function m(){return t().then((e=>(n=e,e)))}return{init(e){t=e.animatorLoader},checkSettingsAndLoadInWeb:function(e){if(StickersSettings.getAutoplay()){var t=ge("fc_msg"+e),n=geByClass1("sticker_animation",t);Bt.loadAndPlaySticker(n)}},checkSettingsAndLoad:function(e){if(StickersSettings.getAutoplay()){var t=$(".msg_id_"+e+" .sticker_animation");Bt.loadAndPlaySticker(t)}},loadStickerInMvkIMAndPlay:function(e,t){var n="_msg"+e;t&&(n="msg_id_"+e);var o=geByClass1("sticker_animation",geByClass1(n));Bt.loadAndPlayStickerWithTimer(o,500)},loadAutoplayAnimationStickers:function(e){if(n){if(e){if(a)return;a=!0}if(!o){o=!0;var t=geByClass("sticker_animation_autoplay");t&&each(t,(function(e,t){p(t,(function(){c(t)}))})),o=!1}}else m().then((()=>{Bt.loadAutoplayAnimationStickers(e)}))},loadAndPlaySticker:function(e){e&&(n?requestAnimationFrame((()=>{p(e,(function(){c(e)}))})):m().then((()=>{Bt.loadAndPlaySticker(e)})))},loadAndPlayStickerWithTimer:function(e,t){if(e&&!s[e]){t||(t=1e3);var n=ge(e);hasClass(n,"sticker_animation_disabled_timer")||(s[e]=setTimeout((function(){!n&&(n=ge(e),hasClass(n,"sticker_animation_disabled_timer"))||(Bt.loadAndPlaySticker(n),clearTimeout(s[e]),s[e]=!1)}),t))}},reloadStickers:function(){r={}},touchStartSticker:function(t){t.addEventListener("contextmenu",Bt.preventContextMenu,!1),e=setTimeout((function(){Bt.loadAndPlaySticker(t)}),500)},touchEndSticker:function(){e&&clearTimeout(e)},preventContextMenu:function(e){e.preventDefault(),e.stopPropagation()}};function f(e){var t=e.getBoundingClientRect().top,n=e.getBoundingClientRect().bottom;return t<window.innerHeight&&n>=0&&isVisible(e)}}(),At={autoplay:0,setAutoplay:function(e){this.autoplay=e},getAutoplay:function(){return!!At.autoplay&&!At.isPreventAutoplayByCalls()},isPreventAutoplayByCalls:function(){return!!window.Calls&&window.Calls.isInActiveCall}};function Ot(){return qs2obj(nav.params)}function xt(e){return"dialogs"===e.tab||!e.q}function Rt(e){var t=nav.getQuery("community");return t?(e?"?":"&")+"community="+t:""}function Nt(){var{lang:e}=window;qsearch.init({init_once:!0,action:"/mail?act=write&fast=1",container:ge("ma_search_items"),field:ge("ma_search_field"),btn:ge("ma_search_btn"),top_items:[],_cache:{},item_tpl:function(e,t,n,o,a){return this.id>2e9||-1===this.id?'<a href="'+(e||"")+'" class="simple_item'+(-1==this.id?" simple_item_create":"")+'">'+(t||"")+'<div class="si_body"><span class="si_owner">'+this.highlight(n||"")+"</span>"+(o||"")+(a?'<div class="si_slabel">'+a+"</div>":"")+"</div></a>":'<a href="'+(e||"")+'" class="inline_item"><div class="ii_body">'+(t||"")+'<span class="ii_owner">'+this.highlight(n||"")+"</span>"+(o||"")+"</div></a>"},null_tpl:function(){return'<div class="service_msg_box"><div class="service_msg service_msg_null">'+e.mobile_mail_no_peers+"</div></div>"},need_invalid_keys:H.default.desktop,onLoaded:function(e){for(var t in e)mail.saveDialog(e[t][e[t].length-1],t)}})}Bt.init({animatorLoader:()=>Promise.all([n.e(8695),n.e(5544)]).then(n.bind(n,68440)).then((e=>e.default))}),window.Stickers=Lt,window.StickersAnimation=Bt,window.StickersSettings=At,window.StickersCache=tt.default,im.clearSearchInput=function(e){if(preventEvent(e),xt(Ot())){var t=ge("ma_search_field");val(t,""),im.onFilterKeyDown(t)}else nav.go("/mail"+Rt(!0))},im.onFilterKeyDown=function(e){setTimeout((function(){var{lang:t}=window,n=encodeURIComponent(e.value),o=Ot();if(toggle(geByClass1("mail_search_clear_button"),n),attr(geByClass1("tab_dialogs_search"),"href",n?"/mail?tab=dialogs&q="+n+Rt():"/mail"+Rt(!0)),attr(geByClass1("tab_messages_search"),"href","/mail?q="+n+Rt()),xt(o)){var a,i=ge("mail_tabs"),r=ge("ma_search_items"),s=ge("dialogs"),l=o.offset;if(removeClass("mail_show_filtered",geByClass1("mail")),Pt&&clearTimeout(Pt),toggleClass("dialogs_filter_without_important",ge("dialogs_filter"),n||0===intval(val(geByClass1("dialogs_filter_button_important")))),n)show(i),show(r),hide(s),Pt=setTimeout((function(){a="/mail?tab=dialogs&q="+n+(l?"&offset="+l:"")+Rt(),"/mail"!==nav.path||Ot().act||nav.go(a,null,{push_only:!0})}),200);else{if(hide(i),hide(r),show(s),!nav.getQuery("community")){var c=geByClass1("mhb_back"),d=geByClass1("mh_header");val(d,t.mobile_mail_head_title),removeClass("mhi_back",d),c.outerHTML=c.outerHTML.replace("<a","<div").replace("</a>","</div>")}a="/mail"+(l?"?offset="+l:"")+Rt(!l),nav.go(a,null,{push_only:!0})}}}),40)},mail.onShowWritePageFromCache(Nt),mail.onShowDialogsPageFromCache(Nt);var Dt=n(22683),Ft="mvk_found_selectors_cache",Ut=function(){function e(){var t=this;this.init=function(){return(0,u.__awaiter)(t,void 0,void 0,(function(){var e;return(0,u.__generator)(this,(function(t){return(0,X.isMutationObserverSupported)()?(e=this.getSelectorsToCheck(),(0,A.partConfigEnabled)("mvk_watch_css_selectors")?(this.selectorsSet=new Ht(e),this.startWatching(),this.registerBeforeUnload()):this.clearLocalStorageCache(),[2]):[2]}))}))},this.startWatching=function(){t.observer=new MutationObserver(t.checkSelectors),t.observer.observe(document.body,{subtree:!0,childList:!0,attributes:!0})},this.clearLocalStorageCache=function(){Dt.vkLocalStorage.removeItem(Ft)},this.checkSelectors=function(){var e,n;try{for(var o=(0,u.__values)((0,u.__spreadArray)([],(0,u.__read)(t.selectorsSet.watching),!1)),a=o.next();!a.done;a=o.next()){var i=a.value;document.querySelector(i)&&(t.selectorsSet.markAsFound(i),t.scheduleSendSelectors())}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}0===t.selectorsSet.watching.size&&t.observer.disconnect()},this.registerBeforeUnload=function(){window.addEventListener("beforeunload",(function(){t.clearSendTimeout(),t.sendSelectors()}),{passive:!0})},this.scheduleSendSelectors=function(){t.clearSendTimeout(),t.selectorsTimeout=setTimeout((function(){t.sendSelectors(),t.selectorsTimeout=void 0}),3e3)},this.clearSendTimeout=function(){null!=t.selectorsTimeout&&clearTimeout(t.selectorsTimeout),t.selectorsTimeout=void 0},this.getSelectorsToCheck=function(){var t,n=null!==(t=window.vk.selectorsToCheck)&&void 0!==t?t:[],o=e.loadFoundSelectorsCache();return o?n.filter((function(e){return!o.includes(e)})):n},this.sendSelectors=function(){var n=t.selectorsSet.popFound();e.writeFoundSelectorsCache(n.map((function(e){return e.selector}))),n.length&&window.ajax.post("/",{act:"store_found_selectors",selectors:JSON.stringify(n)})}}return e.loadFoundSelectorsCache=function(){var e=Dt.vkLocalStorage.getItem(Ft);if(e)return JSON.parse(e)},e.writeFoundSelectorsCache=function(t){var n=e.loadFoundSelectorsCache(),o=new Set(t);null==n||n.forEach((function(e){return o.add(e)})),Dt.vkLocalStorage.setItem(Ft,JSON.stringify((0,u.__spreadArray)([],(0,u.__read)(o),!1)))},e}(),Ht=function(e){var t=this;this.markAsFound=function(e){t.watching.delete(e),t.found.add({selector:e,module:window.cur.module,url:window.location.pathname,userAgent:window.navigator.userAgent,viewportWidth:window.innerWidth})},this.popFound=function(){var e=(0,u.__spreadArray)([],(0,u.__read)(t.found),!1);return t.found.clear(),e},this.watching=new Set(e),this.found=new Set},jt=n(34109),$t=Array.isArray,Vt={mail:{},helpHints:{all:{},shown:{},locked:{}}},Wt={injectStore(e){Vt.mail={};var{cur:t,rolls:n,reached:o,msgs:a,queue:i}=e.mail;$t(e.mail.msgs)&&(e.mail.msgs={}),$t(e.mail.replies)&&(e.mail.replies={}),n&&$t(n.peer)&&(n.peer={}),n&&$t(n.search.peers)&&(n.search.peers={}),n&&$t(n.search.msgs)&&(n.search.msgs={}),o&&$t(o.search.peers)&&(o.search.peers={}),o&&$t(o.search.msgs)&&(o.search.msgs={}),o&&$t(o.peer.before)&&(o.peer.before={}),o&&$t(o.peer.after)&&(o.peer.after={}),Vt.mail=e.mail,Vt.mail.pendingReplies={},Vt.mail.presend={},t&&(t.msgSelected={},t.msgRemoved={},t.msgAttached={},t.msgReply={},t.keyboards={},t.typings={},t.peerMembers={}),"notificationsCount"in Vt||(Vt.notificationsCount=e.notificationsCount),"menuNotifications"in Vt||(Vt.menuNotifications=e.menuNotifications),Array.isArray(t.drafts)?t.drafts={}:t.drafts&&((0,jt.loadDrafts)(t.viewerId),Object.keys(t.drafts).forEach((e=>{var n=t.drafts[e];(0,jt.setPeerDraft)(t.viewerId,e,n)})))},injectMail(e){var t=Vt.mail,n=e,o=isObject(t.peers)&&isObject(n.peers)&&Object.assign({},t.peers);isObject(n.msgs)&&Object.assign(t.msgs,n.msgs),isObject(n.peers)&&Object.assign(t.peers,n.peers),isObject(n.members)&&Object.assign(t.members,n.members),isObject(n.replies)&&Object.assign(t.replies,n.replies),isObject(n.forwards)&&Object.assign(t.forwards,n.forwards),t.page=n.page,n.mrs&&(t.cur.countMR=n.mrs.count,t.rolls.mrs=n.mrs.rolls,t.reached.mrs=n.mrs.reached,t.scraps.mrs=n.mrs.rolls,Object.keys(n.msgs).forEach((e=>{var o=n.msgs[e],a=o.peerId;t.rolls.peer[a]=[o.id],t.reached.peer.after[a]=!0})),t.mrs=n.mrs),o&&Object.keys(o).forEach((e=>{var a=t.peers[e],i=n.peers[e],r=o[e];a&&(a.peerProfileData=r.peerProfileData),r&&r.actionUrls&&i&&!i.actionUrls&&(a.actionUrls=r.actionUrls)}))},injectMsg(e){Wt.injectMail({msgs:{[e.id]:e}})},resetMail(){Vt.mail={}}};window.storeMethods=window.storeMethods||Wt,window.store=window.store||Vt;var Kt=function(){function e(){}return e.prototype.getHintHash=function(e){var t,n,o;return(null===(o=null===(n=null===(t=window.store)||void 0===t?void 0:t.helpHints)||void 0===n?void 0:n.all[e])||void 0===o?void 0:o.hash)||null},e.prototype.hide=function(e){e&&(window.store.helpHints.all[e].active=!1,window.ajax.post("/",{act:"help_hints_hide",hint_id:e,hash:this.getHintHash(e)},{onDone:function(e){return!0!==e&&(0,T.logError)(new Error(e),{environment:"mobile_help_hints"}),!0}}))},e.prototype.canShow=function(e){var t,n,o,a;return Boolean(null===(a=null===(o=null===(n=null===(t=window.store)||void 0===t?void 0:t.helpHints)||void 0===n?void 0:n.all)||void 0===o?void 0:o[e])||void 0===a?void 0:a.active)},e.prototype.initHelpHints=function(e){window.store.helpHints.all=e},e}(),qt=new Kt;window.helpHints=qt;n(43186);var Gt=n(64901);window.Spinner=Gt.Spinner;var zt=n(43365),Qt=(n(63846),n(58208)),Yt=(n(4726),n(95851),{_onCloseClick:function(e){e.stopPropagation(),e.preventDefault(),(0,o.remove)((0,o.geByClass1)(Yt.class.btn))},class:{btn:"FloatBtn"}});Yt.class=(0,_t.default)({},Yt.class,{open:Yt.class.btn+"_open"});var Xt=Yt,Jt={addContent:function(e,t){t&&(0,K.$$)(Zt(e)).forEach((e=>{var n=e.$(en)||e;e.classList.remove(tn),n.insertAdjacentHTML("beforeend",t)}))}};window.Pad=Jt;var Zt=e=>'.Pad[data-id="'+e+'"]',en=".Pad__content",tn="Pad_empty";var nn=(0,o.need)("scrollToEl");(0,o.need)("page").onChange(an);var on=e=>".Anchor#"+e;function an(){var e=window.nav&&window.nav.cur;if(e)try{var t=e.split("#")[1],n=t&&!~t.indexOf("=")&&(0,K.$)(on(t));n&&nn(n)}catch(e){console.error(e)}}window.Select={},Select._onChange=sn,Select._onClick=ln;var rn=e=>'.Select__option[value="'+e+'"]';function sn(e,t){var n=e.value,o=e.form,a=e.$(rn(n));d.default.handle(t,{$select:e,$option:a,$form:o,value:n,name:e.name,label:a.textContent})}function ln(e,t){d.default.handle(t,{$select:e})}var cn=n(42541);window.LoadMore={setUrl:fn,destroy:vn},LoadMore._strategy={replace:{onFail:En,onSuccess(e){var{response:t}=e;pn.outerHTML=t,vn()}},padsExtend:{onFail:En,onSuccess(e){var{response:t}=e,{pads:n,nextPageUrl:o}=t;Object.keys(n).forEach((e=>{var t=n[e];Jt.addContent(e,t)})),o?fn(o):vn()}}},LoadMore._onButtonClick=gn,onDOMReady(hn),page.onChange(hn);var dn=".LoadMore",un=".LoadMore__button",_n="_loadMore_loading",pn=null,mn=null;function fn(e){mn.setAttribute("href",e)}function vn(e){pn.remove(),pn=null,mn=null,yn()}function gn(){Cn()||kn()}function hn(){if(pn=(0,K.$)(dn)){var e=window.cur;mn=pn.$(un),wn(0),(0,o.onBodyScroll)(wn),e.destroy.push(yn)}}function wn(e){if(pn&&!Cn()){var t=(0,o.getY)(pn),n=(0,o.getCh)();t-(e+n)<2*n&&kn()}}function yn(){(0,o.onBodyScroll)("__clear",wn)}function kn(){Sn(!0);var e=mn.getAttribute("href");j.default.post(e,{_ajax:1},{onDone:e=>bn(e,!0),onFail:e=>bn(e,!1)})}function bn(e,t){if(Sn(!1),pn){var n=t?"data-success-handler":"data-fail-handler";n=pn.getAttribute(n),Wd.handle(n,{$loadMore:pn,response:e}),pn=null,mn=null,yn(),hn()}}function Sn(e){mn&&pn&&(mt.default.setLoading(mn,e),pn[_n]=e)}function Cn(){return pn&&pn[_n]}function En(e){console.error("LoadMore: failed to load more",e)}var Tn=n(5732);window.SliderTabs={},SliderTabs._onClick=Dn,onDOMReady(Nn),page.onChange(On),page.onRestore(xn);var In="SliderTabs",Mn="Slider__scroll",Pn="SliderTabs__tab_selected",Ln={active:".SliderTabs__tab_selected",tab:".SliderTabs__tab",scroll:"."+Mn,container:"."+In},Bn="",An=0;function On(){var e=(0,o.ge)(Bn),t=(0,K.$)(Ln.container);e?(0,K.$)(Ln.scroll,e).scrollLeft=An:t?Rn():(Bn="",An=0)}function xn(){setTimeout((()=>{var e=(0,o.ge)(Bn);if(e){var t=Array.from((0,K.$$)(Ln.tab,e));if(t)t.some((e=>e.getAttribute("href")===nav.cur))&&t.forEach((e=>{e.getAttribute("href")===nav.cur?e.classList.add(Pn):e.classList.remove(Pn)}))}}))}function Rn(){var e=(0,K.$$)(null==Ln?void 0:Ln.container),t=Math.min((0,o.getCw)(),882);e.forEach((e=>{var n=(0,K.$)(Ln.scroll,e),a=(0,K.$)(Ln.active,e);if(a){var i=a.offsetWidth,r=(0,o.getX)(a);r+i>t&&(n.scrollLeft=r-t+i,console.log("$scroll.scrollLeft scrollAllToActiveTab",n.scrollLeft))}}))}function Nn(){Rn()}function Dn(e,t){var n=(0,o.gpeByClass)(In,t),a=(0,o.gpeByClass)(Mn,t),i=(0,K.$)(Ln.active,n);return i&&i.classList.remove(Pn),t.classList.add(Pn),An=a.scrollLeft,Bn=(0,o.attr)(n,"id"),!0}window.SearchPanel={setQuery:function(e,t){var n=(0,K.$)(jn(e));t=t||"",n.value!==t&&(n.value=t,Kn(n,t))}},SearchPanel._onInput=Vn,SearchPanel._onClearClick=Wn,SearchPanel._onFocus=$n;var Fn="SearchPanel_hasQuery",Un=".SearchPanel",Hn=".SearchPanel__input",jn=e=>'.SearchPanel[data-id="'+e+'"] .SearchPanel__input';function $n(){}function Vn(e,t){var n=e.value;Kn(e,n),d.default.handle(t,{query:n})}function Wn(e,t){var n=e.closest(Un).$(Hn);n.value="",n.oninput(),d.default.handle(t)}function Kn(e,t){e.closest(Un).classList.toggle(Fn,!!t)}window.TabRow={setSelectedTab:function(e,t){var n=(0,K.$)(Gn(e)),o=(0,K.$)(Qn,n),a=(0,K.$)(zn(t),n);o&&o.classList.remove(qn),a&&a.classList.add(qn)},setTabUrl:function(e,t,n){var o=(0,K.$)(Gn(e)),a=(0,K.$)(zn(t),o);a&&a.setAttribute("href",n)}};var qn="TabRow__tab_selected",Gn=e=>'.TabRow[data-id="'+e+'"]',zn=e=>'.TabRow__tab[data-id="'+e+'"]',Qn=".TabRow__tab_selected";window.SwitcherConfirm={},SwitcherConfirm._onSwitcherChange=to,SwitcherConfirm._onConfirmClick=no,SwitcherConfirm._onCancelClick=e=>{var{$btn:t}=e;return oo(t)},SwitcherConfirm._onPopupOverlayClick=e=>{var{$popup:t}=e;return oo(t)};var Yn=e=>"SwitcherConfirm_checked_"+(e?"yes":"no"),Xn=".SwitcherConfirm",Jn=".SwitcherConfirm__popup",Zn=".SwitcherConfirm__confirm",eo=".SwitcherConfirm__cancel";function to(e){var t=e.$control,n=t.closest(Xn),o=(0,K.$)(Jn,n);ut.default.open(o),n.$popup=o,n.$control=t,n.checked=e.checked}function no(e,t){var n=t.$btn.closest(Xn),o=(0,K.$)(Zn,n),a=(0,K.$)(eo,n),i=n.checked;n.isSaving=!0,mt.default.setLoading(o,!0),mt.default.setDisabled(a,!0),Wd.handle(e,{checked:i,onSuccess(){n.isSaving=!1,ut.default.close(n.$popup),mt.default.setLoading(o,!1),mt.default.setDisabled(a,!1),n.classList.toggle(Yn(!0),i),n.classList.toggle(Yn(!1),!i)}})}function oo(e){var t=e.closest(Xn);t.isSaving||(cn.default.setChecked(t.$control,!t.checked),ut.default.close(t.$popup))}var ao=n(25809);n(50617),n(98102);var io=n(59336),ro=n(26330),so=function(){function e(){this._element=null,this._previousActiveElement=null}return e.prototype.findElement=function(){var e=document.getElementsByClassName("UnsupportedBrowser");return e.length?(this._element=e[0],this._element):null},Object.defineProperty(e.prototype,"element",{get:function(){return this._element?this._element:this.findElement()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDetected",{get:function(){return[!(0,X.isSVGSupported)(),!(0,X.isSupportsSupported)(),!(0,X.isCSSVariablesSupported)(),!(0,X.isGridsSupported)(),!(0,X.isFlexboxSupported)(),!(0,X.isMatchMediaSupported)(),!(0,X.isIntersectionObserverSupported)(),!(0,X.isMutationObserverSupported)()].some((function(e){return e}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"daysHidden",{get:function(){var e=(ro.default.get("unsupportedBrowser")||{}).hiddenSince;return e?Math.round((Date.now()-e)/1e3/60/60/24):-1},enumerable:!1,configurable:!0}),e.prototype.readyToBeShown=function(e){return void 0===e&&(e=0),!e||this.daysHidden<0||this.daysHidden>=e},e.prototype.show=function(){this.element&&(this._previousActiveElement=document.activeElement,this.element.classList.add("UnsupportedBrowser--active"),this.element.focus(),(0,N.statlogsValueEvent)("mvk_unsupported_browser_alert","shown"))},e.prototype.hide=function(){var e,t,n;null===(t=null===(e=this.element)||void 0===e?void 0:e.classList)||void 0===t||t.remove("UnsupportedBrowser--active"),null===(n=this._previousActiveElement)||void 0===n||n.focus(),ro.default.set("unsupportedBrowser",{hiddenSince:Date.now()}),(0,N.statlogsValueEvent)("mvk_unsupported_browser_alert","hidden")},e.prototype.update=function(){(0,N.statlogsValueEvent)("mvk_unsupported_browser_alert","update_link_clicked")},e}();window.UnsupportedBrowser=new so;var lo=n(40906);class co{static findButtonInEvent(e){return e.target.closest(".Btn")}static onChange(e,t){if(void 0===t&&(t=""),"file"===t){var n=e.target.files;if(n&&n[0]){var a=(0,lo.htsc)(n[0].name),i=co.findButtonInEvent(e),r=(0,K.$)(".MobileInput__text",i);(0,o.val)(r,a)}}}}var uo=co;window.MobileInput=uo;var _o=n(38492),po=n(47666);n(39307),n(31332);var mo=n(9223),fo=(n(93284),(0,o.need)("Btn"));window.PrivacyPolicy={},PrivacyPolicy._onAcceptToggle=go;var vo=".PrivacyPolicy__submit";function go(e){var{checked:t}=e,n=(0,K.$)(vo);fo.setDisabled(n,!t)}n(69663);var ho=n(15247);onDOMReady((()=>{window.page.onChange((()=>{(0,K.$$)(".ConfirmPopup").forEach((e=>ut.default.close(e)))}))})),window.ConfirmPopup={onOverlayClick:function(e,t){var n=e.closest(".Popup");n&&"false"!==n.dataset.useNavigation&&(0,K.$)('[data-key="no"]',n).click()},onButtonClick:function(e,t){t.preventDefault(),t.stopPropagation();var n=e.closest(".Popup");if(n){var a=(0,ho.parseURL)(e.href),i=a.pathname+a.search,r=(0,ho.parseURL)(nav.prev_cur),s=r.pathname+r.search,l="false"!==n.dataset.useNavigation;if(!l||"no"===(0,o.domData)(e,"key")&&i===s&&"1"!==(0,o.domData)(e,"force"))return l&&history.back(),ut.default.close(n);e.href?nav.go(i):ut.default.close(n)}}};var wo=class{static hideDisclaimerAndPlay(){var e=(0,K.$)(".vv_inline_video");(0,K.$)(".VideoRestriction__boxWrap").remove(),(0,K.$)(".VideoRestriction__thumb").remove(),(0,K.$)(".VideoRestriction").replaceWith((0,K.$)(".VideoRestriction").firstChild),(0,K.$)(".VideoPage__video--short")?((0,o.show)((0,K.$)(".ShortVideo")),(0,K.$)(".ShortVideo__overlay").click()):(e.setAttribute("controls","controls"),e.play());var t=(0,K.$)(".VideoPage__video").parentNode.id||"video";window.ajax.post("/"+t+"?act=agree_disclaimer",{},{onDone(e){}})}};window.VideoRestriction=wo;n(65081);var yo=function(e){var t=e.bcg,n=t.type;return{class:l.default.class("VotingBcg",{type:n},"_"),style:"photo"===n?ko(t):"gradient"===n?bo(t):"tile"===n?So(t):null,inner:"photo"===n?Co(e):null}};function ko(e){return Eo({"background-color":e.color})}function bo(e){var t,n=[],o=e.points.length;for(t=0;t<o;t++){var a=e.points[t];n.push(a.color+" "+a.percent+"%")}return Eo({background:"linear-gradient("+(e.angle-90)+"deg, "+(n=n.join(", "))+")"})}function So(e){return Eo({"background-image":"url('"+e.image+"')","background-position":"top center","background-size":e.width+"px "+e.height+"px"})}function Co(e){var t=e.bcg,n=t.photo,o=t.color;return{class:"VotingBcg__photoBox",style:Eo({height:e.photoHeight+"px"}),inner:[{class:"VotingBcg__photoImage",style:Eo({"background-image":"url('"+n+"')"})},{class:"VotingBcg__photoGradient",style:Eo({background:"linear-gradient(to bottom, rgba(255, 255, 255, 0), "+o+")"})}]}}function Eo(e){var t,n=[],o=Object.keys(e),a=o.length;for(t=0;t<a;t++){var i=o[t],r=e[i];n.push(i+": "+r+";")}return n.join(" ")}var To=yo;window.VotingBcg=yo;var Io=function(e,t){return{tag:"label",class:l.default.class("VotingForm__bcg",{light:"default"===t.type},"_"),inner:[{class:"VotingForm__bcgPreview",inner:[To({bcg:t,photoHeight:48}),{class:l.default.class("VotingForm__bcgTextGhost",{0:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{1:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{2:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{3:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{4:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{5:!0},"_")}]},{tag:"input",class:"VotingForm__bcgRadio",type:"radio",name:e,checked:t.checked?"checked":null,value:t.id},{class:"VotingForm__bcgControl"}]}};var Mo=function(e){return{class:"VotingForm__option","data-created":e.is_created?"1":"0",inner:[(0,kt.default)({class:"VotingForm__optionInput",name:e.name,value:e.value,on_key_down:"VotingForm._onOptionKeyDown"}),{class:"VotingForm__optionRemove",onclick:["VotingForm._onOptionRemoveClick","this"],inner:(0,zt.default)({icon:"close16"})}]}};var Po=(0,o.need)("Slider");window.VotingForm={},VotingForm._onInit=Wo,VotingForm._onAddOptionClick=Vo,VotingForm._onExpireChange=qo,VotingForm._onOptionRemoveClick=Go,VotingForm._onTitleKeyDown=Ho,VotingForm._onTitleInput=jo,VotingForm._onOptionKeyDown=$o,mediaUpload.onComplete(Yo),mediaUpload.onStart(Xo),mediaUpload.onError(Jo);var Lo="VotingForm_uploading",Bo="VotingForm_withExpire",Ao="VotingForm_maxOptions",Oo=".VotingForm",xo=".VotingForm_maxOptions",Ro=".VotingForm__option",No=".VotingForm__options",Do=".VotingForm__upload",Fo=".VotingForm__bcg",Uo=".VotingForm__bcgRadio:checked";function Ho(e){13===e.keyCode&&e.preventDefault()}function jo(e){var t=+(0,o.attr)(e,"maxlength"),n=(0,K.$)(".VotingForm__count");t-e.value.length<=20?n.innerHTML=e.value.length+"/"+t:n.innerHTML=""}function $o(e){if(Ho(e),13===e.keyCode){if(!(0,K.$)(xo))if((0,K.$)(".VotingForm__option:last-child input")===document.activeElement)return Ko(),void(0,K.$)(".VotingForm__option:last-child input").focus();if(document.activeElement){var t=document.activeElement.closest(".VotingForm__option"),n=t.nextElementSibling&&t.nextElementSibling.$("input");n&&(n.focus(),n.selectionStart=n.value.length,n.selectionEnd=n.value.length)}}else if(8===e.keyCode){if(1===(0,K.$$)(".VotingForm__option").length)return;var o=e.target;o.value||setTimeout((()=>{var e=o.closest(".VotingForm__option"),t=e.previousElementSibling;if(e.outerHTML="",Qo(),t){var n=t.$("input");n.focus(),n.selectionStart=n.value.length,n.selectionEnd=n.value.length}}))}}function Vo(){Ko(),(0,K.$)(".VotingForm__option:last-child input").focus()}function Wo(){var e=(0,K.$)(Uo).closest(Fo);Po.scrollToElem(e)}function Ko(){var e=(0,K.$)(No),t=Mo({});e.insertAdjacentHTML("beforeend",Wd.html(t)),zo(),Qo()}function qo(e){var{$control:t,checked:n}=e;t.closest(Oo).classList.toggle(Bo,n)}function Go(e){e.closest(Ro).outerHTML="",zo(),Qo()}function zo(){Array.from((0,K.$$)('.VotingForm__option[data-created="0"] input')).forEach(((e,t)=>{e.setAttribute("name","answers["+t+"]")}))}function Qo(){var e=(0,K.$)(Oo),t=Number(e.getAttribute("data-max-options")),n=(0,K.$$)(Ro).length;e.classList.toggle(Ao,n===t)}function Yo(e){if((0,K.$)(Oo)){var t=(0,K.$)(Do),n=Wd.html(Io("poll_background_id",{id:"photo_"+e.photo_id,type:"photo",photo:e.src,color:e.color,checked:!0}));t.insertAdjacentHTML("beforebegin",n),Zo()}}function Xo(e){var t=(0,K.$)(Do);t&&t.classList.add(Lo)}function Jo(e){var t=(0,K.$)(Oo);if(t){var n=t.getAttribute("data-upload-error-msg");Zo(),alert(n)}}function Zo(){var e=(0,K.$)(Oo);(0,K.$)(Do).outerHTML=e.getAttribute("data-upload-html")}window.VotingStatsFilters={},VotingStatsFilters._onCountryChange=na;var ea=".VotingStatsFilters__section_country",ta=".VotingStatsFilters__section_city";function na(e){var t=e.$option,n=(0,K.$)(ea),o=(0,K.$)(ta),a=t.getAttribute("data-city-section-html");o&&(o.outerHTML=""),a&&n.insertAdjacentHTML("afterend",a)}var oa=window.Popup,aa=window.Btn;window.AuthCheck={},AuthCheck._onDropConfirmationClick=ca,AuthCheck._onResetSessionSubmit=da,AuthCheck._onCurBrowserDropClick=ua;var ia=e=>".AuthCheck__popup_index_"+e,ra=e=>'.AuthCheck__dropConfirmation[data-index="'+e+'"]',sa=".AuthCheck__dropConfirmationSubmit",la="AuthCheck__dropConfirmation_success";function ca(e){var t=(0,K.$)(ia(e));oa.open(t)}function da(e,t){e.preventDefault();var n=e.target,a=(0,K.$)('iframe[name="'+e.target.target+'"]'),i=n.$(sa);n.submit(),aa.setLoading(i,!0),(0,o.addEvent)(a,"load",(()=>{(0,K.$)(ra(t)).classList.toggle(la),oa.close(),aa.setLoading(i,!1)}))}function ua(e){var t=e.$btn;aa.setLoading(t,!0),window.ajax.click(t,{onDone(){(0,K.$)(ra("0")).classList.toggle(la),oa.close(),aa.setLoading(t,!1)}})}var _a=".AppPasswordsPopup";window.AppPasswords=new class{constructor(){this.showPopup=()=>Popup.open((0,K.$)(_a)),this.hidePopup=()=>Popup.close((0,K.$)(_a))}},window.AuthCheckIntro={},AuthCheckIntro._onMount=ma;var pa=".AuthCheckIntro";function ma(){var e=(0,K.$)(pa),t=new Scroller(e,{byPage:!0,ignoreMouseWheel:!0,noAutoScroll:!0});t.init(),cur.destroy.push((()=>t.destroy()))}window.ReservedCodes={},ReservedCodes._onShowRestCodesClick=ga;var fa=".ReservedCodes",va="ReservedCodes_restCodesShown";function ga(){(0,K.$)(fa).classList.toggle(va)}var ha=n(53593);window.LoginHistory={_onSubmit:function(e,t,n){var o=geByClass1("LoginHistory__iframe");preventEvent(e),t.submit(),addEvent(o,"load",(()=>nav.go(n,null,{isForm:!0})))},showResetSessionModal:function(e,t,n){var o=(0,mo.default)({close:!0,items:[(0,ha.ModalMenuBtn)({class:"ai_add",inner:(0,yt.getLang)("mobile_settings_activity_session_reset_title"),onclick:"LoginHistory.resetSession('"+e+"', '"+t+"', '"+n+"');Popup.close(this);"})]});return mo.default.open(d.default.elem(o),!0),!1},resetSession:function(e,t,n){window.ajax.post(e,{reset_data:t,hash:n})}},window.SettingsMenu={onClick:function(e,t){return void 0===t&&(t=!1),(0,o.statlogsValueEvent)("settings_menu_click",e),t?Z.default.hard_go(e):Z.default.go(e),!1}};n(72107),n(94898);n(11984),n(51273);window.Subscriptions={editSubscription:function(e,t){if(t.context_actions){var n=Wd.html(t.context_actions.map((e=>(0,te.ContextMenuItem)({title:e.title,href:e.href})))),o=Wd.elem((0,te.ContextMenu)({list:n}));o.parentNode.id="container",te.ContextMenu.open(o,"#container",{appendToBody:!0})}}};var wa,ya;class ka{constructor(e){var{selector:t,className:n}=e;this.element=(0,K.$)(t),this.className=n}show(){this.element.classList.add(this.className)}hide(){this.element.classList.remove(this.className)}}class ba extends ka{constructor(){super({selector:".Appearance__fixedSchemes",className:"Appearance__fixedSchemes--active"})}}class Sa extends ka{constructor(){super({selector:".Appearance__autoSwitcher",className:"Appearance__autoSwitcher--active"})}}function Ca(e){var{mode:t}=e;i.ColorScheme.isSchemesAutoSwitchingSupported()?ya.show():wa.show(),t===i.ColorSchemeMode.Auto&&i.ColorScheme.isSchemesAutoSwitchingSupported()?wa.hide():wa.show();var n=(0,K.$)("[name='mode'][value='"+t+"']");n&&(n.checked=!0)}function Ea(e,t){var n={mode:t,_ajax:1};j.default.post(e,n),i.colorScheme.setMode(t),Ca({mode:t})}window.Appearance={init:function(){if(i.ColorScheme.isSchemesSupported()){wa=new ba,ya=new Sa;var e=i.colorScheme.getMode();i.ColorScheme.isSchemesAutoSwitchingSupported()||e!==i.ColorSchemeMode.Auto||(e=i.ColorSchemeMode.Light),Ca({mode:e})}},switchOnChange(e,t){var{checked:n}=t,o=i.colorScheme.isDarkScheme()?i.ColorSchemeMode.Dark:i.ColorSchemeMode.Light;Ea(e,n?i.ColorSchemeMode.Auto:o)},radioOnChange(e,t){var{value:n}=t;Ea(e,n)}};n(34381),n(34044);var Ta=function(e){void 0===e&&(e={});var t=(0,yt.classNames)("LiteSettings",{"LiteSettings--popup":e.isPopup});return{inner:[(0,cn.default)({class:"LiteMode__activeSwitcherInput",type:"switcher",label:(0,yt.getLang)("mobile_settings_lite_enable_switcher_title"),name:"lite_mode_active",value:"active",description:(0,yt.getLang)("mobile_settings_lite_enable_switcher_description"),onChange:e.isPopup?null:["LiteSettings.switchLiteMode"],checked:e.isActive}),(0,cn.default)({class:"LiteMode__reminderSwitcherInput",type:"switcher",label:(0,yt.getLang)("mobile_settings_lite_auto_switcher_title"),name:"lite_mode_reminder_disabled",value:"reminder",description:(0,yt.getLang)("mobile_settings_lite_auto_switcher_description"),onChange:e.isPopup?null:["LiteSettings.switchLiteMode"],checked:e.isReminderDisabled})],class:t,tag:"div"}};function Ia(e){var t={};return"lite_mode_active"===e.name&&(t.lite_mode_active=Number(!!e.checked)),"lite_mode_reminder_disabled"===e.name&&(t.lite_mode_reminder_disabled=Number(!e.checked)),t}function Ma(){W.init({duration:3e3,text:(0,yt.getLang)("mobile_msg_settings_general_saved")})}window.LiteSettings={switchLiteMode:function(e,t,n){t&&t.preventDefault();var o={_ajax:1,hash:window.vk.liteMode.hash};n?((0,K.$$)('[name="lite_mode_active"], [name="lite_mode_reminder_disabled"]').forEach((e=>{o=Object.assign(o,Ia(e))})),mt.default.setLoading(e,!0)):o=Object.assign(o,Ia(e)),j.default.post("/settings?act=save_lite",o,{onDone:t=>{n&&mt.default.setLoading(e,!1);var{liteMode:o,reminderDisabled:a}=t;window.vk.liteMode.enabled=o,window.vk.liteMode.reminderDisabled=a,document.body.classList.toggle("_ioff",o),o||((0,K.$$)(".Avatar").forEach((e=>{e.classList.add("Avatar--loaded")})),(0,K.$$)(".BlurredImage").forEach((e=>{e.classList.add("BlurredImage--loaded")}))),n?mo.default.close(e.closest(".ModalMenu"),{onClose:()=>{Ma()}}):Ma()},onFail:()=>{n&&mt.default.setLoading(e,!1)}})},showLiteModePopup:function(e){e.preventDefault();var t=Ta({isActive:window.vk.liteMode.enabled,isReminderDisabled:!window.vk.liteMode.reminderDisabled,isPopup:!0}),n=[(0,mo.ModalMenuHeaderCloseButton)(),(0,mo.ModalMenuTitle)({inner:[d.default.wrap((0,yt.getLang)("mobile_settings_lite_title"))]}),(0,io.default)(),(0,mo.ModalMenuBody)({inner:[t]}),(0,mo.ModalMenuBtn)({inner:[(0,yt.getLang)("global_save")],url:"/settings?act=lite",theme:"regular",size:"large",isBtn:!0,onclick:["LiteSettings.switchLiteMode","this","event",!0]})],o=(0,mo.default)({class:"LiteSettingsModal",body:n}),a=d.default.elem(o);ut.default.open(a,!0)}};n(88706),n(38869);window.LovinaPromotion={click:function(e,t){var n=t?e?"https://trk.mail.ru/c/e3goc2":"https://trk.mail.ru/c/levhn2":"https://trk.mail.ru/c/i01uk8";(0,o.statlogsValueEvent)("lovina_promotion",t?1:0),window.nav.hard_go(n)}};var Pa=n(71516);window.OwnerButton={click:function(e){e&&(0,Pa.saveStatlogEvents)({name:"owner_button_app_click",value:e});return!0}};var La=n(51888),Ba=n(4992),Aa=n(85703);function Oa(e){void 0===e&&(e={});var t=window.lang,n=e.icon,o=e.actions||[],a=o.length||e.needCloseButton;e.inner&&1===e.inner.length&&null===e.inner[0]&&(e.inner=null);var i=o.map((e=>(0,mt.default)({inner:[e.text],theme:e.theme,url:e.url,onClick:e.onClick,use_native_onclick:!0})));e.needCloseButton&&i.push((0,mt.default)({inner:[t.mobile_close],stretch:!0,onClick:"ModalMenu.close(this)",use_native_onclick:!0,theme:"secondary"}));var r={inner:[e.needCloseIcon?(0,mo.ModalMenuHeaderCloseButton)({onClose:e.onClose}):null,n?{inner:[n],class:"ModalCard__icon",tag:"div"}:null,{inner:[e.title],class:"ModalCard__title",tag:"h2"},e.subhead?{inner:[e.subhead],class:"ModalCard__subhead",tag:"div"}:null,e.inner?{inner:[e.inner],class:"ModalCard__content",tag:"div"}:null,a?(0,Aa.BtnStack)({btns:i,mode:e.actionsLayout||"horizontal",stretch:!0}):null],class:"ModalCard__in",tag:"div"};return(0,mo.default)({on_overlay_click:e.on_overlay_click,class:"ModalCard",body:r})}var xa=n(32609),Ra=n(64260),Na=n(83462),Da=function(){function e(){var e=this;this.aboutServiceModal=null,this.onShareToOwnClick=function(e,t){(0,xa.logQuestionsClickEvent)(Ra.QuestionAnalyticEventType.shareToWall,{questionReceiverId:window.vk.id}),window.cur.share.go(t),(0,Ba.closeShowQuestionsBox)()},this.onShareToGroupClick=function(){(0,xa.logQuestionsClickEvent)(Ra.QuestionAnalyticEventType.shareToGroup,{questionReceiverId:window.vk.id}),(0,Ba.closeShowQuestionsBox)()},this.openAboutServiceModal=function(t){t.stopPropagation(),t.preventDefault(),window.Stories.pauseStory(),e.aboutServiceModal=window.ModalMenu.open(d.default.elem(Oa({title:(0,yt.getLang)("mobile_profile_questions_about_title"),icon:(0,f.Icon56QuestionOutline)(),needCloseIcon:!0,subhead:(0,yt.getLang)("mobile_profile_questions_about_description"),on_overlay_click:"window.Questions.closeAboutServiceModal",onClose:"window.Questions.closeAboutServiceModal",actions:[{text:(0,yt.getLang)("mobile_profile_questions_about_try"),onClick:"window.Questions.onTryServiceButtonClick"}]})),!0)},this.onTryServiceButtonClick=function(){e.closeAboutServiceModal(),window.Stories.opened&&window.Stories.close(),window.nav.go("/question")},this.closeAboutServiceModal=function(){e.aboutServiceModal&&(window.Stories.playStory(),window.ModalMenu.close(e.aboutServiceModal),e.aboutServiceModal=null)}}return e.prototype.ask=function(e,t){void 0===t&&(t={});var n=t.ref;n?(0,xa.logQuestionsOpeningEvent)(e,n,Ra.QuestionAnalyticBoxName.askQuestion):(0,xa.logQuestionsClickEvent)(Ra.QuestionAnalyticEventType.clickToQuestion,{questionReceiverId:e,questionAuthorId:window.vk.id}),(0,ft.fetchAddQuestion)().then((function(t){return t.init().then((function(n){(0,La.getUsers)([e]).then((function(e){var o=e[0];if(!o||o.deactivated||!o.can_ask_question){var a=(0,yt.getLang)("mobile_questions_unknown_user_error");throw W.init({text:a,type:W.SNACKBAR_TYPE_ERROR}),new Error(a)}setTimeout((function(){t.isMounted&&n.setRespondent(o)}),300)})).catch((function(e){n.close(),console.error(e)}))}))})).catch(console.error)},e.prototype.show=function(e,t){void 0===t&&(t={});var n=t.ref;n?(0,xa.logQuestionsOpeningEvent)(e,n,Ra.QuestionAnalyticBoxName.myQuestions):(0,xa.logQuestionsClickEvent)(Ra.QuestionAnalyticEventType.clickToQuestion,{questionReceiverId:e}),(0,ft.fetchShowQuestionsBox)().then((function(n){n.open(),setTimeout((function(){(0,Ba.setShowQuestionsBoxOwnerId)(e),(0,Ba.setShowQuestionsBoxParams)(t)}),300),window.ajax.post("question",{act:"get_show_questions_additional_props"},{onDone:function(e){(0,Ba.setShowQuestionsBoxAdditionalParams)(e)}})})).catch(console.error)},e.prototype.answer=function(e,t,n){(0,xa.logQuestionsClickEvent)(e.processed?Ra.QuestionAnalyticEventType.replyAgain:Ra.QuestionAnalyticEventType.reply,{questionId:e.id,questionReceiverId:window.vk.id});var o=(0,yt.getLang)("mobile_questions_unknown_answer_error");(0,ft.fetchAddQuestionAnswerBox)().then((function(a){if(!e||!t||!n)throw new Error(o);a.open(),setTimeout((function(){(0,Na.setQuestion)(e),(0,Na.setOwner)(t),(0,Na.setAuthor)(n)}),300)})).catch((function(e){W.init({text:(null==e?void 0:e.message)||e||o,type:W.SNACKBAR_TYPE_ERROR}),console.error(e)}))},e.prototype.shareToStory=function(){var e;(0,xa.logQuestionsClickEvent)(Ra.QuestionAnalyticEventType.shareToStory,{questionReceiverId:window.vk.id}),(0,Ba.openAskRequestStoryPublisher)(),(null===(e=window.cur)||void 0===e?void 0:e.share)&&window.cur.share.destroy({isFail:!1,closeModal:!0})},e.prototype.onShareToImClick=function(){(0,xa.logQuestionsClickEvent)(Ra.QuestionAnalyticEventType.shareToIm,{questionReceiverId:window.vk.id})},e.prototype.copyAskUrl=function(){var e;(0,Ba.copyAskRequestLink)(),(null===(e=window.cur)||void 0===e?void 0:e.share)&&window.cur.share.destroy({isFail:!1,closeModal:!0})},e}();window.Questions=new Da;var Fa=n(73283),Ua=n(31931),Ha=function(e){var t="width: "+e.artboardWidth+"px; height: "+e.artboardHeight+"px",n=e.background_type===Fa.StoryPublisherBackgroundType.IMAGE?{class:"StoryPublisher__canvasLayer",width:"1080",height:"1920",style:t,tag:"canvas"}:{inner:[{src:e.src,tag:"source"}],class:"StoryPublisher__video",preload:"metadata",controls:!0,controlsList:"nodownload",onContextMenu:"cancelEvent(); return false;",tag:"video"},o=d.default.wrap((0,yt.getLang)("mobile_apps_story_publisher_description").replace("{service_name}",e.miniAppName));return{inner:[{inner:[(0,mt.default)({inner:[e.is_close_back_icon?(0,f.Icon28ChevronLeftOutline)():(0,f.Icon28CancelOutline)()],theme:"header",class:"StoryPublisher__headerButton",onClick:"StoryPublisher.closePopup()",use_native_onclick:!0,is_icon:!0})],class:"StoryPublisher__header",tag:"div"},{inner:[(0,Ua.default)({mix:"al_loading StoryPublisher__spinner",type:"pageLoader",isFixed:!0}),{inner:[n],class:"StoryPublisher__canvas",style:t,tag:"div"},e.miniAppId?{inner:[o],class:"StoryPublisher__description",tag:"div"}:null,(0,mt.default)({inner:[d.default.wrap((0,yt.getLang)("mobile_apps_story_publisher_publish_btn_text"))],onClick:"StoryPublisher.save(this)",use_native_onclick:!0})],class:"StoryPublisher__content",tag:"div"}],class:"Popup StoryPublisher",tag:"div"}};var ja=n(61540),$a=n(85701),Va=n(41319);Object.assign(Ha,{init:function(e,t,n){var o=this;void 0===t&&(t=ja.noop),void 0===n&&(n=ja.noop),this.successHandler=this.successHandler.bind(this),this.errorHandler=this.errorHandler.bind(this),e.artboardHeight=e.artboardHeight||(window.innerHeight<357?window.innerHeight-100:357),e.artboardWidth=e.artboardWidth||e.artboardHeight/1.78,this.props=e,this.props.src=e.src||e.url||e.blob,this.onClickSave=t,this.cb=n,this.popup=ut.default.open(d.default.elem(Ha(this.props)),!0);var a=function(){return(0,Ua.hide)(document.querySelector(".StoryPublisher__spinner"))};switch(this.props.background_type){case Fa.StoryPublisherBackgroundType.IMAGE:(0,ja.loadImage)(this.props.src).then((function(e){a(),o.drawImage(e)})).catch((function(){return o.errorHandler(new Error("Can't upload image"))}));break;case Fa.StoryPublisherBackgroundType.VIDEO:this.validateVideo(this.props).then(a).catch(this.errorHandler)}return this},drawImage:function(e){if(this.canvas=document.querySelector(".StoryPublisher__canvasLayer"),!this.canvas)return this.errorHandler();var t=this.canvas.getContext("2d");if(!t)return this.errorHandler();var n,o,a=+(e.height/e.width).toFixed(2);if(a>1.77?(o=this.canvas.height,n=this.canvas.height/a):(n=this.canvas.width,o=this.canvas.width*a),t.save(),t.clearRect(0,0,this.canvas.width,this.canvas.height),t.filter="blur(135px)",t.drawImage(e,0,0,this.canvas.width,this.canvas.height),t.restore(),"none"!==t.filter){var i=(0,ja.getAverageRGB)(t);t.fillStyle="rgb("+i.r+", "+i.g+", "+i.b+")",t.fillRect(0,0,this.canvas.width,this.canvas.height)}t.drawImage(e,this.canvas.width/2-n/2,this.canvas.height/2-o/2,n,o)},closePopup:function(e){void 0===e&&(e=!0),e&&this.cb(!1),ut.default.close(this.popup),this.popup=null},successHandler:function(e){this.cb(!0,e),this.isLoading=!1,this.closePopup(!1)},errorHandler:function(e){void 0===e&&(e={}),this.props.closeAfterError&&this.closePopup(!1),this.cb(!1,{error:e}),this.isLoading=!1,mt.default.setLoading(this.shareButton,!1),W.init({type:W.SNACKBAR_TYPE_ERROR,text:e.message||(0,yt.getLang)("mobile_apps_story_publisher_unexpected_error")})},save:function(e){var t=this;if(!this.isLoading){this.onClickSave(),mt.default.setLoading(e,!0),this.shareButton=e,this.isLoading=!0;var n=this.props,o=n.background_type,a=n.miniAppId,i=n.entrypoint,r=n.storyUploadUrlHash,s=n.storySaveHash,l=n.attachment,c=n.clickableStickers,d=n.questionId;this.getBlob().then((function(e){return(0,$a.getStoryUploadUrl)({mini_app_id:a,question_id:d,story_type:o===Fa.StoryPublisherBackgroundType.IMAGE?Va.StoryType.PHOTO:Va.StoryType.VIDEO,hash:r,entry_point:i,ref:window.cur.module,file_size:e.size,clickable_stickers:c?JSON.stringify(c):void 0,attachment:l?JSON.stringify(l):void 0}).then((function(n){return t.uploadStoryBlobToServer(e,n)})).then((function(e){var t=e.response;return(0,$a.saveStoryOnServer)(t&&t.upload_result,s)})).then(t.successHandler).catch(t.errorHandler)})).catch(this.errorHandler)}},uploadStoryBlobToServer:function(e,t){return new Promise((function(n,a){var i=(0,ja.getBlobType)(e),r=9e5*Math.random(),s=new FormData,l=encodeURIComponent("story_"+r+"."+i);s.append("file0",e,l);var c=(0,o.uploadFile)(t,s,{onComplete:function(){var e=(0,o.parseJSON)(c.response);e&&e.response&&e.response.upload_result||a(),n(e)},onError:a})}))},getBlob:function(){var e=this;return this.props.background_type===Fa.StoryPublisherBackgroundType.IMAGE?new Promise((function(t,n){try{e.canvas.toBlob(t,"image/jpeg")}catch(e){n()}})):(0,ja.getMediaBlob)(this.props.src)},validateVideo:function(e){return new Promise((function(t,n){(0,ja.getVideoDuration)(e.src).then((function(o){if(e.maxVideoDuration&&o>e.maxVideoDuration)return n(new Error("The duration of the video file must not exceed 15 seconds"));t(o)})).catch((function(){return n(new Error("Can't upload video"))}))}))}}),window.StoryPublisher=Ha;var Wa=function(){this.onNarrativeChangedFromStoryView=(0,c.default)(),this.onNarrativeRemovedFromStoryView=(0,c.default)()};window.Narratives=new Wa;var Ka={rollback:{onDone(e){var{html:t,post:n,hash:a}=e;cur.restored=0;var i=(0,o.ge)(n+"__message-archived");if(t){var r=n+"__message-rollback",s=(0,o.ce)("div",{className:["post_message_item",i.className].join(" "),innerHTML:t,id:r});(0,o.hide)(i),(0,o.ge)(s)||(0,o.after)(s,i)}else{var l=(0,o.ge)(n+"__message-rollback");(0,o.show)(i),(0,o.remove)(l)}}},set:{onDone(e){var{html:t,post:n,restored:a,rollback_hash:i}=e;cur.restored||(cur.restored=0),a&&"profile"===cur.module&&cur.restored++;var r=(0,o.ge)(n),s=(0,o.ge)(n+"_replies");if(t){if(cur.restored>3){var l=r.id+"?act=rollback_archive&hash="+i;t+=Wd.html({class:"service_msg_row",inner:{tag:"a",href:l,onclick:"return ajax.click(this, Archive.rollback)",inner:(0,yt.getLang)("mobile_archive_restore_bulk")}})}var c=r.id+"__message-archived",d=(0,o.ce)("div",{className:["post_message_item",r.className].join(" "),innerHTML:t,id:c});(0,o.hide)(r),(0,o.hide)(s),(0,o.ge)(c)||(0,o.after)(d,r)}else if(n){var u=(0,o.ge)(n+"__message-archived"),_=(0,o.ge)(n+"_replies");(0,o.show)(n),(0,o.show)(_),(0,o.remove)(u)}}}};window.Archive=Ka;var qa=n(40983);var Ga=function(e,t){(0,o.cancelEvent)(e);var n=t.getAttribute("href"),a=(0,yt.getLang)("mobile_wall_prometheus_edit_warn");(0,qa.Confirm)(a,'Popup.close(this); nav.go("'+n+'");',"",{title:(0,yt.getLang)("mobile_prometheus_edit_warn_popup_title")})};function za(){var{lang:e}=window,t=(0,K.$)(".pcont .service_msg_box");if(t){var n=(0,K.$)(".service_msg",t).innerHTML;(0,o.remove)(t);var a=(0,pt.default)({class:"CopyrightPopup",content:[{inner:d.default.wrap(n)},{class:"Popup__buttons",inner:[(0,mt.default)({class:"Popup__button",inner:e.mobile_zphoto_close,theme:"regular",on_click:"Popup.close(this)",use_native_onclick:!0})]}]});pt.default.open(d.default.elem(a),!0)}}window.PrometheusEditConfirm=Ga,window.CopyrightPopup={open:function(e,t,n,o){var a=(0,pt.default)({class:"CopyrightPopup",header:{title:(0,yt.getLang)("mobile_wall_post_copyright_source")},content:{inner:[t,{class:"Popup__buttons",inner:[(0,mt.default)({class:"Popup__button",inner:(0,yt.getLang)("mobile_wall_post_copyright_go"),theme:"regular",use_native_onclick:!0,on_click:"CopyrightPopup.go(this, '"+n+"', "+(o?1:0)+")"})]}]}});pt.default.open(Wd.elem(a),!0)},go:function(e,t,n){var o;if(pt.default.close(e),t.startsWith("/story"))window.Stories.init(t.substr(1),{source:"view_source"});else if(o=/^\/?narrative(-?\d+)_(\d+)(?:_(\d+))?(\/?([a-z0-9_-]+))?$/i.exec(t)){var[a,i,r]=o;window.showNarrative(a,i,r,{source:"view_source"})}else{if(/^@-?[\d\w._]+-[\d\w.-]+/.test(t.substr(1))&&(t+="?from="+nav.cur),!n)return nav.go(t,null);window.open(t,"post_copyright")}}},window.ZeroVKPopup={open:za,init:function(){window.onDOMReady((function(){za()}))}};n(60319);window.initSharePage=function(e,t){var n=(0,o.ge)("SharePageInput__to"),a="";n&&(a=n.value);var i={};if("mail"===e&&""!==n.value&&(i=a.split(",").reduce(((e,t)=>(e[t]=!0,e)),{})),"club"===e){var r=(0,K.$)(".SharePage .qsearch_wrap"),s=(0,K.$)(".hp_block",r);(0,o.show)(r),(0,o.show)(s)}var l=(0,K.$)(".SharePage .SharePanel.MessagePanel"),c=(0,K.$)(".SharePage .SharePanel.ActionsPanel");(0,o.extend)(cur,{publishTo:e,refreshSelected:function(e,t,a){var i;void 0===a&&(a=!0),(0,o.isUndefined)(e)||(cur.publishSelected=e),t=cur.publishTo,e=cur.publishSelected,"group"===t?i=(0,o.ge)("club"+e):"mail"===t&&(i=(0,o.ge)("peer"+e));var r=!!cur.selectedMap[e];i&&(i.classList.toggle("inline_item_selected",a?!r:r),cur.like_search.toggleAttach(e,!r),a&&(cur.selectedMap[e]=!r),n.value=Object.keys(cur.selectedMap).filter((e=>cur.selectedMap[e])).join(","));var s=Object.keys(cur.selectedMap).length>0&&Object.keys(cur.selectedMap).some((e=>!!cur.selectedMap[e]));return l.classList.toggle("SharePanel--active",s),c.classList.toggle("SharePanel--active",!s),!1},selectedMap:i,selectPeer:function(e,t){return cur.refreshSelected(t,"mail"),!1}}),Object.keys(i).forEach((t=>{cur.refreshSelected(t,e,!1)}))};var Qa=(e,t,n,o,a,i,r,s)=>{n?(0,qa.Confirm)(t,"ReportConfirm.submit('"+a+"', false, "+o+", '"+i+"', "+JSON.stringify(r)+")","",{title:e,id:"confirm-"+o}):Ya(a,!0,o,i,JSON.stringify(r),s)};function Ya(e,t,n,a,i,r){"string"==typeof i&&(i=JSON.parse(i));var s=(0,K.$)("#mcont");(0,o.setStyle)(s,{"pointer-events":"none"}),window.ajax.post(e,(0,_t.default)({_ajax:1,reason:n,onDone:()=>{(0,o.isVkWebView)()&&history.back()}},i)),"story"===i.type&&window.Stories.sendAnalyticsEvent("claim"),window.Snackbar.init({text:r||(0,yt.getLang)("mobile_msg_reported")}),(0,K.$$)(".Confirm").forEach((e=>pt.default.close(e)))}(0,o.extend)(Qa,{submit:Ya}),window.ReportConfirm=Qa;var Xa=n(69607);var Ja,Za,ei=function(e){var t="animation-duration: "+e.duration+"s;";return{inner:[{inner:[(0,f.Icon16Cancel)()],class:"CancelTimer__cross",tag:"div"},{inner:[{inner:[{class:"CancelTimer__line",style:t,tag:"span"}],class:"CancelTimer__hand",tag:"div"},{inner:[{class:"CancelTimer__line",style:t,tag:"span"}],class:"CancelTimer__hand",tag:"div"}],class:"CancelTimer__timer",tag:"div"}],class:"CancelTimer",tag:"div"}},ti=n(37668),ni=n(42030),oi=!1,ai=!1,ii={};window.Replies={init:function(e,t){void 0===t&&(t=0);!function(e){e&&function(){var e=(0,o.geByClass1)("wall_replies"),t=(0,o.domLC)(e);if(!t||!(0,o.hasClass)("RepliesThreadNext",t))return;var n=(0,o.geByClass1)("RepliesThreadNext__link",t);(0,o.autoScroll)((()=>{if((0,o.domPN)(t)&&!(0,o.hasClass)("RepliesThreadNext_loading",t))return n}),window.RepliesNext,{no_cache:!0})}();(function(){var e=(0,o.ge)("reply_field");if(!e||(0,o.hasClass)("RepliesField_static",e))return;var{onBodyScroll:t}=window,n=!1;t((0,o.throttle)((t=>{var a=t+(0,o.getCh)(),i=(0,o.getH)(e),r=a<(0,o.getY)(e)+i;r&&!n?((0,o.setStyle)(e,{height:i}),(0,o.addClass)("RepliesField_fixed",e)):!r&&n&&((0,o.removeClass)("RepliesField_fixed",e),(0,o.setStyle)(e,{height:null})),n=r}),10)),(0,o.onBodyScrollForce)()})(),function(e){var t=(0,o.ge)("replies_to_last"),n=(0,o.geByClass1)("RepliesWrap"),a=(0,o.geByClass1)("RepliesField_wrap");if(!t||!n)return;var i=(0,o.ge)("reply_field"),r=(0,o.hasClass)("RepliesField_static",i),s=(0,o.getY)(n),{onBodyScroll:l}=window,c=!1;ui(),l((0,o.throttle)((e=>{var l=e+(0,o.getCh)(),d=i&&!r?(0,o.getY)(i)-50:s+(0,o.getH)(n)-(0,o.getH)(a),u=s<e&&l<d;u!==c&&((0,o.toggleClass)("Replies_last_shown",t,u),t.setAttribute("tabindex",u?0:-1),c=u)}),10))}()}(e);var n=(0,o.ge)("reply_field"),a=(0,o.ge)("reply_field_text");window.mediaUpload&&n&&(window.mediaUpload.onStart(_i),window.mediaUpload.onRemove((()=>{_i(),a.focus()})));if(tt.default.checkStickers(),n){var{cur:i}=window;i.onStickersToggleCallbacks=i.onStickersToggleCallbacks||[],i.onStickersToggleCallbacks.push((e=>{if((0,o.onBodyScrollForce)(),di(),e){var t=(0,o.geByTag1)("a","stickers_panel");t&&t.focus()}else a.focus()})),function(e){var t=(0,yt.getState)("mention_items_"+e);t&&window.Mention.init({appendTo:(0,K.$)(".MentionContainer"),items:t})}(t),ci()}window.post.stickersInit()},replyTo:function(e,t,n,a,i){void 0===i&&(i="wall_reply");if((0,o.checkEvent)(e))return!0;if(window.cur.replyTo!==n&&oi)return ki(),!0;n=n||0,(0,o.geByClass)("ReplyItem_active").forEach((e=>{(0,o.removeClass)("ReplyItem_active",e)}));var r,s=(0,o.ge)("reply_field"),l=(0,o.ge)("reply_field_text"),c=(0,o.hasClass)("RepliesField_static",s),d=!!window.post&&window.post.replyNamesRE(),u=(0,o.val)(l),_="";if(n){if(r=(0,o.ge)(i+t+"_"+n))if(c||(0,o.addClass)("ReplyItem_active",r),!(0,o.hasClass)("ReplyItem_deleted",r)&&a){var p=window.cur.replyNames[a]||{},m=p[0]||"";_=p[1]||"",u=u?d?u.replace(d,m):u:m,window.post&&window.post.onReplyClick(!0,m)}else u=d?u.replace(d,""):u}else u=d?u.replace(d,""):u;(0,o.val)(l,(0,o.replaceEntities)(u));var f=(0,o.ge)("reply_field_to"),v=(0,o.geByClass1)("RepliesField__infoName",f);(0,o.val)(v,(0,o.htsc)(_)),(0,o.toggleClass)("RepliesField__infoItem_shown",f,n&&_),(0,o.toggleClass)("RepliesField__infoItem_shown","reply_field_to_empty",n&&!_);var g=(0,o.ge)("reply_field_info"),h=(0,o.ge)("reply_field_from");if((0,o.toggleClass)("RepliesField__info_shown",g,n||h),(0,o.toggleClass)("RepliesField__info_single",g,n&&!h||!n&&h),(0,o.val)("field_reply_to",n),(0,o.val)("field_reply_to_name",n&&_?"1":""),window.cur.replyTo=n,(0,o.val)("field_timestamp",gi()),c)if(r)Qt.default.changePosition(Qt.default.getByName("attaches"),!0,!1),(0,o.domInsertAfter)(s,r);else{Qt.default.changePosition(Qt.default.getByName("attaches"),!0,!0);var w=(0,o.geByClass1)("wall_replies");(0,o.domInsertBefore)(s,w)}return di(),ci(),(0,o.elfocus)(l),(0,o.cancelEvent)(e)},showMoreActions:function(e,t){var n=(0,o.ge)("reply_more_"+e);if(!n)return;var a=(0,o.geByClass)("ReplyItem__action",n),i=[];a.forEach((e=>{i.push((0,ha.ModalMenuBtn)({inner:(0,o.val)(e),onclick:"Replies.onClickMoreAction('"+e.id+"', event)"}))}));var r=(0,ha.default)({close:!0,items:i}),s=(0,o.ceFromString)(d.default.html(r));s=ut.default.open(s,!0,{oncloseCallback:()=>{var t=(0,o.ge)("reply_more"+e);t&&t.focus()}});var l=(0,o.geByClass1)("ModalMenu__btn",s);l&&l.focus();return(0,o.cancelEvent)(t)},onClickMoreAction:function(e,t){t&&ut.default.close(t.target);var n=(0,o.ge)(e);if(!n)return;n.click()},onFieldInput:ci,toggleStickers:function(e,t){if(oi)return(0,o.cancelEvent)(t);return window.post.stickersToggle(e),(0,o.cancelEvent)(t)},replyAsShow:function(e,t,n){void 0===n&&(n=!1);var a,i=!!window.cur.replyAs;wi(ri),i?a=fi(window.cur.replyAs):(a=(0,ee.default)({large:!0}),function(e,t){void 0===t&&(t=!1);if(window.cur.replyAsLoading)return;var{ajax:n}=window;window.cur.replyAsLoading=!0,n.post("/wall.php",{act:"get_reply_clubs_list",only_this_group:t?1:0,post_oid:e,modal:1},{onDone:e=>{window.cur.replyAs=e;var t=(0,o.ge)("reply_as_users_list");if(t){var n=fi(e);(0,o.val)(t,d.default.html(n));var a=(0,o.geByClass1)("ModalMenuUserList__item",t);a&&a.focus()}delete window.cur.replyAsLoading},onFail:()=>{delete window.cur.replyAsLoading}})}(t,n));var r=(0,ha.default)({title:(0,o.getLang)("mobile_wall_reply_as_title"),close:!0,items:[{id:"reply_as_users_list",inner:a}]}),s=(0,o.ceFromString)(d.default.html(r));if(ut.default.open(s,!0),i){var l=(0,o.geByClass1)("ModalMenuUserList__item",(0,o.ge)("reply_as_users_list"));l&&l.focus()}return(0,o.cancelEvent)(e)},replyAsChange:function(e,t,n,a){var i=(0,o.ge)("reply_field_from"),r=(0,o.geByClass1)("RepliesField__infoName",i);return(0,o.val)(r,(0,o.htsc)(a)),(0,o.val)("field_from_oid",n),ha.default.close(t),(0,o.ge)("reply_field_text").focus(),(0,o.cancelEvent)(e)},checkSendButton:function(e){if(!mi())return(0,o.cancelEvent)(e);window.cur.needTrackMyTracker&&(0,ti.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onClickLastReplies:function(e,t){var n=(0,o.geByClass1)("wall_replies"),a=(0,o.domLC)(n),i=a&&(0,o.hasClass)("RepliesThreadNext",a);if(i){var r=(0,o.geByClass1)("Loading",a);r||(r=(0,o.ceFromString)((0,ee.default)({})),(0,o.append)(r,a)),(0,o.addClass)("RepliesThreadNext_loading",a)}if((0,o.removeClass)("RepliesWrap_last_shown",e),window.scrollTo(0,document.body.scrollHeight),i)return a.focus(),window.ajax.click(e,window.RepliesLast);a&&((0,o.hasClass)("RepliesThread",a)&&(a=(0,o.domPS)(a)),(0,o.hasClass)("ReplyItem",a)&&(0,o.geByClass1)("ReplyItem__name",a).focus());return(0,o.cancelEvent)(t)},onSubmitForm:function(e,t){if(gi())ki();else{if(e.preventDefault(),ai)return;var n=(0,K.$)('textarea[name="message"]',t),a=n?n.value:"";if(!a)return hi(-1),void ki();ai=!0;var[,i,r]=location.pathname.match(/^\/wall(-?[0-9]+)_([0-9]+)$/);window.ajax.post("/wall.php",{act:"check_comment",oid:i,post_oid:r,text:a},{onDone:e=>{if(ai=!1,hi(e.timestamp),e.delay){var t,n=1e3*e.delay,a=(0,K.$)("#reply_field");(0,o.hasClass)("RepliesField_fixed",a)?t=(0,o.getH)(a)+5:(0,o.hasClass)("RepliesField_static",a)||(t=(0,o.getH)((0,K.$)("body"))-(0,o.getY)(a)+5),Za=window.Snackbar.init({type:W.SNACKBAR_TYPE_BULLYING,text:e.description,bottom:t,duration:n}),Ja=setTimeout((()=>{yi(),ki()}),n),function(e){var t=(0,K.$)("#nc_submit"),n=(0,K.$)(".RepliesField__field"),a=d.default.elem({class:"RepliesField__action RepliesField__action_cancel",inner:ei({duration:e/1e3}),onclick:["Replies.abortTimer",si]});oi=!0;var i=(0,K.$)(".RepliesField__action_attach"),r=(0,K.$)(".RepliesField__action_smile");i&&i.classList.add(li),r&&r.classList.add(li),n.appendChild(a),(0,o.hide)(t)}(n)}else ki()},onFail:()=>{ai=!1,ki()}})}},abortTimer:wi,setCurrentTimestamp:hi,getCurrentTimestamp:gi};var ri="editing",si="button",li="RepliesField__action_disabled";function ci(){var e=(0,o.ge)("reply_field_text"),t=(0,o.ge)("reply_field_text_fake");if(e&&t){var{value:n}=e;t.innerText=n,"\n"===(0,o.last)(n)&&(t.innerHTML+="&nbsp;");var a=(0,o.getH)(t);(0,o.getH)(e)!==a&&((0,o.setStyle)(e,{height:a}),di()),pi(),wi(ri)}}function di(){var e=(0,o.ge)("reply_field");(0,o.hasClass)("RepliesField_static",e)||(0,o.hasClass)("RepliesField_fixed",e)&&((0,o.setStyle)(e,{height:(0,o.getH)((0,o.geByClass1)("RepliesField_wrap",e))}),ui(),(0,o.onBodyScrollForce)())}function ui(){var e=(0,o.ge)("replies_to_last"),t=(0,o.ge)("reply_field");if(e&&t&&!(0,o.hasClass)("RepliesField_static",t)){var n=(0,o.domData)(e,"bottom");n||(n=parseInt((0,o.getStyle)(e,"bottom"))||20,(0,o.domData)(e,"bottom",n)),(0,o.setStyle)(e,"bottom",(0,o.getH)(t)+parseInt(n))}}function _i(){pi(),di();var e=(window.mediaUpload?window.mediaUpload.getAttachesCount():0)<2;["photo_device","photo","video","audio","doc"].forEach((t=>{Qt.default.toggleItemEnabled(Qt.default.getByName("attaches"),t,e)}))}function pi(){var e=(0,o.ge)("nc_submit");e&&(0,o.toggleClass)("RepliesField__action_send_active",e,mi())}function mi(){var{value:e}=(0,o.ge)("reply_field_text")||{};return(0,o.trim)(e)||window.mediaUpload&&window.mediaUpload.getAttachesCount()}function fi(e){var t=[];return e.forEach((e=>{t.push((0,Xa.ModalMenuUserListItem)({href:e[2],image:e[1],name:e[3],id:e[0],onclick:"return Replies.replyAsChange(event, this, "+parseInt(e[0])+', "'+(0,ni.cleanInputValue)(e[4])+'")'}))})),(0,Xa.default)({users:t})}function vi(){oi=!1,clearTimeout(Ja),window.Snackbar.close(Za),yi()}function gi(){return ii[""+window.cur.replyTo]}function hi(e){ii[""+window.cur.replyTo]=e,(0,o.val)("field_timestamp",e)}function wi(e){if(oi){var[,t,n]=location.pathname.match(/^\/wall(-?[0-9]+)_([0-9]+)$/),o=gi();window.ajax.post("/wall.php",{act:"cancel_check_comment",oid:t,post_oid:n,reason:e,timestamp:o})}vi()}function yi(){var e=(0,K.$)("#nc_submit"),t=(0,K.$)(".RepliesField__action_cancel"),n=(0,K.$)(".RepliesField__action_attach"),a=(0,K.$)(".RepliesField__action_smile");n&&n.classList.remove(li),a&&a.classList.remove(li),(0,o.remove)(t),(0,o.show)(e)}function ki(){var e=(0,K.$)("#nc_submit");hi(gi()),nav.go(e,window.event),hi(0)}nav.onBeforeGo(((e,t)=>{var n=location.pathname.substr(1,4);(0,o.isString)(e)&&e.substr(1,4)!==n&&"wall"===n&&(ii={})})),window.page&&window.page.onChange(((e,t)=>{vi()}));var bi="post_draft_reminder_container";function Si(){var e="WallSearchBtn--divided";(0,K.$$)(".WallSearchBtn__wrapper").forEach((t=>{var n=t.querySelector(".Slider__scroll"),o=null==n?void 0:n.getBoundingClientRect(),a=t.querySelector(".Slider__line"),i=null==a?void 0:a.getBoundingClientRect(),r=t.querySelector(".WallSearchBtn");(null==o?void 0:o.width)<(null==i?void 0:i.width)?null==r||r.classList.add(e):(null==r?void 0:r.classList.contains(e))&&(null==r||r.classList.remove(e))}))}window.PostDraftReminder={openContextMenu:function(e,t,n){var o=window.lang;e.preventDefault(),e.stopPropagation();var a=Wd.html([(0,te.ContextMenuItem)({title:o.mobile_wall_draft_delete,href:n.remove_url,ref:"wall_draft_reminder"})]),i=Wd.elem((0,te.ContextMenu)({list:a}));i.parentNode.id=bi,te.ContextMenu.open(i,"#"+bi,{appendToBody:!0})}},window.onDOMReady((()=>{Si(),(0,o.onBodyResize)(Si)})),window.page.onChange(Si),window.WallSearch={onSearch:function(e,t){e.preventDefault(),(0,N.statlogsValueEvent)("mvk_wall_search_button"),nav.go(t)},checkOverflow:Si};var Ci=n(88833),Ei=n(31602);var Ti,Ii=function(){var e=document.querySelector("#select-privacy"),t=e.querySelector(".PostSelect__label");if(!e||!t)return{selectPrivacy:null,selectPrivacyLabel:null,selectPrivacyCreatePostSelect:null,bestFriendsOnlyCheckbox:null,friendsOnlyCheckbox:null};var n=e.closest(".create_post__select");if(!n)return{selectPrivacy:e,selectPrivacyLabel:t,selectPrivacyCreatePostSelect:null,bestFriendsOnlyCheckbox:null,friendsOnlyCheckbox:null};var o=n.querySelector('input[name="best_friends_only"]'),a=n.querySelector('input[name="friends_only"]');return{selectPrivacy:e,selectPrivacyLabel:t,selectPrivacyCreatePostSelect:n,bestFriendsOnlyCheckbox:o,friendsOnlyCheckbox:a}},Mi=n(80235);!function(e){e.PUBLIC="public",e.FRIENDS_ONLY="friends_only",e.BEST_FRIENDS_ONLY="best_friends_only"}(Ti||(Ti={}));var Pi=function(){function e(){var e=this;this.onBestFriendsChange=function(t){var n;null===(n=window.PostPrivacy)||void 0===n||n.changePostPrivacySelectConfig(t),e.changePrivacy(t.bestFriendsCount>0?Ti.BEST_FRIENDS_ONLY:Ti.PUBLIC)},this.onPrivacyChange=function(t){void 0===t&&(t={}),(0,Mi.sendBestFriendsAnalytic)(Mi.BestFriendsEventType.selectBestFriends),e.changePrivacy(t.value)}}return e.prototype.onEditBestFriendsClick=function(){var e;(0,Mi.sendBestFriendsAnalytic)(Mi.BestFriendsEventType.editBestFriends),null===(e=window.BestFriendsEditBox)||void 0===e||e.open({onSubmit:["PostPrivacySelect.onBestFriendsChange"]})},e.prototype.changePrivacy=function(e){var t,n,o=Ii(),a=o.selectPrivacy,i=o.selectPrivacyLabel,r=o.selectPrivacyCreatePostSelect,s=o.bestFriendsOnlyCheckbox,l=o.friendsOnlyCheckbox;if(a&&i&&r){switch(a.classList.remove("PostSelect--bestFriends"),s&&(s.checked=!1),l&&(l.checked=!1),e){case Ti.PUBLIC:i.innerText=(0,yt.getLang)("mobile_profile_new_post_privacy_public");break;case Ti.FRIENDS_ONLY:i.innerText=(0,yt.getLang)("mobile_profile_new_post_privacy_friends_only"),l&&(l.checked=!0);break;case Ti.BEST_FRIENDS_ONLY:a.classList.add("PostSelect--bestFriends"),i.innerText=(0,yt.getLang)("mobile_profile_new_post_privacy_best_friends_only"),s&&(s.checked=!0)}null===(t=window.PostPrivacy)||void 0===t||t.closePostPrivacySelect();var c=function(){var e=Ii().selectPrivacy;return e&&e.getAttribute("data-save-post-draft-hash")||null}();c&&(null===(n=window.post)||void 0===n||n.saveDraft(null,c))}},e}(),Li=function(){function e(){}return e.prototype.openPostPrivacySelect=function(){var e,t=(e=Ii().selectPrivacy)?JSON.parse(e.getAttribute("data-post-privacy-select-config")||"null"):null;if(t){var n=function(e){void 0===e&&(e={});var t={inner:[e.friendsUsersStackHtml?e.friendsUsersStackHtml:null,{inner:[(0,yt.getLang)("mobile_profile_new_post_privacy_select_banner_header")],class:"PostPrivacySelectBestFriendsBanner__header",tag:"div"},{inner:[(0,yt.getLang)("mobile_profile_new_post_privacy_select_banner_description")],class:"PostPrivacySelectBestFriendsBanner__description",tag:"div"},(0,mt.default)({inner:[(0,yt.getLang)("mobile_profile_new_post_privacy_select_banner_button_label")],onClick:["PostPrivacySelect.onEditBestFriendsClick"],use_native_onclick:!0})],class:"PostPrivacySelectBestFriendsBanner",tag:"div"},n={inner:[(0,Ci.default)({type:"radio",onChange:["PostPrivacySelect.onPrivacyChange"],name:"PostPrivacySelectOption",value:"best_friends_only",label:(0,yt.getLang)("mobile_profile_new_post_privacy_best_friends_only"),checked:"best_friends_only"===e.selectedValue}),{inner:[e.bestFriendsUsersStackHtml?e.bestFriendsUsersStackHtml:null,{inner:[(0,f.Icon16Dropdown)()],class:"PostPrivacySelectBestFriendsControlAction__icon",tag:"div"}],class:"PostPrivacySelectBestFriendsControlAction",onClick:["PostPrivacySelect.onEditBestFriendsClick"],tag:"div"}],class:"PostPrivacySelectBestFriendsControl",tag:"div"},o=[(0,Ei.default)({inner:[(0,yt.getLang)("mobile_profile_new_post_privacy_select_header")],onClose:["ModalMenu.close","this"],mix:"PostPrivacySelectModalMenuHeader"}),{inner:[(0,io.default)({noOffset:!0}),{inner:[(0,yt.getLang)("mobile_profile_new_post_privacy_select_description")],class:"PostPrivacySelectBestFriends__description",tag:"div"},e.isForBestFriendsAvailable&&0===e.bestFriendsCount?t:null,(0,Ci.default)({type:"radio",onChange:["PostPrivacySelect.onPrivacyChange"],name:"PostPrivacySelectOption",value:"public",label:(0,yt.getLang)("mobile_profile_new_post_privacy_public"),checked:"public"===e.selectedValue}),(0,Ci.default)({type:"radio",onChange:["PostPrivacySelect.onPrivacyChange"],name:"PostPrivacySelectOption",value:"friends_only",label:(0,yt.getLang)("mobile_profile_new_post_privacy_friends_only"),checked:"friends_only"===e.selectedValue}),e.isForBestFriendsAvailable&&e.bestFriendsCount>0?n:null],class:"PostPrivacySelectBestFriends",tag:"div"}];return(0,mo.default)({attached:!0,body:o})}((0,u.__assign)((0,u.__assign)({},t),{selectedValue:this.getCurrentSelectedPrivacyValue()}));this.postPrivacySelectModalMenu=window.ModalMenu.open(d.default.elem(n),!0)}},e.prototype.changePostPrivacySelectConfig=function(e){var t=Ii().selectPrivacy;t&&t.setAttribute("data-post-privacy-select-config",JSON.stringify(e))},e.prototype.closePostPrivacySelect=function(){this.postPrivacySelectModalMenu&&(window.ModalMenu.close(this.postPrivacySelectModalMenu),this.postPrivacySelectModalMenu=null)},e.prototype.onPostMenuEditBestFriendsClick=function(){(0,Mi.sendBestFriendsAnalytic)(Mi.BestFriendsEventType.editBestFriends),setTimeout((function(){var e;null===(e=window.BestFriendsEditBox)||void 0===e||e.open({showSuccessSnackbar:!0})}),0)},e.prototype.getCurrentSelectedPrivacyValue=function(){var e=Ii(),t=e.bestFriendsOnlyCheckbox,n=e.friendsOnlyCheckbox;return(null==t?void 0:t.checked)?Ti.BEST_FRIENDS_ONLY:(null==n?void 0:n.checked)?Ti.FRIENDS_ONLY:Ti.PUBLIC},e}(),Bi=n(59374),Ai=function(){function e(){var e=this;this.onBestFriendsChange=function(t,n){var o,a;null===(o=window.PostPrivacy)||void 0===o||o.changePostPrivacySelectConfig(n),null===(a=window.PostPrivacySelect)||void 0===a||a.changePrivacy(Ti.BEST_FRIENDS_ONLY),e.close(t)}}return e.prototype.close=function(e){(0,o.remove)(null==e?void 0:e.closest(".PostPrivacyBanner")),this.hideBanner()},e.prototype.onEditBestFriendsClick=function(e){var t;null===(t=window.BestFriendsEditBox)||void 0===t||t.open({onSubmit:["PostPrivacyBanner.onBestFriendsChange",e]})},e.prototype.hideBanner=function(){window.helpHints.hide(Bi.AvailableHelpHints.ACCOUNT_HINT_FRIENDS_BEST_FRIENDS_POSTING)},e}();var Oi=function(){function e(){var e=this;this.postPrivacyModalMenu=null,this.onBestFriendsListChanged=function(){var t,n,o;if(!(null===(t=e.config)||void 0===t?void 0:t.isOwner)&&(null===(n=e.config)||void 0===n?void 0:n.isOnlyForBestFriends)&&0===(null===(o=e.config)||void 0===o?void 0:o.viewerBestFriendsCount)){var a=(0,ho.makeUrl)("wall",{act:"add",post_privacy:"best_friends_only"});window.nav.go(a)}e.close()},this.getConfig=function(e){return e?JSON.parse(e.getAttribute("data-post-privacy-modal-config")||"null"):null}}return e.prototype.open=function(e){var t,n,a=this.getConfig(e);a&&(this.config=a,a.isOnlyForBestFriends?(0,Mi.sendBestFriendsAnalytic)(Mi.BestFriendsEventType.clickToLockBestFriends):a.isOnlyForFriends&&(0,Mi.sendBestFriendsAnalytic)(Mi.BestFriendsEventType.clickToLockFriends),(null===(t=window.BestFriends)||void 0===t?void 0:t.isCountWasChanged)&&(a.bestFriendsCount=null===(n=window.BestFriends)||void 0===n?void 0:n.getCount()),this.postPrivacyModalMenu=window.ModalMenu.open(d.default.elem(function(e){void 0===e&&(e={});var t="",n="",a=null;return e.isOwner?(t=(0,yt.getLang)(e.isOnlyForBestFriends?"mobile_post_privacy_modal_best_friends_owner_title":"mobile_post_privacy_modal_friends_owner_title"),n=(0,yt.getLang)(e.isOnlyForBestFriends?"mobile_post_privacy_modal_best_friends_owner_description":"mobile_post_privacy_modal_friends_owner_description"),e.isOnlyForBestFriends&&0===e.bestFriendsCount&&(t=(0,yt.getLang)("mobile_post_privacy_modal_no_one_will_see_title"),n=(0,yt.getLang)("mobile_post_privacy_modal_no_one_will_see_description"),a={text:(0,yt.getLang)("mobile_post_privacy_modal_choose_best_friends_button_title"),onClick:e.onChooseBestFriendsClick})):(t=(0,o.langSex)(e.ownerSex,(0,yt.getLang)(e.isOnlyForBestFriends?"mobile_post_privacy_modal_best_friends_title":"mobile_post_privacy_modal_friends_title","raw")).replace("{user_first_name}",e.ownerFirstName),n=(0,yt.getLang)(e.isOnlyForBestFriends?"mobile_post_privacy_modal_best_friends_description":"mobile_post_privacy_modal_friends_description"),a=e.createPostUrl&&{text:(0,yt.getLang)("mobile_post_privacy_modal_create_post_button_title"),url:e.createPostUrl,onClick:"PostPrivacyModal.onCreatePostClick(this);"},e.isOnlyForBestFriends&&0===e.viewerBestFriendsCount&&(a={text:(0,yt.getLang)("mobile_post_privacy_modal_choose_best_friends_button_title"),onClick:e.onChooseBestFriendsClick})),Oa({title:t,icon:(0,f.Icon56LockOutline)(),needCloseIcon:!0,subhead:n,actions:a?[a]:null})}(a)),!0))},e.prototype.close=function(){this.config=null,this.postPrivacyModalMenu&&(window.ModalMenu.close(this.postPrivacyModalMenu),this.postPrivacyModalMenu=null)},e.prototype.onCreatePostClick=function(e){var t,n;window.ModalMenu.close(e),(null===(t=this.config)||void 0===t?void 0:t.isOnlyForBestFriends)?(0,Mi.sendBestFriendsAnalytic)(Mi.BestFriendsEventType.createPostFromPopupBest):(null===(n=this.config)||void 0===n?void 0:n.isOnlyForFriends)&&(0,Mi.sendBestFriendsAnalytic)(Mi.BestFriendsEventType.createPostFromPopupFriends)},e.prototype.onChooseBestFriendsClick=function(){var e;(0,Mi.sendBestFriendsAnalytic)(Mi.BestFriendsEventType.editBestFriendsFromPopup),null===(e=window.BestFriendsEditBox)||void 0===e||e.open({showSuccessSnackbar:!0,onSubmit:"PostPrivacyModal.onBestFriendsListChanged"})},e}();window.PostPrivacy=new Li,window.PostPrivacySelect=new Pi,window.PostPrivacyBanner=new Ai,window.PostPrivacyModal=new Oi;var xi=function(){function e(){}return e.prototype.openFakeInfoModal=function(e){var t=function(e){void 0===e&&(e={});var t=(0,yt.getLang)("mobile_wall_post_fake_info_modal_title"),n=(0,yt.getLang)("mobile_wall_post_fake_info_modal_text"),o=[{text:(0,yt.getLang)("mobile_wall_post_fake_info_modal_button"),onClick:"ModalMenu.close(this)"}],a={inner:[n,{inner:[{inner:[(0,yt.getLang)("mobile_wall_post_fake_info_modal_more")],href:e.url,target:"_blank",rel:"noopener",tag:"a"}],style:"margin: 8px 0 20px",tag:"div"}],tag:"div"};return Oa({title:t,icon:(0,f.Icon56ErrorOutline)(),subhead:a,actions:o})}(e);window.ModalMenu.open(d.default.elem(t),!0),window.ajax.post("wall.php",{act:"track_fake_news_caption_clicked"})},e}(),Ri=new xi;window.FakeInfo=Ri,window.TextliveFeedBanner={close:function(e){return ajax.click(e,window.Comment)},restore:function(e){return ajax.click(e,window.Comment)},onTextliveOpen:function(){(0,o.statlogsValueEvent)("textlive_banner_action",null,"open")}};n(16539),n(546),n(91896),n(38200);var Ni=n(91263),Di=n(41313);window.MainMenu={showMenuItems:Ni.showMenuItems},y.default.getRouter().addRoute(/^\/menu([\?#].*)?$/,Ni.rebuildNotifications),(0,Di.onServerEvent)("MainMenu/initMiniAppsCounterTooltip").watch((()=>{"complete"===document.readyState?(0,Ni.renderMiniAppsCounterTooltip)():window.onDOMReady(Ni.renderMiniAppsCounterTooltip)}));Ei.default,n(30756),n(83411),n(77394),n(160),n(95646),n(46010),n(81357);function Fi(){delete window.cur.detailsModalMenuOpened,window.history.pushState({},"",window.location.href.split("#")[0])}function Ui(){return mo.default.open(document.getElementById("money_transfer_receipt_details"),!0,"",{close:!0,onOverlayClick:Fi,onClose:Fi}),window.cur.detailsModalMenuOpened=!0,window.history.pushState({},"",window.location.href.split("#")[0]+"#modal"),!1}"#modal"===window.location.hash&&document.addEventListener("DOMContentLoaded",Ui),window.MoneyTransferReceipt={_onShowDetails:Ui,_onCloseDetails:function(e){mo.default.close(e),Fi()}},window.PostAttachVideoLink={},PostAttachVideoLink._onInit=qi,PostAttachVideoLink._onPlayClick=zi,PostAttachVideoLink._onReplayClick=zi,PostAttachVideoLink._onSoundClick=Gi,PostAttachVideoLink._onVideoClick=Qi,PostAttachVideoLink._onVideoPlay=e=>Yi(e.target,"play"),PostAttachVideoLink._onVideoPause=e=>Yi(e.target,"pause"),PostAttachVideoLink._onVideoEnded=e=>Yi(e.target,"end");var Hi="PostAttachVideoLink_muted",ji=e=>"PostAttachVideoLink_state_"+e,$i=".PostAttachVideoLink",Vi=".PostAttachVideoLink__video",Wi=window.MutationObserver,Ki=null;function qi(){Wi&&!Ki&&(Ki=new Wi(Xi)).observe(document.body,{childList:!0,subtree:!0})}function Gi(e){var t=e.closest($i),n=(0,K.$)(Vi,t);n.muted=!n.muted,t.classList.toggle(Hi,n.muted)}function zi(e){var t=e.closest($i);(0,K.$)(Vi,t).play()}function Qi(e){e.paused||e.pause()}function Yi(e,t){var n=e.closest($i);n.classList.remove(ji("play")),n.classList.remove(ji("pause")),n.classList.remove(ji("end")),n.classList.add(ji(t))}function Xi(e){e.forEach((e=>{e.removedNodes.forEach((e=>{e.nodeType===HTMLElement.ELEMENT_NODE&&(0,K.$$)(Vi,e).forEach((e=>{e.src="",e.load()}))}))})),(0,K.$)(Vi)||(Ki.disconnect(),Ki=null)}n(93252);var Ji=function(){var e=null;function t(e,t,n,o,a,i){var r="/club"+t+obj2qs({act:e,hash:n,id:t,from:o});ajax.post(r,{_ajax:1},{onDone:a,onFail:i})}return{enter:function(n,o,a,i,r){void 0===i&&(i=e),void 0===r&&(r=e),t("enter",n,o,a,i,r)},leave:function(n,o,a,i,r){void 0===i&&(i=e),void 0===r&&(r=e),t("leave",n,o,a,i,r)},init:function(e,t){var n,o,a;void 0===t&&(t={}),t&&t.hasOwnProperty("add_recent_hash")&&(n=e,o=t.add_recent_hash,a={act:"add_recent",group_id:n,hash:o},j.default.post("/groups",a))}}}();window.Groups=Ji;var Zi={register:fs,forceRegister:function(e,t){e[ir]=gs(e),e[sr]=t,Zr.push(e)},onScroll:throttle(ws,50),onStartViewElement:(0,c.default)("element"),onEndViewElement:(0,c.default)("element"),onStopTrackElement:(0,c.default)("element"),onViewedElement:(0,c.default)("element"),onBeforePageChange:Ss,onPageChanged:Cs,getElementType:gs,registerElements:ps,registerTrackingCls:function(e){us.push(e)},unregisterTrackingCls:function(e){Zs(us,e)},setParenViewableX:function(e,t){e[hr]=t},forceProcessTrack:vs,dispatchElementEvent:function(e,t){var n=function(e){return Gr[e]}(Qs(t[ir]||gs(t),e));Ms({type:e,data:n(t)})},dispatchEvent:function(e){Ms(e)},serializeEventData:hs,clearElemsCache:function(){Zr.forEach((function(e){e[ur]=!1,e[_r]=!1}))},_debug:function(){return{started:es,tracking:Zr,events:ds,blindTop:ns,blindBottom:os}},getFromRef:il,getRoot:rl,BLOCKS:{},EVENTS:{}};window.FeedAssistanceStats=Zi;var er,tr,nr=.5,or=.25,ar=500,ir="_feedAssistanceStatsType",rr="_feedAssistanceStatsIdled",sr="_feedAssistanceStatsModule",lr="_feedAssistanceStatsStarted",cr="_feedAssistanceStatsProcessed",dr="_feedAssistanceStatsEventTs",ur="_feedAssistanceStatsCachedY",_r="_feedAssistanceStatsCachedX",pr="_feedAssistanceStatsLeft",mr="_feedAssistanceStatsHeight",fr="_feedAssistanceStatsWidth",vr="_feedAssistanceStatsTop",gr="_feedAssistanceStatsBottom",hr="_feedAssistanceStatsParentViewableX",wr="BLOCK_TYPE_RECOMMENDED_SLIDER",yr="BLOCK_TYPE_EXPLORE_BAIT",kr="BLOCK_TYPE_PROFILE_PHOTO",br="BLOCK_TYPE_PROMO_BUTTON",Sr="BLOCK_TYPE_IMPORT_CONTACTS",Cr="BLOCK_TYPE_PUSH_SWITCH",Er="view_block",Tr="explore_bait",Ir="feed_assistance",Mr="hide",Pr="promo_button",Lr="SUB_EXPLORE_BAIT",Br="view",Ar="opened",Or="subscribe",xr="unsubscribe",Rr="open_user",Nr="open_group",Dr="hide",Fr="report",Ur="seen",Hr="filled",jr="enable_push",$r="decline_push",Vr="SUB_PROMO_BUTTON",Wr="clicked",Kr={[wr]:Er,[br]:Er,[yr]:Tr,[kr]:Ir,[Sr]:Ir,[Cr]:Ir},qr={[wr]:500,[yr]:ar,[kr]:ar,[Sr]:ar,[Cr]:ar},Gr={[Qs(wr,Er)]:e=>{var t=geByClass1("Slider__scroll",e),n=domData(t,"code"),o=domData(t,"ref");return hs(Er,"",e,o,n)},[Qs(br,Er)]:e=>{var t=geByClass1("feedAssistancePromoButtonInstallApp__button",e)?"promo_install_app":"promo_button";return hs(Er,t,e)},[Qs(yr,Tr)]:()=>hs(Lr,Br),[Qs(kr,Ir)]:e=>hs(Ir,e,"m_ph",Ur),[Qs(Sr,Ir)]:e=>hs(Ir,e,"m_mp",Ur),[Qs(Cr,Ir)]:e=>hs(Ir,e,"m_push_switch",Ur)},zr={[Er]:(e,t,n,o)=>(n=n||il(t),[e,domChildIndex(t),sl(t),n,o].join("|")),[Lr]:e=>e,[Ir]:(e,t,n)=>[t,n,il(e)].join("|"),[Mr]:(e,t)=>[e,sl(t),domChildIndex(t),il(t)].join("|"),[Vr]:(e,t,n)=>[domChildIndex(e),t,n||""].join("|")},Qr="feed_other",Yr="feedAssistance",Xr="feedAssistanceStat.events",Jr="feedAssistanceStat.idled",Zr=[],es=[],ts=Date.now(),ns=0,os=0,as=!1,is=null,rs=null,ss=null,ls=null,cs=null,ds=[],us=[],_s=!1;function ps(){var e=[];each(us,(function(){e=e.concat(geByClass(this))})),each(e,(function(){fs(this,"feed")}))}function ms(){ps();var e=Ks();e.length&&(js(e),qs()),vs(),xs()}function fs(e,t){!e[ir]&&function(e){return!~Zr.indexOf(e)}(e)&&(e[ir]=gs(e),e[sr]=t,Zr.push(e))}function vs(){Ts(scrollGetY(),getCh())}function gs(e){return e[ir]?e[ir]:hasClass("feedAssistance_recommendedFriends",e)?wr:hasClass("post_exploreBait",e)?yr:hasClass("feedAssistance_profilePhoto",e)?kr:hasClass("feedAssistance_promoButton",e)?br:hasClass("feedAssistance_importContacts",e)?Sr:hasClass("feedAssistance_pushNotificationsSwitch",e)?Cr:"BLOCK_TYPE_DEFAULT"}function hs(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return zr[e](...n)}function ws(e,t){var n,o=ws;Ts(e||scrollGetY(),t||getCh()),as||_s?(clearTimeout(o.timer),o.timer=setTimeout(ys,150),_s=!1):(as=!0,Os(),n=ge("vk_head"),ns=n&&n.offsetHeight,os=0)}function ys(){Os(),As(),as=!1}function ks(){Os(),ol(es),js(ds.concat(zs(es))),tl(es),ds=[],es=[],Rs()}function bs(){es.forEach((function(e){e[lr]=Date.now()})),$s(null),Vs(null),As(),Rs(),xs()}function Ss(){Os(),ol(es),ds=ds.concat(zs(es)),tl(es),es=[],_s=!0,As()}function Cs(){ps(),vs()}function Es(){ps()}function Ts(e,t){var n=[];Zr.forEach((function(o){Js(o)?n.push(o):!function(e,t,n){return!e[lr]&&Ls(e,nr,t,n)&&Bs(e,nr)}(o,e,t)?!function(e,t,n){return e[lr]&&(!Ls(e,or,t,n)||!Bs(e,or))}(o,e,t)?Ps(o)&&(Is(o),Zi.onViewedElement(o)):(o[rr]?delete o[rr]:(Is(o),Zi.onEndViewElement(o)),delete o[lr]):(o[lr]=Date.now(),es.push(o),Zi.onStartViewElement(o))})),n.forEach((function(e){Zs(Zr,e),Zi.onStopTrackElement(e)}))}function Is(e){Zs(es,e),nl(e),Ms(Xs(e)),el(e)}function Ms(e){e&&ds.push(e)}function Ps(e){if(!e[lr])return!1;var t=Math.min(3e5,Date.now()-e[lr]),n=function(e){var t=gs(e);return qr[t]||ar}(e);return t>n}function Ls(e,t,n,o){if(!e)return!1;e[ur]||(e[ur]=!0,e[mr]=e.offsetHeight,e[vr]=n+e.getBoundingClientRect().top,e[gr]=e[vr]+e[mr]);var a=o-ns-os,i=n+ns,r=n+o-os,s=e[mr],l=e[vr],c=e[gr];return(c>i&&l<r?Math.min(r,c)-Math.max(i,l):0)>=Math.min(a*t,s*t)}function Bs(e,t){var n=e[hr];n&&!n[_r]&&~Zr.indexOf(n)&&(n[_r]=!0,n[fr]=n.clientWidth,n[pr]=n.getBoundingClientRect().left+n.clientLeft),e[_r]||(e[_r]=!0,e[fr]=e.offsetWidth);var o=n?n[fr]||n.clientWidth:getCw(),a=n?n[pr]||n.getBoundingClientRect().left+0:0,i=o+a,r=e[fr],s=e.getBoundingClientRect().left,l=r+s,c=r*t,d=r*Math.max(0,1-t);return s+c>=a&&l-d<=i}function As(){is=setTimeout(Ns,2500),rs=setTimeout(Ds,1e4),ss=setTimeout(Fs,6e3),ls=setTimeout(Us,2e4)}function Os(){clearTimeout(is),clearTimeout(rs),clearTimeout(ss),clearTimeout(ls)}function xs(){cs=setInterval(Hs,3e4)}function Rs(){clearInterval(cs)}function Ns(){ds.length&&$s(ds)}function Ds(){js(ds),ds=[],$s(null)}function Fs(){es.length&&(Vs(zs(es)),ss=setTimeout(Fs,5e3))}function Us(){clearTimeout(ss),ol(es),js(zs(es)),tl(es),es.forEach((function(e){e[rr]=!0})),es=[],Vs(null)}function Hs(){ds.length>=100&&Ds()}function js(e){if(e&&e.length){var t={act:"assistance_stats"};t=extend(t,(n={},each(e,(function(){n[this.type]?n[this.type].push(this.data):n[this.type]=[this.data]})),n)),ajax.post("/feed",t)}var n}function $s(e){Ws(Xr,e)}function Vs(e){Ws(Jr,e)}function Ws(e,t){var n=lsGet(e)||{};t?n[ts]=t:delete n[ts],lsSet(e,n)}function Ks(){var e=Ks,t=[],n=lsGet(Xr)||{},o=lsGet(Jr)||{};return e.iterator||(e.iterator=function(e){return function(n){Gs(n)&&(t=t.concat(e[n]))}}),Object.keys(n).forEach(e.iterator(n)),Object.keys(o).forEach(e.iterator(o)),t}function qs(){var e=qs,t=lsGet(Xr)||{},n=lsGet(Jr)||{};e.iterator||(e.iterator=function(e){return function(t){Gs(t)&&delete e[t]}}),Object.keys(t).forEach(e.iterator(t)),Object.keys(n).forEach(e.iterator(n)),lsSet(Xr,t),lsSet(Jr,n)}function Gs(e){var t=Number(e);return t!==ts&&Date.now()-t>=36e4}function zs(e){var t=[];return e.forEach((function(e){var n=Xs(e);n&&t.push(n)})),t}function Qs(e,t){return e+"_"+t}function Ys(e,t){return(0,Gr[Qs(e[ir],t)])(e)}function Xs(e){if(Js(e))return null;if(!Ps(e))return null;var t=function(e){return Kr[e[ir]]}(e);return{type:t,data:Ys(e,t)}}function Js(e){return e[cr]||!document.body.contains(e)}function Zs(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function el(e){Js(e)||Ps(e)&&(e[cr]=!0)}function tl(e){each(e,(function(){el(this)}))}function nl(e){e[dr]=Date.now()}function ol(e){e.forEach(nl)}function il(e){return(e=rl(e))&&domData(e,"from-ref")||Qr}function rl(e){return hasClass(e,Yr)||(e=domCA(e,".feedAssistance")),e}function sl(e){var t=(new Date).getTime();return e&&(e[dr]||e[lr])||t}Zi.BLOCKS={BLOCK_TYPE_RECOMMENDED_SLIDER:wr,BLOCK_TYPE_EXPLORE_BAIT:yr,BLOCK_TYPE_PROFILE_PHOTO:kr,BLOCK_TYPE_PROMO_BUTTON:br,BLOCK_TYPE_IMPORT_CONTACTS:Sr},Zi.EVENTS={EVENT_EXPLORE_BAIT:Tr,EVENT_EXPLORE_BAIT_SUB:Lr,EVENT_FEED_ASSISTANCE:Ir,SUB_EVENT_EXPLORE_BAIT_VIEW:Br,SUB_EVENT_EXPLORE_BAIT_OPENED:Ar,SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE:Or,SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:xr,SUB_EVENT_EXPLORE_BAIT_OPEN_USER:Rr,SUB_EVENT_EXPLORE_BAIT_OPEN_GROUP:Nr,SUB_EVENT_EXPLORE_BAIT_HIDE:Dr,SUB_EVENT_EXPLORE_BAIT_REPORT:Fr,SUB_EVENT_SEEN:Ur,SUB_EVENT_FILLED:Hr,EVENT_HIDE_BLOCK:Mr,SUB_EVENT_ENABLE_PUSH:jr,SUB_EVENT_DECLINE_PUSH:$r,EVENT_PROMO_BUTTON:Pr,EVENT_PROMO_BUTTON_SUB:Vr,SUB_EVENT_PROMO_BUTTON_CLICK:Wr},addEvent(window,"blur",ks),addEvent(window,"focus",bs),onDOMReady((function(){setTimeout(ms,500)})),addEvent(window,"scroll",(()=>{ws(scrollGetY(),getCh())}),{passive:!0}),nav.onBeforeGo((()=>Ss())),page.onChange((()=>Cs())),er=Es,(tr=pe())?tr.addListener(_e,er):console.warn(new Error("Missing wall ajax events emitter"));n(8677);var ll=n(18782),cl=n(24661),dl=!1;page.onChange(gl),cl.toggleLayer.watch((e=>{var{state:t}=e;t?(dl=!0,hl(pl)):gl()})),i.colorScheme.onInit((()=>{dl||vl()})),i.colorScheme.subscribe((()=>{dl||vl()}));var ul,_l="#19191a",pl="#000",ml=(0,K.$)('meta[name="theme-color"]'),fl=(0,K.$)('meta[name="color-scheme"]');function vl(){i.colorScheme.isDarkScheme()?hl(_l):hl("#ffffff")}function gl(){dl=!1,vl()}function hl(e){ul||(ul=(0,K.$)("#theme_color_shim")),null==ml||ml.setAttribute("content",e),null==fl||fl.setAttribute("content",[pl,_l].includes(e)?"dark":"light"),ul&&(ul.style.backgroundColor=e)}n(58901);var wl,yl,kl,bl,Sl,Cl="groupCover-vk_animationYes",El="groupCover-vk_animationStep",Tl=[".basis__header_unauthorized"],Il=!1;function Ml(){Il||(wl={vk:geByClass1("vk"),basis:geByClass1("basis"),header:geByClass1("basis__header"),headerTitle:geByClass1("mh_header",geByClass1("basis__header")),headerFirstIcon:geByClass1("GroupCoverIcons__icon--back_outline_28",geByClass1("basis__header")),headerSecondIcon:geByClass1("GroupCoverIcons__icon--back_outline_white_28",geByClass1("basis__header")),cover:geByClass1("groupCover"),coverImage:geByClass1("groupCover__image"),coverDimmer:geByClass1("groupCover__dimmer")}).cover&&(Il=!0,addClass(wl.vk,Cl),yl=!H.default.chrome||Number(H.default.version.split(".")[0])>50,kl="fixed"===getStyle(wl.header,"position"),bl=getH(wl.header),Sl=getH(wl.cover),onBodyScroll(Ll),onBodyResize(Bl),Ll(),window.cur.destroy=window.cur.destroy.filter((e=>e!==Pl)),window.cur.destroy.push(Pl))}function Pl(){(!0||menu.opened())&&(removeClass(wl.vk,El),removeClass(wl.vk,Cl)),onBodyScroll("__clear",Ll),onBodyResize("__clear",Bl),Il=!1}function Ll(){var e=scrollTop();if(kl)if(e<0)setStyle(wl.header,"top",-e),Ol(),setStyle(wl.coverDimmer,"opacity",0),setStyle(wl.coverImage,"top",0);else{var{body:t}=document,n=Math.min(1,e/(Sl-bl)),o=t&&t.classList.contains("vk_tabbar_top")&&!wl.header.classList.contains("basis__header_noBottomMenu")?48:0;setStyle(wl.header,"top",o),setStyle(wl.headerTitle,"display","block"),setStyle(wl.headerFirstIcon,"display","block"),setStyle(wl.headerSecondIcon,"display","block"),n<=.9?(Ol(),yl&&setStyle(wl.coverImage,"top",.5*e),setStyle(wl.coverDimmer,"opacity",n/.9),setStyle(wl.headerTitle,"opacity",0),setStyle(wl.headerFirstIcon,"opacity",0),setStyle(wl.headerSecondIcon,"opacity",1)):(setStyle(wl.headerTitle,"opacity",1),setStyle(wl.headerFirstIcon,"opacity",1),setStyle(wl.headerSecondIcon,"opacity",0),Al())}else Math.min(1,e/Sl)<1?(Ol(),setStyle(wl.coverDimmer,"opacity",0),yl&&setStyle(wl.coverImage,"top",.5*e),setStyle(wl.headerTitle,"display","none"),setStyle(wl.headerFirstIcon,"display","none"),setStyle(wl.headerSecondIcon,"display","block")):Al()}function Bl(){Pl(),Ml()}function Al(){Tl.map((e=>$(e))).some((e=>e))||removeClass(wl.vk,El)}function Ol(){Tl.map((e=>$(e))).some((e=>e))||addClass(wl.vk,El)}onDOMReady((()=>{(H.default.chrome||H.default.safari&&H.default.ios>=9)&&(Ml(),page.onChange(Ml),zlayer.onClose((()=>{setTimeout(Ml,0)})))}));n(56626),n(80452),n(22422);var xl,Rl,Nl="tabs_block",Dl="mhb_back",Fl="TopMenu_open",Ul=()=>(0,o.geByClass1)(Nl),Hl=()=>(0,o.geByClass1)("tab_item_top"),jl=!0,$l=0;function Vl(){Rl&&Rl(),xl&&xl()}function Wl(e){(0,o.stopEvent)(e),(0,o.preventEvent)(e),$l=300,jl&&((0,o.toggleClass)("TopMenu__switcher_on",(0,o.geByClass1)("TopMenu__switcher")),"touchstart"===e.type&&setTimeout((()=>{nav.go(Hl(),null)}),130))}function Kl(e){(0,o.gpeByClass)(Nl,e.target)||(0,o.gpeByClass)(Dl,e.target)||((0,o.stopEvent)(e),(0,o.preventEvent)(e),(0,o.removeClass)(Fl,Ul()),ql(),Vl())}function ql(){Vl(),(0,o.removeEvent)(window,"touchstart mousedown click",Kl)}window.TopMenu={onHeaderClick:function(e){if(!jl)return;var t=Ul();(0,o.stopEvent)(e),(0,o.preventEvent)(e);var n=(0,o.geByClass1)(Dl);if((0,o.hasClass)(Fl,t))(0,o.removeClass)(Fl,t),Vl();else{var a=Hl();(0,o.addClass)(Fl,t),(0,o.geByClass1)("_hfixed")&&(0,o.setStyle)(t,"max-height",window.innerHeight-70),(0,o.append)(t,n),(0,o.addEvent)(window,"touchstart mousedown click",Kl),(0,o.addEvent)(a,"touchstart mousedown",Wl),(0,o.addEvent)(a,"click",(e=>{(0,o.stopEvent)(e),(0,o.preventEvent)(e)})),Rl=(0,r.expandPopup)((0,o.geByClass1)("al_back")),(xl=(0,r.setFocusTrap)(t))&&(xl.exitIntent=()=>{(0,o.removeClass)(Fl,t),Vl()}),cur.destroy.push(ql),cur.destroy.push((()=>(0,o.removeEvent)(a,"touchstart mousedown",Wl)))}}},nav.onBeforeGo((()=>{jl=!1,setTimeout((()=>{$l=0,jl=!0,Vl()}),$l)}));var Gl=function(){var e,t,n,o="ai_menu_opened",a=!1;function i(e){for(var t=!1;e;){var n=getStyle(e,"overflow-y");if(("scroll"===n||"auto"===n)&&e.offsetHeight<e.scrollHeight){e===document.documentElement||e===document.body?e=null:t=!0;break}e=e.parentElement}return{cursor:e,isOverflowYContainer:t}}function s(e){for(var t=!1;e;){var n=getStyle(e,"overflow-x"),o=hasClass(e,"Slider__scroll");if("scroll"===n||"auto"===n||o){t=!0;break}e=e.parentElement}return{cursor:e,isOverflowXContainer:t}}function l(){if(e&&t){var n=geByClass1("i_pointer",e);if(document.body.contains(n))i(n).isOverflowYContainer?setStyle(t,"top",n.getBoundingClientRect().top):setStyle(t,"top",getY(n)),s(n).isOverflowXContainer?setStyle(t,"left",function(e){return e.getBoundingClientRect().left}(n)-getW(t)):setStyle(t,"left",getX(n)-getW(t))}}function c(e){e&&"A"===e.target.tagName&&requestAnimationFrame((()=>{l()}))}function d(d){!function(n){e=gpeByClass("ai_menu_wrap",n),t=geByClass1("ai_menu",e)}(d),addClass(o,e),append(t,document.body),(n=(0,r.setFocusTrap)(t))&&(n.exitIntent=()=>{u()}),a=u,tooltip.addHandler(a),tooltip.show(e,t),addEvent(window,"resize",l),addEvent(t,"click",c);var _=geByClass1("i_pointer",e),p=i(_);p.isOverflowYContainer&&addEvent(p.cursor,"scroll",l);var m=s(_);m.isOverflowXContainer&&addEvent(m.cursor,"scroll",l),l()}function u(){removeClass(o,e),append(t,e),tooltip.removeHandler(a),tooltip.hide(),n&&(n(),n=null),removeEvent(window,"resize",l),removeEvent(t,"click",l);var r=geByClass1("i_pointer",e),c=i(r);c.isOverflowYContainer&&removeEvent(c.cursor,"scroll",l);var d=s(r);d.isOverflowXContainer&&removeEvent(d.cursor,"scroll",l)}return{closeMenu:u,toggleMenu:function(t,n){cancelEvent(t),hasClass(o,e)?u():d(n)},update:function(){!function(){if(t){var e=geByClass("wia_item",t);e&&each(e,((e,t)=>{var n=clone(t);before(n,t),remove(t),addClass("unhover",n),setTimeout((()=>{removeClass("unhover",n)}),100)}))}}(),l()}}}();window.ActionMenu=Gl;n(64527),n(35749);var zl=function(){var e=38,t=40,n=13,o=27,a="MentionContainer_opened",i="Mention_inited",r="Mention_noScroll",s="MentionItem_active",l={},d={},u=!1;function _(){l={ignoredTerm:null,curValue:"",curTerm:"",curPos:"",input:{}},d={container:null,scroll:null,index:{},cache:{},shown:[],lastQ:null,text:null,requestTimer:null,opts:{}}}_();var p=!0;function m(){p=!1}function f(){var e=val(l.input),t=Math.max(e.lastIndexOf("@"),e.lastIndexOf("*")),n=!1;if(t>-1){var o=function(e){if(void 0!==e.selectionStart)return e.selectionStart!==e.selectionEnd?e.selectionEnd:e.selectionStart;if(void 0!==window.getSelection){var t=window.getSelection();if(!t||!t.rangeCount)return 0;var n=t.getRangeAt(0),o=n.cloneRange(),a=ce("div");return o.selectNodeContents(e),o.setEnd(n.startContainer,n.startOffset),a.appendChild(o.cloneContents()),val(a).replace(/\n$/,"").length}return 0}(l.input),a=e.substr(0,o);t=Math.max(a.lastIndexOf("@"),a.lastIndexOf("*"));var i=a.match(/(^|[\s.,:\'\"\u00BB\u00AB;>\)\(]|\#[\w_\.\u0400-\u04FF]+)[@\*]([^,@\*\(\)\?\!\s\n\r \u00A0]*)$/);i&&"."!==i[2].substr(-1)&&(n=i[2])}!1===n&&delete l.ignoredTerm,void 0!==l.ignoredTerm&&n==l.ignoredTerm&&(n=!1),l.curValue=e,l.curTerm=n,l.curPos=t,d.text=n,!1===l.curTerm?h():(E(!1,l.curTerm),g(),function(){var e=ge("mhead").offsetHeight,t=d.container.getBoundingClientRect(),n=l.input.offsetHeight,o="Mention_openToBottom",a=parseInt(getStyle(d.scroll,"maxHeight"),10),i=!1;i=hasClass(o,d.container)?t.top-n-a<e:t.bottom-a<e,getXY(l.input)[1]>=e+a&&(i=!1),toggleClass(o,d.container,i),toggleClass(o,d.opts.appendTo,i)}())}function v(e){l.input=e}function g(){B(),document.addEventListener("click",w,!0),addClass(a,d.opts.appendTo),show(d.container),function(){if(!u){var e=browser.ipad?"touchend":"click";u=!0,addEvent(window,e,h),addEvent(window,"touchmove",m),nav.onBeforeGo(h)}}()}function h(e){!browser.ipad||p?e&&e.target&&gpeByClass(i,e.target)&&!gpeByClass("uMailWrite__button",e.target)&&!hasClass("uMailWrite__button",e.target)||hasClass(a,d.opts.appendTo)&&(removeClass(a,d.opts.appendTo),hide(d.container),function(){if(u){var e=browser.ipad?"touchend":"click";removeEvent(window,e,h),removeEvent(window,"touchmove",m),nav.onBeforeGo.off(h),u=!1}}()):p=!0}function w(e){var{target:t}=e;t&&!gpeByClass(i,t)&&(e.preventDefault(),e.stopImmediatePropagation(),h()),document.removeEventListener("click",w,!0)}function y(e){void 0===e&&(e={}),d.opts=extend(d.opts,e),k(),E(!0)}function k(){var e,t,n=d.opts.defaultItems,o=d.opts.items,a=[];for(e=0,t=n.length;e<t;++e)a.push(e);for(d.cache[""]=a,e=0,t=o.length;e<t;++e)b(e,o[e])}function b(e,t){var n,o,a,i="",r=d.opts.searchKeys,s={};for(n=0,a=r.length;n<a;++n)i+=" "+(t[r[n]]||"").replace(d.opts.delimeter," ").replace(/<[^>]*>/g,"");for(i+=(parseLat(i)||"")+(parseCyr(i)||""),i=trim(i.toLowerCase()).split(/\s+/),n=0;n<i.length;n++)for(o=1;o<=d.opts.wholeIndex;o++){var l=i[n].substr(0,o);s[l]||(d.index[l]||(d.index[l]=[]),d.index[l].push(e),s[l]=1)}}function S(){var e=trim(d.text);e&&ajax.post(d.opts.url,extend({str:e,mobile:1},d.opts.params||{}),{onDone:function(t){d.cache[e]=C(e).concat(t),T(d.cache[e],!0)}})}function C(e){if(!(e=trim(e.toLowerCase().replace(d.opts.delimeter," "))))return d.cache[""];var t=d.opts.wholeIndex;if(e.length<=t&&-1===e.indexOf(" "))return d.index[e]||[];var n,o,a=0,i="";for(n=0,o=(e=e.split(" ")).length;n<o;++n){var r=e[n].substr(0,t),s=d.index[r];if((!i||!s||s.length<a)&&(a=s?s.length:0,i=r),!a)return[]}var l=[],c=d.opts.searchKeys,u=c.length,_=e.length;for(n=0,o=d.index[i].length;n<o;++n){for(var p=d.index[i][n],m=d.opts.items[p],f=!1,v="",g=0;g<u;++g)v+=" "+(m[c[g]]||"").replace(d.opts.delimeter," ").replace(/<[^>]*>/g,"");v=(v+=(parseLat(v)||"")+(parseCyr(v)||"")).toLowerCase();for(var h=0;h<_;++h)if(-1===v.indexOf(" "+e[h])){f=!0;break}f||l.push(p)}return l}function E(e,t){if(d.cache[""])if(t=void 0!==t?t:trim(d.text),d.lastQ!==t||e){d.lastQ=t,clearTimeout(d.requestTimer);var n=d.cache[t];n?T(n,!0):(T(n=C(t),!d.opts.url),d.opts.url&&(d.requestTimer=setTimeout(S,d.opts.requestWait)))}else g()}function T(e,t){var n=[];d.shown=[];for(var o=e.slice(0,d.opts.maxItems),a=0,i=o.length;a<i;++a){var s=o[a];isArray(s)||(s=d.opts.items[s]),d.shown[s[0]]||(d.shown[s[0]]=s,n.push(I(s)))}d.container&&d.opts.appendTo.contains(d.container)||(d.container=ce("div"),addClass("Mention",d.container),d.scroll=ce("div"),addClass("ScrollView Mention__scroll",d.scroll),(0,Qe.setScrollView)(d.scroll,{topBanner:!1}),d.opts.appendTo.appendChild(d.container),d.container.appendChild(d.scroll),addEvent(d.scroll,"touchmove",(e=>{hasClass(r,d.scroll)&&preventEvent(e)}))),toggleClass("Mention_empty",d.container,!n.length),val(d.scroll,n.join("")),d.scroll.scrollTop=0,P(),setTimeout((()=>{toggleClass(r,d.scroll,!function(){if(!browser.ios&&!browser.ipad)return!0;if(d.scroll.scrollHeight>d.scroll.offsetHeight)return!0;return!1}())}),0)}function I(e){var[t,n,o,a]=e,i=e[10];return'<div class="MentionItem" onclick="Mention.onSelect(\''+t+'\');" onmouseover="Mention.onItemHover(this);">\n              <div class="MentionItem__cell">\n                '+(i||'<img src="'+a+'" class="MentionItem__img"/>')+'\n              </div>\n              <div class="MentionItem__cell MentionItem__cell_name">\n                <div class="MentionItem__name">'+n+'</div>\n                <div class="MentionItem__tag">'+o+"</div>\n              </div>\n            </div>"}function M(){var e=geByClass1(s,d.container),t=e.offsetTop;d.scroll.scrollTop=t-e.offsetHeight-parseInt(getStyle(d.scroll,"paddingTop"),10)}function P(e){void 0===e&&(e=null);var t=geByClass("MentionItem",d.container);if(t.length){var n=t.find((e=>hasClass(s,e)));e?(removeClass(s,n),addClass(s,e)):n||addClass(s,t[0])}}function L(e,t){setTimeout((()=>{v(t),f()}),0)}var B=(0,c.default)();return{onKeyUp:function(n,o){n.keyCode!==e&&n.keyCode!==t&&(E(!0),v(o),f())},onKeyDown:function(i,r){var l;hasClass(a,d.opts.appendTo)&&(i.keyCode===e?(!function(){var e=geByClass1(s,d.container);if(e){var t=domPS(e);t&&(P(t),M())}else P(),M()}(),i.preventDefault()):i.keyCode===t?(!function(){var e=geByClass1(s,d.container);if(e){var t=domNS(e);t&&(P(t),M())}else P(),M()}(),i.preventDefault()):i.keyCode===n?(l=geByClass1(s,d.container))&&(l.click(),1)&&i.preventDefault():i.keyCode===o&&(h(),i.preventDefault()))},onFocus:L,onClick:L,onSelect:function(e){var t=d.shown[e];t&&function(e){if(!e)return!1;var t,n=e[2].replace("@",""),o=l.curValue.substr(0,l.curPos),a=l.curValue.substr(l.curPos),i=!!o.match(/\#[\w_\.\u0400-\u04FF]+$/i);d.opts.preferDomain&&e[9]&&(i=!0);i||(t=replaceEntities(e[8]||e[1]));var r=new RegExp("^(@|\\*)"+escapeRE(l.curTerm)+"(?:\\s+\\((?:(.*?)\\))?\\s*)?","");a=a.replace(r,((e,o,a)=>{var r=o+n+" ";return i||(r+="("+t.replace(/[\(\)\]\[]/g,"")+") "),r})),i||!o||o.match(/[\.\(\)\?\!\s\n\r\'\"\u00BB\u00AB \u00A0]$/)||(a=" "+a);h(),val(l.input,o+a),elfocus(l.input),d.opts.afterInsert&&d.opts.afterInsert(l.input)}(t),h()},onItemHover:function(e){P(e)},onOpen:B,init:function(e){void 0===e&&(e={}),_(),d.opts=extend({appendTo:document.body,url:"hints",params:{act:"a_json_friends",from:"composer"},delimeter:/[\s\(\)\.,\-]+/g,requestWait:300,wholeIndex:2,maxItems:51,searchKeys:[1,4],preferDomain:!1,defaultItems:[],items:[],afterInsert:()=>{}},e),addClass("Mention_inited",d.opts.appendTo),d.scroll&&removeClass(r,d.scroll),k()},update:y,addItems:function(e){if(d.opts.defaultItems){e=d.opts.defaultItems.concat(e);var t={};e.filter((e=>!t[e[0]]&&(t[e[0]]=!0,!0))),y({defaultItems:e,items:e})}}}}();window.Mention=zl;n(73210),n(22875),n(61982),n(21190);var Ql=n(10708),Yl=n(13370),Xl={URL:"special-event",ACT:"getPopup",start:function(e,t){if(t.stopPropagation(),t.preventDefault(),this.id=window.domData(e,"id"),this.id&&(this.sendStats("click"),!this.timeoutHandle)){var n=Number(window.domData(e,"v"))||0;this.duration||(this.duration=Number(window.domData(e,"duration"))||0),this.animationUrl||(this.animationUrl=String(atob(window.domData(e,"animation-url")))||0),this.width||(this.width=Number(window.domData(e,"width"))||0),this.height||(this.height=Number(window.domData(e,"height"))||0),this.hasPopup=Boolean(window.domData(e,"popup")),this.duration&&this.animationUrl?!this.animationData||!this.animationData.v||"number"==typeof this.v&&this.v!==n?(this.v=n,Promise.all([this._getAnimation(),this._loadAnimator()]).then((e=>{var[t,n]=e;this.animationData=JSON.parse(t),this.animator=n,this._play()}))):this._play():this.hasPopup&&this._loadPopupData((()=>this._showPopup()))}},_getAnimation:function(){return new Promise((e=>{var t=new XMLHttpRequest;t.open("GET",this.animationUrl,!0),t.send(),t.onreadystatechange=()=>{4===t.readyState&&e(t.responseText)}}))},_showPopup:function(){window.ImageStatus&&window.ImageStatus.open&&window.ImageStatus.open({user_id:vk.id,special_id:this.id})},_loadPopupData(e){0},_play:function(){if(this.animator){this.frame||(this.frame=document.createElement("div"),this.frame.className="special_event_frame",document.body.appendChild(this.frame)),this.width&&(this.frame.style.width=this.width+"px"),this.height&&(this.frame.style.height=this.height+"px"),this.frame.style.display="block";var e=this.animator.loadAnimation({container:this.frame,renderer:"svg",loop:!1,autoplay:!0,animationData:this.animationData});this._loadPopupData(),this.timeoutHandle=setTimeout((()=>{e.stop(),e.destroy(),this.frame.style.display="none",this.timeoutHandle=null,this.sendStats("showed"),this._showPopup()}),this.duration)}},init(e){var{platform:t,animatorLoader:n}=e;this.platform=t,this._loadAnimator=n},popupAction(){this.sendStats("popup_action");var e=curBox();e&&setTimeout((()=>{e.hide()}),0)},sendStats(e){e&&(0,Pa.saveStatlogEvents)({name:"special_event",value:e,keys:[this.platform,this.id]})}},Jl=Xl;Jl.init({platform:"mvk",animatorLoader:()=>Promise.all([n.e(8695),n.e(5544)]).then(n.bind(n,68440)).then((e=>e.default))}),window.SpecialEvent=Jl;var Zl={onIframeReady:(0,c.default)("{ is_api, check_transfer_url, on_success_url }"),onPostMessage:(0,c.default)(),onAcceptCookieClick:(0,c.default)()};function ec(e){var t,{origin:n}=e;if(n.match(/^https?:\/\/([a-zA-Z0-9\-\.]+\.)?money\.mail\.ru$/)){try{t=JSON.parse(e.data)}catch(e){t={}}"billing"===t.type&&Zl.onPostMessage(t.action,t.action_params)}}Zl.onIframeReady((()=>{addEvent(window,"message",ec),window.cur.destroy.push((()=>{removeEvent(window,"message",ec)}))})),window.BasisMoneyTransfer=Zl;var tc=Zl;tc.onPostMessage((e=>{"waiterStart"!==e&&"3dsPage"!==e||document.activeElement&&document.activeElement.blur()}));tc.onPostMessage(((e,t)=>{"resizeFrame"===e&&setStyle(geByClass1("pageMoneyTransfer__iframe"),"height",t.height+40)}));var nc=["touchstart","touchend","touchmove","touchcancel"];tc.onIframeReady((e=>{e.is_api&&registeredEvents.forEach((e=>{var[t,n,o]=e;nc.indexOf(n)>=0&&removeEvent(t,n,o)}))})),tc.onPostMessage((e=>{"resizeFrame"!==e&&"pageLoad"!==e||window.scrollTop(0)}));var oc,ac,ic,rc="pageMoneyTransfer",sc="pageMoneyTransfer_error",lc="pageMoneyTransfer__errorText",cc="pageMoneyTransfer__iframe";tc.onIframeReady((e=>{uc(),ac={checkUrl:e.check_transfer_url,onSuccessUrl:e.on_success_url},pc(),window.cur.destroy.push(mc)})),tc.onPostMessage(((e,t)=>{if("paySuccess"===e)addClass("pageMoneyTransfer_success",geByClass1(rc));else if("payError"===e)mc(),addClass(sc,geByClass1(rc)),val(geByClass1(lc),t.descr);else if("session_fail"===e){if(dc)return void _c();mc(),addClass(sc,geByClass1(rc)),addClass("pageMoneyTransfer_errorCookie",geByClass1(rc))}else if("putPixel"===e&&"page_load"===t.alias){var n=null;(0,o.isVkWebView)()&&((0,o.isIosWebView)()?n="iphone":isAndroidWebView()&&(n="android")),n||(n=""),(0,o.statlogsValueEvent)("money_transfers",0,"iframe_loaded",n)}}));var dc=0;function uc(){var e=geByClass1(cc);if(e){var t=e.contentWindow.document;t.open("text/html","replace"),t.write(attr(e,"data-html")),t.close()}else setTimeout(uc,2e3)}function _c(){var e=geByClass1(cc);if(e){var t=ce("div",{innerHTML:attr(e,"data-html")});hide(e),geByClass1(rc).appendChild(t),ge("payment_form").submit()}else setTimeout(_c,2e3)}function pc(){var{checkUrl:e,onSuccessUrl:t}=ac;oc=setInterval((()=>{ic=ajax.post(e,{},{onDone(e,n,o){if(1===e||3===e){if(mc(),o)return void nav.go(o,null,{replace:!0});"/"===t[0]?nav.go(t,null,{replace:!0}):location.href=t}else 2===e&&(mc(),addClass(sc,geByClass1(rc)),val(geByClass1(lc),n))}})}),2e3)}function mc(){oc&&(clearInterval(oc),oc=null),ic&&(ic.abort(),ic=null)}tc.onAcceptCookieClick((()=>{var e=window.open("https://top-fwz1.mail.ru/counter2?id=1;","","width=300; height=300");setTimeout((()=>{e.close();var t=geByClass1(cc),n=clone(t);removeClass(sc,geByClass1(rc)),replace(n,t);var o=n.contentWindow.document;o.open("text/html","replace"),o.write(attr(t,"data-html")),o.close(),pc()}),500),dc++}));var fc={_onMouseDown:(0,c.default)(),_onCancelClick:(0,c.default)()};window.MoneyTransferButton=fc;var vc=fc,gc="-webkit-tap-highlight-color";vc._onMouseDown((e=>{for(var t=e;!(!(t=gpeByClass("msg_item",t))||t&&attr(t,"data-id")););t&&(setStyle(t,gc,"transparent"),setTimeout((()=>function(e){setStyle(e,gc,"initial")}(t)),400))}));var hc,wc,yc=!1,kc=null;function bc(){kc&&Btn.setLoading(kc,!1),hc&&(clearInterval(hc),hc=null),wc&&(wc.abort(),wc=null)}vc._onCancelClick(((e,t)=>{t?(yc=!1,preventEvent(e),cancelEvent(e),lockButton(t)):(yc=!0,t=e.$btn,e=null,kc=t,Btn.setLoading(t,!0)),function(e){var{cancelUrl:t}=e;hc=setInterval((()=>{wc=ajax.post(t,{_ajax:1},{onDone(e){if(1===e){if(yc){var t=arguments[1];return kc.closest(".BtnStack").outerHTML='\n            <div class="notification__tempText">'+t+"</div>\n          ",void bc()}var n=window.scrollTop();nav.go(location.pathname+location.search,null,{replace:!0}),cur.destroy.push((()=>{window.scrollTop(n)})),bc()}}})}),1500)}({cancelUrl:attr(t,"href")}),window.cur.destroy.push(bc)}));need("attr"),need("geByClass1");var Sc=need("preventEvent"),Cc=need("Popup");window.SendMoneyForm={},SendMoneyForm._onAmountChange=Vc,SendMoneyForm._onSubmit=zc,SendMoneyForm._onRecommAmountChange=Wc,SendMoneyForm._onAutoAcceptToggle=Qc,SendMoneyForm._onNoAmountToggle=Yc,SendMoneyForm._onChooseCardClick=$c,SendMoneyForm._onChooseCardCancelClick=jc,SendMoneyForm._onChooseCardContinueClick=Fc,SendMoneyForm._onCardSelect=Uc,SendMoneyForm._onVkPayOfferToggle=Hc;var Ec="sendMoneyForm_error_min",Tc="sendMoneyForm_error_max",Ic="sendMoneyForm_addCardVisible",Mc="sendMoneyForm_requestedVisible",Pc="sendMoneyForm_recommErrorMin",Lc="sendMoneyForm_recommErrorMax",Bc="sendMoneyForm_noAmount",Ac="sendMoneyForm_autoAccept",Oc=".sendMoneyForm",xc=".sendMoneyForm__cardsPopup",Rc=".sendMoneyForm__input_amount",Nc=".sendMoneyForm__recommAmountInput input",Dc=".sendMoneyForm__amountNote_requestAmount";function Fc(){var e=(0,K.$)('.Control__native[name="card"]:checked').value,t=(0,K.$)('.Control__native[name="card"]:checked ~ .Control__label').innerText;(0,K.$)('input[name="accept_card"]').value=e,(0,K.$)('input[name="accept_card"]').setAttribute("data-value",e),(0,K.$)(".sendMoneyForm__chooseCard").innerText=t,Cc.close()}function Uc(e){var t="-1"===e.value;(0,K.$)(Oc).classList.toggle(Ic,t)}function Hc(e){var t=e.checked,n=(0,K.$)(".sendMoneyForm__sendButton");t?n.removeAttribute("disabled"):n.setAttribute("disabled",!0)}function jc(){Cc.close()}function $c(){var e=(0,K.$)(xc);Cc.open(e)}function Vc(e){e||(e=(0,K.$)('input[name="amount"]')),qc(e),Gc(e,6);var t=e.closest(Oc),n="1"===t.getAttribute("data-is-chat-request"),o=Number(e.value),a=Number(t.getAttribute("data-max-amount"));if(t.classList.remove(Ec),t.classList.remove(Tc),n||o>a&&t.classList.add(Tc),n){var i=Kc(),r=Number(t.getAttribute("data-min-amount"))*(i?2:1),s=function(e,t){var n=(0,K.$)('input[name="amount"]').closest(Oc),o=Number(n.getAttribute("data-min-amount")),a=Number(n.getAttribute("data-max-amount")),i=Number(n.getAttribute("data-chat-members-count")),r=Math.ceil(e/(i-(t?0:1)));return Math.min(a,Math.max(o,r))}(o,i);if((0,K.$)(Nc).value=s,t.classList.remove(Lc),t.classList.remove(Pc),!r||o>=r){var l=i?o-s:o;(0,K.$)(Dc).innerText=l,t.classList.add(Mc)}else t.classList.remove(Mc)}}function Wc(e){qc(e),Gc(e,6);var t=e.closest(Oc),n=Number(e.value),o=t.getAttribute("data-max-amount");t.classList.remove(Lc),t.classList.remove(Pc),n>o&&t.classList.add(Lc)}function Kc(){var e=(0,K.$)('input[name="participiate"]');return e&&e.checked}function qc(e){e.value=parseInt(e.value,10)||""}function Gc(e,t){e.value=e.value.slice(0,t)}function zc(e,t){var n=t.$(Rc).value,o=Number(n),a=Number(t.getAttribute("data-min-amount")),i=Number(t.getAttribute("data-max-amount")),r="1"===t.getAttribute("data-is-chat-request"),s=!1;(t.classList.remove(Ec),t.classList.remove(Tc),r&&(t.classList.remove(Lc),t.classList.remove(Pc)),(0,K.$)(Oc).classList.contains(Bc))||(o<a*(!!r&&Kc()?2:1)||!n||n!==o.toString()?(t.classList.add(Ec),s=!0):o>i&&!r&&(t.classList.add(Tc),s=!0));if(r){var l=t.$(Nc).value,c=Number(l);c<a||!l||l!==c.toString()?(t.classList.add(Pc),s=!0):c>i&&(t.classList.add(Lc),s=!0)}if(s)Sc(e),stopEvent(e);else{Sc(e),stopEvent(e),t.insertAdjacentHTML("beforeend",'<input id="submit" type="submit" style="display: none" />');var d=(0,K.$)("#submit");ajax.click(d)}}function Qc(e){(0,K.$)(Oc).classList.toggle(Ac,e.checked),e.checked?(0,K.$)('input[name="accept_card"]').value=(0,K.$)('input[name="accept_card"]').getAttribute("data-value"):(0,K.$)('input[name="accept_card"]').value=""}function Yc(e){(0,K.$)(Oc).classList.toggle(Bc,e.checked)}var Xc=n(35796),Jc=n.n(Xc);window.MoneyLink={copy(e){var{$btn:t}=e,n=t.nextElementSibling,o=geByClass1("TextInput__native",gpeByClass("Pad__content",t));copyToClipboard(o)&&(MoneyLink.lastCopyLabel&&hide(MoneyLink.lastCopyLabel),MoneyLink.lastCopyLabel=n,show(n))},genQRCode(e,t){if(!MoneyLink.qrcode){var n,o,a=i.colorScheme.isDarkScheme();t?(n=geByClass1("snippet__icon",geByClass1(t)),o=a?128:80):(n=ge("money_link_qr"),o=200);var r={isShowLogo:!0};a&&(r.isShowBackground=!0,r.backgroundColor="#fff"),val(n,Jc().createQR(e,o,"qr-code",r));var s=i.colorScheme.subscribe((()=>{s(),this.genQRCode(...arguments)}))}}};var Zc=need("Voting"),ed=function(){var e,t,n=[],o=!1,a=!1,i={};function r(e){return function(){if(!o)return e.apply(this,arguments)}}function s(e){return"A"===e.tagName}function l(){a=n.length>0,toggleClass("vk_messages_actions_visible",document.body,a)}function c(){a&&(i={},each(n,(function(e,t){removeClass("mi_selected",geByClass1("_msg"+t))})),o=!1,n=[],l())}function d(){return!!window.getSelection&&window.getSelection().toString().length>0}function u(e,t,a,i){void 0===i&&(i=!1),o=!0,lockButton(e),im.off(),ajax.click("/mail",{},{url_params:{act:i?"spam":"delete",peer:t,hash:a,ids:n.join(","),community:td()}})}function _(){return Boolean(e)}function p(){ge("dialogs")&&_()?addClass("vk_dialogs_forwarding",document.body):e="",c()}return page.onChange(p),mail.onShowDialogsPageFromCache(p),mail.onShowDialogFromCache(p),mail.onShowDialogsPageFromCache(Ql.showHeader),mail.onShowDialogFromCache(Ql.showHeader),mail.onMessagesRepainted((function(){each(n,(function(e,t){addClass("mi_selected",geByClass1("_msg"+t))}))})),{onMessageClick:r((function(e){var t=e.target,o=e.currentTarget,a=s(t)||s(t.parentNode);t.closest("."+Zc.cls)?e.stopPropagation():(a&&c(),browser.uc_mini||d()||a||setTimeout((function(){var e,t,a;d()||(e=o,t=attr(e,"data-id"),(a=n.indexOf(t))>=0?(n.splice(a,1),removeClass("mi_selected",e),delete i[t]):(n.push(t),addClass("mi_selected",e),i[t]=hasClass("msg_item_important",e)),l(),function(){var{lang:e}=window,t=Math.max(n.length,1);val(geByClass1("messagesActions__row_counter"),langNumeric(t,e.mobile_mail_messages_selected).replace("{count}",t))}())}),40))})),remove:r(u),reply:r((function(e,t,a){o=!0,lockButton(e),ajax.click("/attachments",{},{url_params:{act:"add",target:"mail"+t,hash:a,object:"mail"+n.join(";"),community:td()}})})),forward:r((function(a,i){o=!0,lockButton(a),e="mail"+n.join(";"),t=i;var r=td(),s=r?"?community="+r:"";nav.go(location.pathname+s,null,{ignore_cur_process:!0})})),spam:r((function(e,t,n){u(e,t,n,!0)})),close:r(c),toggleImportant:r((function(e){var t,o=n.length,a=0;for(t=0;t<o;t++)if(!i[n[t]]){a=1;break}for(t=0;t<o;t++)toggleClass("msg_item_important",geByClass1("_msg"+n[t]),1===a);ajax.post("/mail",{_ajax:1,act:"mark_important",ids:n,val:a,hash:e}),c()})),hasFwdMessages:_,attachFwdMessages:function(n){ajax.click("/attachments",{},{url_params:{act:"add",target:"mail"+n,hash:t,object:e,community:td()}}),e=""}}}();function td(){return nav.getQuery("community")}window.MessagesActions=ed;var nd=n(54259),od=n(24816),ad=n(26271),id=Object.entries(od.EMOJI_HINTS).map((e=>{var[t,[n,o]]=e;return[new RegExp("(\\s|^)("+(0,lo.escapeRE)(o)+(o.endsWith(")")||o.endsWith("(")?"+":"")+")([\\s\\.,]|$)","gi"),t]})),rd={q:"й",w:"ц",e:"у",r:"к",t:"е",y:"н",u:"г",i:"ш",o:"щ",p:"з","[":"х","]":"ъ",a:"ф",s:"ы",d:"в",f:"а",g:"п",h:"р",j:"о",k:"л",l:"д",";":"ж","'":"э",z:"я",x:"ч",c:"с",v:"м",b:"и",n:"т",m:"ь",",":"б",".":"ю","/":"."};ad.browser.mac?rd["\\"]="ё":rd["`"]="ё";var sd=new RegExp("["+(0,lo.escapeRE)(Object.keys(rd).join(""))+"]","gi"),ld=e=>e.replace(sd,(e=>rd[e])),cd=Object.entries(rd).reduce(((e,t)=>{var[n,o]=t;return e[o]=n,e})),dd=new RegExp("["+(0,lo.escapeRE)(Object.keys(cd).join(""))+"]","gi"),ud=e=>e.replace(dd,(e=>cd[e])),_d=-184940019;var pd=class{constructor(e){this.config={mvk:!1,peerId:null,maxInputLength:256},this.setConfig(e)}setConfig(e){Object.assign(this.config,e)}getQueries(e){if(!e||e.length>this.config.maxInputLength)return[""];var t=window.Wall&&window.Wall.replyNamesRE||window.post&&window.post.replyNamesRE;if(t){var n=t();n&&(e=e.replace(n,""))}e=e.toLowerCase(),e=(e=id.reduce(((e,t)=>{var[n,o]=t;return e.replace(n,((e,t,n,a)=>(t||"")+(0,nd.emojiByteHexToSymbol)(o)+(a||"")))}),e)).replace(/^[\s\uFEFF\xA0]+|\n+$/g,"");var o=[e=(0,nd.emojiRemoveSkinToneModifiers)(e)];for(var a of[...o])o.push(ld(a)),o.push(ud(a));for(var i of[...o])o.push(i.replace(/ё/g,"е")),o.push(i.replace(/е/g,"ё"));for(var r of[...o])o.push(r.replace(/[.!?]+$/,""));return Object.keys(o.reduce(((e,t)=>(e[t]=1,e)),{}))}isBotLinkEnabled(){return(0,A.partConfigEnabled)("stickers_bot_link")&&this.config.peerId!==_d}getBotLinkUrl(){return this.config.mvk?"/mail?act=show&peer="+_d:"/im?sel="+_d}getBotLinkImageUrl(e,t){return void 0===t&&(t="light"),"/images/stickers_suggestions_bot_"+t+"_"+e+".png"}getBotLinkClickStatName(){return"stickers_suggestions_bot_link"}getBotLinkClickStatKeys(){return[]}isMoneyTransferEnabled(){return(0,A.partConfigEnabled)("stickers_money_transfer_suggestions")&&(this.isMoneySendEnabled()||this.isMoneyRequestEnabled())}isMoneySendEnabled(){return Boolean(this.config.moneyTransfer&&this.config.moneyTransfer.send)}isMoneyRequestEnabled(){return Boolean(this.config.moneyTransfer&&this.config.moneyTransfer.request)}};window.StickersHints=function(){var e,t,n,a,r,s,l=864e5,c=!0,d=0,u=new pd({mvk:!0});od.EMOJI_HINTS;function _(e){var{cur:o}=window;if(n=geByTag1("textarea",gpeByTag("form",geByClass1("cp_sticker_btn"))),u.setConfig(e),n&&!n.initialized){function e(e){var t=n.value.length;t-d>1,d=t,p(),c&&(!function(){w()&&vkNow()-y()>l*(2+Math.random())&&m();e=function(e){e*=1e3,w()&&e>y()&&m()},ajax.post("/attachments",{_ajax:1,act:"stickers_hints_change_date"},{onDone:e});var e}(),c=!1)}n.initialized=!0,r=geByClass1("stickersHints"),a=geByClass1("stickersHints__content"),addEvent(n,"focus",p),addEvent(n,"input",e),addEvent(document,"click",f),onBodyResize(v),onBodyResize(b),o.destroy.push((function(){r=null,a=null,n=null,removeEvent(n,"focus",p),removeEvent(n,"input",e),removeEvent(document,"click",f),onBodyResize("__clear",v),onBodyResize("__clear",b),t&&t.destroy(),d=0})),document.activeElement===n&&p()}}function p(){var o;n&&(e&&clearTimeout(e),o=function(o){var s=u.getQueries(n.value).find((e=>o.hasOwnProperty(e))),l=s&&o[s];l?e=setTimeout((function(){var e,n,o=l.userStickers||[],c=l.promotedStickers||[];if(o.length>0||c.length>0){var d=[];each(o,(function(e,t){d.push(g({stickerId:t,query:s,isPromoted:!1}))})),each(c,(function(e,t){d.push(g({stickerId:t,query:s,isPromoted:!0}))})),u.isBotLinkEnabled()&&d.push((e=(0,L.getStickerSize)(),n="light",i.colorScheme.isDarkScheme()&&(n="dark"),Wd.html({inner:[{inner:[{class:"th_img",src:u.getBotLinkImageUrl(e,n),tag:"img"}],class:"sticker_thumb",href:u.getBotLinkUrl(),onclick:"StickersHints.onSuggestionsBotLinkClick();",target:"_blank",tag:"a"}],class:"sticker_item",tag:"div"}))),a.innerHTML=d.join(""),show(r),v(),b(),(t=new Scroller(r)).init()}}),300):(t&&t.destroy(),hide(r))},s?o(s):w()?(s=lsGet("stickers_keywords").keywords,o(s)):h((function(e){s=e,k(e),o(e)})))}function m(){h((function(e){s=e,k(e),p()}))}function f(t){var o=t.target;o===n||gpeByClass(o,"stickersHints")||(hide(r),e&&clearTimeout(e))}function v(){attr(a,"style","")}function g(e){var t=e.isPromoted,n=t?"":"onclick=\"return StickersHints.onStickerThumbClick(event, this, {{stickerId}}, '{{stickerReferrer}}');\"",o=t?'href="/attachments?'+["act=stickers_store","target="+attr(r,"data-target"),"sticker_id={{stickerId}}","from=inline","sticker_referrer={{stickerReferrer}}"].join("&")+'"':"",a=Stickers.getStickerUrl(e.stickerId,(0,L.getStickerSize)());return('<div class="sticker_item sticker{{stickerId}} {{promotedClass}}">        <a class="sticker_thumb thumb_item" '+o+" "+n+'>          <img class="th_img" src="{{stickerUrl}}" />        </a>      </div>').replace(/{{stickerId}}/g,e.stickerId).replace(/{{stickerUrl}}/g,a).replace("{{promotedClass}}",t?"sticker_item_promoted":"").replace("{{stickerReferrer}}","suggestion_"+e.query)}function h(e){ajax.post("/attachments",{_ajax:1,act:"stickers_hints_keywords"},{onDone:function(t){e(function(e){var t={};return each(e,(function(e,n){var o=n.user_stickers,a=n.promoted_stickers;each(n.words,(function(e,n){t[n]={userStickers:o,promotedStickers:a}}))})),t}(t))}})}function w(){return Boolean(lsGet("stickers_keywords"))}function y(){return lsGet("stickers_keywords").time}function k(e){!e||isEmpty(e)?lsSet("stickers_keywords"):lsSet("stickers_keywords",{keywords:e,time:vkNow()})}function b(){var e=geByClass1("stickersHints__callout");if(e){var t=e.offsetWidth-4,n=t/64,o=n%1;o<.3?n=Math.floor(n)-.5:o>.7&&(n=Math.ceil(n)-.5);var a=Math.round(t/n-8);each(geByClass("sticker_item",e),(function(e,t){var n=geByClass1("sticker_thumb",t),o=geByClass1("th_img",t);setStyle(t,"width",a),setStyle(t,"height",a),setStyle(n,"width",a),setStyle(n,"height",a),setStyle(o,"height",a)}))}}return onDOMReady((function(){lsCheck()&&!geByClass1("vk_stickers_hints_support_no")&&(post.onStickersInit((function(){_()})),geByClass1("stickersHints")&&_())})),ajax.onRedirect((function(e){qs2obj(e.split("?")[1]).invalidate_stickers_hints&&m()})),post.onReplyClick((function(e){var{cur:t}=window;e,setTimeout(p,10),t.destroy.push((function(){;""}))})),{actualizeVisibility:p,init:_,onStickerThumbClick:function(t,o,a,i){window.isNewMail&&preventEvent(t);var s=gpeByClass("sticker_item",o),l=geByClass1("th_img",s);return attr(s,"style",""),attr(o,"style",""),attr(l,"style",""),hide(r),n.value="",e&&clearTimeout(e),post.sendSticker(o,a,!0,i)},onCheckboxLabelClick:function(e,t){setTimeout((function(){!function(e,t,n){var o={_ajax:1,act:"stickers_hints_enabled",value:e,hash:t};ajax.post("/attachments",o,{onDone:n})}(val(geByTag1("input",e.parentElement))?1:0,t,m)}),0)},onCheckboxAutoAnimationLabelClick:function(e,t){setTimeout((function(){!function(e,t,n){var o={_ajax:1,act:"stickers_auto_animation_enabled",value:e,hash:t};ajax.post("/attachments",o,{onDone:n})}(val(geByTag1("input",e.parentElement))?1:0,t,m)}),0)},onSuggestionsBotLinkClick:function(){(0,o.statlogsValueEvent)(u.getBotLinkClickStatName(),0,...u.getBotLinkClickStatKeys())},showNewConvoHints:function(){var n=StickersCache.getStickers()[-3];if(n&&n.stickers.length){e&&clearTimeout(e);var o=n.stickers.reduce(((e,t,n)=>{var[o]=t;return e.push(g({stickerId:o,query:"hi",isPromoted:!1})),e}),[]);a.innerHTML=o.join(""),show(r),v(),b(),(t=new Scroller(r)).init()}}}}();var md=need("nav");window.PinnedMsg={onHideClick:befall(),getByMsgId:function(e){return(0,K.$)(fd(e))}};var fd=e=>'.pinnedMsg[data-msg-id="'+e+'"]';function vd(e,t){var n=t.parentNode.getAttribute("data-msg-id");window.isNewMail&&n?(e.preventDefault(),uMessenger.goToMsg(Number(n))):md.go(t,e)}PinnedMsg._onClick=vd,PinnedMsg._onHideClick=PinnedMsg.onHideClick,window.SettingsRow_select={},SettingsRow_select._onChange=wd;var gd=".settingsRow",hd=".settingsRow__description";function wd(e,t){!function(e){var{$select:t,label:n}=e;t.closest(gd).$(hd).textContent=n}(t),d.default.handle(e,t)}n(19704),n(40111),n(74141);var yd=n(95001);function kd(e){pushNotifier.canBeEnabled().then((t=>{var n=!!e.$control&&geByTag1("input",e.$control);n&&(t?pushNotifier.setupSubscription().then((()=>{!function(e){var t=ce("input",{type:"submit"},{display:"none"});e.$control.form.appendChild(t),ajax.click(t),e.$control.form.removeChild(t)}(e)})).catch((e=>{PushNotifier.PUSH_NOTIFIER_BLOCKED_BY_BROWSER_SETTINGS===e?(n.checked=!1,addClass("Popup_open",geByClass1("pageAllowPushPopup"))):n.checked=!1})):n.checked=!1)}))}window.SettingsNotifyPush={},SettingsNotifyPush._onSwitch=kd;n(19774),n(15099),n(61969);window.FriendsRecommendedSlider={init:function(){window.cur&&(Nd($("."+Ad)),cur.destroy.push((()=>{Od=null,xd=null,Rd=null})))},hideRecommended:function(e,t,n,a){var i=gpeByClass(Sd,e);if(!i)return a&&(0,o.cancelEvent)(a);var r=Ud(i),s=domData(i,"code")||domData(r,"code"),l=domData(r,"ref");!function(e){var t=Ud(e);remove(e),Rd=null,xd=null,Dd().length||Fd(t)}(i);var c=bd+obj2qs({act:"hide_possible",hash:n,id:t,track_code:s,ref:l});return ajax.post(c,{_ajax:1}),a&&(0,o.cancelEvent)(a)},hideBlock:Fd,acceptFriend:function(e,t,n,a){if(hasClass(Cd,e)||hasClass(e))return a&&(0,o.cancelEvent)(a);var i=gpeByClass(Sd,e),r=e.querySelector(".prettyCard__buttonText"),s=Ud(e),l=domData(i,"code")||domData(s,"code"),c=domData(s,"ref");return addClass(Ed,e),Friends.accept(t,n,"user_rec",0,c,l,((t,n)=>{var a=t||getLang("mobile_friends_feed_recom_got_notification");removeClass(Ed,e),addClass(Cd,e),r.innerHTML=a,function(e){var t=function(e){var t=domCA(e,Bd);if(!t)return;return geByClass1(Id,t)}(e);addClass(Md,t)}(e);var i=(0,o.isObject)(null==n?void 0:n.friend_request_add_sent_message_nudge)?n.friend_request_add_sent_message_nudge:void 0;if(i){var{url:s,text:l}=i;(0,W.init)({text:a,type:W.SNACKBAR_TYPE_SUCCESS,vertical:!0,action:{text:l,url:s,callback:(e,t)=>{var{id:n}=t;(0,W.close)(n),(0,o.cancelEvent)(e),window.nav.go(s)}}})}}),((t,n)=>{2===t&&nav.hard_go(n),removeClass(Ed,e)})),a&&(0,o.cancelEvent)(a)},onOpenUser:function(e){var t=gpeByClass(Sd,e);if(!t)return;var n=Ud(t),o=domData(t,"uid")||"",a=domData(t,"code")||domData(n,"code"),i=domData(n,"ref");FriendsStats.log(FriendsStats.EVENTS.EVENT_OPEN_USER,{uid:o,ref:i,trackCode:a})},onScroll:throttle(Nd,50)};var bd="/friends",Sd="prettyCard",Cd="prettyCard__button_accepted",Ed="prettyCard__button_loading",Td="recommended_carousel",Id="prettyCard__closeButton",Md="prettyCard__closeButton_hidden",Pd="Slider__line",Ld="Slider__scroll",Bd=".prettyCard",Ad="friendsRecommendedSliderWrap",Od=null,xd=null,Rd=null;function Nd(e){if(!Od&&e&&(Od=Ud(e)),Od&&(Od._lastScroll=Od.scrollLeft,!e.ajaxIsRunning)){var t=Od.scrollLeft,n=function(){if(xd)return xd;if(!Od)return{};var e=getSize(Od)[0],t=getX(Od),n=Dd(),o=getX(n[0])-t,a=getSize(n[0])[0],i=getX(n[1])-t-o-a,r=Math.floor(a/3);return xd={width:e,itemWidth:a+i,leftMargin:o,part:r,scrollWidth:Od.scrollWidth}}(),o=Math.max(0,Math.floor((t-n.leftMargin)/n.itemWidth)),a=Math.max(0,Math.floor((t+n.width-n.leftMargin)/n.itemWidth));o*n.itemWidth+n.itemWidth-n.part<t&&o++,a*n.itemWidth+n.part>t+n.width&&a--;var i=Dd();o=Math.max(0,o),a=Math.min(i.length,a);for(var r=domData(Od,"ref"),s=domData(Od,"code"),l=o;l<=a;l++){var c=i[l];if(c&&!c.viewed){c.viewed=!0;var d=domData(c,"uid")||"",u=domData(c,"code")||s;FriendsStats.log(FriendsStats.EVENTS.EVENT_VIEW_USER,{uid:d,pos:l,ref:r,trackCode:u})}}!e.allLoaded&&t+n.width>=n.scrollWidth/2&&function(e){(e=Ud(e)).currentPage=e.currentPage||1;var t=domData(e,"next")||"";if(e.allLoaded||!t||e.currentPage++>=3)return void(e.allLoaded=!0);var n=domData(e,"code")||"",o=domData(e,"ref")||"",a=intval(domData(e,"friend-id")),i=bd+obj2qs({act:Td,next:t,ref:o,friendId:a,track_code:n});e.ajaxIsRunning=!0,ajax.post(i,{_ajax:1},{onDone(t,n){if(t){var o=geByClass1(Pd,e),a=cdf(t);append(a,o),xd=null,Rd=null}domData(e,"next",n||null),e.allLoaded=!n,e.ajaxIsRunning=!1},onFail:()=>{setTimeout((()=>e.ajaxIsRunning=!1),500)}})}(e)}}function Dd(){return Rd||(Od&&(Rd=geByClass(Sd,Od)),Rd||[])}function Fd(e,t){var n=gpeByClass(Ad,e);if(!n)return t&&(0,o.cancelEvent)(t);var a=Od;if(!a&&e&&(a=Ud(n)),a){var i=domData(a,"code"),r=domData(a,"ref");FriendsStats.log(FriendsStats.EVENTS.EVENT_HIDE_BLOCK,{ref:r,trackCode:i},!0)}if(remove(n)){var s=nav.getQuery();delete s.recs,nav.go(location.pathname+obj2qs(s),!1,{replace:!0,push_only:!0})}return t&&(0,o.cancelEvent)(t)}function Ud(e){var t;return hasClass(e,Ld)?t=e:(t=geByClass1(Ld,e))||(t=gpeByClass(Ld,e)),t}var Hd="recommended_narratives",jd="narrative_recommendations",$d=function(e,t){var n;return e?e.classList.contains("RecommendedNarrativesBlock")?e.getAttribute(t):(null===(n=e.closest(".RecommendedNarrativesBlock"))||void 0===n?void 0:n.getAttribute(t))||null:null},Vd=function(e){return $d(e,"data-track-code")},Kd=n(74776),qd=function(){function e(){var e=this;this.actionsMenuElement=null,this.openActionsMenu=function(){var t=d.default.elem((0,te.ContextMenu)({withoutWrap:!0,list:[(0,te.ContextMenuItem)({title:(0,yt.getLang)("mobile_fb_recommended_narratives_not_interested_action"),onclick:"RecommendedNarrativesBlock.onNotInterestedActionClick"})]}));e.actionsMenuElement=te.ContextMenu.open(t,"",{appendToBody:!0,withoutPopupCloning:!0,menuEl:t},t)},this.closeActionsMenu=function(){e.actionsMenuElement&&(te.ContextMenu.close(e.actionsMenuElement),e.actionsMenuElement=null)},this.onNotInterestedActionClick=function(){e.closeActionsMenu();var t=document.querySelector(".RecommendedNarrativesBlock");if(t){var n=$d(t,"data-ignore-url");n&&(window.ajax.post(n,{}),(0,o.remove)(t))}},this.onCreateBlockCreateButtonClick=function(e,t,n){(0,de.sendNarrativeAnalytic)(de.NarrativeAnalyticEventType.createNarrative,{ownerId:Number(window.vk.id)},de.NarrativeAnalyticNavScreen.feedBlock),window.nav.go(n)},this.onCreateBlankClick=function(e,t,n){(0,de.sendNarrativeAnalytic)(de.NarrativeAnalyticEventType.createNarrative,{ownerId:Number(window.vk.id)},de.NarrativeAnalyticNavScreen.feedBlock),window.nav.go(n)};(0,Kd.onFeedRowViewCompleted)({isExpectedFeedRow:function(e){return e.classList.contains("RecommendedNarrativesBlock")},onViewCompleted:function(e){var t,n=e.feedRowElement;null===(t=window.RecommendedNarrativesBlock)||void 0===t||t.onBlockViewed(n)}})}return e.prototype.onBlockViewed=function(e){var t=Vd(e),n=function(e){return $d(e,"data-mark-block-seen-hash")}(e);t&&n&&window.ajax.post("narratives",{act:"mark_seen_recommended_narratives_block",hash:n,track_code:t})},e.prototype.onItemClick=function(e,t,n,o){var a=Vd(e);window.showNarrative(n,o,0,Hd,{trackCode:a,source:jd})},e.prototype.openRecommendedNarrativesList=function(e){var t,n=Vd(e),o=function(e){return $d(e,"data-share-narrative-mail-hash")}(e);n&&o&&(null===(t=window.RecommendedNarrativesList)||void 0===t||t.open({trackCode:n,shareNarrativeMailHash:o}))},e}(),Gd=n(93736);var zd=n(17615);var Qd=function(){function e(){var e=this;this.popup=null,this.close=function(t){var n;t&&(console.error(t),(0,T.logError)(t,{environment:"mobile_recommended_narratives_list"})),e.closePopup(),(null===(n=e.config)||void 0===n?void 0:n.onClose)&&d.default.handle(e.config.onClose)},this.targetOwnOnClick=function(t,n){window.cur.share.go(n),e.close()},this.setLockerVisible=function(t){var n,o;void 0===t&&(t=!0);var a=null===(n=e.popup)||void 0===n?void 0:n.querySelector(".RecommendedNarrativesList__locker"),i=null===(o=e.popup)||void 0===o?void 0:o.querySelector(".RecommendedNarrativesList__content");a&&i&&(a.style.display=t?"flex":"none",i.style.display=t?"none":"block")}}return e.prototype.open=function(e){var t=this;if(this.config=e,!this.popup){var n=(0,Gd.default)({title:(0,yt.getLang)("mobile_recommended_narratives_list_header"),content:{inner:[(0,Ua.default)({mix:"RecommendedNarrativesList__locker"}),{class:"RecommendedNarrativesList__content",tag:"div"}],class:"RecommendedNarrativesList",tag:"div"},isLeftActionBack:!0,onLeftActionClick:"RecommendedNarrativesList.close",isConfirmActionAvailable:!1}),o=d.default.elem(n);this.popup=Popup.open(o,!0),this.setLockerVisible(),this.loadData().then((function(e){t.narratives=e,t.renderNarrativesList(e),t.setLockerVisible(!1)})).catch(this.close)}},e.prototype.renderNarrativesList=function(e){var t,n=null===(t=this.popup)||void 0===t?void 0:t.querySelector(".RecommendedNarrativesList__content");if(n){var o="";e.forEach((function(e){o+=d.default.html(function(e){void 0===e&&(e={});var t=e.narrative;return{inner:[(0,zd.default)({narrative:t,isOwnerNameVisible:!0,onClick:["RecommendedNarrativesList.onItemClick","this","event",t.ownerId,t.id]}),{inner:[(0,f.Icon16MoreHorizontal)()],class:"RecommendedNarrativesListItem__editIcon",onClick:["RecommendedNarrativesList.onEditMenuClick",t.id],tag:"div"}],class:"RecommendedNarrativesListItem",tag:"div"}}({narrative:e}))})),n.innerHTML=o}},e.prototype.toggleNarrativeBookmark=function(e){te.ContextMenu.close(this.actionsContextMenu);var t=e.isBookmarked;e.isBookmarked=!t,window.ajax.post("bookmarks.php",{_ajax:1,act:t?"bookmark_remove":"bookmark_add",item_type:31,item_oid:e.ownerId,item_id:e.id,hash:e.bookmarkHash,ref:window.cur.module},{onDone:function(){W.init({type:W.SNACKBAR_TYPE_BOOKMARK,text:(0,yt.getLangReplace)((0,yt.getLang)(t?"mobile_stories_narratives_removed_from_bookmarks":"mobile_stories_narratives_added_to_bookmarks"),{narrative_title:e.title})}),t||(0,de.sendNarrativeAnalytic)(de.NarrativeAnalyticEventType.addToBookmarks,e,de.NarrativeAnalyticNavScreen.feedBlock)},onFail:function(){return e.isBookmarked=t,!0}})},e.prototype.shareNarrative=function(e){te.ContextMenu.close(this.actionsContextMenu),(0,de.sendNarrativeAnalytic)(de.NarrativeAnalyticEventType.shareNarrative,e,e.ownerId>0?de.NarrativeAnalyticNavScreen.profile:de.NarrativeAnalyticNavScreen.club),window.Share(e.rawId,{mail_hash:this.config.shareNarrativeMailHash,object:"narrative"+e.rawId,is_bookmarked:e.isBookmarked,bookmark_hash:e.bookmarkHash,bookmark_type:31,can_bookmark:!0,can_to_own:!0,can_to_club:!1,shouldInteractWithGlobalStories:!1,targetOwnOnClick:"RecommendedNarrativesList.targetOwnOnClick"})},e.prototype.prepareActionsMenu=function(e){var t=this,n=e.isBookmarked,o=(0,te.ContextMenu)({withoutWrap:!0,list:[(0,te.ContextMenuItem)({title:n?(0,yt.getLang)("mobile_narratives_list_action_save_remove"):(0,yt.getLang)("mobile_narratives_list_action_save_fave"),onclick:function(){return t.toggleNarrativeBookmark(e)}}),(0,te.ContextMenuItem)({title:(0,yt.getLang)("mobile_narratives_list_action_share"),onclick:function(){return t.shareNarrative(e)}})].filter(Boolean)});return d.default.preactElemFromTemplate(o)},e.prototype.onItemClick=function(e,t,n,o){window.showNarrative(n,o,0,Hd,{trackCode:this.config.trackCode,source:jd})},e.prototype.onEditMenuClick=function(e){var t=this.narratives.find((function(t){return t.id===e}));if(t){var n=this.prepareActionsMenu(t);this.actionsContextMenu=te.ContextMenu.open(n,"",{appendToBody:!0,withoutPopupCloning:!0,menuEl:n},n)}},e.prototype.loadData=function(){var e=this;return new Promise((function(t,n){window.ajax.post("narratives",{act:"recommended_narratives_list",track_code:e.config.trackCode},{onDone:function(e){t(e)},onFail:function(e){return n(e),!0}})}))},e.prototype.closePopup=function(){this.popup&&(Popup.close(this.popup),this.popup=null)},e}();window.RecommendedNarrativesBlock=new qd,window.RecommendedNarrativesList=new Qd;n(72825),n(24102),n(74982),n(5870),n(20033);window.groupInvitationClick=(e,t)=>{var{$btn:n}=t,o=n.getAttribute("href");(n.nextElementSibling||n.previousElementSibling).remove(),ajax.post(o,{_ajax:1},{onDone(){}}),n.closest(".BtnStack").outerHTML='\n    <div class="notification__tempText">'+e+"</div>\n  "},window.apiCallAction=(e,t,n,o,a,i,r)=>{var{$btn:s}=r,l=s.getAttribute("href"),c=s.nextElementSibling||s.previousElementSibling,d=t?'<span class="notification__tempIcon '+t+'Icon"></span>':"";o&&!confirm(o)||(mt.default.setLoading(s,!0),ajax.post(l,{_ajax:1},{onDone(){mt.default.setLoading(s,!1),c&&c.remove(),s.closest(".BtnStack").outerHTML='<div class="notification__tempText">'+d+e+"</div>"}}))},window.NotifierPage={notifyMarkAsViewed:e=>{ajax.post("feed.php",{_ajax:1,section:"notifications",hash:e,action:"mark_as_viewed"})}},window.NotifyItem={_onPhotoTagAcceptClick(e,t,n){var{$btn:o}=n,a=o.getAttribute("href");o.nextElementSibling||o.previousElementSibling;ajax.post(a,{_ajax:1},{onDone(){}}),o.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+t+"</div>\n    "},_onPhotoTagDeclineClick(e,t,n){var{$btn:o}=n,a=o.getAttribute("href");o.nextElementSibling||o.previousElementSibling;ajax.post(a,{_ajax:1},{onDone(){}}),o.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+t+"</div>\n    "},_onHideClick(e,t,n,a){e.preventDefault();var i=e.target.getAttribute("href"),r=i+"&action=hide",s=i+"&action=restore",l=!n||confirm(n);ContextMenu.close(),l&&ajax.post(r,{_ajax:1},{onDone(){var e="nid"+a,n=document.getElementById(e),i=n.closest(".notificationList__items")||n.closest(".notificationList"),r=i.closest(".notificationList"),l=!0;if(each(geByClass("notification",i),(function(t,n){isVisible(n)&&n.id!==e&&(l=!1)})),l)nav.reload();else if(hide(n),NotifyItem._onBodyScroll(),r.classList.contains("notificationList_type_unread")){var c=r.$(".Pad__title"),d=parseInt(c.innerText,10)-1;c.innerText=langNumeric(d,(0,o.getLang)("mobile_notifications_new"))}var{Snackbar:u}=window;u&&u.init&&u.init({text:t,action:{url:s,text:lang.mobile_notifications_restore,callback:["NotifyItem._onRestoreClick","event",e]}})}})},_onRestoreClick(e,t,n){var{id:o,url:a}=n;e.preventDefault();var i=ge(t);ajax.post(a,{_ajax:1},{onDone(){ge(t).style.display="",Snackbar.close(o);var e=i.closest(".notificationList__items")||i.closest(".notificationList"),n=e.closest(".notificationList");if(n.classList.contains("notificationList_type_unread")){var a=n.$(".Pad__title"),r=parseInt(a.innerText,10)+1;a.innerText=langNumeric(r,lang.mobile_notifications_new)}var s=!0;each(geByClass("notification",e),(function(e,t){isVisible(t)&&(s=!1)})),s||n.classList.remove("Pad_empty")}})},_onBodyScroll(){$$(".notification_actionsOpen").forEach((e=>{e.classList.remove("notification_actionsOpen")})),window.removeEventListener("scroll",NotifyItem._onBodyScroll)},_onActionTriggerClick(e){window.addEventListener("scroll",NotifyItem._onBodyScroll);var t=e.closest(".notification");t.classList.remove("notification_reverse"),t.classList.toggle("notification_actionsOpen"),$$(".notification_actionsOpen").forEach((e=>{e!==t&&e.classList.remove("notification_actionsOpen")})),t.$(".notification__actionsBubble").getBoundingClientRect().y<50&&t.classList.add("notification_reverse")}},window.FriendRequest={_toggleFriendCardActionsAddedClass(e){e&&e.classList.toggle("FriendsUserCell__actions--added")},_onAcceptSuggestion(e,t){var{text:n}=e,{$btn:o}=t,a=o.getAttribute("href");ajax.post(a,{_ajax:1},{onDone(e,t){var o={text:n,type:W.SNACKBAR_TYPE_SUCCESS};if(t&&t.friend_request_add_sent_message_nudge){var a=t.friend_request_add_sent_message_nudge,i={text:a.text,url:a.url};o=(0,_t.default)({},o,{action:i})}(0,W.init)(o)}}),FriendRequest._toggleFriendCardActionsAddedClass(o.closest(".FriendsUserCell__actions"))},_onAcceptClick(e,t){var{text:n,isPartEnabled:o}=e,{$btn:a}=t,i=a.getAttribute("href");if(ajax.post(i,{_ajax:1},{onDone(){}}),o){var r=a.closest(".FriendsUserCell__actions");r&&(r.innerHTML='\n      <div class="notification__tempText">'+n+"</div>\n    ")}else{var s=a.nextElementSibling||a.previousElementSibling;s&&s.remove(),a.closest(".BtnStack").outerHTML='\n        <div class="notification__tempText">'+n+"</div>\n      "}},_disableFriendSuggestionItem(e){e&&e.classList.add("FriendsUserCell--disabled"),e.querySelector(".FriendsUserCell__actions").remove()},_onHideClick(e,t){var{text:n}=e,{$btn:o}=t,a=o.getAttribute("href");ajax.post(a,{_ajax:1},{onDone(e,t){(0,W.init)({text:n,type:W.SNACKBAR_TYPE_SUCCESS,action:{url:t.url,text:t.text}})}}),FriendRequest._disableFriendSuggestionItem(o.closest(".FriendsUserCell"))},_onDeclineClick(e,t){var{text:n,isPartEnabled:o,handlerType:a}=e,{$btn:i}=t,r=i.getAttribute("href");if(ajax.post(r,{_ajax:1},{onDone(){}}),o)if("with_icons"===a){var s=i.closest(".FriendsUserCell__actions");FriendRequest._toggleFriendCardActionsAddedClass(s)}else i.closest(".FriendsUserCell__actions").innerHTML='\n          <div class="notification__tempText">'+n+"</div>\n        ";else{var l=i.nextElementSibling||i.previousElementSibling;l&&l.remove(),i.closest(".BtnStack").outerHTML='\n        <div class="notification__tempText">'+n+"</div>\n      "}}},window.GroupNotify={deleteSource:(e,t)=>(ajax.post("feed.php",{gid:e,hash:t,act:"group_notify_delete_source"},{onDone(){}}),!1),addSource(e,t,n){this.processQuery("group_notify_add_source",e,t,n)},editSource(e,t){this.processQuery("group_notify_edit_source",e,t)},processQuery(e,t,n,o){var a=$(".group_notify_general .Control_type_switcher input.Control__native").checked?1:0,i={};$$(".group_notify_params .Control_type_switcher input.Control__native").forEach((e=>{i["setting_"+e.name]=e.checked?1:0})),ajax.post("feed.php",(0,_t.default)({gid:t,hash:n,unmuted:a,from:o},i,{act:e}),{onDone(){}})},gn_grProcess:function(e,t,n,o){ajax.post("club"+e,{act:"user_action",mid:t,hash:n,from:"top_notifier",action:o},{onDone(){}})}};var Yd=n(11911);function Xd(e,t,n){if(Yd.isWKWebView){attr(t,"onclick",""),attr(t,"href","vk://vk.com/write"+(2e9+e));var o=new Event("click");return t.dispatchEvent(o),void setTimeout((function(){attr(t,"href","/mail?act=show&chat="+e),t.textContent=n}))}H.default.android?location.href="https://"+(0,ja.getHostName)()+"/write"+(2e9+e):Yd.isIOS?(attr(t,"onclick",""),attr(t,"href","/mail?act=show&chat="+e),t.textContent=n,location.href="vk://vk.com/write"+(2e9+e)):location.href="/mail?act=show&chat="+e}window.ChatPreview={join:(e,t,n)=>(ajax.post(e,{_ajax:1},{onDone(e){Xd(e,t,n)}}),!1),open:(e,t,n)=>(setTimeout((function(){Xd(e,t,n)})),!1)};n(92281);var Jd=10,Zd={setMaxAttach(e){Jd=e},checkAttaches(){Zd.toggleEnableAttaches(mediaUpload.getAttachesCount()<Jd)},toggleEnableAttaches(e){if(void 0===e&&(e=!0),(0,K.$)("#feed_add_form")){(0,K.$$)(".cp_attach_btn",(0,K.$)("#feed_add_form")).forEach((t=>{t.classList.toggle("cp_disabled_btn",!e)})),["photo","video","audio","doc","poll"].forEach((t=>{Unfold.toggleItemEnabled(Unfold.getByName("attaches"),t,e)})),["photo","audio"].forEach((t=>{var n=(0,K.$)(".CreatePostButtons__item--"+t);n&&n.classList.toggle("CreatePostButtons__item--disabled",!e)}));var t=(0,K.$)(".CreatePostButtons__item--photo .inline_upload");(0,o.attr)(t,"disabled",!e)}}};window.CreatePost=Zd;n(29752);onDOMReady(nu),window.page&&page.onChange(nu);var eu="feedAssistance_pushNotificationsSwitch",tu="enable_browser_notifications";function nu(){window.pushNotifier&&pushNotifier.canBeEnabled().then((e=>e&&PushNotifier.getPermission()===yd.PUSH_NOTIFIER_PERMISSION_DEFAULT)).then((e=>{if(e){FeedNotifications.addWebActionAcceptHandler(tu,ou),FeedNotifications.addWebActionDeclineHandler(tu,au);var t=geByClass1(eu);if(!t)return;FeedAssistanceStats.registerTrackingCls(eu),FeedAssistanceStats.register(t,"feed")}}))}function ou(e){return pushNotifier.requestPermission().then((t=>{var n,o=!0;return unlockButton(e),t===yd.PUSH_NOTIFIER_PERMISSION_DEFAULT?o=!1:(n=t===yd.PUSH_NOTIFIER_PERMISSION_GRANTED?FeedAssistanceStats.EVENTS.SUB_EVENT_ENABLE_PUSH:FeedAssistanceStats.EVENTS.SUB_EVENT_DECLINE_PUSH,ru(e,n),iu(),o)}),(()=>au(e)))}function au(e){return unlockButton(e),ru(e,FeedAssistanceStats.EVENTS.SUB_EVENT_DECLINE_PUSH),iu(),!0}function iu(){var e=geByClass1(eu);remove(e)}function ru(e,t){FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_FEED_ASSISTANCE,data:FeedAssistanceStats.serializeEventData(FeedAssistanceStats.EVENTS.EVENT_FEED_ASSISTANCE,e,"m_push_switch",t)})}window.closePostSuggest=function(e,t){return suggestionEvent(e,t,!1),stopEvent(t)},window.suggestionEvent=function(e,t,n){void 0===n&&(n=!1);var a=(0,o.geByClass1)("post_suggest");return ajax.post("wall.php",{_ajax:1,act:"suggestion_event",event_type:e,suggest_id:a.getAttribute("data-suggest-id"),not_hide_by_click:intval(n)}),n||(0,o.re)(a),stopEvent(t)};n(54755);var su=function(){function e(e,t){this.sendLogsTimeout=null,this.sendLogsProcess=!1,this.localStorageKey="recommended_groups",this.logsDataDelimiter="|",this.location=e,this.act=t}return e.prototype.sendLogs=function(){this.sendLogsTimeout&&clearTimeout(this.sendLogsTimeout),this.sendLogsTimeout=setTimeout(this.sendLogsAccept.bind(this),1e4)},e.prototype.sendLogsAccept=function(){var e=this;if(!this.sendLogsProcess){var t=this.getLogs(!0);t.length&&(this.sendLogsProcess=!0,this.clearLogs(),window.ajax.post(this.location,{act:this.act,logs:t},{onDone:function(){e.sendLogsProcess=!1},onFail:function(){return e.restoreLogs(t),e.sendLogsProcess=!1,!0}}))}},e.prototype.restoreLogs=function(e){var t=this,n=this.getLogs(),o=e.map((function(e){return e.split(t.logsDataDelimiter)})),a=(0,u.__spreadArray)((0,u.__spreadArray)([],(0,u.__read)(o),!1),(0,u.__read)(n),!1);ro.default.set(this.localStorageKey,a)},e.prototype.getLogs=function(e){var t=this,n=ro.default.get(this.localStorageKey)||[];return e&&(n=n.map((function(e){return e.join(t.logsDataDelimiter)}))),n},e.prototype.addLog=function(e){var t=this.getLogs(),n=e.eventType,o=e.trackCode,a=e.groupId,i=a?[n,o,a]:[n,o];t.push(i),ro.default.set(this.localStorageKey,t),this.sendLogs()},e.prototype.clearLogs=function(){ro.default.remove(this.localStorageKey)},e}(),lu="GroupsRecommendedSlider",cu=function(){function e(){this.eventLog=new su("/groups","stats"),this.sliderSizes=null,this.sliderScrollNode=null,this.sliderLineNode=null,this.slides=null,this.allLoaded=!1,this.ajaxIsRunning=!1,this.onScroll=(0,o.throttle)(this.onScrollImpl,50),this.initializationHandlers()}return e.prototype.initializationHandlers=function(){var e=this;(0,Kd.onFeedRowViewStarted)({isExpectedFeedRow:du,onViewStarted:function(t){var n=t.feedRowElement;e.onFeedBlockRegistered({blockElem:n})}}),(0,Kd.onFeedRowViewCompleted)({isExpectedFeedRow:du,onViewCompleted:function(t){var n=t.feedRowElement;e.onFeedBlockInitialView({blockElem:n})}})},e.prototype.initForBlockElement=function(e){var t=e.blockElem;if(this.gallery=t.querySelector(".groupsRecommendedSlider"),this.gallery)return this.sliderScrollNode=this.gallery.querySelector(".Slider__scroll"),this.sliderLineNode=this.gallery.querySelector(".Slider__line"),!0;console.warn("RecommendedGroupsSlider: Missing gallery element")},e.prototype.onFeedBlockRegistered=function(e){var t=e.blockElem;this.initForBlockElement({blockElem:t})},e.prototype.onFeedBlockInitialView=function(e){var t=e.blockElem.querySelector(".Slider__scroll"),n=null==t?void 0:t.dataset.code;n?(this.viewBlock(n),this.onScroll()):console.error(new Error("RecommendedGroupsSlider: Missing gallery trackCode"),{sliderScroll:t})},e.prototype.subscribe=function(e,t,n){var a=e.closest(".prettyCard").dataset,i=a.groupId,r=a.trackCode;if(i&&r&&!e.classList.contains("prettyCard__button_accepted"))return this.eventLog.addLog({eventType:"group_subscribed",groupId:i,trackCode:r}),window.ajax.post("/groups",{act:"subscribe_from_recomm_groups",hash:t,oid:-i,track_code:r},{onDone:function(t){e.classList.add("prettyCard__button_accepted"),e.innerHTML=t,e.onclick=null},onFail:function(){return!1},showProgress:function(){(0,o.lockButton)(e),e.classList.add("prettyCard__button_loading")},hideProgress:function(){(0,o.unlockButton)(e),e.classList.remove("prettyCard__button_loading")}}),n&&(0,o.cancelEvent)(n);(0,o.cancelEvent)(n)},e.prototype.closeGroup=function(e,t,n){var a=e.closest(".prettyCard"),i=a.dataset,r=i.groupId,s=i.trackCode;if(r&&s)return this.eventLog.addLog({eventType:"group_hidden",groupId:r,trackCode:s}),(0,o.remove)(a),this.slides=null,window.ajax.post("/groups",{act:"hide_recomm_groups_block_group",hash:t,track_code:s,group_id:r}),n&&(0,o.cancelEvent)(n)},e.prototype.hideBlock=function(e){var t=(0,o.domData)(this.sliderScrollNode,"code")||"";this.eventLog.addLog({eventType:"block_hidden",trackCode:t});var n=e.closest("."+lu);(0,o.hide)(n)},e.prototype.clickOnGroup=function(e){var t=e.dataset,n=t.groupId,o=t.trackCode;n&&o&&this.eventLog.addLog({trackCode:o,groupId:n,eventType:"group_opened"})},e.prototype.clickOnViewAll=function(){var e=(0,o.domData)(this.sliderScrollNode,"code")||"";e&&this.eventLog.addLog({trackCode:e,eventType:"block_expanded"})},e.prototype.viewBlock=function(e){this.eventLog.addLog({trackCode:e,eventType:"block_seen"})},e.prototype.onScrollImpl=function(){var e=this;if(this.gallery&&this.sliderScrollNode){var t=this.getScrollSizeValues();if(!this.ajaxIsRunning&&t){var n=this.sliderScrollNode.scrollLeft,a=Math.max(0,Math.floor((n-t.leftMargin)/t.itemWidth)),i=Math.max(0,Math.floor((n+t.width-t.leftMargin)/t.itemWidth));a*t.itemWidth+t.itemWidth-t.part<n&&a++,i*t.itemWidth+t.part>n+t.width&&i--;var r=this.getSlides();if(r){a=Math.max(0,a),i=Math.min(r.length,i);for(var s=a;s<=i;s++){var l=r[s];if(l&&!l.viewed){l.viewed=!0;var c=l.dataset,d=c.groupId;(_=c.trackCode)&&d&&this.eventLog.addLog({trackCode:_,groupId:d,eventType:"group_seen"})}}if(!this.allLoaded&&n+t.width>=t.scrollWidth/2){var u=(0,o.domData)(this.sliderScrollNode,"next")||"",_=(0,o.domData)(this.sliderScrollNode,"code")||"";if(!u)return void(this.allLoaded=!0);this.ajaxIsRunning=!0,window.ajax.post("/groups",{act:"recommended_carousel",next:u,track_code:_},{onDone:function(t,n){if(t){var a=window.cdf(t);(0,o.append)(a,e.sliderLineNode),e.sliderSizes=null,e.slides=null}(0,o.domData)(e.sliderScrollNode,"next",n||null),e.allLoaded=!n,e.ajaxIsRunning=!1},onFail:function(){return setTimeout((function(){return e.ajaxIsRunning=!1}),500),!1}})}}}}},e.prototype.getScrollSizeValues=function(){var e;if(this.sliderSizes)return this.sliderSizes;var t=this.getSlides(),n=(0,o.getSize)(this.sliderScrollNode)[0],a=(0,o.getX)(this.sliderScrollNode),i=(0,o.getX)(t[0])-a,r=(0,o.getSize)(t[0])[0],s={width:n,itemWidth:r+((0,o.getX)(t[1])-a-i-r),leftMargin:i,part:Math.floor(r/3),scrollWidth:null===(e=this.sliderScrollNode)||void 0===e?void 0:e.scrollWidth};return this.sliderSizes=s,this.sliderSizes},e.prototype.getSlides=function(){var e;return this.slides||(this.slides=null===(e=this.gallery)||void 0===e?void 0:e.querySelectorAll(".prettyCard")),this.slides},e}();function du(e){return e.classList.contains(lu)}var uu=new cu;window.RecommendedGroupsSlider=uu;n(11560);function _u(e,t){return void 0===e&&(e=""),void 0===t&&(t=[]),!!t.find((t=>"*"===t[t.length-1]?e.startsWith(t.slice(0,t.length-1)):e===t))}var pu,mu=["/restore","/login","/authorize*","/join*","/","/settings","/album*","/terms","/privacy","/payments*","/attachments*","/page*","/blog*","/about","/privacy","/jobs","/dev","/legal","/data_protection","/safety","/activation*","/licence","/agelimits"];function fu(){pu&&pu.classList.remove(Xt.class.open)}function vu(){pu&&pu.classList.add(Xt.class.open)}onDOMReady((function(){!function e(t,n){void 0===n&&(n=!0),(0,o.isIosWebView)()||(0,o.isAndroidWebView)()||(0,o.isVkWebView)()||(n||(pu=(0,o.geByClass1)(Xt.class.btn),window.page.onChange(e.bind(this))),t=t?t.split("?")[0]:nav.path,!/^\/photo/.test(t)&&fu(),_u(t,mu)||nav.getQuery("z")?(fu(),setTimeout(fu)):vu())}(null,!1)}));var gu={_onCloseClick:function(e){Xt._onCloseClick(e),(0,dt.setCookie)("remixregbtn",0,0)},show:vu,hide:fu};window.uRegisterFloatBtn=gu;var hu,wu=["/restore","/login","/join*","/","/settings","/album*","/terms","/privacy","/payments*","/attachments*","/pages*","/blog*","/about","/privacy","/jobs","/dev","/legal","/data_protection","/safety","/activation*","/licence","/agelimits"];function yu(){hu&&hu.classList.remove(Xt.class.open)}function ku(){hu&&hu.classList.add(Xt.class.open)}onDOMReady((function(){!function e(t,n){void 0===n&&(n=!0),n||(hu=(0,o.geByClass1)(Xt.class.btn),window.page.onChange(e.bind(this))),t=t?t.split("?")[0]:Z.default.path,!/^\/photo/.test(t)&&yu(),_u(t,wu)||Z.default.getQuery("z")?yu():ku()}(null,!1)}));var bu={_onCloseClick:function(e){Xt._onCloseClick(e)},show:ku,hide:yu,processOpenInNativeApp:function(e,t,n,a,i){void 0===i&&(i={}),i=i||{},Z.default.onMenuItemClick(n),Z.default.openInNativeApp(a,t,e),(0,o.statlogsValueEvent)("utm_open_in_native_app_button","clicked",i.utm_source,i.utm_param,i.utm_medium,i.utm_time)}};window.uOpenInNativeAppFloatBtn=bu;var Su="mvk_profile_image_modal",Cu="close";window.ProfileImageModal={open:function(e){void 0===e&&(e={});var{profilePhotosUrl:t,uploadUrl:n,baseUrl:a,staticUrl:i,inputAccept:s,ownerId:l,ownerName:c,newAvatarStoryData:u}=e,_=(0,mo.default)({id:"profile-photo-modal",close:!0,on_overlay_click:"ProfileImageModal.closeModal(this);",items:[(0,ha.ModalMenuBtn)({"aria-label":(0,yt.getLang)("mobile_profile_photo_modal_album"),inner:(0,yt.getLang)("mobile_profile_photo_modal_album"),onclick:"ProfileImageModal.openAlbum(this, '"+decodeURIComponent(t)+"');"}),(0,ha.ModalMenuBtn)({"aria-label":(0,yt.getLang)("mobile_profile_photo_modal_change"),class:"ModalMenu__btn_overflow",inner:[{tag:"input",type:"file",class:"inline_upload","data-upload-url":decodeURIComponent(n)||null,"data-static-url":decodeURIComponent(i)||null,"data-base-url":decodeURIComponent(a)||null,"data-owner-id":l,"data-owner-name":c,"data-new-avatar-story-data":JSON.stringify(u),onchange:"return OwnerPhotoUpload2.onUploadInputChange(this, event);",accept:decodeURIComponent(s)},(0,yt.getLang)("mobile_profile_photo_modal_change")],onclick:"ProfileImageModal.selectImage(this);"})]});mo.default.open(d.default.elem(_),!0),(0,o.statlogsValueEvent)(Su,"open");var p=(0,K.$)(".profile_photo_modal_expand");(0,r.expandPopup)(p).exitIntent=()=>{(0,o.statlogsValueEvent)(Su,Cu),mo.default.close()}},openAlbum:function(e,t){(0,o.statlogsValueEvent)(Su,"album"),mo.default.close(e),nav.go(t)},selectImage:function(e){(0,o.statlogsValueEvent)(Su,"upload"),mo.default.close(e),(0,K.$)(".inline_upload",e).click()},closeModal:function(e){(0,o.statlogsValueEvent)(Su,Cu),mo.default.close(e)}};n(26510);var Eu=function(e){var t=e.tag,n=t.id===e.current_id?"control_radio_checked":"control_radio";return{href:t.href,class:"Bookmarks__tagsSelectItem",inner:[{class:"Bookmarks__tagsSelectItemTitle",inner:d.default.wrap(t.name)},(0,zt.default)({icon:n})]}};var Tu=Eu;window.BookmarksFilterListItem=Eu;var Iu=function(e){var t=!(!e.tags||!e.tags.length)&&e.tags;return{class:"Owner__tags",inner:t?[{class:"Owner__tags_icon Icon Icon_tagLabel"},t.map((e=>({class:"Owner__tag",inner:d.default.wrap(e.name)})))]:null}};var Mu=Iu;window.BookmarksPageItem=Iu;var Pu=window.Popup,Lu=window.ActionMenu,Bu=window.attr,Au=window.val,Ou=window.ajax,xu=window.replace,Ru=window.scrollTop,Nu=window.ceFromString,Du=window.Btn;window.Bookmarks={hideTagsList:o_,showTagsList:function(e,t){void 0===t&&(t=!1);e&&e.stopPropagation();var n=e_(Fu),a=c_();if(n.classList.remove("BookmarksPopup__hideCorner"),t){var i=t.closest(Gu),r=d_(Bu(i,"id"));a=a.filter((e=>r.includes(e.id))),n.classList.add("BookmarksPopup__hideCorner")}var s=(0,o.qs2obj)(nav.params),l=Object.keys(a).reduce(((e,t)=>{var n=a[t];return e.push(Tu({tag:n,current_id:parseInt(s.tag)})),e}),[]),c=d.default.html(l);Au(n.$(".Popup__scrollContent"),c);var u=(0,K.$$)(Wu,n);u&&u.forEach((e=>{(0,o.addEvent)(e,"click",o_)}));return!1},hideDeletePopup:a_,showDeletePopup:function(e){var t=e_(Uu),n=Bu(e,"data-id"),a=Bu(e,"data-hash"),i=Bu(e,"data-name");return __(t,{id:n,hash:a}),Au(t.$("["+zu+"]"),(0,o.htsc)(i)),!1},submitDeleteTag:function(){var e=Array.from((0,K.$$)(Uu)).pop(),{id:t,hash:n}=p_(e);Ou.post("/bookmarks",{_ajax:1,act:"tag_delete",id:t,hash:n},{onDone(e){Zu(e),a_()}})},hideCreatePopup:i_,showCreatePopup:function(e){var t=e_(Hu),n=Bu(e,"data-hash");__(t,{hash:n});var o=(0,K.$)("[name="+Qu+"]",t),a=(0,K.$)(qu,t),i=Au(o).trim();return Du.setDisabled(a,!i),!1},submitCreateTag:function(){var e=Array.from((0,K.$$)(Hu)).pop(),t=Array.from((0,K.$$)(Vu)).pop(),{hash:n}=p_(e),o=Au(e.$("[name="+Qu+"]")),a=+!!(0,K.$)(Vu);Ou.post("/bookmarks",{_ajax:1,act:"tag_edit",tag:o,hash:n,id:0,from_settings:a},{onDone(e,n){if(a){var o=[];Array.from(t.$$('[name="tag"][type="checkbox"]:checked')||[]).forEach((e=>{o.push(e.value)})),Au(t,e),o.forEach((e=>{var n=t.$('[name="tag"][type="checkbox"][value="'+e+'"]');n&&(n.checked=!0)}))}else Zu(e);!function(e){var t=l_(),[n,o]=e;t&&t.tags&&t.tags.push({id:n,name:o,order:0})}(n),i_()}})},hideEditPopup:r_,showEditPopup:function(e){var t=e_(ju),n=Bu(e,"data-id"),o=Bu(e,"data-hash"),a=Bu(e,"data-name")||"",i=t.$("[name="+Yu+"]");Au(i,a),__(t,{id:n,hash:o,name:a});var r=Array.from((0,K.$$)(qu,t)).pop(),s=Au(i).trim();return Du.setDisabled(r,!s),!1},submitEditTag:function(){var e=Array.from((0,K.$$)(ju)).pop(),{id:t,hash:n}=p_(e),o=Au(e.$("[name="+Yu+"]"));Ou.post("/bookmarks",{_ajax:1,act:"tag_edit",tag:o,hash:n,id:t},{onDone(e){Zu(e),r_()}})},hideSettingsPopup:s_,showSettingsPopup:function(e,t){void 0===t&&(t={});var n,o,a,i=Bu(e,"data-item_id"),r=Bu(e,"data-item_oid"),s=Bu(e,"data-item_type"),l=Bu(e,"data-hash"),c=Bu(e,"data-raw");t.wrap||(n=e_($u),o=n.$(Vu),a=d_(c),Au(o,d.default.html({class:"Bookmarks__tagsSettingsLoading"})),__(n,{id:i,oid:r,type:s,hash:l,itemRaw:c}));return Ou.post("/bookmarks",{_ajax:1,act:"tag_settings",hash:l,item_id:i,item_oid:r,item_type:s,wrap:t.wrap?1:0},{onDone(e){if(t.wrap){var d=Nu(e);__(d=e_(d),{id:i,oid:r,type:s,hash:l,itemRaw:c,needRemove:!0,is_from_snackbar:t.is_from_snackbar})}else Au(o,e),a.forEach((e=>{var t=n.$('[name="tag"][type="checkbox"][value="'+e+'"]');t&&(t.checked=!0)}))}}),!1},submitSettingsTags:function(){var e=Array.from((0,K.$$)($u)).pop(),{id:t,oid:n,type:o,hash:a,itemRaw:i,is_from_snackbar:r}=p_(e),s=[];Array.from(e.$$('[name="tag"][type="checkbox"]:checked')||[]).forEach((e=>{s.push(e.value)}));var l=s.join(",");Ou.post("/bookmarks",{_ajax:1,act:"tag_set",hash:a,item_id:t,item_oid:n,item_type:o,tag_ids:l,is_from_snackbar:r},{onDone(e){s_();var t=(0,K.$)("#"+i);if(t){var n=(0,K.$)(".BookmarkListItem__tags, .BookmarksItem__tag",t);if(n)Au(n,e);else if(n=(0,K.$)(".Owner__tags",t)){var o=c_(),a=s.map((e=>parseInt(e,10))),r=o.filter((e=>a.includes(e.id))),l=d.default.html(Mu({tags:r}));Au(n.parentNode,l)}v_(i,s,""),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}})},closeAll:function(){o_(),a_(),i_(),r_(),s_()},initStore:u_,pushItemsToStore:function(e){var t=l_();t&&(t.items=(0,_t.default)({},t.items,{},e))},pushItemToStore:v_,removeFromBookmarkLink:function(e){var t=Bu(e,"data-item_id"),n=Bu(e,"data-item_oid"),a=Bu(e,"data-item_type"),i=Bu(e,"data-hash"),r=Bu(e,"data-raw"),s=Bu(e,"data-link_url"),l=Bu(e,"data-link_title"),c=Bu(e,"data-link_img"),d=(0,K.$)("#"+r);return Lu.closeMenu(),(0,o.addClass)(d,Xu),Ou.post("/bookmarks",{_ajax:1,act:"bookmark_remove",hash:i,item_id:t,item_oid:n,item_type:a,link_url:s,link_title:l,link_img:c},{onDone(e){f_(r,[Xu]),Share.setBookmarkState(r,!1),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}),!1},addToBookmarkLink:function(e){var t=Bu(e,"data-item_id"),n=Bu(e,"data-item_oid"),a=Bu(e,"data-item_type"),i=Bu(e,"data-hash"),r=Bu(e,"data-raw"),s=Bu(e,"data-link_url"),l=Bu(e,"data-link_title"),c=Bu(e,"data-link_img"),d=(0,K.$)("#"+r);return Lu.closeMenu(),(0,o.removeClass)(d,Xu),Ou.post("/bookmarks",{_ajax:1,act:"bookmark_add",hash:i,item_id:t,item_oid:n,item_type:a,link_url:s,link_title:l,link_img:c},{onDone(){var e=m_(r),t=e.indexOf(Xu);-1!==t&&e.splice(t,1),f_(r,e),Share.setBookmarkState(r,!0),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}),!1},showSuccessSnack:function(e){var t,{lang:n}=window,a=(0,o.geByClass1)("RepliesField_fixed");a&&(t=(0,o.getH)(a)+5);Snackbar.init({type:W.SNACKBAR_TYPE_BOOKMARK,text:n.mobile_bookmarks_snackbar_added,bottom:t,action:{url:"/bookmarks",text:n.mobile_bookmarks_snackbar_edit_tags,onclick:"return Bookmarks.showSettingsPopup(this, { wrap: true, is_from_snackbar: 1 });",attrs:Object.keys(e).reduce(((t,n)=>(t["data-"+n]=e[n],t)),{})}})},keyupCreateInput:function(e,t){var n=(0,o.gpeByClass)("BookmarksPopup",t),a=(0,K.$)(qu,n),i=Au(t).trim();Du.setDisabled(a,!i)},openSavedTab:function(e,t){var n=(0,K.$)(".mm_counter",t),o=(0,dt.getCookie)(Ju);o&&!n&&(e&&e.preventDefault(),nav.go("/bookmarks?type="+o))},openLikesFeed:function(e){var t=(0,K.$)(".mm_new",e);(0,o.remove)(t)},getStoreItemDataById:g_,getTagsByItemId:h_,renderSearchItem:function(e,t,n,a,i){var r="";if(!a||(0,o.isEmpty)(a))r=n;else{var s=h_(e),l=m_(e);a=JSON.parse(a),s&&(t=s.reduce(((e,t)=>[...e,t.id]),[]),a.subtitle=Mu({tags:s})),l&&(a.mix=[...l].join(" ")),a.title=d.default.wrap(i.highlight(a.title)),r=d.default.html((0,ao.default)(a))}return v_(e,t,n),r}};var Fu=".BookmarksPopup__filter",Uu=".BookmarksPopup__delete",Hu=".BookmarksPopup__create",ju=".BookmarksPopup__edit",$u=".BookmarksPopup__settings",Vu=".Bookmarks__tagsSettings",Wu=".Bookmarks__tagsSelectItem",Ku=".basisDefault",qu=".BookmarksPopup__buttonSubmit",Gu=".BookmarksItem",zu="data-deletetagname",Qu="createtagname",Yu="edittagname",Xu="BookmarksItem_removed",Ju="remixblt";function Zu(e){var t=Ru(),n=(0,K.$)(Ku),o=Nu(e);xu(o,n),Ru(t)}function e_(e){var t;Lu.closeMenu(),t="string"==typeof e?(0,K.$)(e):e,t=Pu.open(t,!0);var n="popup"+Date.now();return Bu(t,"data-popupid",n),t}function t_(e){return Bu(e,"data-popupid")}function n_(e){var t;if(t=!("string"==typeof e)?e:Array.from((0,K.$$)(e)).pop()){Pu.close(t);var n=p_(t),a=n&&n.needRemove;!function(e){var t=t_(e);delete l_().popup[t]}(t),a&&(0,o.remove)(t)}return!1}function o_(){var e=Array.from((0,K.$$)(Fu)).pop(),t=(0,K.$$)(Wu,e);return t&&t.forEach((e=>{(0,o.removeEvent)(e,"click",o_)})),n_(e)}function a_(){return n_(Uu)}function i_(){var e=Array.from((0,K.$$)(Hu)).pop();if(e){var t=e.$("[name="+Qu+"]");Au(t,"")}return n_(Hu)}function r_(){var e=Array.from((0,K.$$)(ju)).pop();if(e){var t=e.$("[name="+Yu+"]");Au(t,"")}return n_(ju)}function s_(){return n_($u)}function l_(){return window.store.bookmarks||u_(),window.store.bookmarks}function c_(){var e=l_();return e.tags?e.tags:[]}function d_(e){var t=l_();return t.items[e]?t.items[e][3]:[]}function u_(e){void 0===e&&(e={}),window.store.bookmarks=(0,_t.default)({},e,{popup:{}})}function __(e,t){var n=t_(e);l_().popup[n]=t}function p_(e){var t=t_(e);return l_().popup[t]}function m_(e){var t=l_();return t&&t.items&&t.items[e]&&t.items[e][5]}function f_(e,t){var n=l_();n&&n.items&&n.items[e]&&(n.items[e][5]?n.items[e][5]=[...n.items[e][5],...t]:n.items[e][5]=[...t])}function v_(e,t,n,o){var a=l_();a&&a.items&&(t=t.map((e=>parseInt(e,10))),a.items[e]?(a.items[e][3]=t,a.items[e][4]=o):a.items[e]=["",n,e,t,o])}function g_(e){var t=l_();return t&&t.items&&t.items[e]}function h_(e){var t=g_(e),n=c_();if(t&&n){var o=t[3]||[];return n.filter((e=>o.includes(e.id)))}return!1}window.uCloseProfileSwitcher={},window.uCloseProfileSwitcher._onConfirmClick=y_;var w_=null;function y_(e,t){var{checked:n}=t;Z.default.clear();var a={is_closed:n?"1":"0",_ajax:1};j.default.post(e,a,{onDone(){Z.default.reload();var e=window.cur;w_=(0,o.scrollTop)(),e.destroy.push(k_)}})}function k_(){(0,o.scrollTop)(w_),requestAnimationFrame((()=>{(0,o.scrollTop)(w_),requestAnimationFrame((()=>{(0,o.scrollTop)(w_)}))}))}var b_,S_=function(e,t){void 0===t&&(t={});return{inner:[d.default.wrap(e)],class:"CoronaStatus__tooltip CoronaStatus__tooltip--type"+t.id,onclick:["CoronaStatus.open",t],tag:"span"}};window.page.onChange((()=>{b_&&ha.default.close(b_)}));window.CoronaStatus=S_,(0,yt.extend)(S_,{open:function(e){void 0===e&&(e={}),(0,o.cancelEvent)(),(0,o.statlogsValueEvent)("corona_status_stat","show_tooltip");var t=d.default.elem((0,ha.default)({class:"CoronaStatus",items:[(0,ha.ModalMenuHeaderCloseButton)(),(0,ha.ModalMenuIcon)({inner:{class:"CoronaStatus__icon CoronaStatus__icon--type"+e.id}}),(0,ha.ModalMenuTitle)({inner:d.default.wrap(e.title)}),(0,ha.ModalMenuBody)({inner:d.default.wrap(e.text)}),(0,ha.ModalMenuBtn)({url:"/covid19#utm_source=vk&utm_medium=cpc&utm_campaign=status_tooltip_mvk",theme:"regular",size:"large",isBtn:!0,inner:(0,yt.getLang)("mobile_special_covid_status_modal_go_button"),onclick:"window.CoronaStatus.sendStat()"})]}));b_=ha.default.open(t,!0)},sendStat:function(){(0,o.statlogsValueEvent)("corona_status_stat","open_app")}});function C_(e){void 0===e&&(e={});var{url:t,type:n,url_x2:o}=e;if(!t)return"";var a="";return o&&(a=o+" 2x"),{inner:[{inner:[{src:t,srcSet:a,class:"ImageStatus__image ImageStatus__image--"+n,tag:"img"}],class:"ImageStatus__imageFrame",tag:"div"}],class:"ImageStatus__imageWrapper",tag:"div"}}function E_(e){var{backgrounds:t={},themeKey:n}=e,o="";return t[n]&&t[n]&&(o=t[n]),o?{class:"ImageStatus__background",style:'background-image: url("'+o+'")',tag:"div"}:""}var T_;window.page.onChange((()=>{T_&&ha.default.close(T_)})),window.ImageStatus={open:function(e){void 0===e&&(e={}),(0,o.cancelEvent)();var{user_id:t,special_id:n}=e,a=d.default.elem((0,ha.default)({class:"ImageStatus",items:[{class:"ImageStatus__preload",inner:(0,Ua.default)()}]}));T_=ha.default.open(a,!0,"image_status");var r=(0,K.$)(".Popup__content",T_);window.ajax.post("/special_event",{act:n?"special_event":"image_status",user_id:t},{onDone:function(e){var t,{status_id:o,color:a={},backgrounds:s={}}=e;t=i.colorScheme.isDarkScheme()?"dark":"light";var l=[(0,ha.ModalMenuHeaderCloseButton)(),E_({backgrounds:s,themeKey:t}),C_(e.image),(0,ha.ModalMenuTitle)({inner:d.default.wrap(e.title)})];e.description&&l.push((0,ha.ModalMenuBody)({inner:d.default.wrap(e.description)})),e.participants&&l.push(function(e){void 0===e&&(e={});var{images:t,text:n,addition:o}=e;return{inner:[{inner:[t.map((function(e){return{inner:[{src:e,class:"ImageStatus__participantImage",tag:"img"}],class:"ImageStatus__participantWrapper",tag:"div"}})),o?{inner:[{inner:["+"+o],class:"ImageStatus__participantAddition",tag:"div"}],class:"ImageStatus__participantWrapper",tag:"div"}:""],class:"ImageStatus__participantsWrapper",tag:"div"},{inner:[n],class:"ImageStatus__participantsText",tag:"div"}],class:"ImageStatus__participants",tag:"div"}}(e.participants)),(e.buttons||[]).forEach((function(e){l.push((0,ha.ModalMenuBtn)({url:e.url,theme:e.type,size:"large",isBtn:!0,inner:e.title,onclick:e.onclick||(n?"window.SpecialEvent && window.SpecialEvent.sendStats('popup_action');":"ImageStatus.sendStat("+o+");"),attrs:{target:e.target||"_blank"}}))})),l.push(function(e){void 0===e&&(e={});var{terms:t}=e;return t?{inner:[d.default.wrap(t)],class:"ImageStatus__terms",tag:"div"}:""}(e)),Array.from(r.childNodes).forEach((function(e){r.removeChild(e)})),a[t]&&(r.style.backgroundColor="#"+a[t]),r.append(d.default.elem({class:"ImageStatus__inner",inner:l})),n&&window.SpecialEvent?window.SpecialEvent.sendStats("popup_showed"):(0,Pa.saveStatlogEvents)({name:"image_status",value:o,keys:["show_popup"]})},onFail:function(){ha.default.close(T_)}})},sendStat:function(e){e&&(0,Pa.saveStatlogEvents)({name:"image_status",value:e,keys:["popup_action"]})},removeStatus:function(e,t,n){return e.preventDefault(),j.default.post("/special_event?act=image_status_remove&hash="+n),mt.default.setLoading(t,!0),!1}};var I_=n(3616),M_=n(36150),P_=function(e){var t=(0,yt.getLang)("mobile_promo_vkconnect_agreement");return t=(t=t.replace("{link1}",'<a href="'+e.terms_url+'" target="_blank" class="PromoVKConnect__agreementLink">').replace("{/link1}","</a>")).replace("{link2}",'<a href="'+e.privacy_url+'" target="_blank" class="PromoVKConnect__agreementLink">').replace("{/link2}","</a>"),t=d.default.wrap(t),{inner:[{inner:[(0,V.default)({icon:(0,M_.getVkconnectLogoIcon)()}),{inner:[(0,f.Icon28HelpOutline)()],href:e.learn_more_url,target:"_blank",class:"PromoVKConnect__help",tag:"a"}],class:"PromoVKConnect__header",tag:"div"},{inner:[(0,yt.getLang)("mobile_promo_vkconnect_title")],class:"PromoVKConnect__title",tag:"h1"},{inner:[{inner:[{inner:[(0,f.Icon28MagicWandOutline)()],class:"PromoVKConnect__listIcon",tag:"div"},(0,yt.getLang)("mobile_promo_vkconnect_list1")],class:"PromoVKConnect__listItem",tag:"li"},{inner:[{inner:[(0,f.Icon28UserCircleOutline)()],class:"PromoVKConnect__listIcon",tag:"div"},(0,yt.getLang)("mobile_promo_vkconnect_list2")],class:"PromoVKConnect__listItem",tag:"li"},{inner:[{inner:[(0,f.Icon28CheckShieldOutline)()],class:"PromoVKConnect__listIcon",tag:"div"},(0,yt.getLang)("mobile_promo_vkconnect_list3")],class:"PromoVKConnect__listItem",tag:"li"}],class:"PromoVKConnect__list",tag:"ul"},{inner:[(0,mt.default)({inner:[(0,yt.getLang)("mobile_promo_vkconnect_button")],size:"large",class:"PromoVKConnect__button",onClick:["PromoVKConnect.accept","event","this",e.hash],use_native_onclick:!0}),{inner:[t],class:"PromoVKConnect__agreement",tag:"div"}],class:"PromoVKConnect__footer",tag:"div"}],class:"PromoVKConnect ScrollView",tag:"div"}};var L_={init(e){window.onDOMReady((()=>this.open(e)))},open(e){var t=(0,mo.default)({on_overlay_click:[],class:"PromoVKConnectModal",attached:!0,body:P_(e)});mo.default.open(Wd.elem(t),!0,"",{swipeDown:!1})},accept(e,t,n){e.preventDefault(),mt.default.setLoading(t,!0,"white"),j.default.post("/",{act:"vkconnect_accept",hash:n},{onDone:()=>{this.showTooltip(),mo.default.close()},onFail:()=>{this.showTooltip(),mo.default.close()}})},showTooltip(){var e=(0,K.$)(".BottomMenu__cell:nth-child(5) .BottomMenu__icon"),t=Wd.elem((0,I_.default)({pos:"top_right",theme:"accent",inner:(0,yt.getLang)("mobile_promo_vkconnect_tooltip")}));e.appendChild(t)}},B_=L_;window.PromoVKConnect=B_;n(69305);var A_={close:function(e,t,n){e.preventDefault();var o=t.closest(".IPadBanner");o&&(o.remove(),j.default.post("/promo",{act:"ipad_close",hash:n,_ajax:1}))},open:function(e){j.default.post("/promo",{act:"ipad_open",hash:e,_ajax:1})}};window.IPadBanner=A_;var O_=function(e){void 0===e&&(e={});var t=e.storiesCount?"window.showNarrative("+e.ownerId+", "+e.id+", 0, 'narratives"+e.ownerId+"'); return false;":null;return{inner:[{inner:[{class:"NarrativesBlockItem__coverImage",style:"background-image: url('"+e.coverUrl+"')",tag:"div"}],class:"NarrativesBlockItem__cover",tag:"div"},{inner:[e.title],class:"NarrativesBlockItem__title",tag:"div"}],class:"NarrativesBlockItem",onClick:t,tag:"div"}},x_=O_;var R_=function(e){void 0===e&&(e={});var t=l.default.class("NarrativesBlock",{empty:e.isEmpty,collapsed:e.isCollapsed}),n=(0,yt.getNumShort)(e.hiddenNarrativesCount),o=(0,yt.makeUrl)("narratives",{owner_id:e.ownerId}),a=(0,yt.makeUrl)("narratives",{act:"create",owner_id:e.ownerId});return e.isEmpty?{inner:[{inner:[{inner:[{inner:[(0,yt.getLang)("mobile_narratives_block_title")],class:"slim_header_label",tag:"span"},{inner:[(0,f.Icon24ChevronRight)()],class:"slim_header_rl",tag:"span"}],class:"slim_header slim_header_black",tag:"div"}],class:"NarrativesBlock__header link_header",onClick:["NarrativesBlock.onToggle","event"],tag:"div"},{inner:[(0,mt.default)({inner:[(0,yt.getLang)("mobile_narratives_block_create_narrative_label")],theme:"none",url:a,onClick:"return NarrativesBlock.onCreateNarrativeClick("+e.ownerId+", this, event);",use_native_onclick:!0,class:"NarrativesBlock__createBtn",icon:(0,f.Icon24NarrativeOutline)()}),{inner:[(0,yt.getLang)("mobile_narratives_block_empty_description")],class:"NarrativesBlock__emptyPlaceholder",tag:"p"}],class:"NarrativesBlock__content",tag:"div"}],class:t,tag:"div"}:{inner:[{inner:[{inner:[{inner:[(0,yt.getLang)("mobile_narratives_block_title")],class:"slim_header_label",tag:"span"},{inner:[e.narrativesTotalCount],class:"slim_header_cnt",tag:"span"},{inner:[(0,f.Icon24ChevronRight)()],class:"slim_header_rl",tag:"span"}],class:"slim_header slim_header_black",tag:"div"}],class:"NarrativesBlock__header link_header",href:o,onClick:"return NarrativesBlock.onHeaderClick("+e.ownerId+", this, event);",rel:"noopener",tag:"a"},(0,Tn.default)({inner:[e.isCreateBlockVisible?{inner:[{inner:[(0,f.Icon24Add)()],class:"NarrativesBlockItem__cover",tag:"div"},{inner:[(0,yt.getLang)("mobile_narratives_block_create_narrative_label")],class:"NarrativesBlockItem__title",tag:"div"}],class:"NarrativesBlockItem NarrativesBlockItem--create",href:a,onClick:"return NarrativesBlock.onCreateNarrativeClick("+e.ownerId+", this, event);",tag:"a"}:null,e.narratives.map((e=>x_(e))),e.isMoreBlockVisible?{inner:[{inner:["+",n],class:"NarrativesBlockItem__cover",tag:"div"},{inner:[(0,yt.getLang)("mobile_narratives_block_more_narratives_label")],class:"NarrativesBlockItem__title",tag:"div"}],class:"NarrativesBlockItem NarrativesBlockItem--more",href:o,onClick:"return NarrativesBlock.onShowMoreClick("+e.ownerId+", this, event);",tag:"a"}:null],mix:"NarrativesBlock__content"})],class:t,tag:"div"}};Object.assign(R_,{onToggle:function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.closest(".NarrativesBlock");if(!n)return n;n.classList.toggle("NarrativesBlock--collapsed")},onCreateNarrativeClick:function(e,t,n){return(0,de.sendNarrativeAnalytic)(de.NarrativeAnalyticEventType.createNarrative,{ownerId:e},e>0?de.NarrativeAnalyticNavScreen.profile:de.NarrativeAnalyticNavScreen.club),window.nav.go(t,n)},onHeaderClick:function(e,t,n){return(0,de.sendNarrativeAnalytic)(de.NarrativeAnalyticEventType.openNarrativeList,{ownerId:e},e>0?de.NarrativeAnalyticNavScreen.profile:de.NarrativeAnalyticNavScreen.club),window.nav.go(t,n)},onShowMoreClick:function(e,t,n){return(0,de.sendNarrativeAnalytic)(de.NarrativeAnalyticEventType.seeMore,{ownerId:e},e>0?de.NarrativeAnalyticNavScreen.profile:de.NarrativeAnalyticNavScreen.club),window.nav.go(t,n)}}),window.NarrativesBlock=R_;var N_=n(75127),D_=(0,ft.withStatic)((function(e,t,n,o,a){void 0===n&&(n=0),void 0===o&&(o=""),void 0===a&&(a={});var i=""+e+(n?"_"+n:"")+"/"+(o=o||"narrative"+e+"_"+t);Object.assign(a,{narrativeRawId:e+"_"+t}),window.Stories.init(i,a)}),["stories.js"]);window.showNarrative=D_,window.GroupsMenu={},window.GroupsMenu._onClick=function(e,t,n,a,i){return(0,o.statlogsValueEvent)("groups_menu_item_click",e,t,n,a,i),!0};var F_=function(e){void 0===e&&(e={});var t=null;e.ok_button&&(t=(0,mo.ModalMenuBtn)({url:e.proceed_url,class:"WarningModal__button",theme:e.is_action?"regular":"secondary",size:"large",inner:e.ok_button,onclick:["WarningModal.close","this","event"],attrs:{"data-id":e.id,"data-hash":e.hash,"data-gid":e.gid,"data-uid":e.user_id,"data-need-reload":e.need_reload_on_accept?1:0,"data-isaction":e.is_action?1:0}}));return(0,mo.default)({on_overlay_click:e.is_action?["ModalMenu.close","this"]:"return false;",class:"Popup_open",body:{class:"WarningModal",inner:[!e.is_action&&{class:"WarningModal__icon",inner:(0,f.Icon56HideOutline)()},{class:"WarningModal__title",inner:e.title},{class:"WarningModal__text",inner:e.text}]},items:[(0,mo.ModalMenuBtn)({url:"/groups",class:"WarningModal__button",theme:e.is_action?"secondary":"regular",size:"large",inner:e.back_button,onclick:["WarningModal.leave","this","event"],attrs:{"data-id":e.id,"data-hash":e.hash,"data-gid":e.gid,"data-uid":e.user_id,"data-isaction":e.is_action?1:0}}),t]})};window.WarningModal=F_,(0,o.extend)(F_,{close:function(e,t){t&&t.preventDefault(),ha.default.close(e);var n=j.default.post("/groups",{_ajax:1,act:"hide_warning_notification",notification_id:e.dataset.id,group_id:e.dataset.gid,hash:e.dataset.hash}).promise.then((()=>{if(e.dataset.isaction){var t=nav.path+(0,o.obj2qs)((0,_t.default)({},nav.getQuery()||{},{action:void 0}))+nav.hash;nav.go(t,{push_only:!0})}}));Number(e.dataset.needReload)&&n.promise.then((()=>nav.reload()))},leave:function(e,t){if(t&&t.preventDefault(),ha.default.close(e),e.dataset.isaction){var n=nav.path+(0,o.obj2qs)((0,_t.default)({},nav.getQuery()||{},{action:void 0}))+nav.hash;nav.go(n,{push_only:!0})}else{var a=(0,K.$)("#m .header__back");a?a.click():window.history?window.history.back():window.location="/"}}}),window.Donut={help:function(e,t){var{lang:n}=window,a=(0,o.geByClass1)("Tooltip",e);if(a)return;return a=d.default.elem((0,I_.default)({pos:"left",inner:n.mobile_donut_info_text})),e.appendChild(a),(0,o.cancelEvent)(t)}};n(7682);var U_=n(30675);n(94123);function H_(e){void 0===e&&(e={});var t={inner:[e.icon],class:"SplashScreen__icon",tag:"div"};return(0,U_.default)({icon_raw:t,title:e.title,text:e.description,action_text:e.action_text,action_url:e.action_url,before:j_(e),class:"DonutPaymentInfo"})}function j_(e){return void 0===e&&(e={}),{inner:["form"===e.layout?[{inner:[{inner:[(0,f.Icon12StarCircleFillYellow)()],class:"DonutPayment__avatarIcon",tag:"div"}],class:"DonutPayment__avatar",style:"background-image: url("+e.avatar+")",tag:"div"},{inner:[e.title],class:"DonutPayment__title",tag:"h2"},e.description?{inner:[e.description],class:"DonutPayment__description",tag:"span"}:null]:null],class:"DonutPayment__header",tag:"div"}}var $_=n(58776),V_=n(80681),W_=n(36810),K_=n(3859),q_=n(48328),G_={},z_=(0,K_.getPaymentSessionInitialData)(),Q_=()=>X_({title:(0,o.getLang)("mobile_donut_payment_info_error"),description:(0,o.getLang)("mobile_donut_payment_info_canceled_text")}),Y_={init:function(e){var{backURL:t,isCustomPriceVisible:n,ownerId:a,source:i,type:r,waitingTimeSec:s,successActionUrl:l}=e;(0,K_.handlePaymentComponentChange)(z_,Y_),G_={backURL:t,ownerId:a,source:i,type:r,waitingTimeSec:s,successActionUrl:l};var c=(0,K.$)("#custom_price_input"),d=c&&c.checked;tp(n||d),"subscribe"===r&&(u=(0,K.$)('[data-section-ref="donut_payment_external_links"]'))&&(0,o.addEvent)(u,"click",(e=>{(0,o.matchesSelector)(e.target,"a")&&ap()}));var u;(0,K_.handlePaymentComponentDestroy)(z_,Y_)},onCustomAmountChange:function(e,t){return(0,K.$)("#custom_price_input").checked=!0,kt.default.filter("number",e,t)},onLegalExternalLinkClick:ap,onFormSubmit:function(e,t){e.preventDefault();var n=(0,$_.getFormValues)(t),a=(0,ho.parseURL)(t.action);"subscribe"===G_.type&&function(e,t,n){var a=z_.id,i=(0,o.submitBtn)(n),r=(0,K_.getPaymentWindow)((0,o.getLang)("mobile_donut_payment_info_waiting"));mt.default.setLoading(i,!0);var s=window.ajax.post(e.requestUri,t);(0,K_.handleRequestAbortOnDestroy)(s),s.promise.then((e=>{var{json:n,skip:s}=e;if(!s){if(a!==z_.id)throw new Error;mt.default.setLoading(i,!1);var l=n.data[0],c=(0,ho.makeUrl)(window.nav.path,{act:"donut_payment_check",hash:t.hash});(0,K_.startPaymentWaiting)((0,_t.default)({sessionIdCurrent:z_.id,paymentURL:l,paymentWindow:r,getIsSuccess:()=>{var e=window.ajax.post(c,{});return(0,K_.handleRequestAbortOnDestroy)(e),e.promise.then((e=>{var t,{json:n,skip:i}=e;if(!i){if(a!==z_.id)throw new Error;if(!n)throw new Error;return!!(null==n||null==(t=n.data)?void 0:t[0].status)&&(X_({title:(0,o.getLang)("mobile_donut_payment_info_success"),description:n.data[0].text}),op(w.RESULT_PAYMENT_SUCCESS_OK),G_.successActionUrl&&(nav.hard_go(G_.successActionUrl),G_.successActionUrl=void 0),!0)}}))}},{onLoading:()=>{J_()},onResponse:()=>{op(w.RESULT_PAYMENT_SUCCESS_WAITING)},onCancel:()=>{Q_(),op(w.RESULT_PAYMENT_CANCEL)},onFailure:()=>{Q_(),op(w.RESULT_ERROR)},onTimeout:()=>{X_({title:(0,o.getLang)("mobile_donut_payment_info_success"),description:(0,o.getLang)("mobile_donut_payment_info_success_later_text"),type:"success"}),op(w.RESULT_PAYMENT_SUCCESS_WAITING_TIMEOUT)}}))}})).catch((e=>{console.error(e),mt.default.setLoading(i,!1),Z_({message:(0,o.getLang)("mobile_unknown_error")}),(0,K_.closePaymentWindow)(r)}))}(a,n,t);"change"===G_.type&&function(e,t,n){var a=z_.id,i=(0,o.submitBtn)(n);mt.default.setLoading(i,!0),r=(0,K.$)('[data-section-ref="donut_payment_form_error"]'),r&&(r.innerHTML="");var r;var s=(d=t,-1===Number(d.price)?Number(d.custom_price):Number(d.price)),l=(0,K_.getPaymentWindow)((0,o.getLang)("mobile_donut_payment_info_waiting")),c=window.ajax.post(e.requestUri,t);var d;(0,K_.handleRequestAbortOnDestroy)(c),c.promise.then((e=>{var t,{json:n,skip:r}=e;if(!r){var c=null==n||null==(t=n.data)?void 0:t[0];if(a!==z_.id||!c||!Object.keys(c).length)throw new Error;if(mt.default.setLoading(i,!1),null==c?void 0:c.error)return Z_({message:null==c?void 0:c.error}),void(0,K_.closePaymentWindow)(l);c.paymentRequiredToComplete?function(e,t,n){var a=z_.id,i=(0,ho.makeUrl)(window.nav.path,{act:"donut_payment_change_check",hash:e.check_hash}),r=()=>{ep({description:e.successDescription}),op(w.RESULT_CHANGE_SUCCESS_OK)};(0,K_.startPaymentWaiting)((0,_t.default)({sessionIdCurrent:z_.id,paymentURL:e.paymentURL,paymentWindow:n,getIsSuccess:()=>{var e=window.ajax.post(i,{});return(0,K_.handleRequestAbortOnDestroy)(e),e.promise.then((e=>{var n,o,{json:i,skip:s}=e;if(!s){if(a!==z_.id)throw new Error;if((null==i||null==(n=i.data)||null==(o=n[0])?void 0:o.amount)===t)return r(i),!0;throw new Error}}))}},(s=()=>{Q_(),op(w.RESULT_CHANGE_ERROR)},{onFailure:s,onCancel:s,onLoading:()=>{J_()},onResponse:()=>{op(w.RESULT_PAYMENT_SUCCESS_WAITING)},onTimeout:()=>{X_({title:(0,o.getLang)("mobile_donut_payment_change_timeout_error_title"),description:(0,o.getLang)("mobile_donut_payment_change_timeout_error_description"),continueButtonURL:G_.backURL}),op(w.RESULT_CHANGE_SUCCESS_WAITING_TIMEOUT)}})));var s}(c,s,l):(ep({description:c.successDescription}),(0,K_.closePaymentWindow)(l))}})).catch((e=>{console.error(e),mt.default.setLoading(i,!1),Z_({message:(0,o.getLang)("mobile_unknown_error")}),(0,K_.closePaymentWindow)(l)}))}(a,n,t)},onPriceRadioChange:function(e){tp(-1===Number(e.value))}};function X_(e){void 0===e&&(e={});var t=(0,K.$)('[data-section-ref="donut_payment_content"]');if(t){var{type:n}=e;try{t.innerHTML=d.default.html(H_({icon:e.icon,layout:"info",type:n,title:e.title||(0,o.getLang)("mobile_donut_payment_info_error"),description:e.description||"",action_text:("success"===n||"error"===n)&&(0,o.getLang)("mobile_donut_payment_button"),action_url:e.continueButtonURL||window.nav.path}))}catch(e){console.error(e)}}}var J_=()=>{X_({title:(0,o.getLang)("mobile_donut_payment_info_waiting"),description:(0,o.getLang)("mobile_donut_payment_info_waiting_text"),type:"loading",icon:{inner:[(0,V.default)({icon:(0,q_.getLoading40Icon)()})],class:"SplashScreen__icon SplashScreen__icon--loading",tag:"div"}})};function Z_(e){var{message:t}=e,n=(0,W_.default)({inner:[(0,V_.default)({inner:[t],theme:"error"})],style:{small_paddings:!0}}),o=(0,K.$)('[data-section-ref="donut_payment_form_error"]');o&&(o.innerHTML=d.default.html(n))}function ep(e){var{description:t}=e;X_({description:t,title:(0,o.getLang)("mobile_donut_payment_change_amount_changed_title"),continueButtonURL:G_.backURL}),op(w.RESULT_CHANGE_SUCCESS_OK)}function tp(e){void 0===e&&(e=!1),(0,o.toggleClass)("DonutPayment__customAmount--visible",(0,K.$)('[data-section-ref="custom_price_input_container"]'),e)}function np(e,t,n){E.logEventAction((0,_t.default)({event_type:e,owner_id:G_.ownerId,screen:t||w.UNKNOWN,source:G_.source},n))}function op(e,t){np(h.PAYMENT_FORM,e,t)}function ap(){np(h.PAYMENT_FORM_CLICK_OFFER,w.PAYMENT_START)}window.DonutPayment=Y_;var ip=!1,rp={start(e,t,n){if("%page_id%"!==e&&!ip){var o;switch(ip=!0,n&&"%page_path%"!==n?n:Z.default.cur){case"/feed":o=ll.default.TAB_ID_FEED;break;case"/feed?section=recommended":o=ll.default.TAB_ID_RECOMMEND;break;case"/search":o=ll.default.TAB_ID_SEARCH;break;case"/mail":o=ll.default.TAB_ID_MESSAGES;break;case"/feed?section=notifications":o=ll.default.TAB_ID_NOTIFICATION}o&&window.innerWidth<882?ll.default.drawSkeletonLoader((0,K.$)(".layout__basis"),o):(ll.default.drawLoader((0,K.$)(".layout__basis")),(0,a.alLoadingFix)()),setTimeout((()=>{var o={headers:{"X-AppShell-Start-Id":e,"X-AppShell-Start":t},zProcess:()=>{}};window.ajax.onNavDone(rp.onStarted),n&&"%page_path%"!==n?Z.default.go(n,{push_only:!0,replace:!0},o):Z.default.go(Z.default.cur,null,o)}))}},onStarted(){window.ajax.onNavDone.off(rp.onStarted),(0,A.calculateTimeOffsets)()}},sp=rp;window.AppShell=sp;var lp={reload(e){mt.default.setDisabled(e,!0),!1===navigator.onLine?setTimeout((function(){mt.default.setDisabled(e,!1)}),500):Z.default.reload()}};window.OfflinePage=lp;var cp=n(2947);var dp=function(e){var t=e.info||{},n="//"+(0,yt.getHostName)()+"/mp3/bb1.mp3";return{inner:[{inner:[{inner:[Object.keys(t).map((e=>{var n=t[e];return"boolean"==typeof n&&(n=n?"yes":"no"),function(e,t){return{inner:[{inner:[e],tag:"b"},"\n      :\n      ",{inner:[t],tag:"i"}],tag:"div"}}(e,n)}))],class:"fi_row",tag:"div"},{inner:[{inner:[{inner:[{inner:[{inner:"Audio tag not support",tag:"b"}],src:n,tag:"source"}],preload:"none",controls:"controls",style:"width: 100%;",tag:"audio"}],style:"color: #777;",tag:"div"}],class:"fi_row",tag:"div"},{inner:[{inner:[{type:"hidden",id:"device_info_text",name:"device_info",value:e.fallbackText,tag:"input"},{inner:[e.needSendButton&&(0,mt.default)({inner:[(0,yt.getLang)("mobile_send_device_info")],submit:!0,stretch:!0,onClick:e.onSendClick})],class:"cp_buttons_block",tag:"div"}],action:"/?device",method:"post",tag:"form"}],class:"fi_row",tag:"div"}],class:"form_item",tag:"div"}],class:"PageBlock DeviceInfo fit_box",style:"color: #777; line-height: 1.7",tag:"div"}};class up extends cp.Component{constructor(e){super(e),this.onSendClick=e=>{e.preventDefault();var{info:t}=this.state,n=Object.keys(t).map((e=>e+": "+t[e])).join("\n");j.default.post("/?device",{_ajax:!0,device_info:n},{onDone:e=>{1===e?(self.setState({needSendButton:!1}),Snackbar.init({text:getLang("mobile_device_info_sent")})):Snackbar.init({text:getLang("mobile_unknown_error")})}})},this.state=(0,_t.default)({},e)}_testAudio(){return!!window.Audio&&(new Audio).canPlayType("audio/mpeg")}_testPhotoView(e){var t=document.createElement("div").style,n=[];return void 0!==t.webkitTransform&&n.push("webkitTransform"),void 0!==t.MozTransform&&n.push("MozTransform"),void 0!==t.msTransform&&n.push("msTransform"),void 0!==t.OTransform&&n.push("OTransform"),e+" ("+n.join(", ").replace(/^(, )+|(, )+$|(, )(, )+/g,"$3")+")"}_testFileAPI(e){return e+" ("+[window.XMLHttpRequest?"XMLHttpRequest":"",window.XDomainRequest?"XDomainRequest":"",window.FormData?"FormData":"",window.FileReader?"FileReader":"",window.XMLHttpRequest&&XMLHttpRequest.sendAsBinary?"sendAsBinary":"",window.ArrayBuffer?"ArrayBuffer":"",window.Uint8Array?"Uint8Array":"",window.MozBlobBuilder?"MozBlobBuilder":"",window.WebKitBlobBuilder?"WebKitBlobBuilder":"",window.BlobBuilder?"BlobBuilder":""].join(", ").replace(/^(, )+|(, )+$|(, )(, )+/g,"$3")+")"}componentDidMount(){var{info:e}=this.state;e.Audio=this._testAudio(),e["Fullscreen Photoview"]=this._testPhotoView(e["Fullscreen Photoview"]),e.FileAPI=this._testFileAPI(e.FileAPI),this.setState({info:e})}render(){return d.default.preact(dp,(0,_t.default)({},this.state,{onSendClick:this.onSendClick}))}}var _p=up;function pp(){var e=$("#DeviceInfo");d.default.hydrate(_p,(0,yt.getState)("DeviceInfo"),e)}function mp(e){return{inner:[{inner:[e.before],class:"MiniInfoCell__before",tag:"div"},{inner:[e.text],class:"MiniInfoCell__content",tag:"div"}],class:"MiniInfoCell",tag:"div"}}function fp(){return{inner:[(0,Ua.default)()],class:"VacancyPhone__spinner",tag:"div"}}function vp(){return(0,mo.default)({on_overlay_click:["return VacancyPhone.close","this"],class:"VacancyPhone",onClose:["return VacancyPhone.close","this"],body:{inner:[{inner:[(0,f.Icon12Cancel)()],class:"VacancyPhone__close",onClick:"VacancyPhone.close(this)",tag:"button"},{class:"VacancyPhone__content",tag:"div"}],class:"VacancyPhone__wrap",tag:"div"}})}y.default.getRouter().addRoute("/?device",pp),window.initDeviceInfo=pp;var gp,hp,wp=n(83788),yp=function(){function e(e){this.clickStatCollector=e}return e.prototype.logEvent=function(e,t){var n,o=((n={type:C.ClickProductionStatEventTypes.TYPE_WORKI_CLICK})[C.ClickProductionStatEventTypes.TYPE_WORKI_CLICK]=(0,u.__assign)((0,u.__assign)({},t),{screen:window.cur.module}),n);this.clickStatCollector.logEvent(o,{type:e})},e}();!function(e){e.CLICK_CTA="click_cta",e.CLICK_CALL="click_call"}(gp||(gp={})),function(e){e.TYPE_WORKI_SNIPPET_ITEM="type_worki_snippet_item"}(hp||(hp={}));var kp=new(function(){function e(e){void 0===e&&(e=new yp(wp.clickStat)),this.collector=e}return e.prototype.onPhoneClick=function(e){this.collector.logEvent(C.EventItemType.WORKI_SNIPPET,{event_name:gp.CLICK_CALL,event_type:hp.TYPE_WORKI_SNIPPET_ITEM,wallitem_id:e})},e.prototype.onCtaClick=function(e){this.collector.logEvent(C.EventItemType.WORKI_SNIPPET,{event_name:gp.CLICK_CTA,event_type:hp.TYPE_WORKI_SNIPPET_ITEM,wallitem_id:e})},e}()),bp={open:function(e,t,n,o,a){var{$btn:i}=a,r=i.closest(o),s=(0,K.$)(Ep,r);if(s){var l=ha.default.open(s,!0,"",{expandable:!0}),c=l.querySelector(Ip);return c&&(c.innerHTML=d.default.html(fp()),Cp=Lp(e,n,t,c),Sp=()=>{Bp(l),Cp()},nav.onBeforeGo(Sp),kp.onCtaClick(t)),l}return!1},close:Bp,retry:function(e,t,n,o){var{$btn:a}=o,i=a.closest(Ip);i&&(i.innerHTML=d.default.html(fp()),Cp=Lp(e,t,n,i))},onClickCall:function(e){e&&kp.onPhoneClick(e);return!0}},Sp=()=>{},Cp=()=>{},Ep=".VacancyPhone",Tp=".VacancyPhone.Popup_open",Ip=".VacancyPhone__content";function Mp(e,t,n){var o,a,i,r,s,l,c,u,_;t.wallitemId=n,e.innerHTML=d.default.html((a=(o=t).phone,i=o.name,r=o.profession,s=o.company,l=(0,yt.getLang)("market_worki_snippet_phone_modal_title"),c=(0,yt.getLang)("market_worki_snippet_phone_modal_call"),u="tel:"+a,_=11===a.length?"+"+a.substr(0,1)+" "+a.substr(1,3)+" "+a.substr(4,3)+" "+a.substr(7,2)+" "+a.substr(9,2):a,[(0,f.Icon56PhoneOutline)(),{inner:[_],class:"VacancyPhone__phone",tag:"div"},{inner:[i],class:"VacancyPhone__name",tag:"div"},{class:"VacancyPhone__separator",tag:"div"},{inner:[l],class:"VacancyPhone__label",tag:"div"},{inner:[mp({before:(0,f.Icon20UserOutline)(),text:r}),mp({before:(0,f.Icon20WorkOutline)(),text:s})],class:"VacancyPhone__info",tag:"div"},(0,mt.default)({inner:[c],class:"VacancyPhone__call",url:u,role:"link",theme:"large",onClick:'VacancyPhone.onClickCall("'+o.wallitemId+'")',use_native_onclick:!0})]))}function Pp(e,t){e.innerHTML=d.default.html(function(e){var{id:t,hash:n,wallitemId:o}=e,a=["VacancyPhone.retry",t,n,o];return{inner:[{inner:[(0,yt.getLang)("mobile_market_worki_snippet_phone_modal_error")],class:"VacancyPhone__text",tag:"p"},(0,mt.default)({inner:[(0,yt.getLang)("mobile_market_worki_snippet_phone_modal_error_retry")],class:"VacancyPhone__retry",theme:"link",onClick:a})],class:"VacancyPhone__error",tag:"div"}}(t))}function Lp(e,t,n,o){return window.ajax.post("worki.php",{act:"get_vacancy",vacancy_id:e,hash:t},{onDone(a){a?Mp(o,a,n):Pp(o,{id:e,hash:t,wallitemId:n})},onFail(){Pp(o,{id:e,hash:t,wallitemId:n})}}).abort}function Bp(e){return e||(e=(0,K.$)(".Popup_open.VacancyPhone")||(0,K.$)(Tp)),e&&(ha.default.close(e),Cp()),nav.onBeforeGo.off(Sp),!1}Object.assign(vp,bp);var Ap=vp;window.VacancyPhone=Ap;var Op=n(48289),xp=n(34017),Rp=n(85221),Np=(n(80643),n(13933),"4g"),Dp="3g",Fp="2g",Up="slow-2g",Hp="wifi",jp="ethernet",$p="cellular",Vp="bluetooth",Wp="none",Kp="mixed",qp="wimax",Gp="mvk_connection_types",zp="mvk_connection_types_timeout",Qp="remixlroff",Yp=function(){function e(){this.connection=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection,this.connection?(this.badConnectionTimerCounter=0,this.currentConnection=this.updateConnection(this.connection),this.prevConnection=this.updateConnection(this.connection),this.connection.addEventListener("change",this.onConnectionChange.bind(this)),this.isBadQuality=this.isHasBadConnectionQuality(this.currentConnection)):(0,N.statlogsValueEvent)(Gp,"not_supported")}return e.prototype.showSnackbar=function(){if(!(window.vk.liteMode.enabled||window.vk.liteMode.reminderDisabled||(0,dt.getCookie)(Qp))){var e=window.vk.liteMode.hash;this.snackbar=W.init({duration:8e3,text:(0,yt.getLang)("mobile_lite_snackbar_text"),action:{text:window.getLang("mobile_lite_snackbar_action_text"),onclick:"LiteSettings.switchLiteMode({ name: 'lite_mode_active', checked: true, value: '"+e+"' }); window.connectionType.hideSnackbar();"}}),(0,dt.setCookie)(Qp,"true",1/1440*30)}},e.prototype.hideSnackbar=function(){W.close(this.snackbar)},e.prototype.startBadConnectionTimer=function(){var e=this;this.badConnectionTimer||(this.badConnectionTimer=setInterval((function(){e.updateBadConnectionTimer()}),1e3))},e.prototype.stopBadConnectionTimer=function(){this.badConnectionTimer&&(clearInterval(this.badConnectionTimer),this.badConnectionTimer=0,this.badConnectionTimerCounter=0,this.badConnectionTimer10=!1,this.badConnectionTimer20=!1,this.badConnectionTimer30=!1)},e.prototype.updateBadConnectionTimer=function(){this.badConnectionTimerCounter++,this.badConnectionTimerCounter>=30&&!this.badConnectionTimer30?((0,N.statlogsValueEvent)(zp,"supported",this.prevConnection.type,this.currentConnection.type,this.prevConnection.effectiveType,this.currentConnection.effectiveType,"30",window.cur.module),this.badConnectionTimer30=!0):this.badConnectionTimerCounter>=20&&!this.badConnectionTimer20?((0,N.statlogsValueEvent)(zp,"supported",this.prevConnection.type,this.currentConnection.type,this.prevConnection.effectiveType,this.currentConnection.effectiveType,"20",window.cur.module),this.badConnectionTimer20=!0,this.showSnackbar()):this.badConnectionTimerCounter>=10&&!this.badConnectionTimer10&&((0,N.statlogsValueEvent)(zp,"supported",this.prevConnection.type,this.currentConnection.type,this.prevConnection.effectiveType,this.currentConnection.effectiveType,"10",window.cur.module),this.badConnectionTimer10=!0)},e.prototype.updateConnection=function(e){return Object.assign({},{type:e.type,effectiveType:e.effectiveType})},e.prototype.onChangeToBadConnection=function(){this.startBadConnectionTimer(),(0,N.statlogsValueEvent)(Gp,"supported",this.prevConnection.type,this.currentConnection.type,this.prevConnection.effectiveType,this.currentConnection.effectiveType,"to_bad_connection",window.cur.module)},e.prototype.onChangeToGoodConnection=function(){this.stopBadConnectionTimer(),(0,N.statlogsValueEvent)(Gp,"supported",this.prevConnection.type,this.currentConnection.type,this.prevConnection.effectiveType,this.currentConnection.effectiveType,"to_good_connection",window.cur.module)},e.prototype.onChangeToNoConnection=function(){(0,N.statlogsValueEvent)(Gp,"supported",this.prevConnection.type,this.currentConnection.type,this.prevConnection.effectiveType,this.currentConnection.effectiveType,"to_no_connection",window.cur.module)},e.prototype.onChangeToUnknownConnection=function(){(0,N.statlogsValueEvent)(Gp,"supported",this.prevConnection.type,this.currentConnection.type,this.prevConnection.effectiveType,this.currentConnection.effectiveType,"to_unknown_connection",window.cur.module)},e.prototype.isHasBadConnectionQuality=function(e){return e.effectiveType===Dp||e.effectiveType===Fp||e.effectiveType===Up},e.prototype.onConnectionChange=function(){this.currentConnection=this.updateConnection(this.connection),this.isBadQuality=this.isHasBadConnectionQuality(this.currentConnection),this.currentConnection.type&&this.currentConnection.type!==$p&&this.currentConnection.type!==Vp?this.currentConnection.type===Hp||this.currentConnection.type===jp||this.currentConnection.type===qp||this.currentConnection.type===Kp?this.onChangeToGoodConnection():this.currentConnection.type===Wp?this.onChangeToNoConnection():this.onChangeToUnknownConnection():this.prevConnection.effectiveType===Np&&(this.currentConnection.effectiveType===Dp||this.currentConnection.effectiveType===Fp||this.currentConnection.effectiveType===Up)||this.prevConnection.effectiveType===Dp&&(this.currentConnection.effectiveType===Fp||this.currentConnection.effectiveType===Up)||this.prevConnection.effectiveType===Fp&&this.currentConnection.effectiveType===Up?this.onChangeToBadConnection():this.currentConnection.effectiveType!==Np||this.prevConnection.effectiveType!==Dp&&this.prevConnection.effectiveType!==Fp&&this.prevConnection.effectiveType!==Up||this.onChangeToGoodConnection(),this.prevConnection=this.updateConnection(this.currentConnection)},e}();window.Lite={ConnectionType:Yp};var Xp=n(68673),Jp={onClick:function(e){var t=e.querySelector(".BlurredImage__btn");t&&((0,Xp.setLoading)(t,!0),(0,Xp.setDisabled)(t,!0));var n=e.closest(".BlurredImage");n&&n.classList.add("BlurredImage--loaded")}};window.BlurredImage=Jp,window.jsc=e=>"dist/"+e,(0,D.initAPI)(),(0,k.initStaticManager)(),document.scrollListenerAlreadyInited||(document.scrollListenerAlreadyInited=!0,(0,o.addEvent)(window,"scroll touchmove",(()=>{var e,t;(null==(e=window.Speech)||null==(t=e.recorder)?void 0:t.isRecording)||(0,o.onBodyScroll)(!0)}),{passive:!0})),window.trackEvent=Q.trackEvent;var{thover:Zp,ajax:em}=window;if(H.default.safari_mobile&&15===H.default.ios){var tm="_safari_ios15_keyboard_opened";Y.onOpenCallback((()=>document.documentElement.classList.add(tm))),Y.onCloseCallback((()=>document.documentElement.classList.remove(tm)))}function nm(){if((0,o.lsGet)("custom_opts"))return(0,o.addClass)("_copts","vk_wrap");var e=(0,o.ce)("div",{innerHTML:'<input id="copts_test_radio" type="radio" checked="checked"><div id="copts_test_label"></div>'});(0,o.append)(e,"vk_utils");var t=(0,o.ge)("copts_test_label");t&&Math.abs(t.offsetWidth-5)<1&&((0,o.addClass)("_copts","vk_wrap"),(0,o.lsSet)("custom_opts",1)),(0,o.remove)(e)}(0,o.addEvent)(document,"touchmove touchcancel",Zp.cancel,{passive:!0}),(0,o.addEvent)(document,"touchend",Zp.end,{passive:!0}),onDOMReady((()=>{(0,Rp.initInteractionMethodListener)(document.body.classList.contains("_touch")?"touch":"mouse")})),em.enabled=!0,em.enabled&&(onDOMReady((function(){(0,o.remove)("app_go_frame"),em.prepare_click(),menu&&menu.init(),(0,o.addClass)("_js","vk_wrap")})),page.clear()),onDOMReady((()=>{y.default.getRouter().checkRoutes(),window.page&&window.page.onChange((()=>{window.page.fast_load?y.default.getRouter().deactivateAllRoutes():y.default.getRouter().checkRoutes()}));var e=document.getElementById("utils");e||((e=document.createElement("div")).id="utils",document.body.insertAdjacentElement("afterbegin",e)),window.utilsNode=e})),onDOMReady(F.resizePosters),(0,o.addEvent)(window,"resize",F.resizePosters),(0,o.addEvent)(document,"touchstart",(function(e){var t=(0,o.checkTouchHover)(e.target);Zp.clear(),t&&Zp.start.call(t,e)}),{passive:!0}),document.clickListenerAlreadyInited?setTimeout((()=>{var e=Array.from(document.querySelectorAll("script")).map((e=>e.src));(0,N.statlogsValueEvent)("mvk_click_common_multiple_init",1,"common",e.join("|"),location.href)}),0):(document.clickListenerAlreadyInited=!0,(0,o.addEvent)(document,"click",(function(e){var t,n;if((null==(t=e.target)||null==(n=t.dataset)?void 0:n.donutLogEvent)&&M(e.target.dataset.donutLogEvent,e.target),(0,o.ajaxLayoutEnabled)()){var a=(0,o.gpeByClass)("al_after",e.target);if(a){var i=(0,o.attr)(a,"data-target"),r=!!i&&(0,o.geByClass1)(i,a);if(r&&!nav.go_after(r,e)||!nav.go_after(a,e))return}var s=(0,o.matchesSelector)(e.target,".mi_text a");if(P.SAKIntegration.isIntegrated&&s)if(!e.target.getAttribute("mention_id"))return void(e.target.target="_blank");var l=(0,o.checkNav)(e.target,{allow_post_away:!0});if(l&&(document.activeElement&&document.activeElement.tagName&&"input"===document.activeElement.tagName.toLowerCase()&&document.activeElement.blur(),nav.go(l,e)||(0,o.cancelEvent)(e)),"bookmarks"===cur.module){var c=e&&e.target&&(e.target.closest(".BookmarksItem_link")||e.target.closest(".BookmarkSlider__item")||e.target.closest(".OwnerRow"));if(!c)return;var d=c.getAttribute("id"),[u,_,p,m]=d.match(/^(link|page)(-?\d+)_(-?\d+)?$/)||[];if(!(u&&_&&p&&m))return;var f=!1;switch(_){case"link":f=e.target.closest('a[target="_blank"]');break;case"page":f=e.target.closest(".OwnerRow__content")||e.target.closest(".OwnerColumn")}if(!f)return;(0,N.statlogsValueEvent)("bookmarks_product_analytics",{item_type:_,item_owner_id:intval(p),item_id:intval(m),time:vk.ts+Math.floor(((new Date).getTime()-vk.started)/1e3)})}}}))),document.submitListenerAlreadyInited||(document.submitListenerAlreadyInited=!0,(0,o.addEvent)(document,"submit",(function(e){var t=e.target;(0,o.hasClass)("vk_js_yes",geByTag1("html"))&&!(0,o.hasClass)("opera_mini_yes",geByTag1("body"))&&(0,o.hasClass)("qsearch",t)&&(0,o.gpeByClass)("audioPage",t)&&(geBySel1('[type="submit"]',t).click(),(0,o.cancelEvent)(e))}))),document.touchStartListenerAlreadyInited||(document.touchStartListenerAlreadyInited=!0,(0,o.addEvent)(document,H.isTouch?"touchstart":"mousedown",(function(e){tooltip.closeByTap(e)}),{passive:!0})),onDOMReady(nm),onDOMReady((function(){(0,N.statlogsValueEvent)("mvk_feature_is_supported",Number((0,X.isSupportsSupported)()),"css_supports"),(0,N.statlogsValueEvent)("mvk_feature_is_supported",Number((0,X.isGridsSupported)()),"grids"),(0,N.statlogsValueEvent)("mvk_feature_is_supported",Number((0,X.isWebRTCCallsSupported)()),"webrtc_calls"),(0,N.statlogsValueEvent)("mvk_feature_is_supported",Number((0,X.isJsModulesSupported)()),"js_modules"),(0,N.statlogsValueEvent)("mvk_feature_is_supported",Number((0,X.isMutationObserverSupported)()),"mutation_observer"),(0,N.statlogsValueEvent)("mvk_dark_theme",Number((0,X.isDarkTheme)()),"current"),function(){var e={is_schemes_supported:(0,X.isCSSVariablesSupported)(),is_auto_schemes_supported:(0,X.isAutoSchemesSupported)(),current_scheme:(0,X.isDarkTheme)()?2:(0,X.isLightTheme)()},t=Object.keys(e).sort().map((t=>t+":"+Number(e[t]))).join("/");if(localStorage&&localStorage.getItem){var n=localStorage.getItem(J);null!==n&&t===n||(localStorage.setItem(J,t),(0,N.statlogsValueEvent)("browser_features",t))}}()}));onDOMReady((()=>{UnsupportedBrowser.isDetected&&UnsupportedBrowser.readyToBeShown(7)&&UnsupportedBrowser.show()})),onDOMReady(A.calculateTimeOffsets),(0,o.sgFix)(),onDOMReady((function(){var{vk:e}=window;if(e&&!e.id&&(0,o.lsCheck)()){var t=Ut.loadFoundSelectorsCache();localStorage.clear(),(null==t?void 0:t.length)&&Ut.writeFoundSelectorsCache(t)}})),window.optionsTest=nm,zlayer.isReady=!0,window.PasswordInput={toggleVisibility:function(e,t,n){void 0===n&&(n=!1),(n?(0,K.$$)(".PasswordInput .PasswordInput__button"):t).forEach((e=>{setTimeout((()=>{var t="true"===e.getAttribute("aria-expanded"),n=(0,kt.getNative)(e.closest(".TextInput"));e.setAttribute("aria-expanded",t?"false":"true"),n.setAttribute("type",t?"password":"text"),e.innerHTML=Wd.html((0,V.default)({icon:t?(0,_o.getViewOutline24Icon)():(0,po.getHideOutline24Icon)()}))}),0)}));var o=t.closest(".TextInput"),a=(0,K.$)(".TextInput__native",o),i=document.activeElement===a||o.classList.contains("TextInput--focused");function s(){!i||(0,r.isTabbing)()?(e.preventDefault(),e.stopPropagation(),t.focus()):a.focus()}s(),setTimeout((()=>s()))}},onDOMReady((()=>{(0,Yl.updateCounters)(),window.page.onChange((()=>{window.page.lastTrackedPage!==nav.cur&&(0,Yl.updateCounters)()}))})),window.MsgTemplates||(window.MsgTemplates={Carousel:{handleElementAction:N_.handleElementAction,moveSlider:N_.moveSlider,onScroll:N_.onScroll}}),window.MarketAnalyticsManager=Op.MarketAnalyticsManager,window.Form=xp.Form,window.setIsomorphicState=yt.setState,window.emitServerEvent=yt.emitServerEvent,onDOMReady((function(){window.connectionType=new Yp,b.navigationStat.addStatEvent(b.navigationStat.getModule(),b.NavigationProductionStatEventTypes.TAB_OPEN),(new Ut).init()}))},65497:function(){var{gpeByClass:e,hasClass:t,addClass:n,removeClass:o,geByClass1:a,setStyle:i,tooltip:r,ajax:s}=window;window.Fave={showActionsTT(o,s){cancelEvent(s);var l=e("FaveArticles__row",o);if(t(l,"wi_actions_opened"))Fave.hideActionsTT();else{var c=a("wi_actions_wrap",l),d=a("FaveArticles__row_actions",l);i(c,"top",o.offsetTop+o.offsetHeight+"px"),n(l,"wi_actions_opened"),r.addHandler(Fave.hideActionsTT),r.show(c,d)}},hideActionsTT(){o("wi_actions_opened",a("wi_actions_opened")),r.hide()},removeArticle(t,a,i){Fave.hideActionsTT();var r=e("FaveArticles__row",t);n(r,"removed"),s.post("fave.php",{act:"defave_article",link:a,hash:i},{onFail:()=>o(r,"removed")})},restoreArticle(t,a,i){var r=e("FaveArticles__row",t);o(r,"removed"),s.post("fave.php",{act:"enfave_article",link:a,hash:i},{onFail:()=>n(r,"removed")})}}},38920:function(){var e=function(){var t=null,n=!1;function o(e,t){var n=ge("medias_map"),o=ge("attached_wrap");n||(n=ce("div",{id:"medias_map",className:"pi_medias"}),o.appendChild(n));var a=e.latitude,i=e.longitude,r=(window.devicePixelRatio,geByClass1("medias_map",n)),s=t?'<div class="medias_map_close"><i class="i_close">&nbsp;</i></div><div class="medias_map_label">'+t+"</div>":"",l='<input type="hidden" name="map" value="'+(a+"_"+i+"_0")+'">';r?val(r,s+""+l):val(n,'<div class="meias_row medias_map" onclick="geoloc.remove();">'+s+l+"</div>");show(n)}function a(){t=null,remove("medias_map")}function i(e){var n;e&&e.coords&&(t={latitude:+e.coords.latitude||0,longitude:+e.coords.longitude||0},n=t,ajax.post("/places.php",{_ajax:1,act:"map_label",lat:n.latitude,lng:n.longitude},{onDone:function(e){hide("geo_waiting"),o(n,e)},onFail:r}))}function r(t){e.remove(),hide("geo_waiting")}return{toggle:function(){n?e.remove():e.add()},add:function(e){!e&&n||(n=!0,addClass("cp_geo_btn_sel","geo_btn"),e&&(e.latitude||e.longitude)?o(t={latitude:+e.latitude||0,longitude:+e.longitude||0},e.label):(geo.getCurrentPosition(i,r),show("geo_waiting")))},remove:function(){n&&(n=!1,removeClass("cp_geo_btn_sel","geo_btn"),a())},init:function(t){return t&&e.add(t),geo.init()}}}();window.geoloc=e},1576:function(e,t,n){"use strict";n.d(t,{default:function(){return ue}});var o,a=n(20848),i=n(75105),r=n(79573),s=n(91040),l=n(68040),c=n(38736);!function(e){e[e.MENTIONS=1]="MENTIONS",e[e.CASPER=2]="CASPER"}(o||(o={}));var d=n(26338),u=function(e){var t=(0,r.__read)(e,10),n=t[0],a=t[1],i=t[2],s=t[3],l=t[4],c=t[5],u=t[6],_=t[7],p=t[8],m=t[9],f=Object.assign({},c||{},u||{});return Array.isArray(f.marked_users)&&(f.marked_users=f.marked_users.filter((function(e){return Object.values(o).includes(e[0])}))),{messageId:n,flags:a,peerId:i,date:s,attaches:(0,d.convertKludgesToAttaches)(f,n),subject:f.title||"",text:l,kludges:f,randomId:_,userId:(0,d.isChatPeer)(i)?Number(f.from)||0:i,update_time:m,chat_local_id:p}};n(40906);function _(e){switch(e[0]){case 0:return t=e,n=(0,r.__read)(t,2)[1],{type:p,localId:n};case 1:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:f,messageId:n,mask:o,peerId:a}}(e);case 2:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:m,messageId:n,flags:o,peerId:a}}(e);case 3:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:v,messageId:n,flags:o,peerId:a}}(e);case 4:return function(e){var t=(0,r.__read)(e,12),n=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],d=t[8],_=t[9],p=t[10],m=t[11];return(0,r.__assign)((0,r.__assign)({type:g},u([Number(n),Number(o),Number(i),Number(s),l,c,d,_,p,m])),{minorSortId:a})}(e);case 5:return Y(e);case 6:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:h,peerId:n,upToId:o,unread:a}}(e);case 7:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:w,peerId:n,upToId:o,unread:a}}(e);case 10:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:B,peerId:n,mask:o,local:void 0!==a&&a}}(e);case 11:return function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return{type:A,peerId:n,mask:o}}(e);case 12:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:O,peerId:n,mask:o,local:void 0!==a&&a}}(e);case 13:return function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return{type:N,peerId:n,localId:o}}(e);case 18:return function(e){var t=(0,r.__read)(e,11),n=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],d=t[8],_=t[9],p=t[10];return(0,r.__assign)({type:F},u([Number(n),Number(o),Number(a),Number(i),s,l,c,d,_,p]))}(e);case 19:return function(e){var t=(0,r.__read)(e,2)[1];return{type:U,messageId:t}}(e);case 20:return function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return{type:K,peerId:n,majorId:o}}(e);case 21:return function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return{type:q,peerId:n,minorId:o}}(e);case 23:return function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return{type:G,peerId:n,peerTagsMask:o}}(e);case 51:return function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return{type:b,chatId:n,self:o}}(e);case 52:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:S,peerId:o,updateType:n,updateArg:a}}(e);case 63:return function(e){var t=(0,r.__read)(e,5),n=t[1],o=t[2],a=t[3],i=t[4];return{type:C,peerId:n,userIds:o,totalCount:a,ts:i}}(e);case 64:return function(e){var t=(0,r.__read)(e,5),n=t[1],o=t[2],a=t[3],i=t[4];return{type:E,peerId:n,userIds:o,totalCount:a,ts:i}}(e);case 70:return function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return{type:T,userId:n,callId:o}}(e);case 80:return function(e){var t=(0,r.__read)(e,10),n=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],d=t[8],u=t[9];return{type:I,count:n,countNotMuted:o,showOnlyNotMuted:a,businessNotifyUnread:i,headerTotalUnread:s,headerNotMutedUnread:l,archiveUnreadCount:c,archiveUnreadUnmutedCount:d,archiveMentionsCount:u}}(e);case 114:return function(e){var t=(0,r.__read)(e,2)[1]||{},n=t.peer_id,o=t.sound,a=t.disabled_until;return{type:M,peerId:n,sound:o,disabledUntil:a}}(e);case 115:return function(e){var t=(0,r.__read)(e,2)[1];return{type:W,payload:t}}(e);case 116:return function(e){var t=(0,r.__read)(e,2)[1]||{},n=t.id,o=t.flags,a=t.peer_id,i=t.date,s=t.message,l=t.kludges,c=t.random_id,d=t.chat_local_id,u=t.update_time,_=t.title;return Y([5,n,o,a,i,s,Object.assign({},l||{},{title:_||""}),{},c,d,u])}(e);case 117:return function(e){var t=(0,r.__read)(e,2)[1]||{},n=t.uuid,o=t.device_name;return{type:H,uuid:n,deviceName:void 0===o?"":o}}(e);case 119:return function(e){var t=(0,r.__read)(e,2)[1],n=t.event_id,o=t.owner_id,a=t.peer_id,i=t.action;return{type:P,event_id:n,owner_id:o,peer_id:a,action:i}}(e);case 120:return{type:z};case 10006:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:y,peerId:n,upToCmid:o,unread:a}}(e);case 10007:return function(e){var t=(0,r.__read)(e,4),n=t[1],o=t[2],a=t[3];return{type:k,peerId:n,upToCmid:o,unread:a}}(e);case-1:return{type:x};case-2:return function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];return{type:R,key:n,url:o}}(e);case-3:return function(e){var t=(0,r.__read)(e,2)[1];return{type:j,timeout:t}}(e);case-4:return{type:$};case-5:return{type:V};default:return function(e){return{type:L,params:e}}(e)}var t,n}var p="event_delete",m="event_set_flags",f="event_replace_flags",v="event_reset_flags",g="event_add_message",h="event_read_inbound",w="event_read_outbound",y="event_read_inbound_by_cmid",k="event_read_outbound_by_cmid",b="event_chat_changed",S="event_chat_updated",C="event_typing",E="event_recoding_audio",T="event_video_call",I="event_unread_count",M="event_notify_settings_changed",P="event_keyboard_callback_received",L="event_empty",B="event_reset_directories",A="event_replace_directories",O="event_set_directories",x="event_resync",R="event_refresh_lp_key",N="event_delete_dialog",D="event_edit_message",F="event_replace_message",U="event_invalidate_event",H="event_audio_start",j="event_waiting_for_reconnect",$="event_reconnecting",V="event_reconnected",W="incoming_call",K="event_convo_major_id_changed",q="event_convo_minor_id_changed",G="peer_tags_changed",z="peer_profile_tags_changed",Q=1<<21;function Y(e){var t=(0,r.__read)(e,11),n=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=t[6],c=t[7],d=t[8],_=t[9],p=t[10];return(0,r.__assign)({type:D},u([Number(n),Number(o),Number(a),Number(i),s,l,c,d,_,p]))}var X=n(19331),J=(0,X.partConfigEnabled)("me_web_read_by_cmid")?15:14;function Z(e,t){e.waitAbortFns.push(t)}function ee(e){if(e.isStoppedFn())return Promise.resolve({ts:0,updates:[]});var t=function(e,t,n){void 0===n&&(n={});var o=new XMLHttpRequest;return{request:new Promise((function(a,i){var r,s=Date.now(),d=n.timeout||60,u=(0,l.toQueryString)(t);o.onreadystatechange=function(){if(4==o.readyState){if(window.clearInterval(r),(0,c.processWaf)(o))return;o.status>=200&&o.status<300?a([o.responseText,o]):i([o.responseText,o])}};try{o.open("GET",e+"?"+u,!0)}catch(e){return i([e,o])}o.send(),r=window.setInterval((function(){Date.now()-s>1e3*d&&(window.browser.safari&&o.abort(),i(["",{}]),window.clearInterval(r))}),1e3)})),cancel:function(){o.abort()}}}(e.url,{act:"a_check",key:e.key,version:e.version,ts:e.ts,wait:25,mode:e.mode}),n=t.request,o=t.cancel;return e.stopFn=o,n.then((function(t){var n=(0,r.__read)(t,2),o=n[0],a=n[1];return e.onData(e,a),e.waitTimeout=2,JSON.parse(o)})).catch((function(t){var n=(0,r.__read)(t,2)[1];return e.onData(e,n),Promise.reject(new Error(""))})).then((function(t){return function(e,t){var n=t.failed?(0,s.abortablePause)(4,null):{abort:function(){},pause:function(){return Promise.resolve()}},o=n.abort,a=n.pause;switch(t.failed){case 1:return Z(e,o),e.onHistoryLost(e,t).then((function(){return e.onResult({ts:t.ts,updates:[[-1]]})})).then(a).then((function(){return ee(e)}));case 2:return Z(e,o),e.onKeyExpired(e,t).then((function(t){var n=(0,r.__read)(t,4),o=n[0],a=n[1],i=n[2],s=n[3];return e.onResult({ts:+s,updates:[[-2,o,a+"/"+i],[-1]]})})).then(a).then((function(){return ee(e)}));case 3:return e.onLpBroken(e,t);default:return t.updates.some((function(e){switch(e[0]){case 4:return 4===e.length;case 5:case 18:return 3===e.length;default:return!1}}))?e.onHistoryLost(e,t).then((function(){return e.onResult({ts:t.ts,updates:[[-1]]})})).then(a).then((function(){return ee(e)})):Promise.resolve(t)}}(e,t)}))}function te(e){e.isStoppedFn()||ee(e).then(e.onResult.bind(e)).then((function(){return e.isReconnecting&&ne(e,-5)})).catch((function(t){return function(e,t){if(e.isStoppedFn())return;e.onRequestError(t),e.waitTimeout=Math.min(60,2*e.waitTimeout),ne(e,-3);var n=(0,s.abortablePause)(e.waitTimeout,null),o=n.abort,a=n.pause;return Z(e,o),a().then((function(){return ne(e,-4)}))}(e,t)})).then((function(){return te(e)}))}function ne(e,t){e.isReconnecting=-4===t,e.onResult({ts:e.ts,updates:[[t,e.waitTimeout]]})}function oe(e){return e||function(){}}function ae(e){return e?function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Promise.resolve(e.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(t),!1)))}:function(){return Promise.reject()}}function ie(e,t,n){var o=0,a=e,i=[],s=!1;function l(){!i.length||o>0||s||(t(i),i=[])}return{pause:function(){o++},resume:function(){o>0&&(o--,l())},onLp:function(e,t,o){s||(a>=e?(a=t,i.push.apply(i,(0,r.__spreadArray)([],(0,r.__read)(o),!1)),l()):n&&(s=!0,n(a).then((function(e){var t=(0,r.__read)(e,3),n=t[1],o=t[2];a=n,s=!1,i.push.apply(i,(0,r.__spreadArray)([],(0,r.__read)(o),!1)),l()}))))}}}var re=n(67181),se=n(12344),le=n(65256),ce=n(12023),de={onNewMsg:(0,i.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags, isService }"),onEditMsg:(0,i.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags }"),onMsgReadByMe:(0,i.default)("msgId","dialogId"),onMsgReadByOther:(0,i.default)("msgId","dialogId"),onOnlineChange:(0,i.default)("{ userId, isOnline, onlinePlatform, lastActionTime }"),onConvoMinorIdChanged:(0,i.default)("peerId","{ minorSortId }"),onConvoMajorIdChanged:(0,i.default)("peerId","{ majorSortId }"),onTyping:(0,i.default)("dialogId","authorId"),onMultiTyping:(0,i.default)("peerId","userIds","totalCount"),onRecordingAudio:(0,i.default)("peerId","userIds","totalCount"),onMsgImportantRemove:(0,i.default)("msgId"),onMsgImportantAdd:(0,i.default)("msgId"),onMsgRequestChange:(0,i.default)("peerId","type"),onCallInProgress:(0,i.default)("peerId","inProgress"),onIsNewChange:(0,i.default)("peerId","isNew"),onMsgRemove:(0,i.default)("msgId"),onMsgListen:(0,i.default)("msgId"),onMsgRestore:(0,i.default)("msgId"),onPeerKeyboard:(0,i.default)("peerId"),onPeerBanner:(0,i.default)("peerId"),onPeerConvert:(0,i.default)("peerId","convertId"),onPeerAdmin:(0,i.default)("peerId","userId","isAdmin"),onDialogImportant:(0,i.default)("peerId","isImportant"),onDialogMarkedUnread:(0,i.default)("peerId","isMarkedUnread"),onDialogPin:(0,i.default)("peerId"),onDialogUnpin:(0,i.default)("peerId"),onDialogAdTag:(0,i.default)("peerId"),onDialogRemove:(0,i.default)("peerId"),onUnreadCount:(0,i.default)("event"),onIncomingCall:(0,i.default)("event"),onKeyboardCallback:(0,i.default)("eventId","peerId","ownerId","action"),onResync:(0,i.default)(),_onLpEvents:(0,i.default)("Array<Object>"),init(e){de._lpConnect&&(de._onLpEvents.off(),de._lpConnect.stopConnection(),de._lpQueue=null,de._lpConnect=null),de._unsubscribeEventQueue&&(de._unsubscribeEventQueue(),de._unsubscribeEventQueue=null),de._lpConfig=e},isLongPollingEnabled:()=>!(!de._lpConnect||de._lpConnect.isStopped()),on(){clog("[longpoll] start"),window.addEventListener("online",_e),window.addEventListener("offline",_e),de._unsubscribeEventQueue||de._createEventQueue(),de._lpConnect?de._lpConnect.reinitConnection():de._createLongpoll(de._lpConfig)},off(){clog("[longpoll] stop"),window.removeEventListener("online",_e),window.removeEventListener("offline",_e),de._lpConnect&&de._lpConnect.stopConnection(),de._unsubscribeEventQueue&&(de._unsubscribeEventQueue(),de._unsubscribeEventQueue=null)},pause(){clog("[longpoll] pause"),de._lpQueue&&de._lpQueue.pause()},resume(){clog("[longpoll] resume"),de._lpQueue&&de._lpQueue.resume()},abortWaiting(){clog("[longpoll] abort waiting"),de._lpConnect.abortWaiting()},_createLongpoll(e){if(!de._lpConnect){var t=ie(e.ts,(e=>{de._onLpEvents(e)})),n=function(e,t){var n=!!e.stopped,o={id:e.id,key:e.key,ts:e.ts,url:e.url,lpstat:e.lpstat||0,version:e.version||J,mode:1226,waitTimeout:2,waitAbortFns:[],isReconnecting:!1,isStoppedFn:function(){return n},onResult:function(e){e.ts&&i(o.ts,e.ts,e.updates.map(_))},onData:oe(t.onData),onRequestError:oe(t.onRequestError),onHistoryLost:ae(t.onHistoryLost),onKeyExpired:ae(t.onKeyExpired),onLpBroken:ae(t.onHistoryLost)},a=t.onEvents;function i(e,t,n){o.ts=t;for(var i=0;i<n.length;++i)n[i].type===R&&(o.key=n[i].key||"",o.url=n[i].url||"");a(e,t,n)}var r={options:o,isStopped:function(){return n},stopConnection:function(){n=!0,o.stopFn&&o.stopFn(),o.stopFn=void 0,document.removeEventListener("resume",s),this.abortWaiting()},reinitConnection:function(){this.stopConnection(),document.addEventListener("resume",s),ne(o,-4),n=!1,te(o)},abortWaiting:function(){o.waitAbortFns.forEach((function(e){return e()})),o.waitAbortFns=[],o.waitTimeout=2},onLp:i};function s(){r.abortWaiting()}return document.addEventListener("resume",s),te(o),r}(e,{onEvents:(e,n,o)=>{o.length?o.forEach((o=>{t.onLp(e,n,[o])})):t.onLp(e,n,[])},onHistoryLost:()=>{clog("[longpoll] ts expired")},onKeyExpired:e=>{return clog("[longpoll] key expired"),t="/mail",(n={act:"get_key",user_id:e.id})&&(n.im_v=3),new Promise((function(e,a){window.ajax.post(t,n,{timeout:o,onDone:function(){e.apply(null,[(0,r.__spreadArray)([],(0,r.__read)(arguments),!1)])},onFail:function(){return a.apply(null,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1)),!0}})}));var t,n,o},onLpBroken:()=>{clog("[longpoll] broken, reload"),window.location.reload()}});de._lpQueue=t,de._lpConnect=n,de._onLpEvents((e=>{try{e.forEach(de._onEvent)}catch(e){console.error(e)}}))}},_onEvent:function(e){var{type:t}=e;switch("edu"===le.SAKIntegration.type&&le.SAKIntegration.sendMessage("longpoll",{event:e},"mvk_embedded_background"),t){case f:var{flags:n,messageId:o,peerId:i}=e;8&n?de.onMsgImportantAdd(o):de.onMsgImportantRemove(o),128&n||64&n?de.onMsgRemove(o):de.onMsgRestore(o);break;case m:var{flags:r,messageId:s,peerId:l}=e;8&r&&de.onMsgImportantAdd(s),(128&r||64&r)&&de.onMsgRemove(s),4096&r&&de.onMsgListen(s);break;case v:var{flags:c,messageId:d,peerId:u}=e;8&c&&de.onMsgImportantRemove(d),(128&c||64&c)&&de.onMsgRestore(d);break;case g:case D:case F:var{messageId:_,peerId:p,randomId:y,text:k,minorSortId:b,flags:L,attaches:R,kludges:U,date:H}=e,j=(0,a.toInt)(U.from_admin)||null,$=function(e){if(2&e.flags)return de._lpConfig.id;return e.userId}(e),V=!!U.source_act,G=t===D||t===F,z=2&L,Y=!!(65536&L),X=U.keyboard,J=function(e,t){t&Q&&function(e){e.fwd_count}(e)}(U,L),Z=!!U.has_template,ee={peerId:p,id:_,authorId:$,attaches:R,text:k,ts:H,flags:L,adminId:j,randomId:y,isService:G?void 0:V,edited:!!G||void 0,replaced:t===F,keyboard:X,isStealth:Y,isOut:z,hasReply:J,hasTemplate:Z,ttl:U.ttl||U.expire_ttl&&parseInt(U.expire_ttl)||null,isExpired:U.is_expired};G?de.onEditMsg(ee):de.onNewMsg(ee,b);break;case h:case w:var{peerId:te,upToId:ne,unread:oe}=e;t===h?de.onMsgReadByMe(ne,te):de.onMsgReadByOther(ne,te);break;case B:case O:var{mask:ae,peerId:ie,local:re}=e;1&ae?de.onDialogImportant(ie,t===O):32768&ae?de.onDialogAdTag(ie):1048576&ae&&de.onDialogMarkedUnread(ie,t===O);break;case A:var{mask:se,peerId:ce,local:ue}=e;de.onDialogImportant(ce,!!(1&se));break;case N:var{peerId:_e}=e;de.onDialogRemove(_e);break;case K:var{peerId:pe,majorId:me}=e;de.onConvoMajorIdChanged(pe,{majorSortId:me});break;case q:var{peerId:fe,minorId:ve}=e;de.onConvoMinorIdChanged(fe,{minorSortId:ve});break;case S:var{peerId:ge,updateType:he,updateArg:we}=e;if(11===he&&de.onPeerKeyboard(ge),10===he&&de.onPeerBanner(ge),13===he&&de.onPeerConvert(we,ge),12===he){var ye="";switch(we){case 3:ye="created";break;case 2:ye="rejected";break;case 1:ye="accepted";break;case 0:ye="canceled"}de.onMsgRequestChange(ge,ye)}3===he&&de.onPeerAdmin(ge,we,!0),9===he&&de.onPeerAdmin(ge,we,!1),19===he&&de.onCallInProgress(ge,we),22===he&&de.onIsNewChange(ge,we);break;case C:var{peerId:ke,userIds:be,totalCount:Se,ts:Ce}=e;de.onMultiTyping(ke,be,Se);break;case E:var{peerId:Ee,userIds:Te,totalCount:Ie,ts:Me}=e;de.onRecordingAudio(Ee,Te,Ie);break;case T:break;case I:de.onUnreadCount(e);break;case M:break;case W:de.onIncomingCall(e);break;case P:var{owner_id:Pe,peer_id:Le,event_id:Be,action:Ae}=e;de.onKeyboardCallback(Be,Le,Pe,Ae);break;case x:de.onResync()}},_createEventQueue:function(){if(!de._unsubscribeEventQueue){var e=new re.EventQueue({getQueue:()=>(0,se.mailRequest)("/mail",{act:"queue_params"}),registerQueue:(e,t)=>{ce.QueueManager.addQueue(e,t),ce.QueueManager.start()}});de._unsubscribeEventQueue=e.subscribe(de._onEventQueueEvent)}},_onEventQueueEvent:function(e){if(e.entity_type===re.EntityType.Online)de.onOnlineChange({userId:e.data.user_id,isOnline:e.data.online,onlinePlatform:[1,2,3,4,5].includes(e.data.platform)?"mobile":"desktop",lastActionTime:e.data.last_seen})}},ue=de;function _e(e){"online"===e.type?(clog("[longpoll] online"),de._lpConnect.reinitConnection()):(clog("[longpoll] offline"),de._lpConnect.stopConnection())}},77123:function(e,t,n){"use strict";n.d(t,{offCloseCallback:function(){return Q},onClose:function(){return G},onCloseCallback:function(){return z},onOpen:function(){return q},onOpenCallback:function(){return Y}});var o=999999,a=0,i=0,r=null,s=null;function l(){var e=pageYOffset;e!==a&&e!==o&&(a=e,i=Math.max(i,e),scrollTo(0,o)),clearTimeout(s),s=setTimeout((()=>{s=null,window.removeEventListener("scroll",l),scrollTo(0,o),setTimeout((()=>scrollTo(0,o)),1e3)}),150)}var c,d,u,_,p,m,f,v,g,h=n(11911),w=0,y=0,k="",b=!1,S={},C=0;function E(e){if(k=e,b=!1,c=!1,u=0,_=0,m=0,f=0,S={},void 0,v="start",g=0,C=0,h.isIPhone)if("top"===k||"bottom"===k){B()<h.IPHONE_KEYBOARD_REJECT_OFFSET&&A(0);var t=document.body;p=t.offsetHeight,t.offsetWidth,window.addEventListener("scroll",I),"top"===k&&(0,h.isLandscapePhone)()||(P(),M())}else document.body.classList.add("ScrollViewsDisabled")}function T(){"top"===k||"bottom"===k?(d&&clearTimeout(d),window.removeEventListener("scroll",I)):document.body.classList.remove("ScrollViewsDisabled"),b=!1,k="",c=!1,p=0,0}function I(){if(P(),"top"!==k){if("bottom"===k){var e=pageYOffset,t=B();c&&(c=!1,e===m)||(h.isWKWebView?f<=5&&M():e>h.IPHONE_KEYBOARD_REJECT_OFFSET?e>t?(A(e),h.isWKWebView||M()):e<t?S[e]||e>L(t)?(S[e]=!0,M(p)):M():e!==L(t)&&M():t||(e<h.IOS_NO_KEYBOARD_ALLOWED_OFFSET?(u===e?_++:(u=e,_=1),_>=3&&(window.removeEventListener("scroll",I),A(u)),setTimeout((()=>{M()}),300)):M()))}}else{if((0,h.isLandscapePhone)())return;if(h.isWKWebView)return void(0!==pageYOffset&&M(0));var n=innerHeight;if("start"===v&&(n<p?v="animate":M(1)),"animate"===v)if(g=p-n,C||(C=Math.max(1,Math.min(4,Math.floor(g/10)))),g<=0)v="stop";else{var o=h.isIPad?h.iosMajor<11?3:2:1;M(Math.min(g,C)*o)}"stop"===v&&M(1)}}function M(e){c=!0;var t,n=B();"bottom"===k?t=e||(!n||h.isWKWebView||h.isIPad?p:L(n)):"top"===k&&(t=isFinite(e)?e:1),f++,m=t,window.scrollTo(0,t)}function P(){d&&clearTimeout(d),b||(d=setTimeout((()=>{b=!0,d=null,window.removeEventListener("scroll",I)}),500))}function L(e){return h.isIPad||h.isWKWebView||90===Math.abs(window.orientation)&&screen.width>=375||(h.isIPhoneX?e-=h.IPHONE_X_SAFARI_BOTTOM_BAR:e-=h.IPHONE_SAFARI_BOTTOM_BAR),e}function B(){return 90===Math.abs(window.orientation)?w:y}function A(e){90===Math.abs(window.orientation)?w=e:y=e}var O=null,x=0,R=0;function N(){if(!(visualViewport.height>=x)){var e=x-visualViewport.height;R!==e&&(!h.isWKWebView&&e<h.IOS_NO_KEYBOARD_ALLOWED_OFFSET?scrollTo(0,0):(15===h.iosMajor&&h.iosMinor<2&&(e+=h.IOS_15_BOTTOM_NAVBAR_OFFSET),scrollTo(0,e)))}}var D=!1,F=!1,U=!1,H=null,j=[],$=[],V=null,W=h.isScrollBasedViewport&&(h.isIPad||h.isWKWebView),K=h.isScrollBasedViewport&&h.iosMajor<=12;function q(e,t){void 0===e&&(e="default");var{exitIfStarted:n=!1}=void 0===t?{}:t;if(h.isIOS&&!(h.iosMajor<8)&&!(F&&n||D)){if(V=e,F=!0,H&&(clearTimeout(H),H=null),"bottom"===e){if(((0,h.isLandscapePhone)()||!W&&!K)&&!function(){if(O||(O={onceBlocked:!1}),O.onceBlocked&&(O.opened=!0),!O.onceBlocked&&!O.opened){O.onceBlocked=!0;var e=document.activeElement;return e.blur(),e.focus(),!1}return O.opened=!0,window.visualViewport&&(x=visualViewport.height,R=0,setTimeout(N),visualViewport.addEventListener("scroll",N),visualViewport.addEventListener("resize",N)),!0}())return;!W&&K&&E(e),W&&function(e){void 0===e&&(e="default"),r&&(clearTimeout(r),r=null),s&&(clearTimeout(s),s=null),a=0,0,0,i=0,window.addEventListener("scroll",l),setTimeout((()=>{scrollTo(0,o)}),10),setTimeout((()=>{scrollTo(0,o)}),100),setTimeout((()=>{scrollTo(0,o)}),200),setTimeout((()=>{scrollTo(0,o)}),300),setTimeout((()=>{scrollTo(0,o)}),400),setTimeout((()=>{scrollTo(0,o)}),500)}()}else!W&&K&&E(e);$.length&&$.forEach((e=>e())),D=!0,F=!1}}function G(e){var{exitIfStarted:t=!1}=void 0===e?{}:e;if(h.isIOS&&!(h.iosMajor<8)&&(!U||!t)){if(U=!0,"bottom"===V){if(((0,h.isLandscapePhone)()||!W&&!K)&&(!O||O.onceBlocked&&!O.opened||(window.visualViewport&&(setTimeout(N),visualViewport.removeEventListener("scroll",N),visualViewport.removeEventListener("resize",N)),O=null,x=0,R=0,0)))return;if(!D)return;!W&&K&&T(),W&&(clearTimeout(r),clearTimeout(s),a=0,0,0,r=null,s=null,window.removeEventListener("scroll",l))}else!W&&K&&T();D=!1,U=!1,V=null,H&&clearTimeout(H),H=setTimeout((()=>{scrollTo(0,0),j.length&&j.forEach((e=>e()))}),10)}}function z(e){-1===j.indexOf(e)&&j.push(e)}function Q(e){var t=j.indexOf(e);-1!==t&&j.splice(t,1)}function Y(e){-1===$.indexOf(e)&&$.push(e)}},73706:function(e,t,n){"use strict";n.d(t,{preventDocumentScroll:function(){return h},restoreDocumentScroll:function(){return w},setScrollView:function(){return C},cleanScrollView:function(){return E},hideTopBanner:function(){return F}});var o,a,i,r,s,l,c,d=n(71437),u=n(77123),_=n(11911),p=(n(19331),!0),m=!1,f="closed",v=!1,g=[];function h(e){void 0===e&&(e={}),_.isIOS&&(!0!==e.stack&&v||(c={initialized:!1,scrollViews:[]},g.push(c),e.layoutElement&&e.layoutElement.nodeType?c.layoutElement=e.layoutElement:c.layoutElement=(0,d.$)(e.layoutElement||".layout")),!1===e.topBanner?c.topBanner=!1:c.topBanner=!0,v||(v=!0,addEvent(window,"focusin",x),addEvent(window,"focusout",R),addEvent(document,"touchmove",B,{capture:!0}),addEvent(document,"touchmove",A,{capture:!1}),addEvent(window,"resize",I),u.onCloseCallback(N),_.isWKWebView||(addEvent(window,"orientationchange",M),requestAnimationFrame((()=>{(0,_.isLandscapePhone)()?M(null,!0):(I(),c&&!c.topBanner?requestAnimationFrame(F):i||requestAnimationFrame(U))})))))}function w(){v&&(v=!1,y(),1===g.length&&(c.layoutOffset=null,H(),document.body.style.height=""),c.layoutElement=null,g.pop(),(c=g.length?g[g.length-1]:null)&&H(),removeEvent(window,"focusin",x),removeEvent(window,"focusout",R),removeEvent(document,"touchmove",B,{capture:!0}),removeEvent(document,"touchmove",A,{capture:!1}),removeEvent(window,"resize",I),removeEvent(window,"orientationchange",M),removeEvent(window,"resize",P),removeEvent(window,"scroll",L),u.offCloseCallback(N))}function y(){c.scrollViews.forEach((e=>E(e))),c.scrollViews=[]}function k(e){var t=e.currentTarget.__ScrollView;if("prevented"!==t.state){if(!("start"!==t.state||t.allowX&&t.allowY)){var n=Math.abs(t.startX-e.changedTouches[0].clientX),o=Math.abs(t.startY-e.changedTouches[0].clientY);if(!t.allowX&&n>o)return void(t.state="prevented");if(!t.allowY&&o>n)return void(t.state="prevented")}if("allowed"!==t.state&&(t.state="allowed"),p=!1,!t.overscrollX){var a=e.currentTarget.scrollLeft,i=t.startX-e.changedTouches[0].clientX;(a<=0&&i<=0||a>=t.maxX&&i>=0)&&(p=!0,t.standalone&&e.preventDefault())}if(!t.overscrollY){var r=e.currentTarget.scrollTop,s=t.startY-e.changedTouches[0].clientY;(r<=0&&s<=0||r>=t.maxY&&s>=0)&&(p=!0,t.standalone&&e.preventDefault())}}}function b(e){var t=e.currentTarget,n=t.__ScrollView;n.state="start",n.startX=e.changedTouches[0].clientX,n.startY=e.changedTouches[0].clientY,n.maxX=n.overscrollX?null:t.scrollWidth-t.clientWidth,n.maxY=n.overscrollY?null:t.scrollHeight-t.clientHeight}function S(e){e.currentTarget.__ScrollView.state=""}function C(e,t){if(void 0===t&&(t={}),_.isIOS&&(!1!==t.override||!e.__ScrollView)){if(!0!==t.standalone){if(!v)return;e.__ScrollView||c.scrollViews.push(e)}e.__ScrollView={allowX:!1!==t.allowX,allowY:!1!==t.allowY,overscrollX:!1!==t.overscrollX,overscrollY:!1!==t.overscrollY,standalone:!0===t.standalone},c&&(_.isWKWebView||(!1!==t.topBanner&&(e.__ScrollView.topBanner=t.topBanner||{hide:30,show:60}),addEvent(e,"scroll",T))),addEvent(e,"touchstart",b),addEvent(e,"touchmove",k),addEvent(e,"touchend",S)}}function E(e){e.__ScrollView=null,removeEvent(e,"touchstart",b),removeEvent(e,"touchmove",k),removeEvent(e,"touchend",S),removeEvent(e,"scroll",T)}function T(e){if("closed"!==f||(0,_.isLandscapePhone)())return m=!1,void(r&&clearTimeout(r));m=!0;var t=e.target.__ScrollView.topBanner;c&&c.topBanner&&t?D(e.target,t.show,t.hide):D(e.target,1/0,0),r&&clearTimeout(r),r=setTimeout((()=>{m=!1,I()}),100)}function I(){if(!m)if(l)l=!1;else if(!(0,_.isLandscapePhone)()){window.pageYOffset;"closed"===f&&(_.isWKWebView||(o=document.documentElement.offsetHeight,a=innerHeight,i=o===a,"show"===s?(s=null,requestAnimationFrame(U)):"hide"===s&&(s=null,requestAnimationFrame(F))))}}function M(e,t){_.isIPad?c.topBanner||setTimeout((()=>{F()}),400):90===Math.abs(window.orientation)?(addEvent(window,"resize",P),document.body.style.height="",c.layoutHeight=null,t?setTimeout((()=>{window.scrollTo(0,-300),P()})):setTimeout((()=>{window.scrollTo(0,-300)}),400)):(removeEvent(window,"resize",P),c.layoutOffset=null,H(),c.topBanner||setTimeout((()=>{F()}),400))}function P(){if("closed"===f){var e=document.body.offsetHeight,t=e-innerHeight;c.layoutOffset=t,H(),window.scrollTo(0,e)}}function L(){pageYOffset&&(f="opened",removeEvent(window,"scroll",L))}function B(e){p=!0}function A(e){p&&e.preventDefault()}function O(e){var t=e&&e.target,n=0===e.eventPhase&&t.getAttribute("autofocus"),o=!1;return"textarea"!==t.tagName.toLowerCase()||n||(o=!0),"input"!==t.tagName.toLowerCase()||["checkbox","radio","image","submit"].includes(t.type)||n||(o=!0),"select"===t.tagName.toLowerCase()&&(o=!0),o}function x(e){if(O(e)){e&&e.target;f="opening",addEvent(window,"scroll",L),u.onOpen(undefined,{exitIfStarted:!0})}}function R(e){O(e)&&u.onClose({exitIfStarted:!0})}function N(){removeEvent(window,"scroll",L),f="closed",setTimeout((()=>{(0,_.isLandscapePhone)()?P():I()}),100)}function D(e,t,n){var o=e.scrollTop;o<=-t&&(i||s)?(s="show",window.scrollTo(0,-10)):o>=n&&(!i||s)&&(s="hide",window.scrollTo(0,10))}function F(){window.scrollTo(0,300)}function U(){window.setImmediate?setImmediate((()=>{window.scrollTo(0,-300)})):window.scrollTo(0,-300)}function H(){var e=c.layoutOffset;c.layoutElement.style.top=e?e+"px":""}},10965:function(e,t,n){"use strict";n.d(t,{resizePosters:function(){return o}});function o(e,t,n){var o=ge(t)||document,a="poster-resized",i="[data-poster-resized='false']";(e||n)&&(i="");var r=domQuery(".poster__text"+i,o),s=[],l=cur.posterConfig&&cur.posterConfig.constants;if(!l){if(!r.length)return;l=JSON.parse(domData(r[0].parentElement,"poster-constants"))}for(var c=0;c<r.length;c++){var d=r[c],u=domPN(d);s.push(domPN(u).clientWidth)}for(var _=0;_<r.length;_++){var p=r[_],m=domPN(p),f=s[_],v=l.font_size_ratio_range_1*f+"px",g=Math.round(l.line_height_ratio_range_1*f)+"px",h="0 "+Math.round(.05555555555555555*f)+"px";p.textContent.length>l.range_threshold&&(v=Math.round(l.font_size_ratio_range_2*f)+"px",g=Math.round(l.line_height_ratio_range_2*f)+"px"),setStyle(m,{height:.75*f+"px",width:f}),setStyle(p,{fontSize:v,lineHeight:g,padding:h}),domData(p,a,!0)}}},76988:function(e,t,n){"use strict";n.d(t,{default:function(){return f}});var o,a,i=n(75105),r=n(92281),s=n(71437),l=n(20848),c=n(62641),d=n(69161),u=n(20594),_=n(39871),p=n(36461);onDOMReady((()=>{u.default.onStickerPanelUpdate((e=>{cur.waitingStickerPanel?(clog("Show sticker panel after waiting"),m.stickersToggle(null,!0)):e&&"mail"!==cur.module&&m.redrawStickers()}))}));var m={curGif:null,onStickersTabSelected:(0,i.default)(),onStickerClick:(0,i.default)(),onStickersInit:se(),onReplyClick:se(),add_attach:function(e,t){var{al:n}=window;remove("feed_extra_field");var o=gpeByTag("form",e),a=ce("input",{id:"feed_extra_field",type:"hidden",name:"add_attach",value:2});if(o){var i=!1;if(each(o,(function(e,t){if("submit"===t.type)return i=t,!1})),i)return append(a,o),window.al&&n.ver?nav.go(i,t):o.submit()}return!0},saveDraft:function(e,t,n,o){if(e&&e.preventDefault(),!o||!o.classList.contains("CreatePostButtons__item--disabled")){var a=ge("feed_add_form"),i=qs2obj(nav.params),s={act:"post",save_draft:1,redirect:n,hash:t};i.comment&&(s.comment=i.comment),each(a.elements,(function(e,t){if(!["submit","file"].includes(t.type)){if((0,r.isFieldIgnored)(t))return;s[t.name]="checkbox"===t.type?(+t.checked).toString():t.value}})),ajax.post(window.nav.path,s)}},toggleActions:function(e,t){var n=gpeByClass("post_item",e);return toggleClass("pi_actions_opened",n),cancelEvent(t),!1},wallActions:function(e,t){var{tooltip:n}=window,o=gpeByClass("_audioPlaylist",e)||gpeByClass("wall_item",e)||gpeByClass("post",e);if(!o)return!0;if(hasClass("wi_actions_opened",o))removeClass("wi_actions_opened",o),n.hide();else{var a=geByClass1("wi_actions_wrap",o),i=geByClass1("wi_actions",a),r=geByClass1("wi_actions_btn",o);m.wallActionsHide(),addClass("wi_actions_opened",o);var s=getY(o)+45+getH(i)+7,l=scrollTop()+getCh();toggleClass("wi_actions_top",a,s>l),n.addHandler(m.wallActionsHide),n.show(a,r)}return cancelEvent(t),!1},wallActionsHide:function(){var{tooltip:e}=window;removeClass("wi_actions_opened",geByClass1("wi_actions_opened")),e.hide()},wallPostOpen:function(e,t){var n=gpeByClass("wall_item",e),o=geByClass1("wi_date",n);return!o||nav.go_after(o,t)},toggleGif:function(e,t,n,a){return void 0===a&&(a=!1),!e||(!!checkEvent(t)||(clearInterval(o),hasClass("current_gif",e)?m.hideGif(e,t,a):(a||Gif.autoplayTest(),m.showGif(e,t,n,a))))},hidePlayingGifs(e,t){geByClass("current_gif","mcont").forEach(((n,o)=>{n!==e&&m.hideGif(n,!1,t)}))},showGif:function(e,t,n,i){var{cur:r}=window;if(!e)return!0;if(checkEvent(t))return!0;if(n){if(r.loadedGifs||(r.loadedGifs={}),!r.loadedGifs[e.href]&&!confirm(n))return!1;r.loadedGifs[e.href]=!0}if(clearInterval(o),!i){var l=getY(e),c=scrollTop();scrollTop(c-(l-getY(e)))}geByClass("current_gif","mcont").forEach(((e,t)=>{m.hideGif(e,!1,i)}));var d=!hasClass("not_mp4",e)&&Gif.isMp4Supports()&&e.href.includes("&mp4"),u=function(t,n){hasClass("current_gif",e)&&(e.classList.remove("gif_loading"),e.classList.add("gif_opened"),"VIDEO"===a.tagName&&document.body.contains(a)?a.play():append(a,e),m.curGif=e,n&&n())};if(d){var _=geByClass1("ph_img",e).src;(a=(0,s.$)("video.gif_original",e)||ce("video",{src:e.href,className:"gif_original",loop:!0,muted:!0,autoplay:!0,poster:_})).setAttribute("playsinline",!0),a.setAttribute("webkit-playsinline",!0),a.setAttribute("controls",!0),a.controls=!1,a.readyState>=2&&"VIDEO"===a.tagName?(e.classList.remove("gif_loading"),e.classList.add("gif_opened"),a.play(),u()):a.load()}else a=ce("img",{src:e.href,className:"gif_original"});return e.classList.add("current_gif"),e.classList.contains("gif_opened")||e.classList.add("gif_loading"),d?a.oncanplay=()=>{e!==m.curGif&&(statlogsValueEvent("gif_play",0,"mp4",null,i?1:0),u())}:o=setInterval((()=>{a.complete&&(statlogsValueEvent("gif_play",0,"gif",null,i?1:0),u(),clearInterval(o))}),100),t&&!t.defaultPrevented?cancelEvent(t):void 0},hideGif:function(e,t,n){if(void 0===n&&(n=!1),!e)return!0;if(checkEvent(t))return!0;if(removeClass("current_gif",e),removeClass("gif_opened",e),removeClass("gif_loading",e),geByClass("gif_original").forEach((e=>{"VIDEO"===e.tagName?e.pause():remove(e)})),!n){var{currentAutoplayElement:o,ignore:a}=Gif.getState();o===e&&(a.push(e),Gif.setState("ignore",a))}return m.curGif=null,t&&!t.defaultPrevented?cancelEvent(t):void 0},replyNamesRE:function(){var{cur:e}=window;if(!e.replyNames)return!1;var t=[];return each(e.replyNames,(function(){t.push(escapeRE(this[0]))})),new RegExp("^("+t.join("|")+")")},stickerPanelInit(){if((0,s.$)("#stickers_panel"))return!0;var e=!1;if("mail"===cur.module&&window.isNewMail)e=(0,s.$)(".uMailWrite__popupStickers").childNodes[0];else{var t=(0,s.$)(".RepliesField_wrap")||((0,s.$)(".create_post")||{}).parentNode;if(!t)return!1;e=(Array.from(t.children).find((e=>!(!e||!e.nextSibling||e.nextSibling.nodeType!==Node.COMMENT_NODE)))||{}).nextSibling}if(e&&e.nodeType===Node.COMMENT_NODE){var n=u.default.getStickerPanel();if(!n)return!1;var o=document.createElement("div");return o.innerHTML=n,e&&e.after(...o.childNodes),e&&e.remove(),m.stickersInit(),!0}return!1},stickersInit:function(){if(!window.isNewMail||!geByClass1("messenger")){var{cur:e}=window,{Scroller:t}=window,n=(0,s.$)("#stickers_panel");if(!n)return!m.stickerPanelInit()||(m.stickersInit(),"cached");var o=geByClass1("sp_body",n),a=geByClass1("sp_stickers_tabs",n);e.scroller&&e.scroller.destroy(),e.scroller=new t(o,{byPage:!0}),e.scroller.init(),e.destroy.push((function(){e.scroller.destroy()})),e.tabScroller&&e.tabScroller.destroy(),e.tabScroller=new t(a),e.tabScroller.init(),e.destroy.push((function(){e.tabScroller.destroy()})),m.onStickersInit(!0)}},replyTo:function(e,t,n,o,a){var{cur:i}=window;if(checkEvent(e))return!0;n=n||0,removeClass("nc_current_reply",geByClass1("nc_current_reply"));var r=ge("nc_form"),s=ge("nc_message"),l=geByClass1("nc_reply_name",r),c=gpeByClass("near_btn",l),d=ge("nc_reply_as"),u=val(s),_=m.replyNamesRE();if(n){var p=ge(t+"_"+n),f=getY(p)+getH(p),v=scrollTop();after(r,p),addClass("nc_current_reply",geByClass1("pi_reply_wrap",p)),scrollTop(v+getY(p)+getH(p)-f);var g=i.replyNames[o]||{},h=g[0]||"",w=g[1]||"";u=u?_?u.replace(_,h):u:h,m.onReplyClick(!0,h)}else{append(r,geByClass1("wall_replies")),scrollToEl(r);w="";u=_?u.replace(_,""):u}return val(s,replaceEntities(u)),val(l,w),toggle(c,n),d&&(val(d,+a),toggleClass("cp_post_as_group",r,+a)),val("nc_reply_to",n),i.replyTo=n,elfocus(s),!1},stickersToggle:function(e,t){var{cur:n}=window;if(!u.default.getStickers())return u.default.checkStickers(),!0;isUndefined(t)&&(t=!isVisible("stickers_panel")),e&&t&&u.default.checkStickers({force:!0}),!t&&n.waitingStickerPanel&&delete n.waitingStickerPanel;var o=ge("write_form")||ge("nc_form"),a=ge("stickers_panel"),i=geByClass1("cp_sticker_btn",o);if(!a){var r=m.stickersInit();if("cached"===r)return m.stickersToggle(e,t);if(!0===r)return n.waitingStickerPanel=!0,void u.default.checkStickers()}return n.waitingStickerPanel&&delete n.waitingStickerPanel,toggle(a,t),toggleClass("cp_sticker_btn_sel",i,t),t&&n.tabScroller&&n.tabScroller.onShow(),n.onStickersToggleCallbacks&&n.onStickersToggleCallbacks.forEach((e=>e(t))),!1},redrawStickers(){if(m.stickerPanelInit()){var e=isVisible("stickers_panel"),t=(0,c.getState)("target")||safeGet(window.store,"mail.cur.peerId"),n=u.default.getStickerPanel(t),o=document.createElement("div");o.innerHTML=n;var a=(0,s.$)(".stickers_panel",o);ge("stickers_panel").innerHTML=a.innerHTML,m.stickersInit(),cur.onStickersToggleCallbacks&&cur.onStickersToggleCallbacks.forEach((t=>t(e)))}},scrollIntoStickersView(){var e=ge("stickers_panel");return isVisible("stickers_panel")&&setTimeout((()=>{var t=Tabbar.isFixedToBottom()?Tabbar.getHeight():0,{top:n,height:o}=e.getBoundingClientRect(),a=scrollTop()+n+o+t-window.innerHeight;scrollTop(a)}),200),!1},saveCurrentStickersPanelToCache(){var e=(0,s.$)(".stickers_panel");if(e){var t=safeGet(window.store,"mail.cur.peerId"),n=((0,c.getState)("target")||"").toString()||(t?"mail"+t:"");if(n){var o=u.default.getStickerPanel(),a=document.createElement("div");a.innerHTML=o,(0,s.$)(".stickers_panel",a).innerHTML=e.innerHTML.replace(new RegExp(n,"g"),"mail0"),u.default.saveStickerPanel(a.innerHTML)}}},stickersClick:function(e,t){var n=u.default.getStickers();return n&&n[t]?(window.isNewMail&&"/mail"===location.pathname&&(window.uMailWrite.drawStickers(),window.uMailWrite.openStickersPanel()),m.stickersToggle(null,!0),m.stickersSelectTab(null,t)):nav.go(e)},stickersStoreOpen:function(e){var{cur:t}=window;return setTimeout((()=>{u.default.checkStickers({force:!0})}),1e3),ajax.click(e,!1,{url_params:{reply_to:t.replyTo||0}})},fromStickerToObject:function(e){var[t,n,o,a,i,r,s]=e;return{id:t,size:n,url:o,animationUrl:a,recent:i,ref:r,images:s}},fromObjectToSticker:function(e){var{id:t,size:n,url:o,animationUrl:a,recent:i,ref:r}=e;return[t,n,o,a,i,r]},getTarget:function(){var e=((0,c.getState)("target")||"").toString();if(e)return e;var t=safeGet(window.store,"mail.cur.peerId");return t?"mail"+t:null},getStickersTabHTML:function(e){var t=u.default.getStickers()||{},{title:n,can_gift:o,stickers:a}=t[e]||{},i=window.isNewMail?16:8,r=[];if(a&&a.length)for(var s=0;s<a.length/i;s++)r.push(a.slice(s*i,s*i+i));var c=r.map((e=>e&&(0,l.isArray)(e)?'\n        <div class="sp_page scroller_page">\n          <div class="stickers_list">\n            '+e.map((e=>{var{id:t,size:n,url:o,animationUrl:a,recent:i,ref:r}=m.fromStickerToObject(e),s="",l="";return a&&(s=" sticker_animation",l='\n          data-animation-path="'+a+'"\n          data-uniq-id="'+Date.now()+Math.round(1e8*Math.random())+'"\n          data-sticker-id="'+t+'"\n          data-loop-count="3"\n          ontouchstart="StickersAnimation.touchStartSticker(this);"\n          ontouchend="StickersAnimation.touchEndSticker(this);"\n        '),'\n          <div class="sticker_item'+(" sticker"+t)+'">\n            <a class="sticker_thumb thumb_item'+s+'" '+(' onclick="return post.sendSticker(this, '+t+", "+Boolean(i)+", '"+r+"');\"")+" "+l+'>\n              <img src="'+o+'" class="th_img sticker_img" height="'+n+'"/>\n            </a>\n          </div>\n        '})).join("\n")+"\n          </div>\n        </div>\n      ":"")).join("\n"),d='\n        <div class="sp_page scroller_page">\n          <div class="stickers_list">\n            <div class="stickers_null">'+getLang("mobile_common_stickers_no_recent")+"</div>\n          </div>\n        </div>\n    ",f=r.map(((e,t)=>'\n        <span class="sp_ppt '+(0===t?"sp_ppt_sel":"")+'" data-i="'+t+'">\n            <span class="sp_pptw"></span>\n        </span>\n      ')).join("\n"),v=function(e){var t=e.title?{inner:[e.title],class:"StickersKeyboardPackHeader__title",tag:"div"}:null,n=e.canGift&&e.target?{inner:[(0,p.Icon24GiftOutline)()],class:"StickersKeyboardPackHeader__gift",href:"/attachments?act=stickers_gift&stickers_id="+e.packId+"&ref=stickers_keyboard&target="+e.target,tag:"a"}:null;return t||n?{inner:[{inner:[t],class:"StickersKeyboardPackHeader__main",tag:"div"},{inner:[n],class:"StickersKeyboardPackHeader__aside",tag:"div"}],class:"StickersKeyboardPackHeader",tag:"div"}:null}({packId:e,canGift:o,title:n,target:m.getTarget()});return'\n        <div class="sp_cont scroller_wrap">\n          '+(v?_.default.html(v):"")+'\n          <div class="scroller_cont">\n            '+(a&&a.length?c:d)+'\n          </div>\n        </div>\n        <div class="sp_pages_pts">\n            '+(r.length>1?f:"")+"\n        </div>\n      "},stickersSelectTab:function(e,t){var{cur:n}=window;if(!window.isNewMail&&n.tabScroller&&!n.tabScroller.canClick())return!1;var o=ge("stickers_panel"),a=geByClass1("sp_body",o),i=geByClass1("sp_tab_selected",o);n.scroller&&n.scroller.destroy(),val(a,m.getStickersTabHTML(t)),n.scroller&&n.scroller.init(),e||(e=geByClass1("sp_tab"+t,o)),removeClass("sp_tab_selected",i),addClass("sp_tab_selected",e);var r=getY(o),s=r+getW(o),l=scrollTop(),c=l+getCh();return(r<l||s>c)&&scrollToEl(o),n.tabScroller&&n.tabScroller.showElem(e),StickersAnimation&&StickersAnimation.loadAutoplayAnimationStickers(),m.saveCurrentStickersPanelToCache(),window.isNewMail&&m.onStickersTabSelected(),!1},addRecentSticker:function(e,t,n){var{cur:o}=window,a=gpeByClass("sticker_item",e);if(u.default.getStickers()&&a){var i=Object.keys(u.default.getStickers()).reduce(((e,n)=>e||u.default.getStickers()[n].stickers.find((e=>m.fromStickerToObject(e).id===t))),null);if(!i)throw new Error("Sticker "+t+" not found");var{id:r,size:l,url:c,animationUrl:_,images:p}=m.fromStickerToObject(i),f=u.default.getStickers(),{stickers:v=[]}=f[-1]||{};(v=v.filter((e=>m.fromStickerToObject(e).id!==r))).unshift(m.fromObjectToSticker({id:r,size:l,url:c,animationUrl:_,recent:1,ref:"recent",images:p})),v=v.filter(((e,t)=>t<(window.isNewMail?16:8))),u.default.setStickerTab(-1,v);var g=-1;if(!n){var h=(0,s.$)(".stickers_panel .sp_tab_selected"),w=h&&h.className.split(" ").find((e=>/sp_tab.([0-9])*/.test(e))).split("sp_tab")[1];(0,d.isNumber)(+w)&&(g=+w)}m.stickersSelectTab(!1,g)}},sendSticker:function(e,t,n,o){if(window.isNewMail&&m.onStickerClick(t,o))return m.addRecentSticker(e,t,!1),!1;var{cur:a}=window;if(a.scroller&&!a.scroller.canClick())return!1;m.stickersToggle(e,!1);var i=ge("write_submit"),r={lock:!0,url_params:{media:"sticker"+t,_af:srand()}};if(n&&!o&&(r.url_params.media_from="recent"),a.ref&&(r.url_params.ref=a.ref,a.ref=void 0),a.refSource&&(r.url_params.ref_source=a.refSource,a.refSource=void 0),!o){var s=attr(e,"href");s&&(o=s.split("sticker_referrer=")[1].split("&")[0])}return o&&(r.url_params.sticker_referrer=o),m.addRecentSticker(e,t,n),i?ajax.click(i,extend({save:!0},Dialog),r):(i=ge("nc_submit"))?(Replies.getCurrentTimestamp()||Replies.setCurrentTimestamp(-1),setTimeout((()=>{Replies.setCurrentTimestamp(0)}),0),ajax.click(i,{},r)):void 0},toggleMarkAsAds:function(e,t){var n=(0,s.$)("input[name='from_group']");if(n&&!n.checked)return cancelEvent(t);var o=(0,s.$)("input",e);if(o.disabled)return cancelEvent(t);var a=(0,s.$)("input[name='mute_notifications']");a&&(a.checked=o.checked,a.disabled=o.checked),m.checkCopyright()},toggleDonut:function(e,t){var n=(0,s.$)("input[name='from_group']");if(!n||n.checked){var o=(0,s.$)("#feed_add_form"),a=(0,s.$)('input[name="donut_only"]'),i=(0,s.$)("#select-donut-duration"),c=(0,s.$)('[name="donut_duration"]',o),d=!a.checked,u=(0,s.$)("input",i);(0,r.setFieldIgnored)(c,d),i.classList.toggle("PostSelect--hidden",d),(0,l.domData)(u,"ignore-field",d);var _=(0,s.$)("input[name='marked_as_ads']");if(_){var p="1"===(0,l.domData)(_,"value");a.checked?((0,l.domData)(_,"value",_.checked?"1":"0"),_.checked=!1):((0,l.domData)(_,"value",null),_.checked=p),_.disabled=a.checked}}},toggleSender:function(e,t){t.stopPropagation(),t.preventDefault();var n=e.querySelector("input"),o={group:[],user:["marked_as_ads","signed","close_comments","mute_notifications","donut_only"]},a=(0,s.$)("input[name='marked_as_ads']");(0,s.$)("input[name='donut_only']");$$(".Control.Control_type_switcher.Row").forEach((e=>{if(!hasClass("Control__blocked",e)){var t=e.querySelector("input[name]");if("from_group"!==t.name)(n.checked&&!o.group.includes(t.name)||!n.checked&&o.user.includes(t.name))&&(t.disabled=!n.checked),"mute_notifications"===t.name&&a&&a.checked&&(t.disabled=!0);else{var i=(0,s.$)(".header__user"),r=(0,s.$)(".header__group"),l="header_hidden",c=(0,s.$)("#select-timer"),d=(0,s.$)("input[name=postpone]"),u=(0,s.$)("input#add_post_btn");if(n.checked?(i.classList.add(l),r.classList.remove(l),c.style.display="inline-block",d.disabled=!1):(i.classList.remove(l),r.classList.add(l),c.style.display="none",d.disabled=!0),u){var _=u.value;u.value=u.dataset.value,u.dataset.value=_}}}})),m.checkCopyright()},checkCopyright(){var e=(0,s.$)("input[name='marked_as_ads']"),t=(0,s.$)("input[name='from_group']"),n=ge("select-copyright"),o=(0,s.$)('input[name="copyright"]'),a=(0,s.$)(".create_post__source-option");if(n){var i=(0,s.$)(".Btn",a),r=(0,s.$)(".Btn__text",i);e&&e.checked&&(!t||t.checked)?(hide(n),attr(i,"disabled",!0),a.classList.add("create_post__source-option--disabled"),r.innerHTML=getLang("mobile_wall_post_copyright_add_button")):(attr(i,"disabled",!1),a.classList.remove("create_post__source-option--disabled"),o.value?(setStyle(n,"display","inline-block"),r.innerHTML=getLang("mobile_wall_post_copyright_edit_button")):r.innerHTML=getLang("mobile_wall_post_copyright_add_button"))}}},f=m;window.post=m},50617:function(e,t,n){"use strict";n.d(t,{default:function(){return i}});var o=n(64485),a=function(e){var t=e.items?e.items:[];return{inner:[(t=t.filter((e=>e))).map((e=>{var t=o.default.class("OwnerInfo__row",{extraMargin:e.extraMargin,gray:e.gray,black:e.black,link:e.link,accent:e.accent});return{inner:[e.href?{inner:[{inner:[e.left],class:"OwnerInfo__rowLeft",tag:"div"},e.center?{inner:[e.center],class:"OwnerInfo__rowCenter",tag:"div"}:null],href:e.href,class:"OwnerInfo__rowInfo",tag:"a"}:{inner:[{inner:[e.left],class:"OwnerInfo__rowLeft",tag:"div"},e.center?{inner:[e.center],class:"OwnerInfo__rowCenter",tag:"div"}:null],class:"OwnerInfo__rowInfo",tag:"div"},e.right?{inner:[e.right],class:"OwnerInfo__rowRight",tag:"div"}:null],class:t,onClick:e.onClick,attrs:e.attrs,tag:"div"}}))],class:o.default.class("OwnerInfo",{noMargin:e.noMargin}),tag:"div"}};var i=a;window.OwnerInfo=a},25809:function(e,t,n){"use strict";n.d(t,{default:function(){return u}});var o=n(62641),a=n(94898),i=n(52822),r=n(61817),s=n(43569),l=n(36461),c=n(4726),d=function(e){var t=e.img?e.img:"",n=!!e.url&&e.url,d=!!e.innerHref&&e.innerHref,u=e.title?e.title:"",_=e.subtitle?e.subtitle:"",p=!!e.verified,m=e.mix?e.mix:"",f=e.type||null,v=e.online?e.online:"",g=!!e.actions&&e.actions,h=e.link?e.link:null,w=!!e.attrs&&e.attrs,y=!!e.linkAttrs&&e.linkAttrs,k=!!e.icon&&e.icon,b="artist"!==f||t?null:{inner:[(0,l.Icon28MusicMicOutline)()],class:"OwnerRow__placeholderWrapper",tag:"div"},S=e.style||{},C=e.titleIcon?e.titleIcon:null;return{inner:[(0,a.MaybeLink)({inner:[{inner:[k||{inner:[(0,c.Avatar)({mode:"both",backgroundTheme:e.owner_id,text:e.owner_name,textLength:(0,o.getAvatarTextLength)(e.owner_id),size:44,src:t,href:d}),v?v.mobile?{inner:[{inner:[(0,i.default)({icon:(0,r.getOnlineMobileComposite16Icon)()})],class:"mlvi_default",tag:"span"},{inner:[(0,i.default)({icon:(0,s.getOnlineMobileCompositeMuted16Icon)()})],class:"mlvi_muted",tag:"span"}],class:"lvi mlvi OwnerRow__online OwnerRow__online--mobile","aria-label":(0,o.getLang)("mobile_accessibility_profile_online"),tag:"b"}:{class:"lvi OwnerRow__online","aria-label":(0,o.getLang)("mobile_accessibility_profile_online"),tag:"b"}:null,b],class:"OwnerRow__img",tag:"div"}],class:"OwnerRow__left",tag:"div"},{inner:[{inner:[(0,a.MaybeLink)({inner:[u],href:d,class:"OwnerRow__title"}),p?{class:"OwnerRow__verified",tag:"div"}:null,C],class:(0,o.classNames)("OwnerRow__header",{"OwnerRow__header--verified":p}),tag:"div"},{inner:[_],class:"OwnerRow__subtitle",tag:"div"}],class:"OwnerRow__right",tag:"div"},h?{inner:[h],class:"OwnerRow__link",tag:"div"}:null],class:"OwnerRow__content",href:n,attrs:y}),g?{inner:[g],class:"OwnerRow__actions",tag:"div"}:null],attrs:w,onClick:e.onClick,class:(0,o.classNames)("OwnerRow",{OwnerRow_actions:!!g,"OwnerRow--noPadding":S.no_padding},m),tag:"div"}};var u=d;window.OwnerRow=d},69977:function(e,t,n){"use strict";n.d(t,{unhealScroll:function(){return u}});var o=n(20848),a=n(71437),i=n(73706);n(11911).isIOS&&window.MutationObserver&&document.addEventListener("DOMContentLoaded",l);var r=".ScrollView",s="_scrollViewHealed";function l(){(c(),document.body)&&new MutationObserver(c).observe(document.body,{childList:!0,subtree:!0})}function c(){var e,t;(null==(e=window.Speech)||null==(t=e.recorder)?void 0:t.isRecording)||(0,a.$$)(r).forEach(d)}function d(e){if(!e[s]){e[s]={};var t=getComputedStyle(e),n=parseInt(t.paddingTop,10),a=parseInt(t.paddingBottom,10);e.style.paddingTop=n+1+"px",e.style.paddingBottom=a+1+"px",_(e),(0,i.setScrollView)(e,{override:!1}),(0,o.hasClass)("messenger__body",e)||(0,o.addEvent)(e,"scroll",m),(0,o.addEvent)(e,"scroll",p)}}function u(e){e[s]&&(e[s]=null,e.style.paddingTop="",e.style.paddingBottom="",(0,i.cleanScrollView)(e),(0,o.removeEvent)(e,"scroll",m),(0,o.removeEvent)(e,"scroll",p))}function _(e){var t=e.scrollTop;t<0||(0===t?e.scrollTop+=1:t+e.offsetHeight===e.scrollHeight&&(e.scrollTop-=1))}function p(e){var t=e.target,n=t[s];n&&(n.timer&&clearTimeout(n.timer),n.timer=setTimeout((()=>{t[s]&&_(t)}),50))}function m(){onBodyScroll(!0)}},95851:function(e,t,n){"use strict";n.d(t,{default:function(){return r}});var o=n(33155),a=n(43186),i=function(e){return(0,a.default)({attrs:e.attrs,mix:o.default.class(e.mix,"ScrollView"),inner:e.inner})};n(69977);var r=i;window.ScrollView=i},76828:function(e,t,n){"use strict";n.d(t,{default:function(){return a}});var o=n(64485);var a=function(e){void 0===e&&(e={});var t=e.on_change,n=e.on_click;return{inner:[{inner:[e.options.map((e=>e?{inner:[e.label],attrs:e.attrs,class:"Select__option",value:e.value,selected:e.selected?"selected":null,tag:"option"}:null))],class:"Select__native",name:e.name,disabled:e.disabled,onchange:e.nativeOnChange?e.onChange:t?["Select._onChange","this",t]:null,onclick:n?["Select._onClick","this",n]:null,required:e.required,tag:"select"}],class:[e.mix||e.class,o.default.class("Select",{disabled:e.disabled},"_")],tag:"div"}}},89396:function(e,t,n){"use strict";n.d(t,{default:function(){return s},initAutogrow:function(){return r}});var o=n(62641);var a=function(e){return void 0===e&&(e={}),(0,o.extend)({inner:[e.text],class:["Textarea",e.mix],name:e.name,placeholder:e.placeholder,rows:e.rows?e.rows:3,maxlength:e.maxlength,tag:"textarea"},e.attrs)},i=n(20848);function r(e,t){void 0===t&&(t=3);var n=(0,i.ce)("span",{className:"Textarea__ghost"});(0,i.setStyle)(n,{width:e.clientWidth+"px",padding:(0,i.getStyle)(e,"padding"),lineHeight:(0,i.getStyle)(e,"line-height")}),n.innerText="_",(0,i.append)(n,e.parentNode);var o=n.clientHeight;(0,i.addEvent)(e,"input",(()=>{var a=e.value.replace(/ /g,"&nbsp;").replace(/\n/g,"<br />");("\n"===(0,i.last)(a)||a.endsWith("<br />"))&&(a+="&nbsp;"),n.innerHTML=a,e.rows=Math.max(1,Math.min(t,Math.ceil(n.clientHeight/o)))}))}var s=a},39307:function(e,t,n){"use strict";n.d(t,{default:function(){return u}});var o=n(39871),a=n(64485),i=n(43365),r=function(e){var t=window.lang,n=e.count;return o.default.html({class:[a.default.class("Bell",{empty:!n},"_"),"al_menu"],href:e.url,onclick:e.onclick,"aria-label":t.mobile_notifications_title,"data-header":t.mobile_notifications_title,"data-skiponclick":1,inner:[(0,i.default)({mix:"Bell__icon",icon:"bell"}),{class:"Bell__counter",inner:n,tag:"em"}]})};var s=n(71437);Object.assign(r,{setCount:function(e){(0,s.$$)(c).forEach((t=>{var n=t.$(d);t.classList.toggle(l,!e),n.innerText=e}))}});var l="Bell_empty",c=".Bell",d=".Bell__counter";var u=r;window.Bell=r},89414:function(e,t,n){"use strict";n.d(t,{ContextMenu:function(){return r},ContextMenuItem:function(){return s},default:function(){return g}});var o=n(20848),a=n(9223),i=n(52822);function r(e){return(0,a.default)({on_overlay_click:["return ContextMenu.close","this"],class:"ContextMenu",close:!0,onClose:["return ContextMenu.close","this"],items:[e.list?{tag:"ul",class:"ContextMenu__list",inner:e.withoutWrap?e.list:Wd.wrap(e.list)}:null]})}function s(e){return{inner:[{inner:[e.icon?{inner:[(0,i.SVGIcon)({icon:e.icon})],class:"ContextMenu__listIcon",tag:"div"}:null,e.title],attrs:e.attrs,"data-ref":e.ref,href:e.href,target:e.target,class:"ContextMenu__listLink",onClick:e.onclick,tag:"a"}],class:"ContextMenu__listItem","data-name":e.name,tag:"li"}}var l=n(53593),c=n(71437),d=n(95574),u={open:f,close:v},_=()=>{},p=".ContextMenu",m=".ContextMenu.Popup_open";function f(e,t,n){var o;if(void 0===n&&(n={}),!(o=n.pureMenu?e:n.menuEl)){var a=e.closest(t);o=(0,c.$)(p,a)}return!!o&&(o=l.default.open(o,n.appendToBody||n.pureMenu,"",{withoutPopupCloning:n.withoutPopupCloning}),_=()=>{v(o)},nav.onBeforeGo(_),o)}function v(e){return e||(e=(0,c.$)(".Popup_open.ContextMenu")||(0,c.$)(m)),e&&l.default.close(e),nav.onBeforeGo.off(_),!1}(0,d.tq)().setInteractiveHandler("ContextMenu/open",(e=>{var{payload:{dataAttrs:t,target:n}}=e;f(n,t.selector,t.options)})),(0,o.extend)(r,u);var g=r;window.ContextMenu=r},53593:function(e,t,n){"use strict";n.d(t,{ModalMenuBtn:function(){return s},ModalMenuContent:function(){return _},ModalMenuIcon:function(){return l},ModalMenuTitle:function(){return d},ModalMenuBody:function(){return c},ModalMenuHeaderCloseButton:function(){return u}});var o=n(49598),a=n(81294),i=n(62641),r=n(36461);function s(e){var t;return t=e.isBtn?(0,i.classNames)(e.class||e.className,"ModalMenu__btn","ModalMenu__customBtn"):(0,i.classNames)(e.class||e.className,"ModalMenu__btn","ModalMenu__item"),(0,a.default)({icon:e.icon,url:e.url,class:t,theme:e.theme?e.theme:"none",size:e.size?e.size:"",inner:e.inner,on_click:e.onclick,use_native_onclick:!0,attrs:e.attrs,"aria-label":e["aria-label"]||""})}function l(e){return{inner:[{inner:[e.inner],class:"ModalMenu__icon",tag:"div"}],class:"ModalMenu__iconWrapper",tag:"div"}}function c(e){return{inner:[e.inner],class:"ModalMenu__customBody",tag:"div"}}function d(e){return{inner:[e.inner],class:"ModalMenu__title",tag:"div"}}function u(e){return void 0===e&&(e={}),{inner:[(0,r.Icon24Dismiss)()],class:"ModalMenu__headerCloseButton",onClick:e.onClose?e.onClose:["ModalMenu.close","this"],"aria-label":(0,i.getLang)("mobile_close"),tag:"button"}}function _(e){return e.class+=" ModalMenuContent",e}t.default=function(e){var t=[];if(e.title&&t.push({class:"ModalMenu__title",inner:e.title}),e.body&&t.push({class:"ModalMenu__body",inner:e.body}),(0,i.isArray)(e.items)){var n=e.items.map((e=>e));t.push(n)}e.close&&t.push((0,a.default)({class:"ModalMenu__btn ModalMenu__cancel",theme:"secondary",size:"large",inner:e.closeText?e.closeText:(0,i.getLang)("mobile_cancel"),on_click:e.onClose?e.onClose:["ModalMenu.close","this"],use_native_onclick:!0}));var r=e.type?e.type:"default";return(0,o.default)({id:e.id||"",class:(0,i.classNames)("ModalMenu",e.class,"ModalMenu--"+r,{"ModalMenu--attached":e.attached}),on_overlay_click_native:e.on_overlay_click?e.on_overlay_click:["ModalMenu.close","this"],content:t})}},9223:function(e,t,n){"use strict";n.d(t,{ModalMenuBody:function(){return s.ModalMenuBody},ModalMenuBtn:function(){return s.ModalMenuBtn},ModalMenuHeaderCloseButton:function(){return s.ModalMenuHeaderCloseButton},ModalMenuTitle:function(){return s.ModalMenuTitle},close:function(){return O},default:function(){return U},open:function(){return L}});var o,a,i,r=n(20848),s=n(53593),l=n(49598),c=n(71437),d=function(){function e(e){this.lastTime=0,this.lastRegisteredTime=0,this.lastCoordinates=[0,0],this.velocity={x:0,y:0},this.lastTime=e.time,this.lastCoordinates=[e.x,e.y],this.velocity={x:0,y:0}}return e.getVelocity=function(e,t,n){return{x:t/e||0,y:n/e||0}},e.prototype.registerEvent=function(t){if("touchmove"===t.type){var n=+t.touches[0].clientX,o=+t.touches[0].clientY,a=t.timeStamp-this.lastTime;if(t.timeStamp-this.lastRegisteredTime<=16.67)this.lastCoordinates=[n,o],this.lastTime=t.timeStamp;else{var i=n-this.lastCoordinates[0],r=o-this.lastCoordinates[1];this.velocity=e.getVelocity(a,i,r),this.lastTime=t.timeStamp,this.lastRegisteredTime=this.lastTime,this.lastCoordinates=[n,o]}}else window.clog&&window.clog("[Gestures.js] unhandled event "+t.type)},e}(),u=n(63848),_=n(30730),p=n(77750),m=n.n(p),f="horizontal",v="vertical",g=882,h=!1,w=null,y=null,k=0,b=0,S=0,C={},E=null,T=(0,c.$)(".Popup__wrap",o),I=!1,M=!1,P=0;function L(e,t,n,s){void 0===t&&(t=!0),void 0===n&&(n=""),void 0===s&&(s={});var{settling:d=75,expandable:_=!1}=s;return s.settling=d,s.expandable=_,(o=l.default.open(e,t,{hash:n,withoutCloning:s.withoutPopupCloning})).classList.contains("ModalMenu--page")&&(s.settling=100,s.expandable=!0),C=s,T=(0,c.$)(".Popup__wrap",o),i=(0,c.$)(".Popup__content",T),o.classList.toggle("ModalMenu--hasHeader",!!(0,c.$)(".ModalMenuHeader",o)),void 0===s.swipeDown&&(s.swipeDown=!0),_&&A(o,C)&&(I=!0,o.classList.add("ModalMenu--expandable"),100===C.settling&&o.classList.add("ModalMenu--expanded"),m().measure((()=>{var e=(100-C.settling)/100*(0,r.getCh)();P=e,D(),m().mutate((()=>{r.setStyle.animate(T,"transform",{duration:200,func:"ease"}),r.setStyle.transform(T,1,[0,e])}))}))),F(),(0,r.onBodyResize)(F),s.swipeDown&&window.innerWidth<g&&(scrollTop(0),(0,r.addEvent)(i,"touchstart",x,{passive:!0}),(0,r.addEvent)(i,"touchmove",R,{capture:!0}),(0,r.addEvent)(i,"touchcancel touchend",N,{passive:!0}),(0,r.addEvent)(T,"click",B,{passive:!0}),(0,r.addEvent)(T,"click",B,{passive:!0})),(a=(0,u.setFocusTrap)(o))&&(a.exitIntent=()=>!1),o}function B(e){if(T&&e.target===T)return(a=(0,u.setFocusTrap)(o))&&(a.exitIntent=()=>!1),o}function A(e,t){if((0,r.getCw)()>=g)return!1;if(100===t.settling)return!0;var n=(0,c.$)(".ScrollView",e);if(n&&n.scrollHeight>n.clientHeight)return!0;var o=(0,c.$)(".ModalMenu__body",e)||(0,c.$)(".ModalMenuContent",e)||(0,c.$)(".Popup__content",e);return(o.scrollHeight||(0,r.getH)(o))>window.innerHeight}function O(e,t){if(void 0===t&&(t={}),e||(e=document.activeElement),e){var n=e.closest(".ModalMenu.Popup_open")||e;n&&n.classList.contains("ModalMenu")&&(e.classList.contains("Popup__overlay")&&(0,_.isFunction)(C.onOverlayClick)&&C.onOverlayClick(),window.innerWidth<g?l.default.close(n,{smooth:!0,velocity:!(!E||!E.velocity)&&E.velocity,lastY:S,onClose:t.onClose}):setTimeout((()=>{l.default.close(n),t.onClose&&t.onClose()})),(0,r.removeEvent)(i,"touchstart",x,{passive:!0}),(0,r.removeEvent)(i,"touchmove",R,{capture:!0}),(0,r.removeEvent)(i,"touchcancel touchend",N,{passive:!0}),(0,r.removeEvent)(T,"click",B,{passive:!0}),(0,r.removeEvent)(T,"click",B,{passive:!0}),y=null,k=0,b=0,w=null,M=!1,S=0,P=0,o=Array.from((0,c.$$)(".ModalMenu.Popup_open")).pop(),T=o&&(0,c.$)(".Popup__wrap",o),i=T&&(0,c.$)(".Popup__content",T),E=null,C={},(0,r.onBodyResize)("__clear",F),a&&(a(),a=null))}}function x(e){if(e.touches&&e.touches.length>1)h=!1;else{var t=e.target.closest(".ScrollView")||(0,c.$)(".ScrollView",e.target);if(!(0,c.$)(".ModalMenu").classList.contains("ModalMenu--blocked")){var n=C.expandable&&A(o,C);I=n,y=e.touches[0],b=e.touches[0].clientX,k=e.touches[0].clientY,t&&t.scrollTop>1?h=!1:(E=new d({time:e.timeStamp,x:e.touches[0].clientX,y:e.touches[0].clientY}),h=!0)}}}function R(e){if(e.touches&&e.touches.length>1)h=!1;else if(y&&h){var t=e.touches[0];if(w||(w=Math.abs(b-t.clientX)>Math.abs(k-t.clientY)?f:v),w!==f){E.registerEvent(e);var n=-Math.min(0,k-t.clientY-P);0!==n&&((0,r.cancelEvent)(e),S=n,M||(o.classList.add("ModalMenu--dragging"),browser.ios&&r.setStyle.animate(T,"transform",{duration:50,func:"linear"}),M=!0),m().measure((()=>{D(n),m().mutate((()=>{r.setStyle.transform(T,1,[0,n])}))})))}}}function N(e){h&&0!==S?(h=!1,o.classList.remove("ModalMenu--dragging"),M=!1,w!==f?(w=null,m().measure((()=>{D(S);var t=C.expandable&&A(o,C);I=t;var n=o.classList.contains("ModalMenu--expanded"),a=t&&!n,i=function(e){void 0===e&&(e=[]);return e.find((e=>0!==e.scrollTop||e.scrollHeight>e.offsetHeight))}(e.path),s=!1;i&&(s=0!==i.scrollTop);var l=!1,c=!1;E&&(l=!s&&E.velocity.y>=.6,c=!s&&E.velocity.y<=-.15);var d=S/window.innerHeight*100,u="";n?u="expand":a&&(u="collapse");var _=u;l&&d<8?d=8:c&&(d=0),!t&&d>=8||d>=100-C.settling+8?_="close":n?d>=8&&!s&&(_="collapse"):a&&A(o,C)&&d<=100-C.settling&&(_="expand"),m().mutate((()=>{!function(e){if(!e)return;o.classList.toggle("ModalMenu--expanded","expand"===e),"close"!==e&&T.style.removeProperty("transition");switch(e){case"collapse":o.classList.add("ModalMenu--restore");var t=0;A(o,C)&&(t=(100-C.settling)/100*window.innerHeight),P=t,r.setStyle.transform(T,1,[0,t]),D(P=t,!0),setTimeout((()=>{o&&o.classList.remove("ModalMenu--restore"),0===t&&(0,r.setStyle)(T,{transform:""})}),200);break;case"expand":o.classList.add("ModalMenu--restore"),o.classList.add("ModalMenu--expanded"),r.setStyle.transform(T,1,[0,0]),D(P=0,!0),setTimeout((()=>{o&&(F(),o.classList.remove("ModalMenu--restore"))}),200);break;case"close":P=0,O(o,C)}}(_)})),E=null}))):w=null):h=!1}function D(e,t){if(void 0===e&&(e=null),void 0===t&&(t=!1),I){var n=(0,c.$)(".ModalMenuHeader__title",T),o=(0,c.$)(".ModalMenuHeader__close",T);if(n&&o){var a,i=(100-C.settling)/100*(0,r.getCh)();a=100===C.settling||(0,r.getCw)()>=g?1:1-Math.max(0,Math.min(1,(null===e?P:e)/i)),m().mutate((()=>{t&&(0,r.getCw)()<g&&(r.setStyle.animate(n,"transform",{duration:250}),r.setStyle.animate(o,"transform, opacity",{duration:250})),r.setStyle.transform(n,1,[44*a,0]),r.setStyle.transform(o,a),(0,r.setStyle)(o,{opacity:a})}))}}}function F(){var e=(0,c.$)(".ModalMenuContent",o),t=(0,c.$)(".ModalMenuHeader",o);if(e&&t){var n=(0,r.getH)(t),a=(0,r.getH)(e),i=Math.min((0,r.getCh)(),a+n+"px");(0,r.getCw)()>=g&&(i=null),(0,r.setStyle)(e,"height",i)}}(0,r.addEvent)(window,"keydown",(e=>{var t=e.target&&e.target.closest(".ModalMenu")||document.activeElement&&document.activeElement.closest(".ModalMenu")||(0,c.$)(".ModalMenu.Popup_open");if(t&&27===e.keyCode)O(t,C)})),(0,r.addEvent)(window,"click",(e=>{if(e.isTrusted){var t=e.target&&e.target.closest(".ModalMenu")||document.activeElement&&document.activeElement.closest(".ModalMenu")||(0,c.$)(".ModalMenu.Popup_open"),n=!!e.target.closest(".ModalMenu");if(t&&n&&!e.target.closest(".Popup__content")){var o=(0,c.$)(".Popup__overlay",t);window.clog("Simulate modal overlay click"),o.click()}}}),{passive:!0});var U=s.default;(0,r.extend)(s.default,{open:L,close:O}),window.ModalMenu=s.default},31602:function(e,t,n){"use strict";var o=n(62641),a=n(64485),i=n(36461);t.default=function(e){void 0===e&&(e={});var t=[a.default.class("ModalMenuHeader"),e.mix];return{inner:[{inner:[(0,i.Icon24Cancel)()],class:"ModalMenuHeader__close","aria-label":(0,o.getLang)("mobile_close"),onClick:e.onClose,tag:"button"},{inner:[e.inner],class:"ModalMenuHeader__title",tag:"div"},e.right?{inner:[e.right],class:"ModalMenuHeader__right",tag:"div"}:null],class:t,tag:"div"}}},69607:function(e,t,n){"use strict";n.d(t,{ModalMenuUserListItem:function(){return s}});var o=n(5732),a=n(30730),i=n(62641),r=n(4726);function s(e){return{class:(0,a.classNames)("ModalMenuUserList__item",e.class),href:e.href,onclick:e.onclick?e.onclick:null,inner:[{class:"ModalMenuUserList__itemAvatar",inner:(0,r.Avatar)({mode:"both",backgroundTheme:e.id,text:e.name,textLength:(0,i.getAvatarTextLength)(e.id),size:56,src:e.image})},{class:"ModalMenuUserList__itemName",inner:e.name}]}}t.default=function(e){return{class:"ModalMenuUserList",inner:(0,o.default)({inner:e.users})}}},93736:function(e,t,n){"use strict";var o=n(81294),a=n(52822),i=n(4634),r=n(69191),s=n(36461);t.default=function(e){return void 0===e&&(e={}),{inner:[{inner:[{inner:[(0,o.default)({inner:[(0,a.default)({icon:e.isLeftActionBack?(0,i.getBackOutline28Icon)():(0,r.getCancelOutline28Icon)()})],theme:"header",class:"ModalPage__headerButton ModalPage__headerButton--close",onClick:e.onLeftActionClick,use_native_onclick:!0,is_icon:!0}),{inner:[e.title],class:"ModalPage__headerTitle",tag:"div"},e.isConfirmActionAvailable?(0,o.default)({inner:[(0,s.Icon28DoneOutline)()],theme:"header",class:"ModalPage__headerButton ModalPage__headerButton--confirm",onClick:e.onConfirmClick,use_native_onclick:!0,is_icon:!0}):null],class:"ModalPage__header",tag:"div"},{inner:[e.content],class:"ModalPage__content",id:e.contentId,tag:"div"}],class:"ModalPage__wrapper",tag:"div"}],class:"Popup ModalPage",tag:"div"}}},31332:function(e,t,n){"use strict";n.d(t,{default:function(){return m}});var o=n(95040),a=n(33155),i=n(64485),r=n(81290),s=n(62641);function l(){var e=(0,o.default)(['\n    <div class="typing__dotsWrap">\n      <div class="typing__dots">...</div>\n    </div>\n  ']);return l=function(){return e},e}function c(){var e=(0,o.default)(['\n    <div class="','">\n      ','\n      <div class="typing__names">',"</div>\n      ","\n    </div>\n  "]);return c=function(){return e},e}var d=function(e){var t,n,o=e.dimmed,s=e.animation,d=!!e.compact,p=e.typingCount,m=a.default.class("typing",{dimmed:o,id:e.id,empty:u(p),animation:s}),f=_(e);"audio"===s?(t=Wd.html((0,r.default)({class:i.default.class("typing__loading",{audio:!0,compact:d},"_")})),n=""):"dots"===s?(t=Wd.html((0,r.default)({class:i.default.class("typing__loading",{audio:!1,compact:d},"_")})),n=""):"simple-dots"===s&&(t="",n=a.default.html(l()));return a.default.html(c(),m,t,f,n)};function u(e){return!e}function _(e){return"audio"===e.text?function(e,t){var n=window.lang;if(!(0,s.isArray)(e))return e?n.mobile_mail_recaudio_1_short:"";var o=e,a=t,i="";if(1===a&&o.length>=1){var r=o[0];i=(i=n.mobile_mail_recaudio_1).replace("{name}",r)}else if(2===a&&o.length>=2){var l=o[0],c=o[1];i=(i=(i=n.mobile_mail_recaudio_2).replace("{name1}",l)).replace("{name2}",c)}else if(a>1&&o.length>=1){var d=o[0];i=(i=(i=n.mobile_mail_recaudio_many).replace("{name}",d)).replace("{count}",a-1)}else a>=1&&!o.length&&(i=langNumeric(a,n.mobile_mail_recaudio_N_unknown));return i}(e.typing,e.typingCount):"mixed"===e.text?function(e,t){var n=window.lang;if(!(0,s.isArray)(e))return"";var o=e,a=t,i="";if(1===a&&o.length>=1)i="";else if(2===a&&o.length>=2){var r=o[0],l=o[1];i=(i=(i=n.mobile_mail_mixtyping_2).replace("{name1}",r)).replace("{name2}",l)}else if(a>1&&o.length>=1){var c=o[0];i=(i=(i=n.mobile_mail_mixtyping_many).replace("{name}",c)).replace("{count}",a-1)}else a>=1&&!o.length&&(i=langNumeric(a,n.mobile_mail_mixtyping_N_unknown));return i}(e.typing,e.typingCount):function(e,t){var n=window.lang;if(!(0,s.isArray)(e))return e?n.mobile_mail_typing_1_short:"";var o=e,a=t,i="";if(1===a&&o.length>=1){var r=o[0];i=(i=n.mobile_mail_typing_1).replace("{name}",r)}else if(2===a&&o.length>=2){var l=o[0],c=o[1];i=(i=(i=n.mobile_mail_typing_2).replace("{name1}",l)).replace("{name2}",c)}else if(a>1&&o.length>=1){var d=o[0];i=(i=(i=n.mobile_mail_typing_many).replace("{name}",d)).replace("{count}",a-1)}else a>=1&&!o.length&&(i=langNumeric(a,n.mobile_mail_typing_N_unknown));return i}(e.typing,e.typingCount)}var p=n(71437);Object.assign(d,{setTyping:function(e,t){var n="string"==typeof e?(0,p.$)(".typing_id_"+e):e,o=n.$(".typing__names");n.classList.toggle("typing_empty",u(t.typingCount)),o.innerHTML=_(t)},getElem:function(e){return(0,p.$)(".typing_id_"+e)}});var m=d;window.Typing=d,Object.assign(window,{Typing_renderNames:_,Typing_isEmpty:u})},11560:function(e,t,n){"use strict";n.d(t,{default:function(){return i}});var o=n(39307),a=function(){var e=window.store,t="/feed?section=notifications";return(0,o.default)({url:t,count:e.notificationsCount,onclick:["nav.onMenuItemClick",t]})};var i=a;window.uBell=a},77978:function(e,t,n){"use strict";n.d(t,{BotsKeyboardRow:function(){return _},default:function(){return p}});var o=n(81294),a=n(52822),i=n(39871),r=n(64485),s=n(62641),l=n(9239),c=n(36461),d=n(3069),u=n(27686);function _(e,t,n,_,p,m){var f=0;return{class:"BotsKeyboard__row",inner:e.map((e=>function(e,t,n,_,p,m,f){var v,g=window.lang,h=e.action.type,w=r.default.class("BotsKeyboard__button",{primary:"primary"===e.color||"vkpay"===h,positive:"positive"===e.color,negative:"negative"===e.color}),y=["window.uMailWrite && uMailWrite._onKeyboardButtonClick","this","event",{action:(0,s.stringifyJSON)(e.action),authorId:t.author_id,inline:t.inline,msgId:n,subID:p}];v="vkpay"===h?[{class:"BotsKeyboard__buttonInner",inner:[i.default.wrap(g.mobile_mail_keyboard_label_vkpay),i.default.wrap("&nbsp;"),i.default.wrap("&nbsp;"),(0,a.default)((0,l.getVkPay16Icon)())]}]:"location"===h?[{class:"BotsKeyboard__buttonInner",inner:[{tag:"span",class:"BotsKeyboard__leadingIcon",inner:(0,c.Icon24Place)()},i.default.wrap("&nbsp;"),{class:"BotsKeyboard__buttonLabelWrapped",inner:[i.default.wrap(g.mobile_mail_keyboard_label_location)]}]}]:"open_app"===h?[{class:"BotsKeyboard__buttonInner",inner:[{tag:"span",class:"BotsKeyboard__leadingIcon",inner:(0,a.default)((0,d.getService24Icon)())},i.default.wrap("&nbsp;"),{class:"BotsKeyboard__buttonLabelWrapped",inner:[i.default.wrap(e.action.label)]}]}]:"open_link"===h?[{class:"BotsKeyboard__buttonInner",inner:[{class:"BotsKeyboard__buttonLabelWrapped",inner:[i.default.wrap(e.action.label)]},i.default.wrap("&nbsp;"),(0,a.default)((0,u.getOpenLink16Icon)())]}]:[i.default.wrap(e.action.label)];var k=!1,b="";p&&(b=p+"|");var S=""+b+m+","+f;_&&_[S]&&(k=!0);return(0,o.default)({class:w,isLoading:k,spinner:!0,on_click:y,use_native_onclick:!0,inner:v,theme:"none",size:"normal",type:"button",attrs:{"data-position":S}})}(e,t,n,_,p,m,f++)))}}var p=function(e){var t=e.keyboard,n=e.msgId,o=e.pressed||{},a=t.buttons,i=e.subID,r=0;return{class:"BotsKeyboard__main",inner:a.map((e=>_(e,t,n,o,i||null,r++)))}}},75127:function(e,t,n){"use strict";n.d(t,{default:function(){return p},handleElementAction:function(){return d},moveSlider:function(){return _},onScroll:function(){return u}});var o=n(77978),a=n(5732),i=n(62641),r=n(36461);var s=function(e){void 0===e&&(e={});for(var t=e.elements,n=e.msgId,s={inline:!0,author_id:e.authorId||100},l=[],c=function(e){var a=t[e],r=a.pressed,c=a.buttons?a.buttons.map((t=>(0,o.BotsKeyboardRow)([t],s,n,r,"carousel"+e,e))):null,d=a.title||a.description||c,u=(0,i.classNames)("MsgTemplateCard",{"MsgTemplateCard--full":!!d,"MsgTemplateCard--photo":!d}),_=a.action;_&&"open_photo"===_.type&&(_.photo_id=a.photo_id+"/mail"+n),l.push({inner:[a.photo_src?{inner:[{src:a.photo_src,alt:"",tag:"img"},{class:"MsgTemplateCard__imageShadow",tag:"div"}],class:"MsgTemplateCard__image",tag:"div"}:null,d?{inner:[a.title||a.description?{inner:[a.title?{inner:[Wd.wrap(a.title)],class:"MsgTemplateCard__title",tag:"span"}:null,a.description?{inner:[Wd.wrap(a.description)],class:"MsgTemplateCard__subtitle",tag:"span"}:null],class:"MsgTemplateCardContent__text",tag:"div"}:null,c?{inner:[c],class:"MsgTemplateCardContent__buttons",tag:"div"}:null],class:"MsgTemplateCardContent",tag:"div"}:null],class:u,onclick:_?"MsgTemplates.Carousel.handleElementAction(event, "+JSON.stringify(_)+")":"",tag:"div"})},d=0;d<t.length;d++)c(d);var u=(0,i.arrayLength)(t)>1;return{inner:[(0,a.default)({inner:[l],class:"Slider--right",onScroll:["MsgTemplates.Carousel.onScroll","event"],snapping:!0}),u?{inner:[{inner:[(0,r.Icon24ChevronRight)()],class:"MsgTemplate__button MsgTemplate__button--prev",onClick:["MsgTemplates.Carousel.moveSlider","this","prev"],tag:"button"},{inner:[(0,r.Icon24ChevronRight)()],class:"MsgTemplate__button MsgTemplate__button--next",onClick:["MsgTemplates.Carousel.moveSlider","this","next"],tag:"button"}],class:"MsgTemplate__buttons",tag:"div"}:null],class:"MsgTemplate MsgTemplate--carousel",tag:"div"}},l=n(84137),c=n(71437);function d(e,t){if("open_link"===t.type){if("BUTTON"===e.target.tagName||e.target.closest(".MsgTemplateCardContent__buttons"))return;var n=(0,l.wrapAwayIfExternal)(t.link,!0);window.open(n)}else if("open_photo"===t.type){var o=(t.photo_id||"").split("/"),a=o[0],i=o[1];return photo.openInLayer(null,null,a,i,{})}}function u(e){var{target:t}=e,n=t.closest(".Slider"),o=(0,a.getElements)(n),i=(0,a.getCurrentElementIndex)(n,o);n.classList.toggle("Slider--left",0!==i),n.classList.toggle("Slider--right",i<o.length-1)}function _(e,t){var n=e.closest(".MsgTemplate--carousel"),o=(0,c.$)(".Slider",n);"next"===t?Slider.nextElem(o,!0,"left"):Slider.prevElem(o,!0,"left")}var p=s},55656:function(e,t,n){"use strict";n.d(t,{ItemFaveStar:function(){return a}});var o=n(62641);function a(e){var t=(0,o.classNames)("PhotoMarketItem__fave",{"PhotoMarketItem__fave--added":e.isFave}),n=["ItemsList._toggleFave",{event:"event",el:"this",type:e.type,typeInt:e.typeInt,ownerId:e.ownerId,itemId:e.itemId,href:e.href,faveHash:e.faveHash}];return{class:t,"data-is-fave":e.isFave?"fave":"",onclick:n,tag:"a"}}},66021:function(e,t,n){"use strict";n.d(t,{ItemsList:function(){return l}});var o=n(62641),a=n(39871),i=n(55656);function r(e){return{inner:[{src:e.thumb,class:"PhotoMarketItem__thumb",tag:"img"},{inner:[e.title],class:"PhotoMarketItem__title",tag:"div"},{inner:[e.price],class:"PhotoMarketItem__price",tag:"div"},(0,i.ItemFaveStar)({type:e.type,typeInt:e.typeInt,isFave:e.isFave,itemId:e.itemId,ownerId:e.ownerId,href:e.href,faveHash:e.faveHash})],class:"PhotoMarketItem","data-item-id":e.itemId,tag:"div"}}function s(){for(var e=[],t=0;t<10;t++)e.push({class:"PhotoItemsList__item PhotoItemsList__item--filler",tag:"div"});return e}function l(e){var t=JSON.parse(unescape(e.itemsJSON));return{inner:[{inner:[{class:"PhotoItemsList__closeIcon",onClick:e.onClose,tag:"div"},(0,o.getLang)("mobile_photos_market_items_title")],class:"PhotoItemsList__header",tag:"div"},{inner:[t.map((e=>({inner:[r({itemId:e.item_id,thumb:e.thumb,title:e.title,price:a.default.wrap(e.price),href:e.href,faveHash:e.fave_hash,type:e.type,typeInt:e.type_int,ownerId:e.owner_id,isFave:l._faveCache[e.item_id]||e.is_fave})],onClick:["ItemsList._goToItem",e],class:"PhotoItemsList__item",tag:"div"}))),s()],class:"PhotoItemsList__body",tag:"div"}],class:"PhotoItemsList",tag:"div"}}},17615:function(e,t,n){"use strict";n.d(t,{default:function(){return r}});var o=n(62641),a=n(64485),i=n(36461);var r=function(e){void 0===e&&(e={});var t=e.narrative,n=e.disablePreview||!t.storiesCount||e.onClick?null:e.onCoverClick||"window.showNarrative("+t.ownerId+", "+t.id+", 0); return false;",r=0===t.storiesCount,s=a.default.class("NarrativesListItem",{draft:r,previewDisabled:e.disablePreview}),l=(0,o.getLangNumeric)(t.storiesCount,(0,o.getLang)("mobile_narratives_stories_count","raw"));return e.isOwnerNameVisible&&(l=t.ownerName),{inner:[{inner:[r?(0,i.Icon24NarrativeActiveOutline)():{class:"NarrativesListItem__coverImage",style:"background-image: url("+t.coverUrl+");",tag:"div"}],class:"NarrativesListItem__cover",onClick:n,tag:"div"},{inner:[{inner:[(0,o.winToUtf)(t.title)],class:"NarrativesListItem__name",tag:"div"},{inner:[r?{inner:[(0,o.getLang)("mobile_narratives_no_stories"),"\n               · \n              ",(0,o.getLang)("mobile_narratives_draft")],tag:"span"}:l],class:"NarrativesListItem__storiesCount",tag:"div"}],class:"NarrativesListItem__description",tag:"div"}],class:s,onClick:e.onClick,tag:"div"}}},34381:function(){window.FaceRecognitionSwitch={onChange(e,t){window.ajax.post(e,{checked:t.checked,_ajax:1})}}},59066:function(e,t,n){"use strict";n.d(t,{Circle:function(){return i}});var o=n(62641),a=n(64485);function i(e){void 0===e&&(e={});var t=(0,o.getRandomId)("skeleton-circle"),n=(e.size?(0,o.stylesObjectToString)({width:e.size+"px",height:e.size+"px"}):"")+(e.style||"");return{id:t,"data-skeleton-el":"true",class:["SkeletonComponent","SkeletonComponent__item",a.default.class("SkeletonCircle",{header:e.header}),e.class].filter((e=>e)).join(" "),style:n,tag:"div"}}},19070:function(e,t,n){"use strict";n.d(t,{SkeletonRow:function(){return a},SkeletonCol:function(){return i},SkeletonOffset:function(){return r}});var o=n(64485);function a(e){void 0===e&&(e={});var t=[o.default.class("SkeletonRow",{justifyContent:e.justify,alignItems:e.align}),e.class].filter((e=>e));return{inner:[e.inner],class:t.join(" "),tag:"div"}}function i(e){void 0===e&&(e={});var t=[o.default.class("SkeletonCol",{auto:e.auto,grow:e.grow,flexColumn:e.flexColumn}),e.class].filter((e=>e)).join(" ");return{inner:[e.inner],class:t,tag:"div"}}function r(e){void 0===e&&(e={});var t=[o.default.class("SkeletonOffset",{small:e.small}),e.class].filter((e=>e));return{inner:[e.inner],class:t.join(" "),tag:"div"}}},71231:function(e,t,n){"use strict";n.d(t,{SkeletonRow:function(){return o.SkeletonRow},SkeletonCol:function(){return o.SkeletonCol},SkeletonOffset:function(){return o.SkeletonOffset}});var o=n(19070)},87531:function(e,t,n){"use strict";n.d(t,{Line:function(){return i}});var o=n(62641),a=n(64485);function i(e){void 0===e&&(e={});var t=(0,o.getRandomId)("skeleton-line"),n=(0,o.stylesObjectToString)({})+(e.style||"");return{id:t,"data-skeleton-el":"true",class:["SkeletonComponent","SkeletonComponent__item",a.default.class("SkeletonLine",{small:e.small,header:e.header}),e.class].filter((e=>e)).join(" "),style:n,tag:"div"}}},13933:function(e,t,n){"use strict";n.d(t,{HEADER_HEIGHT:function(){return i},processSkeletonElements:function(){return u}});var o=n(20848),a=n(71437),i=56,r=new Set,s=(0,o.debounce)((()=>{var e=Array.from(r.values()).map((e=>(0,a.$)("#"+e))).filter((e=>e)).map((e=>{var t=Math.round(e.getBoundingClientRect().left),n="skeleton-gradient-slide-"+t;return function(e,t){if(c[e])return;var n=function(e,t){return["@"+l()+"keyframes "+e+" {",t.map(((e,n)=>["\t"+n/(t.length-1)*100+"% {",Object.keys(e).map((t=>"\t\t"+t+": "+e[t]+";")).join("\n"),"\t}"].join("\n"))).join("\n"),"}"].join("\n")}(e,t);c[e]=n,d.appendChild(document.createTextNode(n))}(n,[{"background-position-x":-600-t+"px"},{"background-position-x":window.innerWidth-t+"px"}]),{el:e,prop:n+" 1.2s infinite cubic-bezier(0.4, 0.0, 0.2, 1)"}}));requestAnimationFrame((()=>{e.forEach((e=>{var{el:t,prop:n}=e;t.style[l()+"animation"]=n})),r.clear()}))}),100);function l(){var e="";document&&(e=null!=(document.documentElement||document.createElement("div")).style.animation?"":"-webkit-");return e}var c={},d=document.createElement("style");function u(){setTimeout((()=>{(0,a.$$)("[data-skeleton-el=true]").forEach((e=>{return t=e.id,r.add(t),void s();var t}))}),0)}document.head.appendChild(d),window.onDOMReady&&window.onDOMReady((()=>{u()}))},60319:function(e,t,n){"use strict";n.d(t,{init:function(){return ue}});var o=n(20848),a=n(52822),i=n(89396),r=n(90893),s=n(81294),l=n(62641),c=n(36461),d=n(44264),u=n(87267),_=n(1753),p=n(48328),m=n(46493),f=n(56798),v=n(5372);function g(e){return void 0===e&&(e={}),{class:"SharePanel SharePanel-header SharePanel--active ShareHeaderConversationsPanel","aria-hidden":"false","data-name":"ShareHeaderConversationsPanel",inner:[{"aria-label":(0,l.getLang)("mobile_close"),onclick:"cur.share && cur.share.destroy()",role:"button",class:"SharePanel-header__close",inner:(0,c.Icon24Cancel)()},{class:"SharePanel-headerText",inner:[{class:"SharePanel-headerText__label",inner:(0,l.getLang)("mobile_like_publish_head_title")},{class:"SharePanel-headerText__receivers"}]},{class:"SharePanel-headerRight",inner:[{"aria-label":(0,l.getLang)("mobile_search"),class:"SharePanel-headerRight__search",role:"button",inner:(0,c.Icon24Search)(),onclick:"cur.share.toggleConversationsSearch(true)"},e.supportsExternalShare?{"aria-label":(0,l.getLang)("mobile_share_external"),class:"SharePanel-headerRight__externalShare",role:"button",inner:"iOS"===e.platform?(0,a.default)((0,d.getShareExternalIos24Icon)()):(0,a.default)((0,u.getShareExternalAndroid24Icon)()),onclick:"cur.share.externalShare()"}:null]}]}}function h(e){var t=e.buttons,n=e.options,o="boolean"!=typeof e.active||e.active;return{class:"ActionsPanel SharePanel "+(o?"SharePanel--active":""),"data-name":"ActionsPanel","aria-hidden":!o,style:!(n.can_to_own||n.can_to_club||n.can_bookmark)?"display: none;":"",inner:t.map((e=>{if(e)return function(e){var t=e.href?"a":"div",n=e.onclick,o={tag:t,role:"button",tabindex:-1,href:e.href,onclick:n,class:"ActionsPanel-button ActionsPanel-button--"+e.target,inner:[{class:"ActionsPanel-button__icon",inner:e.icon},{class:"ActionsPanel-button__label",inner:e.label}]};"boolean"==typeof e["aria-pressed"]&&(o["aria-pressed"]=e["aria-pressed"]+"");return o}(e)}))}}var w=function(e){var{can_bookmark:t,is_bookmarked:n,object:o,list:d,from:u,post_from:w,supportsExternalShare:y,isVKApp:k,targetOwnOnClick:b}=e,S=(0,l.makeUrl)("/wall",{act:"add",share_box:1,is_vk_app:k,object:o,list:d,from:u,post_from:w}),C="cur.share.go('"+S+"')";return"function"==typeof b?C="cur.share.toOwnWall()":Array.isArray(b)?C=b:"string"==typeof b&&(C=[b,"event",S]),{inner:[{inner:[g({platform:e.platform,supportsExternalShare:y}),{class:"SharePanel ShareHeaderSearch ShareHeaderConversationsSearchPanel","aria-hidden":"true","data-name":"ShareHeaderConversationsSearchPanel",role:"search",inner:(0,r.default)({disabled:!0,autocomplete:!1,onblur:'cur.share.clearSearch(event, "peers", true)',prefix:{text:{role:"button",inner:(0,c.Icon16SearchOutline)()}},postfix:{text:{class:"ShareHeaderSearch__clear",role:"button",onclick:'cur.share.clearSearch(event, "peers")',inner:(0,c.Icon24CancelOutline)()}},class:"ShareHeaderConversationsSearchPanel__input",id:"ShareHeaderConversationsSearchPanel__input",placeholder:(0,l.getLang)("mobile_search"),spellcheck:!1})},{class:"SharePanel SharePanel-header ShareHeaderGroupsPanel","aria-hidden":"true","data-name":"ShareHeaderGroupsPanel",inner:[{"aria-label":(0,l.getLang)("mobile_back"),onclick:"cur.share.toggleGroupsPanel(false)",role:"button",class:"SharePanel-header__close",inner:(0,c.Icon24Back)()},{class:"SharePanel-headerText",inner:[{class:"SharePanel-headerText__label",inner:(0,l.getLang)("mobile_like_publish_head_title")}]},{class:"SharePanel-headerRight",inner:[{class:"SharePanel-headerRight__search",role:"button",inner:(0,c.Icon24Search)(),onclick:'cur.share.setActivePanel(this, "ShareHeaderGroupsSearchPanel", true)'}]}]},{class:"SharePanel ShareHeaderSearch ShareHeaderGroupsSearchPanel","aria-hidden":"true","data-name":"ShareHeaderGroupsSearchPanel",role:"search",inner:(0,r.default)({disabled:!0,autocomplete:!1,onblur:'cur.share.clearSearch(event, "group", true)',prefix:{text:{"aria-label":(0,l.getLang)("mobile_search"),role:"button",inner:(0,c.Icon16SearchOutline)()}},postfix:{text:{class:"ShareHeaderSearch__clear",onclick:'cur.share.clearSearch(event, "group")',inner:(0,c.Icon24CancelOutline)()}},class:"ShareHeaderGroupsSearchPanel__input",id:"ShareHeaderGroupsSearchPanel__input",placeholder:(0,l.getLang)("mobile_search"),spellcheck:!1})}],class:"SharePanelRoot ShareHeader",tag:"header"},{id:"Share__input",style:"display: none;",tag:"input"},{inner:[{class:"ShareConversations SharePanel SharePanel--active filter_peer_wrap","data-name":"ShareConversations","aria-hidden":"false",role:"group",id:"ShareConversations"},{class:"ShareGroups SharePanel","data-name":"ShareGroups","aria-hidden":"true",role:"group",id:"ShareGroups"}],class:"SharePanelRoot ShareLists",tag:"section"},{inner:[h({active:!0,options:e,buttons:[e.can_to_story?{target:"story",label:(0,l.getLang)("mobile_share_target_story"),icon:(0,c.Icon28StoryOutline)(),onclick:e.onToStoryClick}:null,e.can_to_own?{target:"own",label:(0,l.getLang)("mobile_share_target_own"),onclick:C,icon:(0,a.default)((0,m.getArrowUturnRightOutline28Icon)())}:null,e.can_to_club?{target:"group",label:(0,l.getLang)("mobile_share_target_group"),icon:(0,c.Icon28UsersOutline)()}:null,t?{target:"bookmark","aria-pressed":n,label:n?(0,l.getLang)("mobile_share_target_bookmark_active"):(0,l.getLang)("mobile_share_target_bookmark"),icon:(0,a.default)(e.is_bookmarked?(0,f.getFavorite28Icon)():(0,v.getFavoriteOutline28Icon)())}:null,e.can_to_copy_url?{target:"copy_url",label:(0,l.getLang)("mobile_share_target_copy_url"),icon:(0,c.Icon28CopyOutline)(),onclick:e.onToCopyUrlClick}:null]}),{class:"SharePanel MessagePanel","aria-hidden":"true","data-name":"MessagePanel",inner:[(0,r.default)({tabindex:-1,autocomplete:!1,class:"MessagePanel__input",on_click:["cur.share.expandMessage"],placeholder:(0,l.getLang)("mobile_share_message_placeholder"),spellcheck:!1,readonly:!0,disabled:!0}),(0,s.default)({stretch:!0,size:"large",inner:(0,l.getLang)("mobile_share_message_single"),on_click:"cur.share.sendMessage(event)",use_native_onclick:!0})]},{class:"SharePanel ExpandedMessagePanel","aria-hidden":"true","data-name":"ExpandedMessagePanel",inner:[{class:"ExpandedMessagePanel__textareaWrap",inner:[(0,i.default)({placeholder:(0,l.getLang)("mobile_share_message_placeholder"),rows:1}),{class:"ExpandedMessagePanelSend",inner:(0,a.default)((0,_.getSendActive24Icon)())}]}]},{class:"SharePanel ProcessingPanel","aria-hidden":"true","data-name":"ProcessingPanel",inner:[{class:"ProcessingPanel__icon ProcessingPanel__icon--loading",inner:(0,a.default)((0,p.getLoading40Icon)())},{class:"ProcessingPanel__label",inner:(0,l.getLang)("mobile_share_state_progress")}]}],class:"SharePanelRoot ShareBottom",tag:"footer"}],class:"Share",role:"dialog","aria-label":(0,l.getLang)("mobile_like_publish_head_title"),hidden:"false",tabindex:"-1",tag:"div"}},y=n(9223),k=n(89414),b=n(43365),S=n(73706),C=n(75105);function E(e){return/^((?:([a-z]+)_)?([a-z_]+))(-?\d+)?(?:_(\d+))?$/.test(e)}var T=n(71437),I=n(15247),M=n(77123),P=n(11911),L=n(12449),B=n(11740),A=n(86380),O=n(7418),x=n(49464),R=n(4726),N=n(24661),D="/hints?act=a_json_friends&mobile=1&from=imwrite&case=Nom&qs=1",F="ShareConversations",U="ShareGroups",H=D+F,j=0,$=!1,V={bookmarks:{}};function W(e){var t=window.cur.module;return e.startsWith("photo")&&N.$isOpen.getState()&&(t="photo_viewer"),t}function K(e){z(e)}function q(e){var t;nav.go(e),null==(t=cur.share)||t.destroy({isNavigation:!0})}function G(){var e,t;null==(e=cur.share)||null==(t=e.options)||null==t.onToGroupClick||t.onToGroupClick(),q(...arguments)}function z(e){if(cur.share){var{header:t}=cur.share._els,{scrollTop:n}=e;t.classList.toggle("ShareHeader--scrolled",n>=10)}}function Q(e,t,n){if(!cur.share||cur.share.blocked)return!1;if(X(!0),(0,o.cancelEvent)(n),(0,o.hasClass)("inline_item_selected",t))return cur.shareSearch.toggleAttach(e,!1),function(e,t){for(var n=0;n<cur.share.selected.length;n++)if(cur.share.selected[n]===e){cur.share.selected.splice(n,1);break}return te(!1),oe(),!1}(e);cur.shareSearch.toggleAttach(e,!0);for(var a=!1,i=0;i<cur.share.selected.length;i++)if(cur.share.selected[i]===e){a=!0;break}return a||cur.share.selected.push(e),X(!1),te(!1),oe(),!1}function Y(e,t,n){if(cur.share&&!cur.share.blocked){e=e.closest(".SharePanelRoot");var a,i=(0,T.$$)(".SharePanel",e);t&&(a=(0,T.$)("."+t,e)),i.forEach((e=>{var t=e===a;e.setAttribute("aria-hidden",!t),e.classList.toggle("SharePanel--active",t),t?e.removeAttribute("tabindex"):e.setAttribute("tabindex",-1),(0,T.$$)("input, ul",e).forEach((e=>{e.setAttribute("aria-hidden",!t);var n=e.closest(".TextInput");t?(null==n||n.classList.remove("TextInput_disabled"),e.removeAttribute("disabled"),e.setAttribute("tabindex",0)):(null==n||n.classList.add("TextInput_disabled"),e.setAttribute("disabled",!0),e.setAttribute("tabindex",-1))}))}));var r=(0,T.$)("input",a);r&&n&&r.focus(),(0,o.setStyle)(e,{height:a?a.clientHeight:0})}}function X(e){var t=(0,T.$)(".ShareModal");t&&t.classList.toggle("ShareModal--disableAnimations",!e)}function J(e){if(cur.share){var{header:t,content:n,bottom:o}=cur.share._els;n.classList.add("ShareLists--transition"),X(!0),Y(t,e?"ShareHeaderGroupsPanel":"ShareHeaderConversationsPanel"),Y(n,e?"ShareGroups":"ShareConversations"),Y(o,e?"":"ActionsPanel"),setTimeout((()=>{n.classList.remove("ShareLists--transition")}),300),(0,T.$)(".SharePanel--active ul",n).focus(),oe(),z(e?(0,T.$)("#ShareGroups .ShareList__container"):(0,T.$)("#ShareConversations .ShareList__container"))}}function Z(e){if(cur.share){var{header:t,bottom:n}=cur.share._els,a=ne();$=e,X(!1),Y(n,e?"":a),e&&Y(t,"ShareHeaderConversationsSearchPanel",!0),!P.isIOS&&window.innerWidth<L.DESKTOP_WIDTH&&oe(e),setTimeout((()=>{browser.ios&&(0,o.scrollTop)(document.activeElement)}),500)}}function ee(){if(cur.share){var{content:e,bottom:t,messageTextarea:n}=cur.share._els;Y(t,"ExpandedMessagePanel"),e.classList.add("ShareLists--transition"),P.isIOS||oe(!1),n.focus({preventScroll:!0})}}function te(e){if(void 0===e&&(e=!0),cur.share){var{selected:t,_els:n}=cur.share;(0,o.ge)(F)&&(!function(){if(!cur.share)return;var{_cache:e}=cur.share.cache,t=(0,T.$)(".ShareHeaderConversationsPanel"),n=(0,T.$)(".ShareHeaderConversationsPanel .SharePanel-headerText__receivers",t),o=cur.share.selected,a=o.length;t.classList.toggle("ShareHeaderConversationsPanel--hasReceivers",a>0);var i="";if(1===a){i=(0,l.getLang)("mobile_share_box_to_single");var r=e[o[0]][0];i=i.replace("{name}",r)}else if(2===a){i=(0,l.getLang)("mobile_share_box_to_couple");var s=e[o[0]][6]||e[o[0]][0],c=e[o[1]][6]||e[o[1]][0];i=i.replace("{name1}",s).replace("{name2}",c)}else if(a>2){i=(0,l.getLang)("mobile_share_box_to_many");var d=e[o[0]][6]||e[o[0]][0];i=i.replace("{name}",d).replace("{count}",a-1)}n.innerHTML=i}(),ae());var a=ne();Y(n.bottom,a,e),function(e){var{messagePanel:t}=cur.share._els,n=(0,T.$)(".Btn",t);n.innerHTML=e?(0,l.getLang)("mobile_share_message_many"):(0,l.getLang)("mobile_share_message_single")}(t.length>1)}}function ne(){if(cur.share){var{selected:e,content:t}=cur.share,n=(0,T.$)(".SharePanel--active",t).getAttribute("data-name");return"ShareHeaderGroupsSearchPanel"===n||"ShareHeaderGroupsPanel"===n?"":document.activeElement&&document.activeElement.closest(".ExpandedMessagePanel")?"ExpandedMessagePanel":e.length>0?"MessagePanel":"ActionsPanel"}}function oe(e){if(cur.share&&cur.share._els){var{header:t,bottom:n,content:a,groupsList:i}=cur.share._els;if(t&&n&&a){var r=400;(e=$||e)&&(r+=cur.share.lastBottomHeight-(0,o.getH)(n)),n.clientHeight&&(cur.share.lastBottomHeight=n.clientHeight);var s=[t,n].reduce(((e,t)=>{var n=(0,T.$)(".SharePanel--active",t);return n&&(e+=n.clientHeight,(0,o.setStyle)(t,{height:n.clientHeight})),e}),0),l=Math.min(r,(0,o.getCh)()-s),c=s+l!==j;c||(X(!1),a.classList.remove("ShareLists--transition")),(0,o.setStyle)(i,{bottom:-n.clientHeight}),(0,o.setStyle)(a,{height:l}),c||X(!0),j=s+l}}}function ae(){cur.share&&(0,o.each)((0,o.geByClass)("inline_item",(0,T.$)("ShareConversations__container")),((e,t)=>{if(cur.share){var n=(0,o.intval)((t.id||"").substr(4)),a=-1!==cur.share.selected.indexOf(n);(0,o.toggleClass)("inline_item_selected",t,a),t.setAttribute("aria-selected",a);var i=(0,T.$)('input[type="checkbox"]',t);i&&(i.checked=a)}}))}function ie(e){var{bookmarkButton:t}=cur.share._els;if(t){var n=(0,T.$)(".ActionsPanel-button__icon",t),o=(0,T.$)(".ActionsPanel-button__label",t);t.setAttribute("aria-pressed",e),e?(n.innerHTML=Wd.html((0,c.Icon28Favorite)()),o.innerHTML=(0,l.getLang)("mobile_share_target_bookmark_active")):(n.innerHTML=Wd.html((0,c.Icon28FavoriteOutline)()),o.innerHTML=(0,l.getLang)("mobile_share_target_bookmark")),window.thover.clear()}}function re(e){var t,n;null==(t=cur.share)||null==(n=t.options)||null==n.onToSendImClick||n.onToSendImClick();var{bottom:i,processingPanel:r}=cur.share._els,{mail_hash:s,object:c,list:d,appId:u,shouldInteractWithGlobalStories:_}=this,p={_ajax:1,from:"share_box",hash:s,list:d,message:(0,T.$)(".ExpandedMessagePanel__textareaWrap textarea").value,to:cur.share.selected.join(","),app_id:u,ref:W(c)};E(cur.share.options.object)?p.media=c:p.link=c,X(!0),e&&(0,o.cancelEvent)(e),Y(i,"ProcessingPanel"),cur.share.blocked=!0,(c.startsWith("story")||c.startsWith("narrative"))&&!1!==_&&window.Stories.sendAnalyticsEvent("share_to_message"),setTimeout((()=>{oe()})),setTimeout((()=>{oe()}),350),window.ajax.post("/mail?act=send",p,{onDone:e=>{X(!0);var t=(0,T.$)(".ProcessingPanel__icon",r),n=(0,T.$)(".ProcessingPanel__label",r);t.classList.remove("ProcessingPanel__icon--loading");var o=e.error;t.innerHTML=Wd.html(o?(0,a.default)((0,O.getErrorCircle40Icon)()):(0,a.default)((0,A.getDoneCircle40Icon)())),n.innerText=o?(0,l.getLang)("mobile_share_state_error"):(0,l.getLang)("mobile_share_state_success"),setTimeout((()=>{cur.app&&(o&&cur.app.hasOwnProperty("vkMiniAppShareFail")?cur.app.vkMiniAppShareFail():!o&&window.isFunction(cur.app.vkMiniAppShareSuccess)&&cur.app.vkMiniAppShareSuccess(0)),cur.share&&cur.share.destroy({isFail:o})}),1e3)}})}function se(e,t,n){void 0===n&&(n=!1),(0,o.preventEvent)(e);var a,i,r,{header:s}=cur.share._els;if("group"===t?(a=(0,o.ge)("ShareHeaderGroupsSearchPanel__input"),i="ShareHeaderGroupsPanel",r=cur.shareGroupSearch):"peers"===t&&(a=(0,o.ge)("ShareHeaderConversationsSearchPanel__input"),i="ShareHeaderConversationsPanel",r=cur.shareSearch),X(!1),a.value){if(n)return void X(!0);r.clear()}else"peers"===t?(Y(s,i),Z(!1)):(Y(s,i),X(!0))}function le(){var e,t=cur.share.options.object,n="unknown";if(E(cur.share.options.object)){e=/^([a-z_]+)(-?\d+)_(\d+)$/.exec(cur.share.options.object),n=e[1];var a=e[2],i=e[3];"app"===n&&"0"===i&&(t="app"+a),cur.share.options.list&&(t+="?list="+cur.share.options.list),t=t.replace("wall_reply","wall")}else cur.share.options.isVKApp&&(n="link");t=cur.share.options.external_url||t;var r=navigator.share({url:t});if(!r)return(0,o.statlogsValueEvent)("mvk_share_external",n);r.then((()=>{cur.share&&(0,o.statlogsValueEvent)("mvk_share_external",n)}))}function ce(e,t,n){var a=e.split("_"),i=31,r=5,s=6,l=[i,r,3,s].includes((0,o.toInt)(t.bookmark_type)),c=[2,s].includes(t.bookmark_type);if(window.ajax.post("/bookmarks.php",{_ajax:1,from:"share_box",wide:c?1:0,star:l?1:0,act:t.is_bookmarked?"bookmark_remove":"bookmark_add",item_type:t.bookmark_type,item_oid:a[0],item_id:a[1],hash:t.bookmark_hash,link_url:t.link_url,link_title:t.link_title,link_img:t.link_img,ref:W(e)},{onDone:(e,t,n,a,r)=>{var s=(0,T.$)("."+e),l=(0,o.ceFromString)(t);s&&(0,o.replace)(l,s.parentNode),n&&n.item_type===i&&r&&(0,x.sendNarrativeAnalytic)(x.NarrativeAnalyticEventType.addToBookmarks,{ownerId:n.item_oid,id:n.item_id},x.NarrativeAnalyticNavScreen.storyViewer)}}),t.bookmark_type===r&&window.Article.toggleButton(e,!t.is_bookmarked),t.bookmark_type===i&&!1!==t.shouldInteractWithGlobalStories){var d=(0,T.$)(".StoryMenu__button");window.Stories.toggleBookmark(d,!0)}t.is_bookmarked=!t.is_bookmarked,V.bookmarks[e]=t.is_bookmarked,n()}function de(){oe(!1)}var ue=function(e,t,n){var{can_to_own:r=!0,can_to_club:s=!0,can_to_story:c,onToStoryClick:d,can_to_copy_url:u,onToCopyUrlClick:_,can_bookmark:p,is_bookmarked:m,from:f,post_from:v,list:g,targetOwnOnClick:h,appId:L,isVKApp:A}=t;cur.share&&cur.share.destroy();var O=!E(t.object);if(!O||A){O&&!/^(https|http)?:\/\//i.test(t.object)&&(t.object="https://"+e,e=t.object),k.default&&k.default.close(),t.withoutScrollView||(0,S.preventDocumentScroll)(),O||(m=void 0!==V.bookmarks[e]?V.bookmarks[e]:m,t.is_bookmarked=m),(0,o.cancelEvent)(n);var x=!!navigator.share,N=browser.ios?"iOS":"Android",j=(0,y.default)({on_overlay_click:"cur.share && cur.share.destroy()",class:"ShareModal",attached:!0,body:w({targetOwnOnClick:h||null,can_to_own:r,can_to_club:s,can_to_story:c,onToStoryClick:d,can_to_copy_url:u,onToCopyUrlClick:_,supportsExternalShare:x,platform:N,can_bookmark:p,is_bookmarked:m,list:g,from:f,post_from:v,object:t.object,isVKApp:t.isVKApp})}),$=t.withoutHash?null:"share";y.default.open(Wd.elem(j),!0,$,{swipeDown:!0,onClose:()=>{cur.share&&cur.share.destroy({closeModal:!1})}});var z=(0,T.$)(".ShareModal"),ne=(0,T.$)(".ShareHeader"),ue=(0,T.$)(".ShareLists"),_e=(0,T.$)(".ShareBottom"),pe=(0,T.$)(".ActionsPanel-button--bookmark"),me=(0,T.$)(".ActionsPanel-button--group");setTimeout((()=>{!function(e){void 0===e&&(e={});cur.shareSearch=new window.QuickSearch;var t=e.appId?D+"&app_id="+e.appId:D,n=e.appId?D+"&app_id="+e.appId+F:H;cur.shareSearch.init({action:t,field:"ShareHeaderConversationsSearchPanel__input",container:F,top_len:20,onFocusChanged:function(e){e?M.onOpen("top"):M.onClose(),oe(e),setTimeout((()=>{oe(e)}),200)},tpl:function(e,t){return'<ul aria-multiselectable="true" aria-hidden="false" class="ScrollView ShareConversations__container ShareList__container" onscroll="cur.share.onScroll(this)">'+e+"</ul>"},item_tpl:function(e,t){if(cur.share){var{_cache:n}=cur.share.cache,o=n[this.id][0],i=!(!n[this.id][8]||!n[this.id][8].is_casper)?'<span class="ShareConversationsCasperTitle">\n             <span class="ShareConversationsCasperTitle__text">'+this.highlight(o)+'</span>\n             <span class="ShareConversationsCasperTitle__icon">'+Wd.html((0,a.default)((0,B.getCasper16Icon)()))+"</span>\n           </span>":this.highlight(o),r=-1!==cur.share.selected.indexOf(+this.id)?"inline_item_selected":"",s=Wd.html((0,R.Avatar)({mode:(0,l.getAvatarMode)({id:this.id,name:o}),backgroundTheme:this.id,text:o,textLength:(0,l.getAvatarTextLength)(this.id),src:t,size:44,mix:"ii_img",attrs:{"aria-hidden":"true"}}));return'\n        <label aria-label="'+o+'" tabindex="0" role="checkbox" id="peer'+this.id+'" onclick="cur.share.select('+this.id+', this)" class="inline_item active '+r+'">\n          <input type="checkbox" style="display: none;">\n            '+s+'\n            <div class="ii_body">\n              <div class="ii_owner">'+i+"</div>\n            </div>\n          </input>\n        </label>\n      "}},null_tpl:function(e){var t=(0,l.getLang)("mobile_friends_search_not_found").replace("%s",(0,o.htsc)(e));return e||(t=(0,l.getLang)("mobile_share_list_no_friends")),'<div class="service_msg_box"><div class="service_msg service_msg_null">'+t+"</div></div>"}}),cur.share.cache=window.QuickSearchCache[n],ae()}({appId:L})}),250),(0,o.addEvent)(pe,"click",ce.bind(this,e,t,(()=>{ie(t.is_bookmarked)})),{passive:!0}),(0,o.addEvent)(me,"click",(()=>{J(!0)}),{passive:!0});var fe=(0,T.$)(".ExpandedMessagePanel textarea"),ve=(0,T.$)(".MessagePanel__input input");fe.value=t.message||"",ve.value=t.message||"",(0,i.initAutogrow)(fe),(0,o.addEvent)(fe,"input blur focus",(e=>{var{content:t}=cur.share._els;ve.value=fe.value.replace(/\n/gi," "),X(!1),"input"===e.type&&oe(!1),"focus"===e.type&&(t.classList.remove("ShareLists--transition"),z.classList.add("ModalMenu--blocked"),z.classList.add("ModalMenu--focused"),M.onOpen("bottom"),setTimeout((()=>{te(!0),X(!1),oe()}),100)),"blur"===e.type&&(z.classList.remove("ModalMenu--blocked"),e.preventDefault(),e.stopPropagation(),M.onClose(),X(!1),z.classList.remove("ModalMenu--focused"),P.isIOS||oe(!1),setTimeout((()=>{te(!1),X(!1),oe()}),100))})),(0,o.addEvent)((0,T.$)(".ExpandedMessagePanelSend"),"click touchend",(e=>{e.stopPropagation(),e.preventDefault(),document.activeElement&&document.activeElement.blur(),cur.share.sendMessage()}),{capture:!0}),(0,o.addEvent)(fe,"touchmove",(e=>{(0,o.stopEvent)(e)}),{capture:!0}),M.onCloseCallback(de),(0,o.addEvent)(fe,"keydown",(e=>{13===e.keyCode&&(e.ctrlKey||e.metaKey&&browser.mac)&&cur.share.sendMessage(e)}));var ge={act:"publish_box",object:"null"};L&&(ge.app_id=L),t.object?(ge.object=t.object,t.list&&(ge.list=t.list)):O&&(ge.link=e,delete ge.object);var he=(0,I.makeUrl)("/like",ge);cur.share={open:!0,onClose:(0,C.default)(),go:q,shareToGroup:G,options:t,externalShare:le,actionBox:he,blocked:!1,updateHeights:oe,_els:{actionsPanel:(0,T.$)(".ActionsPanel"),messagePanel:(0,T.$)(".MessagePanel"),processingPanel:(0,T.$)(".ProcessingPanel"),groupsList:(0,o.ge)("ShareGroups"),conversationsList:(0,o.ge)("ShareConversations"),bookmarkButton:pe,messageTextarea:fe,header:ne,content:ue,bottom:_e},selected:[],expandMessage:ee,toggleGroupsPanel:J,toggleConversationsSearch:Z,select:Q,clearSearch:se,setActivePanel:Y,onScroll:K,sendMessage:re.bind(t),lastBottomHeight:_e.clientHeight,destroy:function(e){void 0===e&&(e={}),e=(0,o.extend)({closeModal:!0,isFail:!0,isNavigation:!1},e),M.offCloseCallback(de);var t=(0,T.$)(".ShareModal");e.isFail&&cur.app&&cur.app.vkMiniAppShareFail&&cur.app.vkMiniAppShareFail(),t&&e.closeModal&&y.default.close(t),cur.share&&(cur.share.onClose(e.isNavigation),cur.share.open=!1),cur.share.options.withoutScrollView||(0,S.restoreDocumentScroll)(),delete cur.share,delete cur.shareSearch,delete cur.shareGroupSearch}},h&&"function"==typeof h&&(cur.share.toOwnWall=h),setTimeout((()=>{!function(){cur.shareGroupSearch=new window.QuickSearch;var e=Wd.html((0,b.default)({icon:"chevron_right"}));if(!cur.share||!cur.share.options.can_to_club)return;cur.shareGroupSearch.init({load_once:!0,field:"ShareHeaderGroupsSearchPanel__input",container:U,action:cur.share.actionBox,onFocusChanged:function(e){e?M.onOpen("top"):M.onClose(),setTimeout((()=>{oe(!1)}),100)},tpl:function(e,t){return'<ul aria-hidden="true"  class="ScrollView ShareGroups__container ShareList__container" onscroll="cur.share.onScroll(this)">'+e+"</ul>"},item_tpl:function(t,n){if(!cur.share)return"";var{_cache:a}=function(){if(!cur.share)return{};var e=cur.share.actionBox+U;return window.QuickSearchCache[e]}(),i=a[this.id][0],{object:r,list:s,from:c,post_from:d}=cur.share.options,u={act:"add",share_box:"1",ref:W(r)};r&&(u=(0,o.extend)(u,{object:r,list:s,from:c,post_from:d})),cur.share.options.isVKApp&&(u.is_vk_app=+cur.share.options.isVKApp);var _=(0,I.makeUrl)("/wall"+this.id,u),p=Wd.html((0,R.Avatar)({mode:(0,l.getAvatarMode)({id:this.id,name:i}),backgroundTheme:this.id,text:i,textLength:(0,l.getAvatarTextLength)(this.id),src:n,size:44,mix:"ii_img",attrs:{"aria-hidden":"true"}}));return'\n        <li aria-label="'+i+'" tabindex="0" role="link" id="group'+this.id+'" onclick="cur.share.shareToGroup(\''+_+"', "+cur.share.options.isVKApp+')" class="inline_item " xmlns="http://www.w3.org/1999/html">\n          '+p+'\n          <div class="ii_body">\n            <div class="ii_owner">'+this.highlight(i)+'</div>\n            <div class="ii_go">\n               '+e+"\n            </div>\n          </div>\n        </li>\n      "},null_tpl:function(e){var t=(0,l.getLang)("mobile_groups_no_groups_found");return e||(t=(0,l.getLang)("mobile_share_list_no_groups")),'<div class="service_msg_box"><div class="service_msg service_msg_null">'+t+"</div></div>"}})}()}),300),ie(m),oe(),ne.closest(".Share").focus(),window.onBodyResize((()=>{document.activeElement&&"INPUT"===document.activeElement.tagName?oe(!0):oe(!1),setTimeout((()=>{X(!0)}),150)})),window.onBodyResize(!0)}else console.warn("Can't share link outside miniapp")};window.Share=ue,(0,o.extend)(window.Share,{setBookmarkState:function(e,t){V.bookmarks[e]=t}})},8677:function(){var e="friendsStat.events",t=null;function n(){clearTimeout(t);var n=lsGet(e)||[];if(n.length){lsSet(e);var o,a={act:"stats"};a=extend(a,(o={},each(n,(function(){o[this.type]?o[this.type].push(this.data):o[this.type]=[this.data]})),o)),ajax.post("/friends",a)}}window.FriendsStats={log:function(o,a,i){var r=function(e,t){var n=[],o=(new Date).getTime();switch(e){case FriendsStats.EVENTS.EVENT_VIEW_USER:n=[t.uid,o,t.pos,t.ref,t.blockType,t.trackCode];break;case FriendsStats.EVENTS.EVENT_HIDE_BLOCK:n=[o,t.ref,t.trackCode];break;case FriendsStats.EVENTS.EVENT_OPEN_USER:n=[t.uid,o,t.ref,t.trackCode]}return n.join("|")}(o,a);if(!r)return;var s=lsGet(e)||[];s.push({type:o,data:r}),lsSet(e,s),clearTimeout(t),i?n():t=setTimeout(n,1e4)},EVENTS:{EVENT_VIEW_USER:"show_user_rec",EVENT_HIDE_BLOCK:"hide_block",EVENT_OPEN_USER:"open_user"}},t=setTimeout(n,1e4)},43253:function(){var e={obj:null,highlight:!1,start:function(t){t.touches&&1==t.touches.length&&(e.clear(),e.end(t),e.obj=this||null,e.obj&&(e.highlight=!0,addClass("hover",e.obj),addClass("_thover",e.obj)))},cancel:function(t){e.obj&&(e.highlight=!1,e.end(t))},end:function(){e.obj&&(removeClass("hover",e.obj),e.highlight&&(e.clear(),addClass("active",e.obj)),e.obj=null,e.highlight=!1)},clear:function(){removeClass("active",geByClass1("active","vk_wrap")),removeClass("active",$(".Popup .active._thover"))}};window.thover=e},9149:function(){var e={tt:!1,handlers:[],show:function(){e.shown||(e.tt=Array.prototype.slice.call(arguments))},hide:function(){e.tt&&(e.tt=!1)},addHandler:function(t){t&&e.handlers.push(t)},removeHandler:function(t){t?each(e.handlers,(function(n){if(t===this)return e.handlers.splice(n,1),!1})):e.handlers=[]},onClose:function(){each(e.handlers,(function(){this()}))},clear:function(){e.tt&&(e.hide(),e.onClose(),e.removeHandler())},closeByTap:function(t){if(!e.tt||!t.target)return!1;var n=t.target;do{for(var o=0;o<e.tt.length;o++)if(n===e.tt[o])return!1}while(n=n.parentNode);return e.hide(),e.onClose(),!0}};window.tooltip=e},37668:function(e,t,n){"use strict";n.d(t,{tmrTrackPage:function(){return l},tmrTrackCustomGoal:function(){return c},tmrTrackMiniAppOpen:function(){return m},tmrTrackMiniAppClose:function(){return f},tmrTrackMiniAppCustom:function(){return v}});var o=n(85863),a="2579437",i="miniAppEvent";function r(){return window.vk&&window.vk.id?window.vk.id:0}function s(e){window.vk&&window.vk.zero||window.__dev||(window._tmr=window._tmr||[],window._tmr.push(e))}function l(e,t){s({id:a,url:e,referrer:t,type:"pageView",start:(new Date).getTime(),pid:r(),userid:r()})}function c(e,t){void 0===t&&(t={}),s({id:a,type:"reachGoal",goal:e,userid:r(),params:t})}function d(e){var t=r();r&&s({id:a,type:i,params:(0,o.default)({},e,{platformUserId:String(t)})})}var u="open",_="close",p="custom";function m(e,t){d({eventType:u,miniAppId:e,queryParams:t})}function f(e){d({eventType:_,miniAppId:e})}function v(e,t){d((0,o.default)({eventType:p,miniAppId:e},t))}},40962:function(e,t,n){"use strict";n.d(t,{updateCounters:function(){return l}});var o=n(19331);var a=n(40906),i=n(79957);function r(e,t){var n=location.protocol,r="^https?:\\/\\/(?:(?:www|m)\\.)?(?:\\w+\\.)*"+(0,a.escapeRE)("vk.com"),s=window._tns&&(window._tns.tnsPixelSocdem||"83"),l=t.replace(/\*/g,"%2a").split("#")[0],c=window._tns&&window._tns.tnsPixelType;if((0,a.vkImage)().src=n+"//www.tns-counter.ru/V13a**clid:"+s+"*"+l+"*vk_com/ru/UTF-8/tmsec=vksite_total/"+Math.round(1e9*Math.random()),(0,o.partConfigEnabled)("tns_track_sections")){var d="content",u="photo",_="music",p="video",m="clips",f="ecomm",v="games",g="docs",h=[...[[/w=story-?\d+_\d+/,d,"story"],[/z=video-?\d+_\d+/,p,"videoview"],[/z=(photo(_tag)?-?\d+_\d+|albums?-?\d+)/,u,"photoview"],[/z=audio_playlist-?\d+_\d+/,_,"playlistview"],[/z=podcast-?\d+_\d+/,_,"podcastview"],[/z=clip-?\d+_\d+/,m,"clipsview"],[/w=app\d+/,v,"gamesappview"],[/w=product-?\d+_\d+/,f,"product"]].map((e=>{var[t,n,o]=e;return[new RegExp(r+"\\b.*?\\b"+t.source),n,o]})),...[[/feed\?section=likes(\/|\&|$)/,d,"likes"],[/feed(\/|\?|$)/,d,"feed"],[/friends(\/|\?|$)/,d,"friends"],[/groups(\/|\?|$)/,d,"groups"],[/(id|public|club)\d+(\/|\?|$)/,d,"idpublicclub"],[/@[\w-\.]+(\/|\?|$)/,d,"longread"],[/bookmarks(\/|\?|$)/,d,"bookmarks"],[/stickers(\/|\?|$)/,d,"stickers"],[/im(\/|\?|$)/,"messenger","messenger"],[/(photos|tag\d+|(albums|photos)-?\d+|(album|photo)-?\d+_\d+)(\/|\?|$)/,u,"photo"],[/(audio(s-?\d+)?|music)(\/|\?|$)/,_,"music"],[/podcasts(-?\d+)(\/|\?|$)/,"podcasts","podcasts"],[/(videos-?\d+|video(-?\d+_\d+)?)(\/|\?|$)/,p,"video"],[/(clips(-?\d+)?|clip-?\d+_\d+)(\/|\?|$)/,m,"clips"],[/services(\/|\?|$)/,"services","services"],[/taxi(\/|\?|$)/,"taxi","taxi"],[/eda(\/|\?|$)/,"eda","eda"],[/worki(\/|\?|$)/,"worki","worki"],[/market(-?\d+)?(\/|\?|$)/,f,"ecomm"],[/apps(\/|\?|$)/,v,"gamesapp"],[/app\d+(_-?\d+)(\/|\?|$)/,v,"gamesapppage"],[/docs(\/|\?|$)/,g,"docs"],[/doc-?\d+_\d+(\/|\?|$)/,g,"docdoc"]].map((e=>{var[t,n,o]=e;return[new RegExp(r+"\\/"+t.source),n,o]}))],w=window.cur&&window.cur.module||"other",y="other",k="other";h.some((t=>{if(t[0].test(e))return y=t[1],k=t[2],!0})),(0,i.statlogsValueEvent)("counters_check_tns",y,k,w)}"unauth"===c?(0,a.vkImage)().src=n+"//www.tns-counter.ru/V13a****vk_ad/ru/UTF-8/tmsec=vkad_cid1015708-posid1184674/"+Math.round(1e9*Math.random()):"has_rough"===c?(0,a.vkImage)().src=n+"//www.tns-counter.ru/V13a****vk_ad/ru/UTF-8/tmsec=vkad_cid1015708-posid1184675/"+Math.round(1e9*Math.random()):"not_has_rough"===c&&((0,a.vkImage)().src=n+"//www.tns-counter.ru/V13a****vk_ad/ru/UTF-8/tmsec=vkad_cid1015708-posid1184677/"+Math.round(1e9*Math.random())),(0,o.partConfigEnabled)("tns_track_hosts")&&((0,a.vkImage)().src="https://"+function(){if(window.cur&&window.cur.module&&(0,a.isString)(window.cur.module)){var e=window.cur.module.trim().toLowerCase().replace(/[^a-z0-9_-]/g,"");if(e)return e}return"unknown"}()+".tns.vk-portal.net?v="+Math.round(1e9*Math.random()))}var s=n(37668);function l(e,t){if(!(window.__dev||window.vk&&(window.vk.zero||window.vk.__dev))){t=t||document.referrer||"";[[/(hash|dl)=\w+/g,"$1="],[/(\/(?:write|mail|im|al_im.php))(?:\?[a-z0-9&=_-]*)?$/,"$1"],[/(\/write)\d*(?:\?[a-zA-Z0-9&=_-]*)?$/,"$1"]].forEach((n=>{var[o,a]=n;e=e.replace(o,a),t=t.replace(o,a)})),(0,s.tmrTrackPage)(e,t);var n=[/\/login\?.*$/];n.some((t=>t.test(e)))||n.some((e=>e.test(t)))||(r(e,t),function(){if((0,o.partConfigEnabled)("geminus_counter")){var e="pzBAVLtpzyiyDVIwmwjmX5a2zSVdA6eUI7mpf0ufDFf.57";if(window.pp_gemius_identifier)window.pp_gemius_hit(e);else{window.pp_gemius_identifier=e;var t=function(e){window[e]=window[e]||function(){var t=window[e+"_pdata"]=window[e+"_pdata"]||[];t[t.length]=arguments}};t("gemius_hit"),t("gemius_event"),t("pp_gemius_hit"),t("pp_gemius_event"),function(e,t){try{var n=e.createElement(t),o=e.getElementsByTagName(t)[0],a="http"+("https:"==location.protocol?"s":""),i="vkgalv";if(window.vk&&window.vk.countryISO)switch(window.vk.countryISO){case"BY":i="vkgaby";break;case"MD":i="vkgamd";break;case"EE":i="vkgaee"}n.setAttribute("async","async"),n.setAttribute("defer","defer"),n.src=a+"://"+i+".hit.gemius.pl/xgemius.js",o.parentNode.insertBefore(n,o)}catch(e){}}(document,"script")}}}(),(0,i.statlogsValueEvent)("counters_check",1))}}},84137:function(e,t,n){"use strict";n.d(t,{wrapAwayIfExternal:function(){return i}});var o=n(61540),a=new RegExp("^(https?:\\/\\/)?([a-z0-9_\\-.]+\\.)?"+o.VK_SITE_REGEX_SOURCE_UNSAFE+"(\\/.*)?");function i(e,t){var n=decodeURIComponent(e);return/^\/[^/]/.test(n)||a.test(n)?e:"/away.php?to="+encodeURIComponent(n)+(t?"&utf=1":"")}},9720:function(e,t,n){"use strict";function o(e,t,n){var o;return function(){var a=arguments,i=()=>{o=null,n||e.apply(this,a)},r=n&&!o;clearTimeout(o),o=setTimeout(i,t),r&&e.apply(this,a)}}n.d(t,{debounce:function(){return o}})},64904:function(e,t,n){"use strict";n.d(t,{cutTextToHighlight:function(){return i}});var o="cutTextToHighlight",a=15;function i(e){var t=null;document.querySelectorAll(e+":not(."+"cutTextToHighlight)").forEach((e=>{if(e.classList.add(o),null===t){var n=getComputedStyle(e).font;t=function(e){var t=document.createElement("canvas").getContext("2d");function n(e){var n=t.measureText(e).width;return Math.ceil(n)}return t.font=e,n}(n)}e.innerHTML=function(e,t,n){void 0===n&&(n="…");var o=e.querySelector(".highlight");if(!o)return e.innerHTML;var i=e.innerHTML.indexOf('<em class="highlight">');if(o.offsetLeft+o.offsetWidth<=e.offsetWidth-a)return e.innerHTML;if(o.offsetWidth<e.offsetWidth-a){for(var r=0,s="",l=i;l>0&&r+o.offsetWidth<=e.offsetWidth;){var c=e.innerHTML.lastIndexOf(" ",l-1);if(-1===c&&(c=0),!((r=t(n+(s=e.innerHTML.substring(c,l)+s).trim()))+o.offsetWidth<=e.offsetWidth-a))break;l=c}i=l}if(i>0)return n+e.innerHTML.substring(i).trim();return e.innerHTML}(e,t)}))}},34017:function(e,t,n){"use strict";n.d(t,{Form:function(){return c},PasswordRepeatRule:function(){return d},AttributesRule:function(){return u}});var o=n(58776),a=n(62641),i=n(20848),r=n(10708),s=n(18782),l=n(22186),c=function(){function e(e,t,n){this.errors={},this.serverErrors={},this.wasFocused={},this.name=e,this.layout=t,this.options=n,this.errors=(0,a.getState)(this.name).errors||{},this.serverErrors=n.serverErrors||{}}return Object.defineProperty(e.prototype,"values",{get:function(){return(0,o.getFormValues)(this.layout)},enumerable:!1,configurable:!0}),e.prototype.getSubmitButton=function(){return this.layout.querySelector("[type=submit]")},e.prototype.onFocus=function(e){this.wasFocused[e]=!0},e.prototype.setServerError=function(e,t){t?this.serverErrors[e]=t:delete this.serverErrors[e]},e.prototype.validate=function(e){var t=this,n=void 0===e?{}:e,a=n.isSubmitting,i=void 0!==a&&a,r=n.fieldName,s=n.isScrollToErrors,c=void 0!==s&&s,d=(0,o.getFormValues)(this.layout),u={},_=r?[r]:Object.keys(d);_.forEach((function(e){t.options.rules.forEach((function(n){var o=n.validator(t,e,i);o&&(u[e]=o)}))})),this.errors=u,_.forEach((function(e){var n=u[e]||t.serverErrors[e]||"";"string"!=typeof n&&(n=n.__raw__);var o=t.getFormFieldElement(e);if(o){var a=(0,l.getFormItem)(o);a&&(n?(0,l.setBottom)(a,n):(0,l.setBottom)(a,""),(0,l.setStatus)(a,n?"error":""))}}));var p=0!==Object.keys(u).length||0!==Object.keys(this.serverErrors).length;return p&&c&&this.scrollToErrors(),!p},e.prototype.scrollToErrors=function(){var e,t=this,n=Object.keys(this.errors);if(n.length){var o=n[0],a=n.reduce((function(e,n){var o=t.getFormFieldElement(n);return o&&o.offsetTop<e.offsetTop?{name:n,offsetTop:o.offsetTop}:e}),{name:o,offsetTop:null!==(e=this.getFormFieldElement(o))&&void 0!==e?e:0}),c=this.getFormFieldElement(a.name);if(c){var d=(0,l.getFormItem)(c),u=(0,r.getHeaderHeight)(),_=s.default.isFixedToTop()?s.default.getHeight()+u:u;(0,i.scrollToEl)(d,_)}}},e.prototype.getFormFieldElement=function(e){return this.layout.querySelector("[name="+e+"]")},e}(),d={validator:function(e,t,n){var o=e.values;return!("pass_repeat"!==t||!e.wasFocused[t]&&!n||o[t]===o.pass)&&(0,i.getLang)("join_pwds_mismatch")}},u={validator:function(e,t,n){var a,r,s,l=e.values[t],c=[e.layout.elements[t]].filter(o.filterFormFieldElements)[0],d=null===(a=e.options.errorMessagesDefault)||void 0===a?void 0:a[t];return!(!e.wasFocused[t]&&!n)&&(c.required&&!l?null!==(r=null==d?void 0:d.required_error_msg)&&void 0!==r?r:(0,i.getLang)("mobile_form_field_err_required"):!c.checkValidity()&&(null!==(s=null==d?void 0:d.validation_regex_error_msg)&&void 0!==s?s:(0,i.getLang)("mobile_form_validation_error")))}}},39814:function(e,t,n){"use strict";n.d(t,{initScrollRestoration:function(){return _}});var o=n(22683),a=n(15893),i=n(20848),r="scroll-restoration-key",s="scroll-restoration-value";function l(){var e=window.cur.page_version_hash||null;return window.nav.cur+(e?"#"+e:"")}function c(){return window.cur.scroll_restoration_mode||null}function d(e,t){"skeleton"!==c()&&(o.vkSessionStorage.setItem(r,e),o.vkSessionStorage.setItem(s,t.toString()))}function u(){o.vkSessionStorage.removeItem(r),o.vkSessionStorage.removeItem(s)}function _(){(0,i.addEvent)(window,"scroll",(0,a.throttle)((function(){d(l(),(0,i.scrollTop)())}),1e3),{passive:!0}),window.page.onReadyOrChanged((function(){if(p)return p=!1,void function(){var e=o.vkSessionStorage.getItem(r);if(e!==l())return u();window.clog("Restore scroll for "+e);var t=o.vkSessionStorage.getItem(s);setTimeout((function(){(0,i.scrollTop)(t),(0,i.onBodyScrollForce)()}),20),u()}();"skeleton"===c()&&(p=!0)}))}var p=!1},83194:function(e,t,n){"use strict";function o(e,t,n){return void 0===t&&(t=""),e&&n?new Promise((function(o,a){window.ajax.post("/?act=track_event",{type:e,value:t,hash:n},{onDone:function(){o()},onFail:function(e){return a(e),!0}})})):Promise.reject()}n.d(t,{trackEvent:function(){return o}})},3859:function(e,t,n){"use strict";n.d(t,{closePaymentWindow:function(){return h},getOrderIsPaidCheckUrl:function(){return y},getOrderPaymentUrl:function(){return w},getOrderPaymentWindow:function(){return g},getPaymentSessionInitialData:function(){return _},getPaymentWindow:function(){return v},handlePaymentComponentChange:function(){return p},handlePaymentComponentDestroy:function(){return m},handleRequestAbortOnDestroy:function(){return f},startOrderPaymentWaiting:function(){return C},startPaymentWaiting:function(){return S}});var o=n(75105),a=n(71437),i=n(15247),r=n(20848),s=n(39871),l=n(52822),c=n(36461),d=n(48328),u=n(30675);var _=function(){return{id:0}},p=function(e,t){void 0===e&&(e=_());var n=e.id+1;e.id=n,t.sessionId=n},m=function(e,t){(0,o.onEmitOnce)(window.nav.onBeforeGo,(function(){return p(e,t)}))},f=function(e){(0,o.onEmitOnce)(window.nav.onBeforeGo,(function(){return e.abort()}))},v=function(e){var t=window.open("");return null==t||t.focus(),null==t||t.document.write(e),(0,o.onEmitOnce)(window.nav.onBeforeGo,(function(){return null==t?void 0:t.close()})),t||void 0},g=function(){return v((0,r.getLang)("mobile_market_cart_payment_info_waiting"))},h=function(e){return e&&e.close()},w=function(e){var t=e.userId,n=e.orderId,o=e.hash,a=window.ajax.post("/market.php",{act:"get_payment_url_by_order",order_user_id:t,order_id:n,hash:o});return f(a),a.promise.then((function(e){var t=e.json;if(!e.skip){if(!t||!t.data||!t.data.length)throw Error();return decodeURIComponent(t.data[0])}}))},y=function(e){var t=e.orderId,n=e.userId;return(0,i.makeUrl)("/market.php",{act:"check_payment_by_order",order_id:t,order_user_id:n})},k=function(e){var t=e.icon,n=e.title,o=e.description,i=e.type,_=e.continueButtonURL,p=(0,a.$)('[data-section-ref="payment_content"]');if(p){var m=t||(e=>{switch(e){case"error":return{inner:[(0,c.Icon56ErrorOutline)()],class:"SplashScreen__icon",tag:"div"};case"timeout":return{inner:[(0,c.Icon56RecentOutline)()],class:"SplashScreen__icon",tag:"div"};case"loading":return{inner:[(0,l.default)({icon:(0,d.getLoading40Icon)()})],class:"SplashScreen__icon SplashScreen__icon--loading",tag:"div"};default:return{inner:[(0,c.Icon56CheckCircleOutline)()],class:"SplashScreen__icon",tag:"div"}}})(i);try{p.innerHTML=s.default.html(function(e){void 0===e&&(e={});var t={inner:[e.icon],class:"SplashScreen__icon",tag:"div"};return(0,u.default)({icon_raw:t,title:e.title,text:e.description,action_text:e.actionText,action_url:e.actionUrl})}({icon:m,title:n||(0,r.getLang)("mobile_market_cart_payment_info_error"),description:o||"",actionText:(0,r.getLang)("mobile_market_cart_payment_button"),actionUrl:_||window.nav.path}))}catch(e){console.error(e)}}},b=function(e){var t=(void 0===e?{continueButtonURL:void 0}:e).continueButtonURL;k({continueButtonURL:t,title:(0,r.getLang)("mobile_market_cart_payment_info_error"),description:(0,r.getLang)("mobile_market_cart_payment_info_canceled_text"),type:"error"})},S=function(e){var t=e.sessionIdCurrent,n=e.paymentURL,a=e.paymentWindow,i=e.waitingTimeSec,r=void 0===i?5:i,s=e.getIsSuccess,l=e.onLoading,c=e.onResponse,d=e.onCancel,u=e.onFailure,_=e.onTimeout,p=t;window.clog("Open VK Pay window. Starting payment check"),a.location.href=n,l();var m=setInterval((function(){if(p!==t)return clearInterval(m),void v();a&&a.window&&!a.window.closed||(window.clog("VK Pay window was manually closed. Unsubscribing from events"),clearInterval(m),v(),d())}),500),f=function(e){if(p===t)if("externalAppDone"===e.data.method&&e.data.params.status){window.clog("Received VK Pay done event. Waiting for payment success check"),v(),clearInterval(m);var n=Date.now(),o=!0,a=setInterval((function(){return p!==t?(clearInterval(a),void(o=!1)):o?Date.now()-n>=1e3*r?(window.clog("Payment check timeout. Showing done info."),clearInterval(a),o=!1,void _()):void s().then((function(e){if(!o||!e)return!1;window.clog("Payment check succeeded. Showing done info"),clearInterval(a),o=!1})).catch((function(){window.clog("Received VK Pay close or fail event. Unsubscribing from events"),clearInterval(a),u()})):void 0}),1e3);c&&c()}else"closeApp"!==e.data.method&&"externalAppFail"!==e.data.method||(window.clog("Received VK Pay close or fail event. Unsubscribing from events"),clearInterval(m),v(),u());else v()};function v(){window.removeEventListener("message",f,!1)}window.addEventListener("message",f,!1);(0,o.onEmitOnce)(window.nav.onBeforeGo,(function(){v()}))},C=function(e){var t=e.paymentComponent,n=e.checkIsPaidUrl,o=e.sessionIdCurrent,a=e.paymentURL,i=e.paymentWindow,s=e.onCancel,l=e.onFail,c=e.onTimeout;return S({sessionIdCurrent:o,paymentURL:a,paymentWindow:i,waitingTimeSec:40,getIsSuccess:function(){var e=window.ajax.post(n,{});return f(e),e.promise.then((function(e){var n,a=e.json;if(!e.skip){if(o!==t.sessionId)throw Error();if(!a)throw Error();return!!(null===(n=null==a?void 0:a.data)||void 0===n?void 0:n[0].status)&&(function(e){var t=e.description,n=e.continueButtonURL;k({description:t,continueButtonURL:n,title:(0,r.getLang)("mobile_market_cart_payment_info_success"),type:"success"})}({description:a.data[0].text}),!0)}}))},onLoading:function(){!function(e){var t=e.title,n=e.description,o=e.continueButtonURL;k({title:t,description:n,continueButtonURL:o,type:"loading"})}({title:(0,r.getLang)("mobile_market_cart_payment_info_waiting"),description:(0,r.getLang)("mobile_market_cart_payment_info_waiting_text")})},onCancel:function(){s&&s(),b()},onFailure:function(){l&&l(),b()},onTimeout:function(){c&&c(),function(e){var t=(void 0===e?{continueButtonURL:void 0}:e).continueButtonURL;k({continueButtonURL:t,title:(0,r.getLang)("mobile_market_cart_payment_info_success"),description:(0,r.getLang)("mobile_market_cart_payment_info_success_later_text"),type:"timeout"})}()}})}},16144:function(e,t,n){"use strict";n.d(t,{requestBlurRemoveFx:function(){return a},$photos:function(){return i},removeBlurRestrictions:function(){return r},removeRestrictionById:function(){return s},upsertPhoto:function(){return l},upsertPhotos:function(){return c},insertPhotos:function(){return d},removePhoto:function(){return u}});var o=(0,n(72864).createDomain)("PHOTO/ITEMS"),a=o.createEffect(),i=o.createStore({},{name:"photos",updateFilter:function(){return!0}}),r=o.createEvent("removeBlurRestrictions"),s=o.createEvent("removeRestrictionById"),l=o.createEvent("upsertPhoto"),c=o.createEvent("upsertPhotos"),d=o.createEvent("insertPhotos"),u=o.createEvent("removePhoto")},83462:function(e,t,n){"use strict";n.d(t,{setQuestion:function(){return a},setAuthor:function(){return i},setOwner:function(){return r},setAnswer:function(){return s},setSnackbar:function(){return l},setIsPublisherOpened:function(){return c},closeAddAnswerBox:function(){return d},$question:function(){return u},$author:function(){return _},$owner:function(){return p},$answer:function(){return m},$snackbar:function(){return f},$isPublisherOpened:function(){return v}});var o=(0,n(72864).createDomain)("MvkQuestionsAddAnswerModal"),a=o.createEvent(),i=o.createEvent(),r=o.createEvent(),s=o.createEvent(),l=o.createEvent(),c=o.createEvent(),d=o.createEvent();o.onCreateStore((function(e){e.reset(d)}));var u=o.createStore(null),_=o.createStore(null),p=o.createStore(null),m=o.createStore(""),f=o.createStore(null),v=o.createStore(!1);u.on(a,(function(e,t){return t})),_.on(i,(function(e,t){return t})),p.on(r,(function(e,t){return t})),m.on(s,(function(e,t){return t})),v.on(c,(function(e,t){return t})),f.on(l,(function(e,t){return t}))},7682:function(e,t,n){"use strict";var o=n(80681);t.default=o.default},94898:function(e,t,n){"use strict";n.d(t,{MaybeLink:function(){return o.MaybeLink}});var o=n(41960)},98102:function(e,t,n){"use strict";n.d(t,{RowLabeledSelect:function(){return r},default:function(){return d}});var o=n(36810),a=(n(81294),n(90893),n(76828)),i=n(64485);function r(e){return s({anchor:e.anchor,style:e.style,label:e.label,content:(0,a.default)(e)})}function s(e){return d({anchor:e.anchor,url:e.url,style:e.style,content:[l({is_mini:e.is_mini,label:e.label}),c({content:e.content})]})}function l(e){return{inner:[e.label],class:[i.default.class("Row__label",{mini:e.is_mini},"_"),e.class||""].join(" "),tag:"div"}}function c(e){return{inner:[e.content],class:["Row__labeledContent",e.class||""].join(" "),tag:"div"}}var d=o.default},93284:function(e,t,n){"use strict";n.d(t,{HASH_ROUTE:function(){return d},showCookieBanner:function(){return p}});var o=n(79573),a=n(20848),i=n(79764),r=n(60201),s=n(56769),l=n(34757),c=(0,a.need)("onDOMReady"),d="#cookie-settings";c((function(){CookiePolicy._onHideClick=_,CookiePolicy._showCookieBanner=p}));var u=".CookiePolicy";function _(e,t){e.preventDefault();var n=t.getAttribute("href");t.closest(u).style.display="none",i.default.post(n,{_ajax:1})}function p(e,t){var a=document.getElementById("CookiePolicyWrap");a&&(a.style.display="none"),window.location.hash=d,(0,l.addStatic)(["vkui.css"]).then((function(){Promise.all([Promise.all([n.e(1777),n.e(779)]).then(n.bind(n,61040)).then((function(e){return e.default}))]).then((function(n){var i=(0,o.__read)(n,1)[0];(0,r.showComponent)((function(n){return(0,s.createElement)(i,{loadExistsSettings:e,selectAll:t,onMainClose:function(){a&&(a.style.display="block"),window.location.hash="",n()},onSubmit:function(){a&&(a.style.display="none")}})}))}))}))}},22186:function(e,t,n){"use strict";n.d(t,{setBottom:function(){return a},setStatus:function(){return i},getFormItem:function(){return r}});var o=["error"];function a(e,t){var n=e.querySelector(".FormItem__bottom");if(n){var o=n.innerHTML;o&&!n.getAttribute("data-initial")&&n.setAttribute("data-initial",o),n.innerHTML=t,n.classList.toggle("FormItem__bottom--hidden",!t)}}function i(e,t){o.forEach((function(n){n!==t&&e.classList.remove("FormItem--"+n)}));var n=e.querySelector("input")||e.querySelector("textarea");if(n)if(t){e.classList.add("FormItem--"+t);var a=e.getAttribute("data-name");a&&n.setAttribute("aria-describedby",a+"-bottom")}else n.removeAttribute("aria-describedby")}function r(e){return e.closest(".FormItem")}},84316:function(e,t,n){"use strict";n.d(t,{ItemsList:function(){return l},_onClose:function(){return c},_goToItem:function(){return d},_toggleFave:function(){return u},_openItemsPopup:function(){return _}});var o=n(39871),a=n(49598),i=n(9223),r=n(55656),s=n(66021),l={_faveCache:{},_itemsPopup:void 0,_onClose:function(){},_goToItem:function(){},_toggleFave:function(){},_openItemsPopup:function(){}},c=function(){l._itemsPopup&&(a.default.close(l._itemsPopup),delete l._itemsPopup)};l._onClose=c;var d=function(e){var t,n;(null===(t=window.cur.destroy)||void 0===t?void 0:t.includes(l._onClose))||null===(n=window.cur.destroy)||void 0===n||n.push(l._onClose),window.nav.go(e.url)};l._goToItem=d;var u=function(e){var t=e.event,n=e.el,a=e.type,i=e.typeInt,s=e.ownerId,c=e.itemId,d=e.href,u=e.faveHash;t.stopPropagation();var _=n.dataset.isFave;window.ajax.post("/bookmarks.php",{_ajax:1,item_type:i,act:_?"bookmark_remove":"bookmark_add",hash:u,item_oid:s,item_id:c,link_url:d},{onDone:function(e){if(e){l._faveCache[c]=!_;var t=document.querySelector(".PhotoItemsList");if(!t)return;t.querySelectorAll(".PhotoMarketItem").forEach((function(e){if(e.dataset.itemId===c.toString()){var t=e.querySelector(".PhotoMarketItem__fave");if(!t)return;t.outerHTML=o.default.html((0,r.ItemFaveStar)({type:a,typeInt:i,isFave:!_,ownerId:s,itemId:c,href:d,faveHash:u}))}}))}}})};l._toggleFave=u;var _=function(e){var t=(0,i.default)({class:"Photo__marketItemsModal",body:(0,s.ItemsList)({itemsJSON:e,onClose:["ItemsList._onClose"]})});l._itemsPopup=a.default.open(o.default.elem(t),!0)};l._openItemsPopup=_},74776:function(e,t,n){"use strict";n.d(t,{onFeedRowViewStarted:function(){return r},onFeedRowViewCompleted:function(){return s}});var o=n(79573),a="_feedRowViewHandle",i=function(e){var t=e.isExpectedFeedRow,n=e.onViewCallback,o=e.once,a=void 0===o||o,i=e.onceViewHandledCheck,r=e.onceViewHandledSet;return{onAnyFeedRowViewTrigger:function(e){a&&i(e)||t(e)&&(r(e),function(e){n({feedRowElement:e})}(e))}}},r=function(e){var t,n=e.onViewStarted,a=(0,o.__rest)(e,["onViewStarted"]),r=null===(t=window.pStats)||void 0===t?void 0:t.onViewStarted;r&&r(i((0,o.__assign)((0,o.__assign)((0,o.__assign)({},a),l(Symbol("ViewStarted"))),{onViewCallback:n})).onAnyFeedRowViewTrigger)},s=function(e){var t,n=e.onViewCompleted,a=(0,o.__rest)(e,["onViewCompleted"]),r=null===(t=window.pStats)||void 0===t?void 0:t.onViewed;r&&r(i((0,o.__assign)((0,o.__assign)((0,o.__assign)({},a),l(Symbol("ViewCompleted"))),{onViewCallback:n})).onAnyFeedRowViewTrigger)};function l(e){return{onceViewHandledCheck:function(t){return function(e,t){var n,o=t;return!0===(null===(n=e[a])||void 0===n?void 0:n[o])}(t,e)},onceViewHandledSet:function(t){var n,o,i;o=e,(i=(n=t)[a])||(i=Object.create(null),n[a]=i),i&&(i[o]=!0)}}}},20594:function(e,t,n){"use strict";var o=n(79573),a=n(26330),i=n(76567),r=n(79764),s=n(62641),l=n(75105),c=n(71437),d=n(69161),u=n(20848),_=function(){function e(){}return e.saveStickerPanel=function(e,t){a.default.set("sticker_panel",e),t&&(0,i.setCookie)("remixstickers_hash",t),window.cur.sticker_panel=e},e.getStickerPanel=function(e){void 0===e&&(e=""),e||(e=(0,s.getState)("target")||"");var t=a.default.get("sticker_panel")||window.cur.sticker_panel;return t?e?t.replace(/mail0/g,e):t:""},e.saveStickers=function(t){e.stickers=t,a.default.set("stickers",t),this.stickerImages=void 0},e.getStickerImages=function(){var e,t,n,a;if(this.stickerImages)return this.stickerImages;var i={},r=this.getStickers();if(r)try{for(var s=(0,o.__values)(Object.values(r)),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.stickers)try{for(var d=(n=void 0,(0,o.__values)(c.stickers)),u=d.next();!u.done;u=d.next()){var _=u.value;_[6]&&(i[Number(_[0])]=_[6])}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return this.stickerImages=i,i},e.getStickerImage=function(e,t){var n;return(null===(n=this.getStickerImages()[e])||void 0===n?void 0:n[t])||null},e.setStickerTab=function(e,t){return void 0===t&&(t=[]),this.getStickers(),this.stickers[e]?this.stickers[e].stickers=t:this.stickers[e]={stickers:t},this.saveStickers(this.stickers),this.stickers[e]},e.getStickers=function(){if(this.stickers)return this.stickers;var t=a.default.get("stickers");return t&&Object.values(t).find((function(e){return!e.hasOwnProperty("stickers")}))&&(window.clog("[StickerCache] Stickers cache format is outdated"),t=null),!t&&window.cur.stickers&&(t=window.cur.stickers,this.saveStickers(t)),e.stickers||(e.stickers=t),e.stickers},e.setNewStickersCount=function(t,n){var o=n||e.getStickerPanel();if(!(0,d.isNumber)(t))return n||"";var a=document.createElement("ce");a.innerHTML=o;var i=(0,c.$)(".sp_badge",a),r=window.devicePixelRatio>=1.5?"_2x":"";return(0,u.setStyle)(i,{"background-image":t>0?"url(/images/mobile/badge"+t+r+".png)":""}),a.innerHTML||""},e.checkStickers=function(t){var n=this;if(void 0===t&&(t={}),window.vk)if(window.vk.id){var s=(0,i.getCookie)("remixstickers_hash");if(this.getStickers()&&this.getStickerPanel()&&s){if(!t.force&&Date.now()-a.default.get("stickers_last_load")<3e5)return window.clog("[StickerCache] Stickers check was fired in less than 5 minutes. Prevent loading"),!1}else window.clog("[StickerCache] Stickers cache isn't loaded or broken"),(0,i.setCookie)("remixstickers_hash","");t.ignore_hash&&(0,i.setCookie)("remixstickers_hash",""),a.default.set("stickers_last_load",Date.now()),r.default.post("/?act=load_stickers",{},{onDone:function(t){if(a.default.set("stickers_last_load",Date.now()),t){if(t.part_load){window.clog("[StickerCache] Force loaded some categories");var n=t.stickers_data,o=t.new_items;if((0,d.isNumber)(o)){var i=e.setNewStickersCount(o);e.saveStickerPanel(i)}var r=(0,u.extend)(e.getStickers()||{},n);e.saveStickers(r)}else{window.clog("[StickerCache] New version of stickers async loaded");var l=t.sticker_panel;n=t.stickers_data;e.saveStickerPanel(l,t.hash),e.saveStickers(JSON.parse(n))}e.onStickerPanelUpdate(t.hash!==s)}else window.clog("[StickerCache] Stickers already exists.")}})}else window.clog("[StickerCache] User unauthorized.");else setTimeout((function(){var t;return(t=n.checkStickers).call.apply(t,(0,o.__spreadArray)([e],(0,o.__read)(arguments),!1))}),1e3)},e.stickers=null,e.onStickerPanelUpdate=(0,l.default)(),e}();window.stickers_cache=_,t.default=_},5488:function(e,t,n){"use strict";n.d(t,{BaseUploadStrategy:function(){return i}});var o=n(40906),a=n(61508),i=function(){function e(e){var t=this;this.queue=[],this._is_processing=!1,this._started=!1,this.emitter=new a.default,this.addFile=function(e){var n=(0,o.srand)();return t.queue.push({id:n,file:e}),t._started&&t.touchQueue(),n},this.addFiles=function(e){return e.map((function(e){return t.addFile(e)}))},this.removeFile=function(e){var n;(null===(n=t._current_task)||void 0===n?void 0:n.id)===e?t._current_task=void 0:t.queue=t.queue.filter((function(t){return t.id!==e}))},this.isTaskExist=function(e){var n;return(null===(n=t._current_task)||void 0===n?void 0:n.id)===e||!!t.queue.find((function(t){return t.id===e}))},this.touchQueue=function(){if(!t._is_processing){var e=t.queue.shift();t._current_task=e,e&&(t._is_processing=!0,t.emitter.emit("start"),t.onQueueNextTask(e).then((function(){return t.touchQueue()})))}},this.start=function(){t._started=!0,t.touchQueue()},this.pause=function(){t._started=!1},this.destroy=function(){t.emitter.removeAllListeners(),t._started=!1,t._is_processing=!1,t._current_task=void 0,t.queue.splice(0,t.queue.length)},this.onProgress=function(e){t.emitter.emit("progress",e)},this.onComplete=function(e,n){var o=null;t.isTaskExist(e.id)&&(o={task_id:e.id,data:n},t.emitter.emit("complete",o)),0===t.queue.length&&t.emitter.emit("end",o),t._is_processing=!1},this.onError=function(e,n){t.emitter.emit("error",{task_id:e.id,error:n}),0===t.queue.length&&t.emitter.emit("end",null),t._is_processing=!1},this.onQueueNextTask=function(e){return t.processUploadStorage(e).then(t.processSaveFile.bind(t,e)).then(t.onComplete.bind(t,e)).catch(t.onError.bind(t,e))},this.options=e}return e.prototype.processUploadStorage=function(e){throw new Error("Not implemented")},e.prototype.processSaveFile=function(e,t){throw new Error("Not implemented")},e}()},91253:function(e,t,n){"use strict";n.d(t,{PLATFORM_MVK:function(){return o}});var o="mvk"},67181:function(e,t,n){"use strict";n.d(t,{EntityType:function(){return o},EventQueue:function(){return i}});var o,a=n(79573);!function(e){e.Online="online"}(o||(o={}));var i=function(e){var t=this,n=e.getQueue,o=e.registerQueue;this.QUEUE_KEY_TTL=3e3,this.MAX_RETRIES=5,this.listeners=[],this.retriesLeft=this.MAX_RETRIES,this.restart=function(){t.intervalId&&clearInterval(t.intervalId),0!==t.retriesLeft&&(t.retriesLeft--,t.getQueue().then((function(e){t.retriesLeft=t.MAX_RETRIES;var n=(0,a.__assign)({},e);t.intervalId=window.setInterval((function(){t.registerQueue(n,(function(e,o){var i,r,s,l;if(function(e){return void 0!==e.err}(o))t.restart();else{n.ts=o.ts;try{for(var c=(0,a.__values)(o.events),d=c.next();!d.done;d=c.next()){var u=d.value;try{for(var _=(s=void 0,(0,a.__values)(t.listeners)),p=_.next();!p.done;p=_.next())(0,p.value)(u)}catch(e){s={error:e}}finally{try{p&&!p.done&&(l=_.return)&&l.call(_)}finally{if(s)throw s.error}}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(i)throw i.error}}}}))}),t.QUEUE_KEY_TTL)})).catch((function(e){console.error(e),setTimeout(t.restart,t.QUEUE_KEY_TTL)})))},this.subscribe=function(e){return t.listeners.push(e),1===t.listeners.length&&t.restart(),function(){t.listeners=t.listeners.filter((function(t){return t!==e})),0===t.listeners.length&&(t.retriesLeft=t.MAX_RETRIES,t.intervalId&&clearInterval(t.intervalId))}},this.registerQueue=o,this.getQueue=n}},80235:function(e,t,n){"use strict";n.d(t,{BestFriendsEventType:function(){return o},sendBestFriendsAnalytic:function(){return r}});var o,a=n(79957),i=n(19331);function r(e,t){var n={event_type:e,nav_screen:t||window.cur.module};(0,i.partConfigEnabled)("best_friends_analytics_log")&&console.log(n),(0,a.statlogsValueEvent)("best_friends_product_analytic",n)}!function(e){e.addFriendsFromChat="add_friends_from_chat",e.clear="clear",e.moreChats="more_chats",e.selectFriendFromSearch="select_friend_from_search",e.selectChatFromSearch="select_chat_from_search",e.saveBestFriendsList="save_best_friends_list",e.updatePopupSave="update_popup_save",e.updatePopupCancel="update_popup_cancel",e.createPostFromPopupBest="create_post_from_popup_best",e.createPostFromPopupFriends="create_post_from_popup_friends",e.clickToLockFriends="click_to_lock_friends",e.clickToLockBestFriends="click_to_lock_best_friends",e.editBestFriendsFromPopup="edit_best_friends_from_popup",e.editBestFriends="edit_best_friends",e.selectBestFriends="select_best_friends",e.clickToBestFriendsEntrypoint="click_to_best_friends_entrypoint"}(o||(o={}))},49464:function(e,t,n){"use strict";n.d(t,{NarrativeAnalyticEventType:function(){return o},NarrativeAnalyticNavScreen:function(){return a},sendNarrativeAnalytic:function(){return s}});var o,a,i=n(79957),r=n(19331);function s(e,t,n){var o;void 0===n&&(n=a.other);var s=(null==t?void 0:t.title)||void 0,l=(null==t?void 0:t.customCover)?0:(null==t?void 0:t.coverStoryId)||0,c=(null==t?void 0:t.id)||0,d=(null==t?void 0:t.ownerId)||0,u=null===(o=null==t?void 0:t.stories)||void 0===o?void 0:o.map((function(e){return e.id})),_={event_type:e,nav_screen:n,narrative_owner_id:d,narrative_id:c,narrative_title:s,story_ids:(null==u?void 0:u.length)?u:void 0,cover_story_id:l};(0,i.statlogsValueEvent)("narrative_product_analytic",_),(0,r.partConfigEnabled)("narratives_web_analytic_debug")&&console.log("-- narrative analytic",_)}!function(e){e.clickToAddToNarrative="click_to_add_to_narrative",e.addStoryToNarrative="add_story_to_narrative",e.openNarrativeList="open_narrative_list",e.close="close",e.changeSort="change_sort",e.publishNarrative="publish_narrative",e.createNarrative="create_narrative",e.deleteNarrative="delete_narrative",e.clickToEditNarrative="click_to_edit_narrative",e.editNarrative="edit_narrative",e.addToBookmarks="add_to_bookmarks",e.shareNarrative="share_narrative",e.seeMore="see_more",e.addToNarrativeFromActionSheet="add_to_narrative_from_action_sheet"}(o||(o={})),function(e){e.storyArchive="story_archive",e.storyViewer="story_viewer",e.profile="profile",e.feedBlock="narratives_feed_block",e.club="club",e.other="other"}(a||(a={}))},85701:function(e,t,n){"use strict";n.d(t,{MAX_STORY_VIDEO_DURATION:function(){return i},getStoryUploadUrl:function(){return r},saveStoryOnServer:function(){return s}});var o=n(79573),a=(n(40906),n(61540)),i=16;function r(e){return new Promise((function(t,n){window.ajax.post((0,a.isMvk)()?"stories.php":"al_stories.php",(0,o.__assign)({act:"get_upload_url"},e),{onDone:t,onError:n,onFail:n})}))}function s(e,t){return new Promise((function(n,o){window.ajax.post((0,a.isMvk)()?"stories.php":"al_stories.php",{act:"save",upload_result:e,hash:t},{onDone:n,onError:o,onFail:o})}))}},42493:function(e,t,n){"use strict";n.d(t,{trackMarketArea:function(){return P},trackMarketEvent:function(){return M}});var o=n(79573),a=n(71014),i=n(91253),r=n(22683),s=n(73762),l="market_event_count",c="market_event_item_";function d(e,t,n,i){var s=window.MarketAnalyticsManager&&window.MarketAnalyticsManager.getHash();if(s){var c=n.slice(0,10),d=0,_=r.vkLocalStorage.getItem(l);_&&(d=parseInt(_)),d>=20&&(u(e),d=0);var p=Date.now(),m="market_event_item_"+Math.floor(1e5*Math.random())+"_"+p+"_"+t;c.unshift(p),c.unshift(t),c.push(s),r.vkLocalStorage.setItem(m,JSON.stringify(c)),r.vkLocalStorage.setItem(l,String(++d)),i&&u(e),a.marketDebug.apply(void 0,(0,o.__spreadArray)(["debug","event",t],(0,o.__read)(n),!1))}else(0,a.marketDebug)("warn","events","Hash error")}function u(e){for(var t=[],n=0;n<r.vkLocalStorage.length();++n){var o=r.vkLocalStorage.key(n);o&&0===o.lastIndexOf(c)&&t.push(o)}if(!(t.length<=0)){r.vkLocalStorage.setItem(l,String(0));var s=[],d="";t.forEach((function(e){var t=r.vkLocalStorage.getItem(e);if(r.vkLocalStorage.removeItem(e),t)try{var n=JSON.parse(t);d?n.pop():d=n.pop(),s.push(Object.values(n))}catch(e){(0,a.marketDebug)("error","event error","Unable to assemble events pack",e)}})),!d||s.length<1||(!window.MarketAnalyticsManager||window.MarketAnalyticsManager.isEnabled()?window.ajax.post(e===i.PLATFORM_MVK?"market.php":"al_market.php",{act:"log_events",hash:d,events:s},{onDone:function(){(0,a.marketDebug)("warn","events sent",s.length+" events sent")}}):(0,a.marketDebug)("error","event error","analytics disabled"))}}var _=function(){function e(){}return e.prototype.connectMutator=function(t){if(this.mutationObserver)throw new Error("{Observer #"+t.getObserverId()+"} MutationObserver already connected to observer");var n=document.querySelector(t.getContainerQuery());n instanceof HTMLElement&&(this.mutationObserver=new MutationObserver((function(n){n.forEach((function(n){if(n.addedNodes)for(var o=0;o<n.addedNodes.length;o++){var a=n.addedNodes[o];if(a instanceof HTMLElement){var i=e.resolveNodes(a,t).filter((function(e){return!!e}));i&&(i.forEach((function(e){t.add(e)})),t.scan())}}}))})),this.mutationObserver.observe(n,{childList:!0,subtree:!0,attributes:!1,characterData:!1}))},e.prototype.disconnectMutator=function(e){e.isRunning()&&this.mutationObserver&&this.mutationObserver.disconnect()},e.resolveNodes=function(e,t){var n=[];if(t.getSelectorQuery(!1).split(",").forEach((function(t){if(e.matches(t))return n.push(e),!1})),n.length<1){var o=e.querySelectorAll(t.getSelectorQuery(!1));n=Array.from(o)}return n},e}(),p=n(9720),m={};function f(){for(var e in m){if(m[e])m[e].stop()}}var v="data-stat-item",g="data-stat-id",h=function(){function e(e,t,n,o,a,i){var r;if(void 0===n&&(n=""),void 0===o&&(o=!1),void 0===a&&(a=""),this.observerId=e,this.itemSelector=t,this.container=n,this.isUnifyNodes=o,this.platform=a,this.getExtraItemParams=i,this.trackingItems={},this._debounceTimeout=20,this.uniqueNodeCounter=0,this.nodes=[],this.isWatching=!1,this.mutatorList=[],(r=this).getObserverId()in m&&(m[r.getObserverId()].stop(),delete m[r.getObserverId()]),m[r.getObserverId()]=r,!this.itemSelector.types&&!this.itemSelector.selectors)throw new Error("Empty itemSelector definition");this.container||(this.container=this.observerId)}return Object.defineProperty(e.prototype,"debounceTimeout",{set:function(e){this._debounceTimeout=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemReachedCallback",{set:function(e){this._itemReachedCallback=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preCheckReachedCallback",{set:function(e){this._preCheckReachedCallback=e},enumerable:!1,configurable:!0}),e.prototype.getObserverId=function(){return this.observerId},e.prototype.getItemSelector=function(){return this.itemSelector},e.prototype.getPlatform=function(){return this.platform},e.prototype.add=function(e){this.nodes.push(e)},e.prototype.getTrackingItems=function(){return this.trackingItems},e.prototype.addMutators=function(e){this.mutatorList=this.mutatorList.concat(e)},e.prototype.isRunning=function(){return this.isWatching},e.prototype.watch=function(){this.isWatching||(this.update(),this.startObserving(),this.connectMutators(),this.isWatching=!0)},e.prototype.stop=function(){this.isWatching&&(this.trackUntracked(),this.stopObserving(),this.disconnectMutators(),this.isWatching=!1)},e.prototype.scan=function(){this.viewportScanner()},e.prototype.trackUntracked=function(){var e=this.getTrackingItems();for(var t in e)if(e[t]){var n=e[t];!n.isTracked&&n.isReached&&(this.track(n),this.persist(n))}},e.prototype.connectMutators=function(){var e=this;this.mutatorList.forEach((function(t){t.connectMutator(e)}))},e.prototype.disconnectMutators=function(){var e=this;this.mutatorList.forEach((function(t){t.disconnectMutator(e)}))},e.prototype.getContainerQuery=function(){var e=this.container.substr(0,1);return"#"===e||"."===e?this.container:'[data-stat-container="'+(this.container?this.container:this.observerId)+'"]'},e.prototype.getSelectorQuery=function(e){void 0===e&&(e=!0);var t=this.getContainerQuery(),n=[];return this.itemSelector.selectors?n=this.itemSelector.selectors.split(",").map((function(n){return e?t+" "+n:n})):this.itemSelector.types&&(n=this.itemSelector.types.split(",").map((function(n){return e?t+" ["+'data-stat-item^="'+n+'|"]':'[data-stat-item^="'+n+'|"]'}))),n.join(",")},e.prototype.update=function(){var e=document.querySelectorAll(this.getSelectorQuery());this.nodes=Array.from(e)},e.parseStatAttribute=function(e){var t=e.getAttribute(v),n=null==t?void 0:t.split("|");return n?{type:n[0],ownerId:parseInt(n[1]),itemId:n[2]}:{type:"",ownerId:0,itemId:0}},e.prototype.getNodeKey=function(e,t){var n=String(t.itemId);this.isUnifyNodes&&(this.unifyNode(e),n=n+"_"+e.getAttribute(g));return this.observerId+"_"+n},e.prototype.isItemReached=function(e){return!(void 0!==this._preCheckReachedCallback&&!this._preCheckReachedCallback(e))&&this.isReached(e)},e.prototype.filterItem=function(e){return!e.isTracked&&!e.isReached&&(this.isItemReached(e.node)?(this.track(e),this.persist(e),!1):(this.persist(e),!0))},e.prototype.track=function(e){e.isTracked||(e.viewEnd=Date.now(),e.duration=e.viewEnd-e.viewStart,this._itemReachedCallback(e),e.isReached=!1,e.isTracked=!0)},e.prototype.persist=function(e){this.trackingItems[e.key]=e},e.prototype.getTrackingItem=function(t){var n=e.parseStatAttribute(t);if(!n.type||!n.itemId)return null;var o=this.getNodeKey(t,n);return o?o in this.trackingItems?this.trackingItems[o]:this.createTrackingItem(t,n):null},e.prototype.createTrackingItem=function(e,t){var n=this.getNodeKey(e,t),a=this.getExtraItemParams&&this.getExtraItemParams()||{};return this.trackingItems[n]=(0,o.__assign)((0,o.__assign)({},a),{key:n,type:t.type,observerId:this.observerId,ownerId:t.ownerId,itemId:t.itemId,isTracked:!1,isReached:!1,viewStart:0,viewEnd:0,duration:0,node:e,viewTimer:0,data:{},platform:this.getPlatform(),city:(0,s.getStatCity)(),screen:a.screen||(0,s.getStatScreen)()}),this.trackingItems[n]},e.prototype.getNextUnifyId=function(){return++this.uniqueNodeCounter},e.prototype.unifyNode=function(e){e.getAttribute(g)||e.setAttribute(g,String(this.getNextUnifyId()))},e.prototype.startObserving=function(){var e=this;this.update(),this.viewportScanner=(0,p.debounce)((function(){e.nodes=e.nodes.filter((function(t){var n=e.getTrackingItem(t);return!!n&&e.filterItem(n)}))}),this._debounceTimeout),this.scrollEventListener=function(){return e.scan()},document.addEventListener("scroll",this.scrollEventListener,{passive:!0}),this.scan()},e.prototype.stopObserving=function(){document.removeEventListener("scroll",this.scrollEventListener),this.nodes=[],this.viewportScanner=function(){},this.scrollEventListener=function(){}},e}();var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.filterItem=function(e){return!e.isTracked&&(e.isReached&&!this.isItemReached(e.node)?(this.track(e),this.persist(e),!1):(this.isItemReached(e.node)&&this.view(e),this.persist(e),!0))},t.prototype.view=function(e){var t=this;e.isTracked||(e.isReached=!0,e.viewStart||(e.viewStart=Date.now()),e.viewTimer&&(clearTimeout(e.viewTimer),e.viewTimer=0),e.viewTimer=window.setTimeout((function(){var n=e.node;!t.isItemReached(n)||function(e){var t=e.viewStart;return Date.now()-t>3e4}(e)?t.track(e):t.view(e)}),3e3))},t.prototype.track=function(t){t.viewTimer&&(clearTimeout(t.viewTimer),t.viewTimer=0),e.prototype.track.call(this,t)},t}(h),y=n(30104),k=function(e){function t(n,o,a,i,r,s,l){void 0===a&&(a=""),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===s&&(s="");var c=e.call(this,n,o,a,i,s,l)||this;return c.observerId=n,c.itemSelector=o,c.container=a,c.isUnifyNodes=i,c.isDynamicNodes=r,c.gap=null,r&&c.addMutators([new _]),c.gap=t.getViewportGap(c.getPlatform()),c}return(0,o.__extends)(t,e),t.prototype.isReached=function(e){if(!(0,a.isElementVisible)(e))return!1;var t,n=this.gap,o=e.closest("[data-stat-viewport]");if(o){var i=o.getBoundingClientRect();n={top:i.top,left:i.left},t={width:i.left+i.width,height:i.top+i.height}}return(0,a.isElementInViewport)(e,45,n,t)},t.create=function(e){return new t(e.observerId,e.itemSelector,null==e?void 0:e.container,null==e?void 0:e.isUnifyNodes,null==e?void 0:e.isDynamicContent,null==e?void 0:e.platform,null==e?void 0:e.getExtraItemParams)},t.getViewportGap=function(e){void 0===e&&(e="");var t={left:0,top:0},n="";return n=e===i.PLATFORM_MVK?"#vk_head":"#page_header_wrap,#market_search_input",document.querySelectorAll(n).forEach((function(e){var n=(0,y.getElementSize)(e);t.top=t.top+n.height})),t},t}(w),b=n(58755),S=[],C=!1;function E(e,t){void 0===t&&(t=0);var n=T(t);return!!n&&e.includes(n.event)}function T(e){return void 0===e&&(e=0),S.length>e?S[S.length-(1+e)]:null}function I(e){C||(window.addEventListener("beforeunload",(function(){f(),u(e)})),C=!0)}function M(e){if(function(e){var t=T();if(t){if(e===b.ECommGoodsEvent.CLOSE_ITEM&&t.event===b.ECommGoodsEvent.CLOSE_ITEM)return!1;if(e===b.ECommGoodsEvent.TRANSITION_TO_ITEM){if(E([b.ECommGoodsEvent.TRANSITION_TO_ITEM_LEFT,b.ECommGoodsEvent.TRANSITION_TO_ITEM_RIGHT]))return!1;if(E([b.ECommGoodsEvent.SWITCH_ITEM_VARIANT_1,b.ECommGoodsEvent.SWITCH_ITEM_VARIANT_2]))return!1}}return!0}(e.event))if(e.event||e.table){e.table||(Object.values(b.ECommGoodsEvent).includes(e.event)?e.table=b.AnalyticsEventTable.GOODS:Object.values(b.ECommOrdersEvent).includes(e.event)?e.table=b.AnalyticsEventTable.ORDERS:(0,a.marketDebug)("error","table not specified")),e.screen=e.screen?e.screen:window.MarketAnalyticsManager&&window.MarketAnalyticsManager.getScreen(),e.platform=e.platform?e.platform:"web",e.itemType=e.itemType?e.itemType:"",I(e.platform);var t=String(e.event),n=e.table+":"+t;e.instant?function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];d(e,t,n,!0)}(e.platform,n,e.ownerId,e.itemId,e.screen,e.albumId,e.time,e.duration,e.itemType):function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];d(e,t,n,!1)}(e.platform,n,e.ownerId,e.itemId,e.screen,e.albumId,e.time,e.duration,e.itemType),S.push(e),S.length>3&&S.shift()}else(0,a.marketDebug)("error","event and table not specified",e)}function P(e,t){var n;switch(void 0===t&&(t=""),I(t),u(t),f(),(0,a.marketDebug)("warn","analytics: start tracking area",e),e){case b.AnalyticsArea.MARKET:n=function(e){var t=0;void 0!==window.cur.aid&&(t=window.cur.aid),M({event:"market_item"===e.type?b.ECommGoodsEvent.VIEW_ITEM:b.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,albumId:"market_item"===e.type?t:e.itemId,duration:e.duration,time:e.viewStart,platform:e.platform})};var o=k.create({observerId:"market_products",itemSelector:{types:"market_item"},isUnifyNodes:!0,isDynamicContent:!0,platform:t});o.itemReachedCallback=n;var r=k.create({observerId:"market_albums",itemSelector:{types:"market_album"},isUnifyNodes:!0,isDynamicContent:!1,platform:t});r.itemReachedCallback=n,t!==i.PLATFORM_MVK&&(r.preCheckReachedCallback=function(e){var t,n=e.offsetTop,o=null===(t=e.parentNode)||void 0===t?void 0:t.parentNode;return o&&n<o.offsetHeight}),o.watch(),r.watch();break;case b.AnalyticsArea.GROUP:n=function(e){M({event:"market_item"===e.type?b.ECommGoodsEvent.VIEW_ITEM:b.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,albumId:"market_item"===e.type?0:e.itemId,duration:e.duration,time:e.viewStart,platform:e.platform})};var s=k.create({observerId:"market_module",itemSelector:{types:"market_item"},isUnifyNodes:!0,platform:t});s.itemReachedCallback=n;var l=k.create({observerId:"group_wall",itemSelector:{types:"market_item,market_album"},isUnifyNodes:!0,isDynamicContent:!0,platform:t});l.itemReachedCallback=n,s.watch(),l.watch();break;case b.AnalyticsArea.USER_PROFILE:var c=k.create({observerId:"user_wall",itemSelector:{types:"market_item,market_album"},isUnifyNodes:!0,isDynamicContent:!0,platform:t});c.itemReachedCallback=function(e){M({event:"market_item"===e.type?b.ECommGoodsEvent.VIEW_ITEM:b.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,duration:e.duration,time:e.viewStart,albumId:"market_item"===e.type?0:e.itemId,platform:e.platform})},c.watch();break;case b.AnalyticsArea.BOOKMARKS:var d=k.create({observerId:"bookmarks",itemSelector:{types:"market_item"},isUnifyNodes:!0,isDynamicContent:!0,platform:t});d.itemReachedCallback=function(e){M({table:b.AnalyticsEventTable.GOODS,event:b.ECommGoodsEvent.VIEW_ITEM,ownerId:e.ownerId,itemId:e.itemId,duration:e.duration,time:e.viewStart,albumId:0,platform:e.platform})},d.watch();break;case b.AnalyticsArea.FEED:var _=k.create({observerId:"feed",itemSelector:{types:"market_item"},isUnifyNodes:!0,isDynamicContent:!0,container:".feed_wrap",platform:t});_.itemReachedCallback=function(e){M({event:"market_item"===e.type?b.ECommGoodsEvent.VIEW_ITEM:b.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,duration:e.duration,time:e.viewStart,albumId:"market_item"===e.type?0:e.itemId,platform:e.platform})},_.watch()}}},48289:function(e,t,n){"use strict";n.d(t,{MarketAnalyticsManager:function(){return a}});var o={screens:[],hash:"",replacedScreen:"",isEnabled:!1},a={setHash:function(e){o.hash=e},getHash:function(){return o.hash},getScreens:function(){var e=[];return o.screens.forEach((function(t){e.push(t)})),e},replaceScreen:function(e){o.replacedScreen=e},setScreen:function(e){o.screens.push(e),o.screens.length>5&&o.screens.shift()},getScreen:function(){return""!==o.replacedScreen?o.replacedScreen:o.screens.length>0?o.screens[o.screens.length-1]:""},getPrevScreen:function(){return o.screens.length>1?o.screens[o.screens.length-2]:""},popScreen:function(){return o.screens.length>0?String(o.screens.pop()):""},setEnabled:function(e){o.isEnabled=e},isEnabled:function(){return o.isEnabled}}},58755:function(e,t,n){"use strict";var o,a,i,r;n.d(t,{AnalyticsArea:function(){return o},AnalyticsEventTable:function(){return a},ECommGoodsEvent:function(){return i},ECommOrdersEvent:function(){return r}}),function(e){e.MARKET="market",e.GROUP="group",e.USER_PROFILE="user_profile",e.BOOKMARKS="bookmarks",e.FEED="feed"}(o||(o={})),function(e){e.GOODS="ecomm_goods",e.ORDERS="ecomm_orders"}(a||(a={})),function(e){e.TRANSITION_TO_ITEM="transition_to_item",e.TRANSITION_TO_ALBUM="transition_to_album",e.SWITCH_ITEM_VARIANT_1="switch_item_variant_1",e.SWITCH_ITEM_VARIANT_2="switch_item_variant_2",e.TRANSITION_TO_ITEM_LEFT="transition_to_item_left",e.TRANSITION_TO_ITEM_RIGHT="transition_to_item_right",e.VIEW_ITEM="view_item",e.VIEW_ALBUM="view_album",e.CLOSE_ITEM="close_item",e.TRANSITION_TO_OWNER="transition_to_owner",e.VIEW_ITEM_MEDIA="view_item_media",e.ADD_ITEM_TO_CART="add_item_to_cart",e.EXPAND_ITEM_DESCRIPTION="expand_item_description",e.ADD_ITEM_TO_BOOKMARKS="add_item_to_bookmarks",e.REMOVE_ITEM_FROM_BOOKMARKS="remove_item_from_bookmarks",e.EXPAND_COMMENTS="expand_comments",e.COMMENT="comment",e.ADD_TO_CART_HS="add_to_cart_hs",e.OPEN_WIKI="open_wiki",e.SEND_MESSAGE_TO_OWNER="send_message_to_owner",e.SEND_MESSAGE_TO_OWNER_2="send_message_to_owner_2",e.OPEN_CHAT_WITH_OWNER="open_chat_with_owner",e.OPEN_CHAT_WITH_OWNER_2="open_chat_with_owner_2",e.LIKE_ITEM="like_item",e.UNLIKE_ITEM="unlike_item",e.SHARE_ITEM="share_item",e.CTA_LINK="cta_link",e.CTA_LINK_2="cta_link_2",e.CALL="call",e.CALL_2="call_2",e.CREATE_ITEM="create_item",e.CREATE_ALBUM="create_album",e.EDIT_ITEM="edit_item",e.EDIT_ALBUM="edit_album",e.DELETE_ITEM="delete_item",e.DELETE_ALBUM="delete_album",e.GROUP_ITEMS="group_items",e.ADD_PROPERTY="add_property",e.ADD_PROPERTY_VALUE="add_property_value",e.DELETE_PROPERTY="delete_property",e.DELETE_PROPERTY_VALUE="delete_property_value",e.TRANSITION_TO_EDIT_PROPERTIES="transition_to_edit_properties",e.TRANSITION_TO_EDIT_ALBUMS="transition_to_edit_albums",e.TRANSITION_TO_ADD_ALBUM="transition_to_add_album",e.TRANSITION_TO_ADD_ITEM="transition_to_add_item",e.TRANSITION_TO_EDIT_ITEM="transition_to_edit_item",e.TRANSITION_TO_DELETE_ALBUM="transition_to_delete_album",e.TRANSITION_TO_GROUP_ITEMS="transition_to_group_items",e.VIEW_FEEDBACK="view_feedback",e.OPEN_FEEDBACK_PHOTO="open_feedback_photo"}(i||(i={})),function(e){e.EVENT_MAKE_ORDER="make_order",e.CANCEL_ORDER="cancel_order",e.EXPAND_ORDER_INFO="expand_order_info",e.TRANSITION_TO_ORDERS="transition_to_orders",e.OPEN_MARKET_GROUP_ORDERS="open_market_group_orders",e.OPEN_MARKET_GROUP_ITEMS="open_market_group_items",e.OPEN_MARKET_GROUP_SETTINGS="open_market_group_settings",e.OPEN_MARKET_GROUP_DELIVERY="open_market_group_delivery",e.TRANSITION_TO_MARKET_SUPPORT="transition_to_market_support",e.OPEN_ORDER_INFO="open_order_info",e.ADD_TRACK_CODE="add_track_code",e.ADD_INTERNAL_COMMENT="add_internal_comment",e.CHANGE_ORDER_STATUS="change_order_status",e.OPEN_CHAT_WITH_CUSTOMER="open_chat_with_customer",e.SEND_MESSAGE_TO_CUSTOMER="send_message_to_customer",e.OPEN_ORDER_HISTORY="open_order_history",e.FILTER_ORDERS_BY_STATUS="filter_orders_by_status",e.EXPORT_ORDERS_DATA="export_orders_data"}(r||(r={}))},71014:function(e,t,n){"use strict";n.d(t,{marketDebug:function(){return l},marketItemIdToObject:function(){return c},albumLinkToObject:function(){return d},parseBookmarkedProductClass:function(){return u},isElementVisible:function(){return _},isElementInViewport:function(){return p}});var o=n(30104),a=n(19331),i=n(22683),r="extended_client_logging",s="market_extended_client_logging";function l(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];((0,a.partConfigEnabled)(r)||i.vkLocalStorage.getItem(s))&&("error"===e?console.error("[market "+t+"]: ",n):"warn"===e?console.warn("[market "+t+"]: ",n):"info"===e?console.info("[market "+t+"]: ",n):console.debug("[market "+t+"]: ",n))}function c(e,t){void 0===t&&(t="market");var n=new RegExp(t+"(-?[0-9]+)_([0-9]+)"),o=e.match(n);if(!o||o.length<3)return null;var a=o[1],i=o[2];return{id:a+"_"+i,ownerId:parseInt(a),itemId:parseInt(i)}}function d(e){var t=e.match(/market(\-?[0-9]+).+section=album_([0-9]+)/);if(!t||t.length<3)return null;var n=t[1],o=t[2];return{id:n+"_"+o,ownerId:parseInt(n),itemId:parseInt(o)}}function u(e){var t=e.match(/_([0-9]+)_(\-?[0-9]+)_4/);if(!t||t.length<3)return null;var n=t[1],o=t[2];return{id:o+"_"+n,ownerId:parseInt(o),itemId:parseInt(n)}}function _(e){var t;return"none"!==(null===(t=e.style)||void 0===t?void 0:t.display)}function p(e,t,n,a){void 0===t&&(t=50),void 0===n&&(n=null);var i=n?n.left:0,r=n?n.top:0,s=(0,o.getViewportSize)(),l=(0,o.getElementOffset)(e),c=(0,o.getElementSize)(e),d=c.width*t/100,u=c.height*t/100;if(a){if(a.width>s.width)return!1;if(a.height>s.height)return!1;s=a}return!(l.left+c.width<i+d)&&(!(l.left+d>s.width)&&(!(l.top+c.height<r+u)&&!(l.top+u>s.height)))}},83788:function(e,t,n){"use strict";n.d(t,{clickStat:function(){return i}});var o=n(79654),a=new o.ProductionStatCollector,i=new o.ClickStatCollector(a)},73762:function(e,t,n){"use strict";n.d(t,{setStatData:function(){return s},getUtmMarks:function(){return l},getStatCategoryId:function(){return c},getStatScreen:function(){return d},getStatOwnerId:function(){return u},getStatCity:function(){return _}});var o=n(79573),a=n(22683),i="market_stat_data";function r(){var e=a.vkSessionStorage.getItem(i);return e?JSON.parse(e):{}}function s(e){var t=r();a.vkSessionStorage.setItem(i,JSON.stringify((0,o.__assign)((0,o.__assign)({},t),e)))}var l=function(){var e=r();return{utm_source:e.utm_source,utm_medium:e.utm_medium,utm_campaign:e.utm_campaign,utm_campaign_id:e.utm_campaign_id,utm_content:e.utm_content}},c=function(){return r().category_id};function d(){return r().screen||window.cur.module}function u(){return r().ownerId||0}function _(){return r().city}},24530:function(e,t,n){"use strict";n.d(t,{AudioNetworkStatCollector:function(){return l},AudioNetworkType:function(){return s.AudioNetworkType},NetworkStatCollector:function(){return i},NetworkStatCollectorInstance:function(){return r}});var o=n(45582),a=n(71516),i=function(){function e(){}return e.prototype.logEvent=function(e){e.type&&e[e.type]?(0,a.saveNetworkStats)(e):(0,o.logError)(new Error("NetworkStatCollector: invalid event."))},e}(),r=new i,s=n(62148),l=function(){function e(e){this.networkStatCollector=e}return e.prototype.logEvent=function(e,t,n){var o,a=((o={network_type:t,network_effective_type:n,type:s.NetworkStatEventTypes.TYPE_NETWORK_AUDIO_ITEM})[s.NetworkStatEventTypes.TYPE_NETWORK_AUDIO_ITEM]=e,o);this.networkStatCollector.logEvent(a)},e}()}},function(e){"use strict";e.O(0,[4578,1777,4736,5456,5790,3898,5411,6855,6199,490,410,6444,7219,6429],(function(){return t=63527,e(e.s=t);var t}));e.O()}]);