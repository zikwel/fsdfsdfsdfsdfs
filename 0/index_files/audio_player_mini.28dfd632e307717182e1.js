(self.webpackChunkvk=self.webpackChunkvk||[]).push([[3517],{41898:function(e,t,i){"use strict";i.d(t,{AudioPlayerBase:function(){return d}});var a=i(2947),s=i(134),o=i(76567),n=i(49849),r=i(79957);class d extends a.Component{constructor(){super(),this.AUDIO_COOKIE="remixcurr_audio",this.AUDIO_COOKIE_OLD="remixmaudio",this.AUDIO_PLAYER_CLASS="vk_audio_player",this.STAT_KEY="mvk_audio_player",this.audio=window.audio,this.state=this.getState(),this.setState({expanded:!1}),this.audio.subscribe(s.events.PLAY,(()=>this.updateState())),this.audio.subscribe(s.events.PLAY_REQUESTED,(()=>this.updateState())),this.audio.subscribe(s.events.PAUSE,(()=>this.updateState())),this.audio.subscribe(s.events.SEEK,(()=>this.updateState())),this.audio.subscribe(s.events.PROGRESS,(()=>this.updateProgress())),this.audio.subscribe(s.events.STOP,(()=>this.updateState())),this.audio.subscribe(s.events.PLAYLIST_CHANGED,(()=>{this.audio.shuffled&&this.audio.shuffle(),this.audio.canRepeat||this.audio.repeat(),this.updateState()})),this.audio.subscribe(s.events.AD_READY,(()=>this.updateState())),this.audio.subscribe(s.events.AD_DEINITED,(()=>this.updateState())),this.audio.subscribe(s.events.AD_STARTED,(()=>this.updateState())),this.audio.subscribe(s.events.AD_COMPLETED,(()=>this.updateState())),window.page.onChange((()=>this.updateState()))}updateProgress(){var e=this.audio.getCurrentProgress(),t=this.audio.duration();this.setState({loaded:this.audio.loaded(),progress:e,listened:this.formatTime(e*t),remained:this.formatTime(-(t-e*t))})}updateState(){this.setState(this.getState())}getState(){var{title:e,subTitle:t,performer:i,mainArtists:a,featArtists:s,isExplicit:r,fullId:d,coverUrl_p:u,coverUrl_s:l}=this.audio.getCurrent()||{};(0,o.setCookie)(this.AUDIO_COOKIE,d,1),e?document.body.classList.add(this.AUDIO_PLAYER_CLASS):document.body.classList.remove(this.AUDIO_PLAYER_CLASS);var _=this.audio.getCurrentProgress(),h=this.audio.duration();return{title:(0,n.decodeHTMLEntities)(e||""),subtitle:(0,n.decodeHTMLEntities)(t||""),performer:(0,n.decodeHTMLEntities)(i||""),mainArtists:this.prepareArtists(a),featArtists:this.prepareArtists(s),cover:u||l||"",explicit:r||!1,loaded:this.audio.loaded(),progress:_,listened:this.formatTime(_*h),remained:this.formatTime(-(h-_*h)),playing:this.audio.isPlaying(),adsplaying:this.audio.isAdsPlaying(),canRepeat:this.audio.canRepeat,shuffled:this.audio.shuffled,show:!!e||this.audio.isAdsPlaying(),onPlay:()=>this.onPlay(),onPause:()=>this.onPause(),onPrev:()=>this.onPrev(),onNext:()=>this.onNext(),onClose:()=>this.onClose(),onShuffle:()=>this.onShuffle(),onDisableAds:()=>this.onDisableAds(),onRepeat:()=>this.onRepeat(),onMiniPlayerClick:()=>this.requestExpanded()}}prepareArtists(e){return e?e.map((e=>[e.id,(0,n.decodeHTMLEntities)(e.name)])):[]}onPlay(){(0,r.statlogsValueEvent)(this.STAT_KEY,"play",this.state.expanded),this.audio.play()}onPause(){(0,r.statlogsValueEvent)(this.STAT_KEY,"pause",this.state.expanded),this.audio.pause()}onClose(){(0,r.statlogsValueEvent)(this.STAT_KEY,"close",this.state.expanded),this.audio.clearCurrentPlaylist(),requestAnimationFrame((()=>{(0,o.setCookie)(this.AUDIO_COOKIE,"",-1),(0,o.setCookie)(this.AUDIO_COOKIE_OLD,"",-1),this.setState({title:"",subtitle:"",performer:"",explicit:!1,progress:0,playing:!1,adsplaying:!1,show:!1,expanded:!1}),document.body.classList.remove(this.AUDIO_PLAYER_CLASS)}))}onPrev(){this.audio.isAdsPlaying()||((0,r.statlogsValueEvent)(this.STAT_KEY,"prev",this.state.expanded),this.audio.prev(!0))}onNext(){this.audio.isAdsPlaying()||((0,r.statlogsValueEvent)(this.STAT_KEY,"next",this.state.expanded),this.audio.next(!0))}onShuffle(){this.audio.isAdsPlaying()||((0,r.statlogsValueEvent)(this.STAT_KEY,"shuffle",this.state.expanded),this.audio.shuffle(),this.updateState())}onDisableAds(){(0,r.statlogsValueEvent)(this.STAT_KEY,"disable_ads",this.state.expanded),this.audio.pause(),nav.go("/combo")}onRepeat(){this.audio.isAdsPlaying()||((0,r.statlogsValueEvent)(this.STAT_KEY,"repeat",this.state.expanded),this.audio.repeat(),this.updateState())}requestExpanded(){window.audio.notify(s.events.REQUEST_EXPANDED)}formatTime(e){var t=Math.abs(e);return(e<0?"-":"")+[Math.floor(t/3600),Math.floor(t/60)%60,Math.floor(t%60)].map((e=>e<10?"0"+e:e)).filter(((e,t)=>"00"!==e||t>0)).join(":")}}},65496:function(e,t,i){"use strict";var a=i(85863),s=i(39871),o=i(64485),n=i(62641),r=i(52822),d=i(67332),u=i(85073),l=i(63414),_=i(23739);var h=function(e){var t=e.show,i=e.adsplaying,a=i?(0,n.getLang)("mobile_audio_player_ad"):e.title,s=i?"":e.subtitle,h=i?"":e.performer,p=e.explicit,A=e.playing,E=e.onPlay,c=e.onPause,S=e.onNext,P=e.onMiniPlayerClick;if(!t)return"";var g=o.default.class("AudioPlayerMini__controls",{playing:A}),f=a?{inner:[a],class:"AudioPlayerMini__title",tag:"span"}:"",y=s?{inner:[s],class:"AudioPlayerMini__subtitle",tag:"span"}:"",D=!i&&p?{inner:[(0,r.default)({icon:(0,d.getExplicitGray13Icon)()})],class:"AudioPlayerMini__explicit",tag:"span"}:"",v=A?"AudioPlayerMini__pause":"AudioPlayerMini__play",T=A?(0,l.getPauseBlue24Icon)():(0,_.getPlayBlue24Icon)(),L=A?c:E,b=A?(0,n.getLang)("mobile_audio_player_pause"):(0,n.getLang)("mobile_audio_player_play");return{inner:[{inner:[{inner:[(0,r.default)({icon:T})],class:v,onClick:L,"aria-label":b,tag:"button"}],class:g,tag:"div"},{inner:[{inner:[f,y,D],class:"AudioPlayerMini__info1",tag:"div"},{inner:[{inner:[h],class:"AudioPlayerMini__performer",tag:"span"}],class:"AudioPlayerMini__info2",tag:"div"}],class:"AudioPlayerMini__info",role:"button",tabindex:"0","aria-label":h+" - "+a+" "+s,onClick:P,tag:"div"},{inner:[{inner:[(0,r.default)({icon:(0,u.getNextBlue28Icon)()})],class:"AudioPlayerMini__next",onClick:S,"aria-label":(0,n.getLang)("mobile_audio_player_next"),disabled:i,tag:"button"}],class:"AudioPlayerMini__controls",tag:"div"}],class:"AudioPlayerMini__container",tag:"div"}},p=i(41898);class A extends p.AudioPlayerBase{render(){return s.default.preact(h,(0,a.default)({},this.state))}}var E=A,c=i(2947),S=i(45582);function P(){if(!window.audio||!window.audioplayer){var e="Can't init AudioPlayerMini. Audio not loaded yet.";return console.error(e),void(0,S.logError)(new Error(e))}var t=$$(".AudioPlayerMini");t&&0!==t.length&&t.forEach((e=>(0,c.render)((0,c.createElement)(E,(0,n.getState)("AudioPlayerMini")),e)))}(0,i(41313).onServerEvent)("AudioPlayerMini/init").watch((()=>{P(),window.page&&window.page.onChange(P)}))},134:function(e,t,i){"use strict";i.d(t,{events:function(){return a}});var a={CURRENT_CHANGED:"curr",PLAY:"start",PLAY_REQUESTED:"request_play",PAUSE:"pause",STOP:"stop",UPDATE:"update",LOADED:"loaded",ENDED:"ended",FAILED:"failed",BUFFERED:"buffered",PROGRESS:"progress",VOLUME:"volume",PLAYLIST_CHANGED:"plchange",ADDED:"added",REMOVED:"removed",FREQ_UPDATE:"freq",SEEK:"seek",PLAY_NEXT:"play_next",AD_READY:"ad_ready",AD_DEINITED:"ad_deinit",AD_STARTED:"ad_started",AD_COMPLETED:"ad_completed",START_LOADING:"start_load",CAN_PLAY:"actual_start",SELECT:"select",DESELECT:"deselect",EMPTY_PLAYLIST:"empty_playlist",NOT_FOUND_PLAYLIST:"not_found_playlist",INIT:"init",REQUEST_EXPANDED:"request_expanded",MUSIC_AUDIOS_ADD:"music_audios_add",MUSIC_AUDIOS_DELETE:"music_audios_delete",MUSIC_PLAYLISTS_ADD:"music_playlists_add",MUSIC_OWNERS_FOLLOW:"music_owners_follow",MUSIC_OWNERS_UNFOLLOW:"music_owners_unfollow",CURATOR_FOLLOW:"curator_follow",CURATOR_UNFOLLOW:"curator_unfollow",PLACEHOLDER_REMOVE:"placeholder_remove"}}},function(e){"use strict";e.O(0,[4578,1777,4736,5456,5790,3898,5411,6855,6199,490,410,6444,8592,7219,6429],(function(){return t=65496,e(e.s=t);var t}));e.O()}]);