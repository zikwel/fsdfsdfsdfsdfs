(self.webpackChunkvk=self.webpackChunkvk||[]).push([[410],{95283:function(e,t,n){"use strict";n.d(t,{decodeHTMLEntities:function(){return r}});n(98884);var o=n(49849),i=o.symbols;o.encodeHTMLEntities,o.escape;function r(e){return i.reduce(((e,t)=>{var[n,o]=t;return e.replace(new RegExp(n,"ig"),o)}),e).replace(/&#(\d+);/g,((e,t)=>String.fromCodePoint(t)))}},60201:function(e,t,n){"use strict";n.d(t,{createReactInitiator:function(){return l},createReactContainer:function(){return d},getReactContainer:function(){return f},removeReactContainer:function(){return _},showComponent:function(){return h}});n(91896);var o=n(93176),i=n(71437),r=n(20848),s=n(62641),u=(n(82917),n(18226)),a=n(45582),c={environment:"react"};function l(e,t,n){var i;function r(){return i=(0,s.isJSFunction)(t)?t()||i:t,document.body.contains(i)&&i||null}var l=(0,s.getRandomId)(),d=!1,f=null,_=function(){if(d){d=!1;var e=((0,s.isJSFunction)(t)?t():null)||r()||f;if(e){if(!(o.unmountComponentAtNode(e)||f&&o.unmountComponentAtNode(f))){var u="Failed to unmount react node";console.error(u),(0,a.logError)(new Error(u),c)}}else{u="Can't find react DOM node to deactivate it.";console.error(u),(0,a.logError)(new Error(u),c)}i=null,l="",null==n||n(),f=null}};return{activate:function(t){if(!d){if(d=!0,!(0,s.isJSFunction)(e))return f=r(),o.render(e,f),void(0,u.onElementRemove)(f,(function(){return _()}));if(t){var n=l;e(t).then((function(e){l===n&&(f=r(),o.render(e,f),(0,u.onElementRemove)(f,(function(){return _()})))}))}}},deactivate:_}}function d(e){var t="rc_"+e,n=document.createElement("div");return n.id=t,document.body.appendChild(n),n}function f(e){var t="rc_"+e;return document.getElementById(t)||d(e)}function _(e){var t="rc_"+e,n=(0,i.$)("#"+t);!function(e){var t="rc_"+e,n=(0,i.$)("#"+t);try{o.unmountComponentAtNode(n)}catch(e){}}(e),(0,r.remove)(n)}function h(e){var t=d((0,r.srand)()),n=function(){},o=l(e((function(){return n()})),t);return n=function(){o.deactivate(),(0,r.remove)(t)},o.activate(),o.deactivate}},85221:function(e,t,n){"use strict";n.d(t,{onInteractionMethodChange:function(){return i},initInteractionMethodListener:function(){return s},getLastInteractionMethod:function(){return a}});var o=n(72864),i=(0,o.createEvent)("onInteractionMethodChange"),r=(0,o.createStore)("coarse").on(i,(function(e,t){return t}));function s(){window.clog("[UserInteraction] init"),"matchMedia"in window?(window.matchMedia("(pointer: coarse)").addEventListener("change",(function(e){e.matches&&i("coarse")})),window.matchMedia("(pointer: fine)").addEventListener("change",(function(e){e.matches&&i("fine")}))):u()}function u(){document.addEventListener("mouseenter",(function e(){i("fine"),document.removeEventListener("mouseenter",e,{capture:!0}),function(){function e(t){var n;(null===(n=t.sourceCapabilities)||void 0===n?void 0:n.firesTouchEvents)||(i("coarse"),document.removeEventListener("touchstart",e,{capture:!0}),u())}document.addEventListener("touchstart",e,{passive:!0,capture:!0})}()}),{passive:!0,capture:!0})}function a(){return r.getState()}r.watch((function(e){window.clog("[UserInteraction] Last interaction method changed to "+e)}))},82917:function(e,t,n){"use strict";n.d(t,{StandaloneModalRoot:function(){return u}});var o=n(79573),i=n(91896),r=n(34158),s=n(85438),u=function(e){var t=e.modal,n=e.popout,u=e.children,a=e.shouldLockBodyScroll;return(0,i.jsx)(r.VKUIAppWrapper,(0,o.__assign)({shouldLockBodyScroll:a},{children:(0,i.jsx)("div",(0,o.__assign)({className:"StandaloneModalRoot"},{children:(0,i.jsx)(s.AppRoot,(0,o.__assign)({mode:"embedded",noLegacyClasses:!0,style:{backgroundColor:"transparent"}},{children:(0,i.jsx)(s.SplitLayout,{modal:u||t,popout:n},void 0)}),void 0)}),void 0)}),void 0)}},34158:function(e,t,n){"use strict";n.d(t,{VKUIAppWrapper:function(){return f}});var o,i=n(79573),r=n(91896),s=n(56769),u=n(85438),a=n(85221),c=n(20848),l=n(90616),d=((o={})[u.ViewWidth.DESKTOP]=1024,o[u.ViewWidth.TABLET]=882,o[u.ViewWidth.SMALL_TABLET]=620,o[u.ViewWidth.MOBILE]=320,o[u.ViewWidth.SMALL_MOBILE]=180,o);var f=function(e){var t,n=(0,i.__read)((0,s.useState)("fine"===(0,a.getLastInteractionMethod)()),2),o=n[0],f=n[1],_=(0,i.__read)((0,s.useState)((0,c.getCw)()),2),h=_[0],p=_[1],g=(0,s.useRef)(null);return(0,s.useEffect)((function(){var t=function(){p((0,c.getCw)())};return window.addEventListener("resize",t),e.shouldLockBodyScroll&&(null==g?void 0:g.current)&&(0,l.disableBodyScroll)(g.current),function(){window.removeEventListener("resize",t),e.shouldLockBodyScroll&&(0,l.enableBodyScroll)()}}),[]),(0,s.useEffect)((function(){var e=a.onInteractionMethodChange.watch((function(e){f("fine"===e)}));return function(){e()}}),[]),(0,r.jsx)(u.AdaptivityProvider,(0,i.__assign)({hasMouse:o,viewWidth:(t=h,t>=d[u.ViewWidth.DESKTOP]?u.ViewWidth.DESKTOP:t>=d[u.ViewWidth.TABLET]?u.ViewWidth.TABLET:t>=d[u.ViewWidth.SMALL_TABLET]?u.ViewWidth.SMALL_TABLET:t>=d[u.ViewWidth.MOBILE]?u.ViewWidth.MOBILE:u.ViewWidth.SMALL_MOBILE)},{children:(0,r.jsx)(u.ConfigProvider,(0,i.__assign)({isWebView:!0,scheme:"inherit",platform:u.Platform.ANDROID,transitionMotionEnabled:!1,webviewType:u.WebviewType.INTERNAL},{children:(0,r.jsx)("div",(0,i.__assign)({className:"VKUIAppWrapper",ref:g},{children:e.partial?(0,r.jsx)(u.AppRoot,(0,i.__assign)({mode:"partial",noLegacyClasses:!0},{children:e.children}),void 0):e.children}),void 0)}),void 0)}),void 0)}},4992:function(e,t,n){"use strict";n.d(t,{$additionalParams:function(){return Ae},$authors:function(){return ve},$deletedQuestions:function(){return he},$deletedQuestionsCount:function(){return pe},$isLoading:function(){return ye},$ownerId:function(){return _e},$popout:function(){return Se},$questions:function(){return ge},$snackbar:function(){return we},$totalQuestionsCount:function(){return me},banAuthor:function(){return G},closeShowQuestionsBox:function(){return ne},copyAskRequestLink:function(){return J},deleteAllAuthorQuestions:function(){return H},deleteQuestion:function(){return D},loadQuestions:function(){return W},openAskRequestStoryPublisher:function(){return X},openAuthorProfile:function(){return Y},openQuestionActionsMenu:function(){return V},reportQuestion:function(){return $},restoreAllAuthorQuestions:function(){return j},restoreQuestion:function(){return F},setForceContentScroll:function(){return te},setQuestionAnsweredFx:function(){return de},setShowQuestionsBoxAdditionalParams:function(){return ee},setShowQuestionsBoxOwnerId:function(){return N},setShowQuestionsBoxParams:function(){return oe},unbanAuthor:function(){return K}});var o=n(79573),i=n(91896),r=n(72864),s=n(51888),u=n(20848),a=n(85438),c=n(62641),l=n(32609),d=n(64260),f=function(e){var t=e.onClose,n=e.toggleRef,r=e.question,s=e.author,f=(0,c.getLangReplace)((0,u.getLang)("mobile_profile_questions_open_profile"),{name:String(null==s?void 0:s.first_name_gen)}),_=r.is_anonymous?(0,u.getLang)("mobile_profile_questions_ban_profile"):(0,c.getLangReplace)((0,u.getLang)("mobile_profile_questions_ban_named_profile"),{name:String(null==s?void 0:s.first_name_gen)}),h=r.is_anonymous?(0,u.getLang)("mobile_profile_questions_unban_profile"):(0,c.getLangReplace)((0,u.getLang)("mobile_profile_questions_unban_named_profile"),{name:String(null==s?void 0:s.first_name_gen)}),p=r.is_author_blocked?h:_;return(0,i.jsxs)(a.ActionSheet,(0,o.__assign)({onClose:t,toggleRef:n},{children:[r.is_anonymous?null:(0,i.jsx)(a.ActionSheetItem,(0,o.__assign)({onClick:function(){return Y(r)},autoclose:!0},{children:f}),void 0),(0,i.jsx)(a.ActionSheetItem,(0,o.__assign)({onClick:function(){return function(e){$(e)}(r)},autoclose:!0},{children:(0,u.getLang)("mobile_profile_questions_report_question")}),void 0),(0,i.jsx)(a.ActionSheetItem,(0,o.__assign)({onClick:function(){return r.is_author_blocked?function(e){K(e),(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.unblock,{questionId:e.id,questionReceiverId:window.vk.id})}(r):function(e){G(e),(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.block,{questionId:e.id,questionReceiverId:window.vk.id})}(r)},autoclose:!0},{children:p}),void 0),(0,i.jsx)(a.ActionSheetItem,(0,o.__assign)({onClick:function(){return function(e){D(e),(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.delete,{questionId:e.id,questionReceiverId:window.vk.id})}(r)},autoclose:!0,mode:"destructive"},{children:(0,u.getLang)("mobile_profile_questions_delete_question")}),void 0)]}),void 0)},_=function(e){return e.reduce((function(e,t){return e[t.id]=t,e}),{})},h=n(74930),p=n(31927),g=n(73283),v=n(62370),m=n(89746),E=136,y=144,T="VK Sans Display, SF Pro Text, sans-serif",S="600",w="#000",A="#fff",I=48,b=64,k=40,x=72,L=72,R=function(e){function t(t){var n=e.call(this)||this;return n.props=t,n}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this;return new Promise((function(t){e.draw(),t(1)}))},t.prototype.draw=function(){var e=new m.TextItem({text:this.props.text,fontSize:E,lineHeight:y,fontFamily:T,fontWeight:S,color:w,fillColor:A,fillRadius:I,padding:{top:b,bottom:k,left:x,right:L}});this.add(e),this.setWidth(e.getWidth()),this.setHeight(e.getHeight()),this.drawScene()},t}(v.Sticker),C=n(69410),Q=function(e){function t(t){var n=e.call(this)||this;return n.props=t,n}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this;return new Promise((function(t,n){e.loadImages({photo:e.props.photoUrl}).then((function(){e.draw(),t(1)})).catch((function(e){n(e)}))}))},t.prototype.draw=function(){var e=this.props,t=e.size,n=e.borderSize,o=void 0===n?0:n,i=e.borderColor,r=void 0===i?"":i,s=4*t,u=4*o,a=new C.ImageItem({image:this.getImage("photo"),width:s,height:s,radius:s/2,borderSize:u,borderColor:r});this.add(a),this.setWidth(a.getWidth()),this.setHeight(a.getHeight()),this.drawScene()},t}(v.Sticker),q=n(61540),P=function(){var e=document.createElement("canvas");e.width=1080,e.height=1920;var t,n,o=e.getContext("2d"),i="",r="";return new Promise((function(e,t){window.ajax.post("stories.php",{act:"get_profile_question_ask_request_story_data"},{onDone:e,onError:t,onFail:t})})).then((function(o){var s,u=o.backgrounds,a=o.stickerText,c=o.avatarUrl;if(i=o.getStoryUploadUrlHash,r=o.saveStoryHash,t=new Q({photoUrl:c,size:.41*e.width/4,borderSize:4,borderColor:"#fff"}),n=new R({text:a}),null==u?void 0:u.length){var l=String(null===(s=u[Math.round(Math.random()*u.length-1)])||void 0===s?void 0:s.url);return(0,p.loadImage)(l).catch((function(e){return console.error(e),Promise.resolve()}))}})).then((function(e){return e&&(null==o||o.drawImage(e,0,0)),Promise.all([t.render(),n.render()])})).then((function(){var i=.075*e.width,r=t.getWidth(),s=t.getHeight(),u=n.getWidth(),a=n.getHeight(),c=Math.min(u,.76*e.width)/u,l=u*c,d=a*c;return null==o||o.drawImage(t.getCanvas(),i,.17*e.height,r,s),null==o||o.drawImage(n.getCanvas(),i,.63*e.height,l,d),e.toDataURL("image/jpeg",1)})).then((function(e){return new Promise((function(t,n){var o,s;null===(o=window.StoryPublisher)||void 0===o||o.init({entrypoint:"profile_question",questionId:-1,src:e,background_type:g.StoryPublisherBackgroundType.IMAGE,storyUploadUrlHash:i,storySaveHash:r,closeAfterError:!0,attachment:{type:"url",text:"questions",url:"https://"+(0,q.getHostName)()+"/question/ask"+(null===(s=window.vk)||void 0===s?void 0:s.id)}},(function(){}),(function(e,o){e?t({isPublished:e,isEscaped:!1,story:null==o?void 0:o.story}):o?n(o):t({isPublished:!1,isEscaped:!0})}))}))}))},O=n(53271),M=(0,r.createDomain)("MvkShowQuestionsModal"),N=M.createEvent(),W=M.createEvent(),U=M.createEvent(),D=M.createEvent(),F=M.createEvent(),V=M.createEvent(),B=M.createEvent(),H=M.createEvent(),j=M.createEvent(),Y=(M.createEvent(),M.createEvent(),M.createEvent()),G=M.createEvent(),K=M.createEvent(),$=M.createEvent(),z=M.createEvent(),X=M.createEvent(),J=M.createEvent(),Z=M.createEvent(),ee=M.createEvent(),te=M.createEvent(),ne=M.createEvent(),oe=M.createEvent();Y.watch((function(e){(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.openProfile,{questionId:e.id,questionReceiverId:window.vk.id}),window.nav.hard_go("/id"+e.user_id_from+"?from=question")})),X.watch((function(){P().then((function(e){var t=e.isPublished,n=e.story;t&&z((0,i.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,action:(0,u.getLang)("mobile_profile_questions_show_story"),before:null,onActionClick:function(){return(0,h.showStoryWithAnswer)(n.owner_id,n.id)}},{children:(0,u.getLang)("mobile_profile_questions_success_shared_to_story")}),void 0))})).catch(console.error)})),J.watch((function(){(0,O.copyToClipboard)("https://"+(0,q.getHostName)()+"/question/ask"+window.vk.id),(0,l.logQuestionsClickEvent)(d.QuestionAnalyticEventType.copyLink,{questionReceiverId:window.vk.id}),z((0,i.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,before:null},{children:(0,u.getLang)("mobile_profile_questions_share_success_copy_url")}),void 0))}));var ie=M.createEffect((function(e){var t=e.question,n=e.questions;return(0,s.banUser)(t.id).then((function(){var e=0,r=!1;n.forEach((function(t){t.user_id_from==t.user_id_from&&e++,e>1&&(r=!0)}));var s=(0,u.getLang)("mobile_profile_questions_delete_question_label"),c=(0,u.getLang)("mobile_profile_questions_delete_author_question");t.is_anonymous?r=!1:r&&(s=(0,u.getLang)("mobile_profile_questions_delete_questions_label"),c=(0,u.getLang)("mobile_profile_questions_delete_author_questions")),z((0,i.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,action:s,before:null,onActionClick:function(){return r?H(t):D(t)}},{children:c}),void 0))}))})),re=M.createEffect((function(e){return(0,s.reportQuestion)(e.id).then((function(){z((0,i.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,before:null},{children:(0,u.getLang)("mobile_profile_questions_report_sended")}),void 0))}))})),se=M.createEffect((function(e){return(0,s.deleteFromAuthor)(e.id)})),ue=M.createEffect((function(e){return(0,s.restoreAuthorQuestions)(e.id)})),ae=M.createEffect((function(e){return(0,s.deleteQuestion)(e.id)})),ce=M.createEffect((function(e){var t=e.startFrom,n=e.isReload;return(0,s.getQuestions)(n?"":t).then((function(e){return{response:e,isReload:n}}))})),le=M.createEffect((function(e){return(0,s.restoreQuestion)(e.id)})),de=M.createEffect((function(e){var t=e.question,n=e.story;return(0,s.getQuestion)(t.id).then((function(e){return e.question?(z((0,i.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,action:(0,u.getLang)("mobile_profile_questions_show_story"),before:null,onActionClick:function(){return(0,h.showStoryWithAnswer)(null==n?void 0:n.owner_id,null==n?void 0:n.id)}},{children:(0,u.getLang)("mobile_profile_questions_success_answered")}),void 0)),e):Promise.reject()}))})),fe=M.createEffect((function(e){return(0,s.unbanUser)(e.id).then((function(){z((0,i.jsx)(a.Snackbar,(0,o.__assign)({layout:"vertical",onClose:function(){return z(null)},duration:5e3,before:null},{children:(0,u.getLang)("mobile_profile_questions_author_unblocked")}),void 0))}))})),_e=M.createStore(null).reset(ne),he=M.createStore({}),pe=M.createStore(0),ge=M.createStore([]),ve=M.createStore({}),me=M.createStore(0),Ee=M.createStore(""),ye=(0,r.combine)({isLoadingQuestions:ce.pending,isDeleteAllAuthorQuestions:se.pending,isRestoreAllAuthorQuestions:ue.pending},(function(e){var t=e.isLoadingQuestions,n=e.isDeleteAllAuthorQuestions,o=e.isRestoreAllAuthorQuestions;return t||n||o})),Te=(0,r.combine)(ge,me,(function(e,t){return e.length>=t})),Se=M.createStore(null),we=M.createStore(null),Ae=M.createStore({}).reset(ne),Ie=M.createStore((function(){}));Z.watch((function(e){return null==e?void 0:e()})),Ie.on(te,(function(e,t){return t})),Ae.on(ee,(function(e,t){return t})),ge.on(ce.doneData,(function(e,t){var n=t.response;return t.isReload?n.items:function(e){var t={};return e.filter((function(e){return!t[e.id]&&(t[e.id]=!0,!0)}))}((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e),!1),(0,o.__read)(n.items),!1))})).on(G,(function(e,t){return e.map((function(e){return e.user_id_from===t.user_id_from&&(e.is_author_blocked=!0),e}))})).on(K,(function(e,t){return e.map((function(e){return e.user_id_from===t.user_id_from&&(e.is_author_blocked=!1),e}))})).on(de.doneData,(function(e,t){return e.map((function(e){return e.id===t.question.id?t.question:e}))})).on(H,(function(){return[]})).on(j,(function(){return[]})),ve.on(ce.doneData,(function(e,t){var n=t.response,i=_(n.profiles);return(0,o.__assign)((0,o.__assign)({},e),i)})).on(de.doneData,(function(e,t){var n=_(t.profiles);return(0,o.__assign)((0,o.__assign)({},e),n)})),me.on(ce.doneData,(function(e,t){return t.response.count||0})).on(D,(function(e){return e-1})).on(F,(function(e){return e+1})),Ee.on(ce.doneData,(function(e,t){return t.response.next_from})),pe.on(D,(function(e){return e+1})).on(F,(function(e){return e-1})),he.on(D,(function(e,t){var n,o,i,r=(0,h.getQuestionAuthorVirtualId)(t);return Object.assign({},e,((n={})[r]=Object.assign({},e[r],((o={})[t.id]=!0,o.count=((null===(i=e[r])||void 0===i?void 0:i.count)||0)+1,o.lastDeleteTrigger=t,o)),n))})).on(F,(function(e,t){var n,o,i,r=(0,h.getQuestionAuthorVirtualId)(t);return Object.assign({},e,((n={})[r]=Object.assign({},e[r],((o={})[t.id]=!1,o.count=((null===(i=e[r])||void 0===i?void 0:i.count)||0)-1,o)),n))})).on(H,(function(e,t){var n,o=(0,h.getQuestionAuthorVirtualId)(t);return Object.assign({},e,((n={})[o]=Object.assign({},e[o],{deleteAllTrigger:t}),n))})).on(j,(function(e,t){var n,o=(0,h.getQuestionAuthorVirtualId)(t);return Object.assign({},e,((n={})[o]=Object.assign({},e[o],{deleteAllTrigger:void 0}),n))})).on(ce.doneData,(function(e,t){if(t.isReload)return(0,h.getCleanedDeletedAuthorsTriggers)(e)})),_e.on(N,(function(e,t){return t})),Se.on(V,(function(e,t){var n=t.event,o=t.question,r=t.author;return(0,i.jsx)(f,{onClose:B,toggleRef:n.currentTarget,question:o,author:r},void 0)})).reset(B),we.on(z,(function(e,t){return t})),(0,r.sample)({clock:ue.done,target:U}),(0,r.sample)({clock:se.done,target:U}),(0,r.sample)({clock:_e,target:U}),(0,r.sample)({clock:U,fn:function(){return{isReload:!0}},target:W}),(0,r.sample)({clock:[ae.done,le.done],source:Ie,target:Z}),(0,r.guard)({clock:D,filter:ae.pending.map((function(e){return!e})),target:ae}),(0,r.guard)({clock:F,filter:le.pending.map((function(e){return!e})),target:le}),(0,r.guard)({clock:H,filter:se.pending.map((function(e){return!e})),target:se}),(0,r.guard)({clock:j,filter:ue.pending.map((function(e){return!e})),target:ue}),(0,r.guard)({clock:W,filter:function(e,t){void 0===t&&(t={});var n=t.isReload,o=e.isLoading,i=e.isAllLoaded;return!!n||!o&&!i},source:{startFrom:Ee,isLoading:ye,isAllLoaded:Te,isReload:(0,r.restore)(W.map((function(e){return null==e?void 0:e.isReload})),!1)},target:ce}),(0,r.sample)({clock:G,fn:function(e,t){return{question:t,questions:e}},source:ge,target:ie}),(0,r.guard)({clock:K,filter:fe.pending.map((function(e){return!e})),target:fe}),(0,r.guard)({clock:$,filter:re.pending.map((function(e){return!e})),target:re})},74930:function(e,t,n){"use strict";n.d(t,{getQuestionAuthorVirtualId:function(){return u},getRestoreDeletedAuthorsTriggers:function(){return a},getCleanedDeletedAuthorsTriggers:function(){return c},updateQuestionInputHeight:function(){return l},onQuestionContentChange:function(){return d},showStoryWithAnswer:function(){return f}});var o=n(79573),i=n(98966),r=n(41319),s=n(34757),u=function(e){return e.is_anonymous?-1:Number(null==e?void 0:e.user_id_from)},a=function(e){var t,n,i={restoreAuthorTriggers:[]};if(!e)return i;try{for(var r=(0,o.__values)(Object.entries(e)),s=r.next();!s.done;s=r.next()){var u=(0,o.__read)(s.value,2),a=u[0],c=u[1];c.deleteAllTrigger&&(-1===Number(a)?i.restoreAnonymousTrigger=c.deleteAllTrigger:i.restoreAuthorTriggers.push(c.deleteAllTrigger))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return i},c=function(e){var t,n,i={};if(!e)return i;try{for(var r=(0,o.__values)(Object.entries(e)),s=r.next();!s.done;s=r.next()){var u=(0,o.__read)(s.value,2),a=u[0],c=u[1];i[a]={deleteAllTrigger:c.deleteAllTrigger}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return i},l=function(e){e&&(e.style.height="auto",requestAnimationFrame((function(){var t=e.scrollHeight;e.style.height=t+"px"})))},d=function(e,t){var n=e.target.value,o=(n=n.replace(/(\n|\s){2,}/g,"$1")).split("\n");o.length>i.QUESTION_MAX_NEW_LINES&&(n=o.reduce((function(e,t,n){return n<i.QUESTION_MAX_NEW_LINES-1?e+=t+"\n":e+=t+" ",e}),"")),null==t||t(n.slice(0,i.QUESTION_MAX_LENGTH)),l(e.target)},f=function(e,t){(0,s.addStatic)(["stories.js"]).then((function(){window.Stories.init(e+"/"+e+"_"+t,{source:r.StorySource.MY_QUESTIONS})}))}},73283:function(e,t,n){"use strict";var o;n.d(t,{StoryPublisherBackgroundType:function(){return o}}),function(e){e.IMAGE="image",e.VIDEO="video"}(o||(o={}))},53271:function(e,t,n){"use strict";function o(e){return navigator.clipboard?function(e){return navigator.clipboard.writeText(e)}(e):(function(e){var t=document.createElement("input"),n=document.activeElement;t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),n.focus()}(e),Promise.resolve())}n.d(t,{copyToClipboard:function(){return o}})},32609:function(e,t,n){"use strict";n.d(t,{logQuestionsClickEvent:function(){return c},logQuestionsOpeningEvent:function(){return l}});var o,i=n(79654),r=n(40517),s=n(19331),u=n(64260);!function(e){e.SNIPPET="snippet",e.URL="url",e.STORY="story"}(o||(o={}));var a=new(function(){function e(){this.productionStatCollector=new i.ProductionStatCollector,this.clickStatCollector=new i.ClickStatCollector(this.productionStatCollector)}return e.prototype.logClickEvent=function(e,t){var n;void 0===t&&(t={});var o=((n={type:r.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM})[r.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM]={type:e,screen:t.navScreen||window.cur.module||""},n);t.questionReceiverId&&(o[r.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_receiver_id=t.questionReceiverId),t.questionAuthorId&&(o[r.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_author_id=t.questionAuthorId),t.questionText&&(o[r.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_text=t.questionText);var i={type:r.EventItemType.QUESTION,id:t.questionId||0};(0,s.partConfigEnabled)("profile_questions_analytic_debug")&&console.log("--"+e,o,i),this.clickStatCollector.logEvent(o,i)},e.prototype.logOpeningEvent=function(e,t,n){var i;switch(t){case o.STORY:i=n===u.QuestionAnalyticBoxName.askQuestion?u.QuestionAnalyticEventType.openAskQuestionFromStory:u.QuestionAnalyticEventType.openMyQuestionsFromStory;break;case o.SNIPPET:i=n===u.QuestionAnalyticBoxName.askQuestion?u.QuestionAnalyticEventType.openAskQuestionFromSnippet:u.QuestionAnalyticEventType.openMyQuestionsFromSnippet;break;default:i=n===u.QuestionAnalyticBoxName.askQuestion?u.QuestionAnalyticEventType.openAskQuestionFromUrl:u.QuestionAnalyticEventType.openMyQuestionsFromUrl}var r={questionReceiverId:e};n===u.QuestionAnalyticBoxName.askQuestion&&(r.questionAuthorId=window.vk.id),this.logClickEvent(i,r)},e}());function c(e,t){void 0===t&&(t={}),a.logClickEvent(e,t)}function l(e,t,n){a.logOpeningEvent(e,t,n)}},64260:function(e,t,n){"use strict";n.d(t,{QuestionAnalyticEventType:function(){return o},QuestionAnalyticBoxName:function(){return i}});var o,i;n(40517);!function(e){e.clickToQuestion="click_to_question",e.reply="reply",e.replyAgain="reply_again",e.sharing="sharing",e.shareToStory="share_to_story",e.shareToWall="share_to_wall",e.shareToGroup="share_to_group",e.shareToIm="share_to_im",e.copyLink="copy_link",e.openStory="open_story",e.callFriends="call_friends",e.openSettings="open_settings",e.openProfile="open_profile",e.block="block",e.unblock="unblock",e.deleteAllQuestions="delete_all_questions",e.delete="delete",e.cancelDelete="cancel_delete",e.cancelDeleteAllAuthorQuestions="cancel_delete_all_author_questions",e.cancelDeleteAllAnonymousQuestions="cancel_delete_all_anonymous_questions",e.next="next",e.close="close",e.clickToSend="click_to_send",e.sendQuestion="send_question",e.cancelSendQuestion="cancel_send_question",e.cancelWriteAnswer="cancel_write_answer",e.closeMyQuestions="close_my_questions",e.openMyQuestionsFromUrl="open_my_questions_from_url",e.openAskQuestionFromUrl="open_ask_question_from_url",e.openMyQuestionsFromSnippet="open_my_questions_from_snippet",e.openAskQuestionFromSnippet="open_ask_question_from_snippet",e.openMyQuestionsFromStory="open_my_questions_from_story",e.openAskQuestionFromStory="open_ask_question_from_story"}(o||(o={})),function(e){e[e.askQuestion=0]="askQuestion",e[e.myQuestions=1]="myQuestions"}(i||(i={}))},41319:function(e,t,n){"use strict";var o,i,r,s,u;n.d(t,{StoryType:function(){return o},StoryEntryPoint:function(){return i},StorySource:function(){return r}}),function(e){e.PHOTO="photo",e.VIDEO="video",e.LIVE="live"}(o||(o={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar"}(i||(i={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="questions"}(r||(r={})),function(e){e.stories="stories",e.communityGroupedStories="community_grouped_stories",e.appGroupedStories="app_grouped_stories",e.discover="discover"}(s||(s={})),function(e){e.feed="feed",e.groups="groups",e.apps="apps",e.discover="discover"}(u||(u={}))},69410:function(e,t,n){"use strict";n.d(t,{ImageItem:function(){return i}});var o=n(79573),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.draw=function(e){var t=this.props,n=t.x,o=void 0===n?0:n,i=t.y,r=void 0===i?0:i,s=t.image,u=t.width,a=void 0===u?0:u,c=t.height,l=void 0===c?0:c,d=t.radius,f=void 0===d?0:d,_=t.borderSize,h=void 0===_?0:_,p=t.borderColor,g=void 0===p?"transparent":p,v=t.shadowBlur,m=void 0===v?0:v,E=t.shadowColor,y=void 0===E?"":E,T=Math.min(s.width,s.height),S=(s.width-T)/2,w=(s.height-T)/2;e.save(),e.lineWidth=h,e.strokeStyle=g,m&&y&&(e.shadowBlur=m,e.shadowColor=y,e.shadowOffsetX=1e4+o,e.shadowOffsetY=1e4+r,e.fillRect(-1e4,-1e4,a,a)),e.beginPath(),e.arc(o+f,r+f,f,Math.PI,Math.PI+Math.PI/2),e.lineTo(o+a-f,r),e.arc(o+a-f,r+f,f,Math.PI+Math.PI/2,2*Math.PI),e.lineTo(o+a,r+l-f),e.arc(o+a-f,r+l-f,f,2*Math.PI,Math.PI/2),e.lineTo(o+f,r+l),e.arc(o+f,r+l-f,f,Math.PI/2,Math.PI),e.closePath(),e.clip(),e.drawImage(s,S,w,T,T,o,r,a,l),e.stroke(),e.restore()},t.prototype.getWidth=function(){return this.props.width},t.prototype.setWidth=function(e){this.props.width=e},t.prototype.getHeight=function(){return this.props.height},t.prototype.setWeight=function(e){this.props.height=e},t}(n(76692).Shape)},76692:function(e,t,n){"use strict";n.d(t,{Shape:function(){return o}});var o=function(){function e(e){this.props=e}return e.prototype.getBoundingClientRect=function(){var e=this.props,t=e.x,n=void 0===t?0:t,o=e.y,i=void 0===o?0:o;return{width:this.getWidth(),height:this.getHeight(),top:i,left:n,right:n+this.getWidth(),bottom:i+this.getHeight()}},e.prototype.setX=function(e){this.props.x=e},e.prototype.setY=function(e){this.props.y=e},e}()},89746:function(e,t,n){"use strict";n.d(t,{TextItem:function(){return u}});var o,i=n(79573),r=n(76692),s=n(95283);!function(e){e.LEFT="LEFT",e.CENTER="CENTER"}(o||(o={}));var u=function(e){function t(t){var n=e.call(this,t)||this;return n.context=document.createElement("canvas").getContext("2d"),n.splitText=n.splitTextIntoLines(),n}return(0,i.__extends)(t,e),t.prototype.draw=function(e){var n=this,i=this.props,r=i.x,s=void 0===r?0:r,u=i.y,a=void 0===u?0:u,c=i.color,l=void 0===c?"#000":c,d=i.lineHeight,f=i.fillColor,_=i.fillRadius,h=void 0===_?0:_,p=i.align,g=void 0===p?o.LEFT:p,v=i.maxWidth,m=void 0===v?0:v,E=i.shadowBlur,y=i.shadowColor,T=i.maxLines,S=i.afterPadding,w=void 0===S?0:S;if(e.save(),this.setFont(e),e.fillStyle=l,e.textBaseline="top",e.textAlign="left",E&&y&&(e.shadowBlur=E,e.shadowColor=y),f){var A=this.getPadding(),I=0;this.splitText.forEach((function(i,r){var u=e.measureText(i).width;T&&r==n.splitText.length-1&&(u+=w);var a=s;g===o.CENTER&&(a=s+(m-u)/2);var c=0;c=0===r?A.top:A.top/2;var l=0;l=r===n.splitText.length-1?A.bottom:A.bottom/2;var _={tl:0,tr:0,bl:0,br:0};if(0===r)_.tl=h,_.tr=h,(p=e.measureText(n.splitText[r]).width)>(E=e.measureText(n.splitText[r+1]).width)&&(_.bl=0,_.br=h);else if(r===n.splitText.length-1){_.bl=h,_.br=h,(p=e.measureText(n.splitText[r]).width)>(v=e.measureText(n.splitText[r-1]).width)&&(_.tl=0,_.tr=h)}else{var p=e.measureText(n.splitText[r]).width,v=e.measureText(n.splitText[r-1]).width,E=e.measureText(n.splitText[r+1]).width;p>v&&(_.tl=0,_.tr=h),p>E&&(_.bl=0,_.br=h)}var y=d+c+l;t.drawFill(e,a,I,u+A.left+A.right,y,f,_),e.fillText(i,a+A.left,I+c),I+=y}))}else this.splitText.forEach((function(t,i){var r=e.measureText(t).width;T&&i==n.splitText.length-1&&(r+=w);var u=s;g===o.CENTER&&(u=s+(m-r)/2),e.fillText(t,u,a+d*i)}));e.restore()},t.drawFill=function(e,t,n,o,i,r,s){e.save(),e.beginPath(),e.fillStyle=r,e.lineWidth=0,e.strokeStyle="transparent",e.moveTo(t+s.tl,n),e.lineTo(t+o-s.tr,n),e.quadraticCurveTo(t+o,n,t+o,n+s.tr),e.lineTo(t+o,n+i-s.br),e.quadraticCurveTo(t+o,n+i,t+o-s.br,n+i),e.lineTo(t+s.bl,n+i),e.quadraticCurveTo(t,n+i,t,n+i-s.bl),e.lineTo(t,n+s.tl),e.quadraticCurveTo(t,n,t+s.tl,n),e.closePath(),e.stroke(),e.fill(),e.restore()},t.prototype.setFont=function(e){var t=this.props,n=t.fontSize,o=t.lineHeight,i=t.fontFamily,r=void 0===i?"sans-serif":i,s=t.fontWeight,u=void 0===s?"normal":s;e.font=u+" "+n+"px/"+o+"px "+r},t.prototype.splitLongWords=function(e){var t=this.context,n=this.props.maxWidth,o=void 0===n?0:n,r=[];return t&&o?(this.setFont(t),e.forEach((function(e){if("\n"!==e)if(t.measureText(e).width<=o)r.push(e);else{var n=Array.from(e).reduce((function(e,n){return t.measureText(e.current+n).width>o?{current:n,items:(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__read)(e.items),!1),[e.current],!1)}:{current:e.current+n,items:(0,i.__spreadArray)([],(0,i.__read)(e.items),!1)}}),{current:"",items:[]});r.push.apply(r,(0,i.__spreadArray)((0,i.__spreadArray)([],(0,i.__read)(n.items),!1),[n.current],!1))}else r.push(e)})),r):e},t.prototype.splitTextIntoLines=function(){var e=this.context,t=this.props,n=t.text,o=t.maxWidth,i=void 0===o?0:o,r=t.maxLines,u=void 0===r?0:r,a=t.afterPadding,c=void 0===a?0:a,l=String((0,s.decodeHTMLEntities)(n)).replace(/(?:<br\s*\/?>)+/gim,"\n");if(!e)return l.split(/\n/);if(i<=0)return l.split(/\n/);this.setFont(e);for(var d=this.splitLongWords(l.replaceAll("\n"," \n ").split(" ")),f=0,_=[],h=function(){if(u&&_.length>=u-1){var t=d.splice(0).join(" ");if(e.measureText(t).width+c<=i)_.push(t);else{var n=e.measureText("...").width,o=!1,r=Array.from(t).reduce((function(t,r){var s=e.measureText(t+r).width;return!o&&s+n+c<=i?t+r:(o=!0,t)}),"");_.push(r.trim()+"...")}}else{var s=f+1,a="\n"===d[f],l=d.slice(0,s).join(" "),h=e.measureText(l).width;if(s>=d.length&&(h+=c),h>i||s>d.length||a){var p=d.splice(0,a?s:s-1);_.push(p.join(" ")),f=0}else f++}};d.length;)h();return _},t.prototype.getWidth=function(){var e=this.getLinesWidth();return 0===e.length?0:Math.max.apply(Math,(0,i.__spreadArray)([],(0,i.__read)(e),!1))},t.prototype.getLinesWidth=function(){var e=this.context,t=this.props,n=t.maxLines,o=t.afterPadding,i=void 0===o?0:o;if(!e)return[];this.setFont(e);for(var r=this.getPadding(),s=[],u=0;u<this.splitText.length;u++){var a=e.measureText(this.splitText[u]).width;n&&u==this.splitText.length-1&&(a+=i),a+=r.left+r.right,s.push(Math.round(a))}return s},t.prototype.getHeight=function(){var e=this.getPadding(),t=this.props,n=t.fillColor,o=t.lineHeight;if(n){var i=this.splitText.length*o,r=(this.splitText.length-1)*(e.top+e.bottom)/2;return e.top+i+r+e.bottom}return this.splitText.length*(o+e.top+e.bottom)},t.prototype.getPadding=function(){var e=this.props.padding,t=void 0===e?0:e;return"number"==typeof t?{top:t,bottom:t,left:t,right:t}:t},t}(r.Shape)},62370:function(e,t,n){"use strict";n.d(t,{Sticker:function(){return r}});var o=n(79573),i=n(31927),r=function(){function e(){this.layers=[],this.images=[],this.width=0,this.height=0,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}return e.prototype.drawScene=function(){var e=this.ctx;e&&(this.canvas.width=this.getWidth(),this.canvas.height=this.getHeight(),e.clearRect(0,0,this.canvas.width,this.canvas.height),this.layers.forEach((function(t){t.draw(e)})))},e.prototype.add=function(e){this.layers.push(e)},e.prototype.getCanvas=function(){return this.canvas},e.prototype.toBlob=function(){var e=this;return new Promise((function(t,n){e.canvas.toBlob((function(e){e||n(),t(e)}),"image/png",1)}))},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.setWidth=function(e){this.width=e},e.prototype.setHeight=function(e){this.height=e},e.prototype.loadImages=function(e){var t=this;return new Promise((function(n,r){var s,u,a=[];try{for(var c=(0,o.__values)(Object.entries(e)),l=c.next();!l.done;l=c.next()){var d=(0,o.__read)(l.value,2),f=d[0],_=d[1];f&&_&&a.push((0,i.loadImage)(_,f))}}catch(e){s={error:e}}finally{try{l&&!l.done&&(u=c.return)&&u.call(c)}finally{if(s)throw s.error}}Promise.all(a).then((function(e){t.images=e,n(1)})).catch((function(e){r(e)}))}))},e.prototype.getIconUrl=function(e){return URL.createObjectURL(new Blob([e],{type:"image/svg+xml"}))},e.prototype.getImage=function(e){return this.images.find((function(t){return t.dataset.name===e}))},e}()},31927:function(e,t,n){"use strict";function o(e,t){return new Promise((function(n,o){var i=new Image;i.crossOrigin="Anonymous",t&&(i.dataset.name=t),i.onerror=function(){o(new Error("Failed to load image's URL: "+e))},i.onload=function(){n(i)},i.src=e}))}n.d(t,{loadImage:function(){return o}})},98966:function(e,t,n){"use strict";n.d(t,{QUESTION_MAX_LENGTH:function(){return o},QUESTION_MAX_NEW_LINES:function(){return i}});var o=80,i=3},51888:function(e,t,n){"use strict";n.d(t,{getQuestion:function(){return i},getQuestions:function(){return r},deleteQuestion:function(){return s},restoreQuestion:function(){return u},deleteFromAuthor:function(){return a},restoreAuthorQuestions:function(){return c},sendQuestion:function(){return l},getUsers:function(){return d},banUser:function(){return f},unbanUser:function(){return _},reportQuestion:function(){return h}});var o=n(89798);function i(e){return(0,o.api)("questions.getById",{owner_id:window.vk.id,question_id:e,extended:1,fields:"photo_50,photo_100,first_name_gen,last_name_gen,domain"})}function r(e,t){return void 0===e&&(e=""),void 0===t&&(t=15),(0,o.api)("questions.get",{owner_id:window.vk.id,start_from:e,limit:t,extended:1,fields:"photo_50,photo_100,first_name_gen,last_name_gen,domain"})}function s(e){return(0,o.api)("questions.delete",{owner_id:window.vk.id,question_id:e})}function u(e){return(0,o.api)("questions.restore",{owner_id:window.vk.id,question_id:e})}function a(e){return(0,o.api)("questions.deleteFromAuthor",{owner_id:window.vk.id,question_id:e})}function c(e){return(0,o.api)("questions.restoreFromAuthor",{owner_id:window.vk.id,question_id:e})}function l(e,t,n){return void 0===n&&(n=!1),(0,o.api)("questions.send",{owner_id:e,text:t,is_anonymous:n?1:0})}function d(e){return(0,o.api)("users.get",{user_ids:e.join(","),fields:"photo_50,photo_100,can_ask_anonymous,can_ask_question,first_name_nom,first_name_dat,first_name_gen,last_name_gen,sex"})}function f(e){return(0,o.api)("questions.authorBan",{owner_id:window.vk.id,question_id:e})}function _(e){return(0,o.api)("questions.authorUnBan",{owner_id:window.vk.id,question_id:e})}function h(e){return(0,o.api)("reports.add",{type:"profile_story_question",owner_id:window.vk.id,item_id:e})}}}]);