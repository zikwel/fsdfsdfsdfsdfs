(self.webpackChunkvk=self.webpackChunkvk||[]).push([[6444],{19774:function(e,t,n){"use strict";var i=n(85863),r=n(92540),a=n(4077),o=n.n(a),s=n(40906),l=100,c=101,u=102,d=103,_=105,h=106,p=107,f=108,v=109,m=110,g=112,w=113,b=[c,d,u,h,p,f,v,m],y="click_on_video",S="click_on_audio",E="click_on_photo",k="external_link_click",P="click_on_carousel_next",C="click_on_carousel_prev",A="click_on_mentions",I="night_mod_on",T="night_mod_off",x="close";function R(e,t,n){var i=[];if((0,s.each)(e,(function(e,t){n&&!["w","z","y","x","m","s"].includes(e)||i.push(t)})),!i.length)return[!1];i.sort((function(e,t){return e[1]-t[1]})),t*=window.devicePixelRatio>=2?2:1;var r=i[i.length-1];return(0,s.each)(i,(function(e,n){if(n[1]>=t)return r=n,!1})),r}var L={};function N(e,t){if((0,s.isObject)(t)&&!(0,s.isEmpty)(t)){var n="https://vk-callback.go.mail.ru/longread_pxl?action="+e;(0,s.each)(t,(function(e,t){n+="&"+e+"="+t})),(new Image).src=n}}function O(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t||location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function B(e){if(/^https?:\/\/([\w-]+\.)*(instagram\.com|instagr\.am)$/.test(e.origin)){var t=function(e){for(var t,n=document.getElementsByTagName("iframe"),i=n.length-1;i>=0;i--){var r=n[i];if(r.contentWindow===e.source){t=r;break}}return t}(e);if(t){try{e=JSON.parse(e.data)}catch(e){}"object"==typeof e&&"string"==typeof e.type&&"object"==typeof e.details&&setTimeout((function(){if("MEASURE"===e.type){var n=e.details.height;t.setAttribute("height",n)}}),100)}}}function M(e,t){var n=e.querySelector("[data-sizes]"),i=JSON.parse(n.getAttribute("data-sizes"));(n.getAttribute("data-media-links")||"").split(",");if(!(i.length<=1||e.getAttribute("data-carousel-inited"))){e.setAttribute("data-carousel-inited",1);var r="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;if(t.mobile&&r)return function(e,t,n){void 0===n&&(n={});var i=t.querySelector(".article_photo_carousel__controls"),r=t.querySelector(".article_photo_carousel__counter"),a=r.getAttribute("data-counter-lang")||getLang("global_article_carousel_counter"),o=getSize(t.querySelector(".article_figure_content")),l=t.querySelector(".article_photo_carousel_inner");t.querySelector(".article_photo_carousel__left").remove(),t.querySelector(".article_photo_carousel__right").remove();var c,u,d,_=n.onClick,h=0,p=0,f=!1,v=0,m=0,g=!1,w=!1;i.addEventListener("touchstart",(e=>{u=e.touches[0].pageX,c=e.touches[0].pageY,l.classList.add("--no_trans"),f=!0,clearTimeout(d)}));var b,y=!1;i.addEventListener("touchmove",(t=>{if(w||!(Math.abs(t.touches[0].pageY-c)>5||g)){if(p=t.touches[0].pageX-u,!(Math.abs(p)<10)||y){w||window.addEventListener("touchmove",b=e=>cancelEvent(e),{passive:!1}),w=!0,y=!0;var n=Math.min(e.length-1,Math.max(0,h+(p<0?1:-1))),i=0===n&&0===h,r=n===e.length-1&&h===e.length-1;v=n;var a=-h*o[0];a+=i||r?.2*p:p,l.style.transform="translateX("+a+"px)"}}else g=!0})),i.addEventListener("touchend",(()=>{y=!1,g=!1,w=!1,m=h,l.classList.remove("--no_trans"),b&&window.removeEventListener("touchmove",b),Math.abs(p)<50||(h=v),E(0,!1,v,!0)})),window.addEventListener("resize",S),window.cur&&window.cur.destroy&&window.cur.destroy.push((()=>{window.removeEventListener("resize",S)}));function S(){o=getSize(t.querySelector(".article_figure_content")),E(0,!1,h,!1,!1)}function E(n,i,c,u,p){if(void 0===u&&(u=!1),void 0===p&&(p=!0),!i||!f){if(f=!0,i)return l.style.transform="translateX(-50px)",void(d=setTimeout((()=>{l.style.transform="translateX(0px)"}),700));clearTimeout(d),h=void 0===h?Math.min(e.length-1,Math.max(0,h+n)):c,u&&(0,s.isFunction)(_)&&m!==h&&_(m<h?P:C),t.setAttribute("data-photo-carousel-index",h),j(h,t),r.innerHTML=a.replace("{counter}",h+1).replace("{total}",e.length),p||l.classList.add("--no_trans"),l.style.transform="translateX(-"+h*o[0]+"px)",p||(l.offsetWidth,l.classList.remove("--no_trans"))}}return function(e,t,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=!0),t||(v=n),m=h,E(e,t,n,i,r)}}(i,e,t);var a=function(e,t,n,i){var r,a=0,o=t.querySelector(".article_photo_carousel__controls"),s=t.querySelector(".article_photo_carousel__counter"),l=s.getAttribute("data-counter-lang")||getLang("global_article_carousel_counter"),c=getSize(t.querySelector(".article_figure_content")),u=t.querySelector(".article_photo_carousel_inner"),d=t.querySelector(".article_photo_carousel__left"),_=t.querySelector(".article_photo_carousel__right"),h=n.onClick,p=!1;function f(n,i){if(!i||!p){if(p=!0,i)return u.style.transform="translateX(-50px)",void(r=setTimeout((()=>{u.style.transform="translateX(0px)"}),700));clearTimeout(r),a=Math.min(e.length-1,Math.max(0,a+n)),u.style.transform="translateX(-"+a*c[0]+"px)",s.innerHTML=l.replace("{counter}",a+1).replace("{total}",e.length),window.toggle(d,a>0),window.toggle(_,a<e.length-1),t.setAttribute("data-photo-carousel-index",a),j(a,t)}}return _.addEventListener("click",(e=>(f(1),h&&h(P),cancelEvent(e)))),d.addEventListener("click",(e=>(f(-1),h&&h(C),cancelEvent(e)))),t.addEventListener("mousemove",(()=>{o.style.opacity=1})),t.addEventListener("mouseleave",(()=>{o.style.opacity=0})),f}(i,e,t);return window.data&&window.data(e,"changePhotoFunction",a),a}}function j(e,t){var n=t.querySelector("figcaption"),i=[];n&&((i=n.getAttribute("data-captions"))&&(i=JSON.parse(i)),n.innerHTML=i[e]||"")}var D,V,U=n(70313),F=n(61540),H={};window._articleCarouselGlobalId=window._articleCarouselGlobalId||1;class W{constructor(e,t,n){this._handleClick=e=>{if(e.target.href)try{var t=new URL(e.target.href);window.location.pathname===t.pathname&&t.search.match(/\?|&anchor=/)&&(e.preventDefault(),this.scrollToAnchor(null,t.search),window.history.replaceState({},document.title,""+t.pathname+t.search))}catch(e){console.error(e)}},this._article=e,this._options=t,this._readTO=null,this._scrollStatEvent=!1,this._openTime=0,this._graphemes=[],this._els={view:document.querySelector("#article_view_"+e.raw_id)},window.cur&&cur.destroy&&cur.destroy.push((()=>{this.deinit()})),n&&this.ready()}getEl(){return this._els.view}getArticle(){return this._article}getScrollNode(){return this._options.getScrollNode?this._options.getScrollNode():document}_getScrollTop(){return this._options.getScrollTop?this._options.getScrollTop():window.scrollNode?window.scrollNode.scrollTop:window.document.documentElement.scrollTop}getTimeSpent(){return Math.round((Date.now()-this._openTime)/1e3)}changeCarouselPosition(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=!0);var r=H[e];(0,s.isFunction)(r)&&r(0,!1,t,n,i)}deinit(){this._scrollEvent&&(this.getScrollNode().removeEventListener("scroll",this._scrollEvent),this._scrollEvent=!1),this._scrollStatEvent&&(this.getScrollNode().removeEventListener("scroll",this._scrollStatEvent),this._scrollStatEvent=!1),document.removeEventListener("click",this._handleClick),clearTimeout(this._readTO)}_onViewScroll(){var e=scrollGetY(),t=window.innerHeight;this._els.view.querySelectorAll("figure").forEach((n=>{var i=(0,s.intval)(n.getAttribute("data-done"));if(!i){var r,a=getH(n),o=getXY(n)[1],l=(0,s.intval)(n.getAttribute("data-type"));switch(l){case c:r=-200;break;case u:r=0;break;default:r=100}var d,_=o+a,h=e+r,p=e+t-r;if(l===u)d=_<=p&&h<=o||p<=_&&o<=h;else d=o<=p&&h<=_;(i=this._onObjectView(d,l,n))&&n.setAttribute("data-done",String(1))}})),this._els.view.querySelectorAll("figure").forEach((n=>{var i,r=getH(n),a=getXY(n)[1],o=(0,s.intval)(n.getAttribute("data-type")),l=a,c=a+r,u=e,d=e+t;if(l>d||u>c)i=!1;else{var _=Math.max(l,u);i=(Math.min(c,d)-_)/r>.7}this._onObjectPartialView(i,o,n)}))}_initObjects(){this._initedObjects=this._initedObjects||{},this._els.view.querySelectorAll("._article_unmute_button").forEach(((e,t)=>{this._initedObjects[t]||(this._initedObjects[t]=!0,e.addEventListener("click",(()=>{var t=e.parentNode,n=t.querySelector("video");n.muted=!n.muted,t.classList.toggle("article_object_unmuted",!n.muted)})))})),this._els.view.querySelectorAll("figure").forEach(((e,t)=>{if(!this._initedObjects[t])switch(this._initedObjects[t]=!0,parseInt(e.getAttribute("data-type"))){case c:var n=M(e,{mobile:this._options.mobile,moderDeletePhoto:this._options.moderDeletePhoto,onClick:e=>{this.sendStats({type:e})}});if(this._initPhoto(e),n){var i=window._articleCarouselGlobalId++;e.setAttribute("data-carousel-id",i),H[i]=n}break;case _:case l:e.querySelector(".article_figure_content").addEventListener("click",(()=>{this.sendStats({type:S})}),!0);break;case g:case w:break;case d:case u:if(this._options.mobile){var r=e.querySelector("video");r&&(r.addEventListener("play",(()=>{this.sendStats({type:y})})),r.addEventListener("pause",(()=>{this.sendStats({type:y})})))}else{var a=e.querySelector(".article_figure_content");a.addEventListener("click",(()=>{this.sendStats({type:y})}),!0);var o=a.querySelector(".article_object_video");if(o){var s=o.getAttribute("data-video");e.getAttribute("data-autoplay")&&this._preloadVideo(s)}}}})),this._els.view&&this._els.view.addEventListener("click",(e=>{var t=e.target;if(matchesSelector(t,'a[href^="/away"]')){var n=decodeURIComponent(unescape(t.href)).split((0,F.getHostName)()+"/away.php?to=")[1];n&&this.sendStats({type:k,domain:encodeURIComponent(this._getUrlDomain(n))})}}))}_initPhoto(e){e.querySelector(".article_figure_content").addEventListener("click",(()=>{var t=e.querySelector("[data-sizes]"),n=JSON.parse(t.getAttribute("data-sizes")),i=(0,s.intval)(e.getAttribute("data-photo-carousel-index"));this._options.onImageOpen&&this._options.onImageOpen.call(this,n,e,i),this.sendStats({type:E})}))}_initStats(){if(this._statsInited)this._scrollStatEvent&&this._scrollStatEvent();else{this._statsInited=!0,this._openTime=Date.now();var e,t=-1,n=[];this._scrollStatEvent&&this.getScrollNode().removeEventListener("scroll",this._scrollStatEvent),clearTimeout(this._readTO);var i=this;this.getScrollNode().addEventListener("scroll",this._scrollStatEvent=function(){var a=i.getCurrentScrollRatio();if(!(a<0)){var o=1;a>=.95?o=4:a>.66?o=3:a>.33&&(o=2),function(a){if(i._isReady&&(i._article.has_more&&(a=Math.min(a,1)),!(t>=a))){for(var o=t+1;o<=a;o++)n.push(o);if(t=a,clearTimeout(e),e=setTimeout(r,300),3==a&&i._article.ttr){var s=i._article.ttr-i.getTimeSpent();s>0&&(i._readTO=setTimeout((()=>{if(!document.hidden){var e=i.getCurrentScrollRatio();if(!(e<0||e>1.3)){var a=4==t;n=[t=4],r(a)}}}),1e3*s))}}}(o),4!=o||i._article.has_more||(i.getScrollNode().removeEventListener("scroll",i._scrollStatEvent),i._scrollStatEvent=!1)}},{passive:!0}),this._scrollStatEvent&&this._scrollStatEvent()}function r(e){if(n.length){var t=i._article,r=i._options,a="";if(t.ref)a=t.ref;else if(window.cur){if("feed"===(a=window.cur.module)&&cur.articlePrevLoc&&!r.mobile)"search"===nav.fromStr(cur.articlePrevLoc).section&&(a="feed_search")}var o={act:"stats",scroll:n.join(","),spent:i.getTimeSpent(),hash:t.access_hash,article_owner_id:t.owner_id,article_id:t.id,is_web_view:r.isWebView?1:0,post_id:r.sourcePostId,is_widget:r.isWidget,is_delayed_scroll_4:(0,s.intval)(e),track_code:r.trackCode,ref:a};ajax.post(r.mobile?"article.php":"al_articles.php",o),t.mailru_stats_data&&n.forEach((e=>{N("scroll_"+e,t.mailru_stats_data)})),n=[]}}}_initGoogleAnalytics(){var e=this._options.googleAnalyticsId;if(e)if(window.dataLayer=window.dataLayer||[],window.gtag)window.gtag("config",e,{page_location:window.location.href});else{var t=document.createElement("script");t.setAttribute("src","https://www.googletagmanager.com/gtag/js?id="+e),t.setAttribute("async","true"),document.head.appendChild(t),window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",e)}}_onObjectPartialView(e,t,n){var i=n.querySelector("[data-sizes]");if(i){var r=Boolean(Number(i.getAttribute("data-should-disable-carousel-animation")));if(t==c&&!r)if(JSON.parse(i.getAttribute("data-sizes")).length>1){var a=n.getAttribute("data-carousel-id");e?V!=a&&(clearTimeout(D),D=setTimeout((()=>{var e=H[a];e&&e(1,!0)}),400),V=a):a==V&&(V=-1,clearTimeout(D))}}}_onObjectView(e,t,n){var i=!1;switch(t){case c:if(e){var r=n.querySelector("img"),a=getW(r)||this._options.width,o=n.querySelector("[data-sizes]"),l=JSON.parse(o.getAttribute("data-sizes")),_=n.querySelectorAll("img");l.forEach(((e,t)=>{var[n]=R(l[t],a,!0);!function(e,t){if(!0===L[e])return t&&t(),!0;if(Array.isArray(L[e]))return L[e].push(t),!1;L[e]=[t];var n=new Image;n.onload=function(){var t=L[e];L[e]=!0,(0,s.each)(t,(function(e,t){t&&t()}))},n.src=e}(n,(()=>{var e=_[t];e.classList.remove("article_object_photo__image_blur"),e.src=n}))})),i=!0}break;case d:if(!this._options.mobile){var g=n.querySelector("video");if(g)if(e){if(g.hasAttribute("autoplay")){var w=g.play();w&&w.catch((()=>{}))}}else g.pause();else i=!0}break;case u:if(!this._article.isVideoAutoplayEnabled)return;if(this._options.mobile){if(n.getAttribute("data-autoplay")){var b=n.querySelector("video");if(b)if(e){if(n.hasAttribute("data-autoplay")&&!n.hasAttribute("playing")){n.setAttribute("playing",!0);var y=b.play();y&&y.catch((()=>{}))}}else n.removeAttribute("playing")}}else if(n.getAttribute("data-autoplay")){var S=n.querySelector(".article_object_video_play"),E=n.querySelector("video");if(S)if(e){if(!E&&!S.hasAttribute("playing")){S.setAttribute("playing",!0);var k=n.querySelector(".article_object_video"),P=k.getAttribute("data-video"),C=this._getVideoParams(P);showInlineVideo(P,"",{autoplay:1,no_progress:1,cache:1,addParams:C},!1,k)}}else E||S.removeAttribute("playing")}break;case h:case p:case f:case v:case m:this.initEmbed(t,n),i=!0}return i}_getVideoParams(e){return{ad_block_id:null,ad_data:null,autoplay:1,autoplay_sound:0,from_autoplay:1,module:"article",list:"",repeat:1,video:e}}_preloadVideo(e){var t=this._getVideoParams(e);loadInlineVideo(t,null,!0)}initEmbed(e,t){switch(e){case h:var n=t.querySelector("[data-tweet-id]"),i=n.getAttribute("data-tweet-id");(0,U.loadScript)("https://platform.twitter.com/widgets.js",{onLoad:()=>{window.twttr.widgets.createTweet(i,n,{align:"center",lang:window.vk&&0==window.vk.lang?"ru":"en",dnt:!0})}});break;case p:var r=window.vk&&0==window.vk.lang?"ru_RU":"en_US";(0,U.loadScript)("https://connect.facebook.net/"+r+"/all.js#xfbml=1&amp;version=v2.8",{onLoad:()=>{window.FB.XFBML.parse()}});break;case f:(0,U.loadScript)("https://www.instagram.com/embed.js",{onLoad:()=>{window.instgrm.Embeds.process(),addEvent(window,"message",B)}});break;case v:var a=t.querySelector("[data-raw-id]"),o=a.getAttribute("data-raw-id"),s=a.getAttribute("data-index"),[l,c]=o.split(";");(0,U.loadScript)("/js/api/openapi.js",{onLoad:()=>{ajax.post("al_articles.php",{act:"get_post_hash",post_raw_id:l+"_"+c},{onDone:e=>{e&&window.VK&&window.VK.Widgets&&window.VK.Widgets.Post("vk_post_"+o+"_"+s,l,c,e,{from:this._options.isWebView?"article_webview":""})}})}});break;case m:(0,U.loadScript)("https://telegram.org/js/telegram-widget.js?5",{})}}getCurrentScrollRatio(){var e=getH(this._els.view),t=getXY(this._els.view)[1]-getXY(this.getScrollNode().firstElementChild)[1];return(this._getScrollTop()+window.innerHeight-t)/e}getScreenVisibilityRatio(){var e=getH(this._els.view),t=getXY(this._els.view)[1]-getXY(this.getScrollNode().firstElementChild)[1],n=this._getScrollTop(),i=window.innerHeight,r=t,a=t+e,o=n,s=n+i;if(o>a||r>s)return 0;var l=Math.max(r,o);return(Math.min(a,s)-l)/i}update(){this._initObjects(),this._initStats(),this._options.onScroll&&this._options.onScroll.call(this,this.getCurrentScrollRatio())}ready(){(this._isReady=!0,this._initObjects(),this._initStats(),this._initGoogleAnalytics(),setTimeout((()=>{var e=O("anchor");if(e){this._options.isWebView||this.scrollToAnchor(e);var t=this.getScrollNode();t===document&&(t=document.scrollingElement||window.scrollNode||document.body),t.click&&t.click(),t.focus()}}),0),!this._options.mobile&&window.AudioPlaylist)&&(this._article.audios_list&&this._article.audios_list.length>0&&new AudioPlaylist(AudioPlaylist.TYPE_TEMP,this._article.owner_id,"article_"+this._article.id).mergeWith({list:this._article.audios_list}));this.getScrollNode().addEventListener("scroll",this._scrollEvent=()=>{this._onViewScroll(),this._options.onScroll&&this._options.onScroll.call(this,this.getCurrentScrollRatio())}),document.addEventListener("click",this._handleClick),setTimeout((()=>{this._scrollEvent()}),this._options.objectsInitDelay||0)}scrollToAnchor(e,t){e=e||O("anchor",t);var n=this._options,i=this.getScrollNode();i===document&&(i=document.scrollingElement||window.scrollNode||document.body);e&&(()=>{var t=document.getElementById(e);if(t){"scrollRestoration"in history&&(history.scrollRestoration="manual");var r=n.isWebView?0:25,a=t.parentNode.offsetTop-r;window.setTimeout((()=>{i.scrollTo?i.scrollTo(0,a):i.scrollTop=a}),10)}})()}sendStats(e){var t=this._article,n=this._options,i={act:"stats",spent:this.getTimeSpent(),article_id:t.id,article_owner_id:t.owner_id,hash:t.access_hash,is_web_view:n.isWebView?1:0};Object.assign(i,e),ajax.post(n.mobile?"article.php":"al_articles.php",i)}_getUrlDomain(e){var t=document.createElement("a");return t.href=e,t.hostname}setGraphemes(e){this._graphemes=e||[]}getGrapheme(e){return this._graphemes.find((t=>e>=t.utterance_range[0]&&e<=t.utterance_range[1]))}hasGraphemes(){return!!this._graphemes.length}requestTts(e,t){var n=this.getArticle(),i=this._options.mobile?"article.php":"al_articles.php";ajax.post(i,{act:"tts",article_owner_id:n.owner_id,article_id:n.id,hash:n.tts_hash,support_streaming:t?1:0},{onDone:e})}removeHighlight(){var e=document.querySelectorAll(".articleView__ttsHighlight");e.length&&e.forEach((e=>{var{parentNode:t}=e;e.firstChild&&t.insertBefore(e.firstChild,e),t.removeChild(e),t.normalize()}))}highlightProgress(e){this.removeHighlight();var t=this.getGrapheme(e);e>0&&t&&this._highlightText(t.orig_text_range[0],t.orig_text_range[1])}_getTextNodesIn(e){if(3===e.nodeType)return[e];var t=e.classList.contains("article__info_line"),n="FIGURE"===e.tagName;if(!e.childNodes.length||t||n)return[];var i=[];return e.childNodes.forEach((e=>{i.push(...this._getTextNodesIn(e))})),i}_highlightText(e,t){for(var n=this.getEl(),i=this._getTextNodesIn(n),r=0,a=0,o=e=>e.textContent.length;r+o(i[a])-1<e;)r+=o(i[a]),a++;var s=i[a],l=o(s),c=document.createRange(),u=t-r,d=u>l;u=d?l:u,c.setStart(s,e-r),c.setEnd(s,u);var _=document.createElement("span");_.className="articleView__ttsHighlight",_.appendChild(c.extractContents()),c.insertNode(_),d&&this._highlightText(r+l,t)}}var q,$=[],K=!1;function Q(e,t,n,i){$.push(n+"/"+e.owner_id+"_"+e.id+"/"+i),clearTimeout(q),q=setTimeout((()=>{var e=K?"article.php":"al_articles.php";ajax.post(e,{act:"ads_event",events:$.join(","),is_web_view:(0,s.intval)(t.isWebView)}),$=[]}),200)}var Y,z,G,X,J,Z,ee=n(11417),te=n(51236),ne=n(12023),ie=n(35749),re=n(19331);window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);var ae,oe,se,le=!1,ce=[],ue=[],de=1,_e=2,he={},pe={};function fe(e,t){e=e.split("_");for(var n=0;n<t.length;n++){var i=t[n].split("_");if(i[0]==e[0]&&i[1]==e[1])return n}return-1}function ve(){return document}function me(){return(document.scrollingElement||window.scrollNode||document.body).scrollTop}function we(e){return domQuery('.articleView__social_buttons[data-article-id="'+e+'"] .articleView__footer_btn_bookmark')}function be(e){if(Z!=e.raw_id)if(Z=e.raw_id,z.isWebView)!function(e){o().send("articleUpdate",{article:Ne(e),isSubscribedToOwner:e.is_subscribed_to_owner})}(e);else{var t=geByClass1("articleView__owner"),n=geByTag1("img",t);t&&n&&(n.src=e.owner_photo);var i=geByTag1("a",t);t&&i&&(i.href=e.owner_href);var r=geByClass1("articleView__ownerName"),a=geByTag1("a",r);r&&a&&(a.href=e.owner_href,a.innerHTML=e.owner_name);var l=geByClass1("articleView__footer"),c=geByClass1("articleView__footer_views");c&&(c.innerHTML=e.views_formatted);var u=geByClass1("articleView__social_buttons",l);l&&u&&!e.is_blog&&u.setAttribute("data-article-id",e.raw_id);var d=[domQuery1('.articleView__content_misc_block[data-article-id="'+e.raw_id+'"] .articleView__footer_btn_share'),l&&domQuery1(".articleView__footer_btn_share",l)];(0,s.each)(d,((t,n)=>{n&&!e.is_blog&&(n.href="/like?act=publish&object=article"+e.raw_id+"&list="+e.access_hash)}));var _=we(e.raw_id),h=JSON.stringify(e.mailru_stats_data);(0,s.each)(_,((t,n)=>{n&&(n.setAttribute("onclick","Article.fave(this, '"+e.url+"', '"+e.fave_hash+"', "+h+", '"+e.raw_id+"')"),toggleClass(n,"_active",e.is_faved))}));var p=geByClass1("Unfold__item_name_noted");p&&(p.href="/feed?section=search&q=url:https://"+(0,F.getHostName)()+e.url);var f=geByClass1("Unfold__item_name_report");f&&(f.href=(0,te.getArticleReportUrl)({ownerId:e.owner_id,articleId:e.id,accessHash:e.access_hash,refrom:"feed"}))}}function ye(e,t){void 0===t&&(t=!1),e.has_more||(ce=ce.concat(e.audios_list));var n=new W(e,{notFull:!!z.preloadMoreHash,isWebView:z.isWebView,mobile:!0,width:z.width,getScrollTop:me,getScrollNode:ve,trackCode:z.trackCode,onScroll:function(t){if(!e.has_more){var n=ue[ue.length-1],i=gpeByClass("articleView__content",n.getEl());t>.6&&e.next_article_url&&(ue.length<20&&(Ae(e.next_article_url),addClass(i,"articleView_waitNextArticle")),function(){var e=ue[ue.length-1];if(e){var t=gpeByClass("articleView__content",e.getEl()),n=geByClass1("articleView__social_buttons",t);n&&show(n)}}()),t>.99&&e.next_article_url&&ue.length<20&&Ae(e.next_article_url,((e,t)=>{if(e){for(var n=0;n<ue.length;n++)if(ue[n].getArticle().raw_id==t.raw_id)return;se||(se=setTimeout((()=>{var n=domCreate(e);J.appendChild(n),removeClass(i,"articleView_waitNextArticle"),addClass(n,"articleView_nextPrepared"),requestAnimationFrame((()=>{removeClass(n,"articleView_nextPrepared")})),ye(t),se=null}),400))}})),this.getScreenVisibilityRatio()>.5&&be(e)}},onImageOpen:(e,t,i)=>{if(z.isWebView){for(var r=[],a=0;a<e.length;a++){var s=e[a],l=[];for(var c in s)s.hasOwnProperty(c)&&l.push({type:c,src:s[c][0],width:s[c][1],height:s[c][2]});r.push(l)}ae=t,oe=n,o().send("articlePhotoView",{photos:r,index:i})}}});if(t||n.ready(),ue.push(n),Ce(e),(0,s.each)(geByTag("video"),((e,t)=>{domData(t,"auto-pause-inited")||(domData(t,"auto-pause-inited",1),t.addEventListener("play",(()=>{(0,s.each)(geByTag("video"),((e,n)=>{n!=t&&n.pause()}))})))})),z.isWebView){(0,s.each)(geByTag("figure",n._els.view),((e,t)=>{var i=(0,s.intval)(domData(t,"type"));n._onObjectView(!1,i,t)&&domData(t,"done",1)}));var i=document.getElementsByClassName("articleView__educationCloseButton")[0];i&&i.addEventListener("click",(function(e){var t=e.target,n=(0,s.intval)(domData(t,"article-id")),i=(0,s.intval)(domData(t,"course-id")),r=(0,s.intval)(domData(t,"step-id")),a=t.href;o().send("articleClose",{fallback_url:a,payload:{status:"read",data:{author_id:n,course_id:i,step_id:r}}}),e.preventDefault()}))}}function Se(e){var t=Pe(e);t&&t.removeHighlight()}function Ee(e,t,n){var a=Pe(e);if(a){a.requestTts((s=>{var{queue:l,approx_generation_time:c,error:u,has_error:d}=s,_=(0,r.default)(s,["queue","approx_generation_time","error","has_error"]);if(d)ke(e,u);else if(l){if(ne.QueueManager.addQueue((0,i.default)({},l,{keepAlive:!0}),((i,r)=>{r.events.find((t=>"marusyatts"===t.entity_type&&t.data.article_raw_id===e))&&(Ee(e,t,n),ne.QueueManager.deleteQueue(l.key),z.isWebView&&!Object.keys(ne.QueueManager.queues).length&&ne.QueueManager.stop())})),ne.QueueManager.start(),z.isWebView&&c){var h=a.getArticle();o().send("articleTtsApproxGenerationTime",{id:h.id,owner_id:h.owner_id,approx_generation_time:c})}}else!function(e,t,n){var i=Pe(e);if(!i)return;var{graphemes:r,meta:a,support_streaming:s,stream_id:l}=t;if(i.setGraphemes(r.result),z.isWebView&&n){var c=i.getArticle();o().send("articleTtsReady",{id:c.id,owner_id:c.owner_id,url:c.url,meta:a,support_streaming:s,stream_id:l})}}(e,_,t)}),n)}}function ke(e,t){var n=Pe(e);if(n&&z.isWebView){var i=n.getArticle();o().send("articleTtsError",{id:i.id,owner_id:i.owner_id,error_message:t})}}function Pe(e){var[t,n]=e.split("_");return ue.find((e=>e.getArticle().owner_id.toString()===t&&e.getArticle().id.toString()===n))}function Ce(e){var t=gpeByClass("articleView__content",ge("article_view_"+e.raw_id)),n=geByClass1("articleView__ads_block",t);(class{static init(e,t,n,i){if(void 0===n&&(n=0),void 0===i&&(i={}),K=i.mobile||i.isWebView,t&&e.ads&&!(0,s.isEmpty)(e.ads)&&!(e.has_more||Array.isArray(e.ads)&&0===e.ads.length)){var r=document.createElement("ins");r.classList.add("mrg-tag"),r.classList.add("article_adsblock"),i.mobile&&r.classList.add("article_adsblock_mobile"),r.style.display="block",r.style.textDecoration="none";var a="";if((0,s.isObject)(i.deviceInfo))for(var o in i.deviceInfo)i.deviceInfo.hasOwnProperty(o)&&(a+="&"+o+"="+i.deviceInfo[o]);for(var l in e.ads.data["ad-query"]=e.ads.data["ad-query"].replace("%device_info%",a),e.ads.data["ad-query"]+="&place="+n,e.ads.data)e.ads.data.hasOwnProperty(l)&&r.setAttribute("data-"+l,String(e.ads.data[l]));t.appendChild(r),window.MRGtag||(window.MRGtag=[]);var c=i.isWebView?{iframeMode:!0}:{},u=e.ads.eventsHash;if(Q(e,i,"requested",u),c.onNoAds=()=>{Q(e,i,"no_ads",u)},c.onAdsLoaded=()=>{Q(e,i,"ads_loaded",u)},c.onAdsClosed=()=>{Q(e,i,"ads_closed",u)},c.onAdsSuccess=()=>{Q(e,i,"ads_success",u)},c.onAdsClicked=()=>{Q(e,i,"ads_clicked",u)},c.onScriptError=()=>{Q(e,i,"script_error",u)},window.MRGtagOnAdsImpression=()=>{Q(e,i,"ads_impression",u)},window.MRGtag.push(c),!window.mailRuSdsScriptLoaded){var d=document.createElement("script");d.setAttribute("src",e.ads.script),d.setAttribute("async","true"),document.head.appendChild(d),window.mailRuSdsScriptLoaded=!0}}}static wasShown(){return!1}}).init(e,n,ue.length,z)}function Ae(e,t){var n=pe[e];n!==_e?(0,s.isArray)(n)?t&&t(n[0],n[1]):(he[e]=he[e]||[],t&&he[e].push(t),n!=de&&(pe[e]=de,ajax.post("article.php",{act:"view",url:e,scroll_load:1,wall_owner_id:z.wallOwnerId,audio_bridge:(0,s.intval)(z.audioBridge),can_infinite_scroll:(0,s.intval)(z.canInfiniteScroll),web_view:z.isWebView,context:z.context,ref:"scroll",v:z.clientVersion},{onDone:(t,n)=>{for(var i=he[e],r=0;r<i.length;r++)i[r](t,n);pe[e]=[t,n]}}))):t&&t()}function Ie(e,t){var n=we(e);(0,s.each)(n,((e,n)=>{toggleClass(n,"_active",t)}))}function Te(e){var t;(t=z.isWebView?document.body:document.querySelector(".basis"))&&ee.colorScheme.applyScheme(t,e?ee.ColorSchemeName.Dark:ee.ColorSchemeName.Light)}function xe(){var e=O("anchor");e&&(()=>{var t=document.getElementById(e);if(t){"scrollRestoration"in history&&(history.scrollRestoration="manual");var n=z.isWebView?0:25,i=t.parentNode.offsetTop-n;window.setTimeout((()=>{var e;e=i,(document.scrollingElement||window.scrollNode||document.body).scrollTop=e}),0)}})()}function Re(e){if(void 0===e&&(e={}),le)xe();else{z.deviceInfo=e.deviceInfo;var t=ue[0],n=t.getArticle();t.ready(),n.has_more?ajax.post("article.php",{act:"load_more",rev:n.rev,hash:n.has_more_hash,article_owner_id:n.owner_id,article_id:n.id,audio_bridge:(0,s.intval)(z.audioBridge),no_lazy_images:(0,s.intval)(z.noLazyImages),can_infinite_scroll:(0,s.intval)(z.canInfiniteScroll),wall_owner_id:z.wallOwnerId,context:z.context,client_version:z.clientVersion},{onFail:()=>{z.failTries>0&&(z.failTries--,setTimeout((()=>{Re(e)}),2e3))},onDone:(e,i)=>{le=!0,n.audios_list=i.audios_list,n.next_article_url=i.next_article_url,n.has_more=!1,n.audios_list&&n.audios_list.length&&(ce=ce.concat(n.audios_list));var r=domCreate(e),a=geByClass1("article_view",r),o=geByClass1("article_view");"figure"!==o.lastElementChild.tagName.toLowerCase()&&o.lastChild.remove();for(var s=o.children.length,l=a.children;s<l.length;)o.appendChild(l[s]);var c=geByClass1("article_preload_spinner");c&&c.parentNode.removeChild(c);var u=geByClass1("articleView__content_misc_block",r);o.parentNode.appendChild(u),function(){for(var e=geByClass1("article").children,t=0;t<e.length;t++){var n=t>0&&e[t-1],i=e[t],r=t+1<e.length&&e[t+1],a=n?n.tagName+"_"+domData(n,"type"):"",o=i?i.tagName+"_"+domData(i,"type"):"",s=r?r.tagName+"_"+domData(r,"type"):"",l=!1,c=!1,u=!1;a&&o==a||(l=!0),s&&o==s||(c=!0),(b.includes(+s.type)||s.sep)&&(u=!0),toggleClass(i,"article_decoration_first",l),toggleClass(i,"article_decoration_last",c),toggleClass(i,"article_decoration_before",u)}}(),Ce(n),xe(),t.update()}}):ajax.post("article.php",{act:"next_url",access_hash:n.access_hash,article_owner_id:n.owner_id,article_id:n.id,wall_owner_id:z.wallOwnerId,context:z.context},{onDone:e=>{e&&(n.next_article_url=e,t.update())}});var i=t.getEl();e.paddingTop&&setStyle(i,"marginTop",(0,s.intval)(e.paddingTop)),e.paddingBottom&&setStyle(i,"marginBottom",(0,s.intval)(e.paddingBottom)),e.noDarkModeTransition&&addClass(i,"article_dark_no_transition")}}function Le(e){var t=null;return(0,s.each)(ue,((n,i)=>{var r=i.getArticle();if(r.raw_id==e)return t=r,!1})),t}function Ne(e){var t="https://"+z.devHost+(0,F.getHostName)()+e.url,n={id:e.id,owner_id:e.owner_id,owner_name:e.owner_name,state:"available",can_report:e.can_report,title:e.title,subtitle:"",views:e.views,shares:e.shares,is_favorite:e.is_faved,url:t,view_url:t,access_key:e.access_hash,published_date:e.published_date,no_footer:e.no_footer};return e.owner_photo&&0!=e.owner_photo.indexOf("/images/")&&(n.owner_photo=e.owner_photo),n}function Oe(e,t){void 0===t&&(t="");var n=ue[ue.length-1];if(t)for(var i=0;i<ue.length;i++)if(ue[i]._article.raw_id===t){n=ue[i];break}n.sendStats({type:e})}window.ArticleView=W,window.Article={init:function(e,t){(z=t).mobile=!0,z.failTries=50,window.cur&&(window.cur.lang=window.cur.lang||{},extend(window.cur.lang,t.lang||{})),J=geByClass1("articleView__content_list");var n=document.querySelector(".articleView__layout");if(!z.isWebView){var i,r=me(),a=document.querySelector(".articleView__header"),l=document.querySelector(".articleView__footer");ve().addEventListener("scroll",i=()=>{var e=n.clientHeight,t=Math.max(0,me()),i=t-r>0,o=t+window.innerHeight+20>e;toggleClass(a,"articleView__header--narrow",i),l&&toggleClass(l,"articleView__footer--hidden",!o&&i),r=t},{passive:!0});var c=geByClass1("articleView__close"),u=geByClass1("articleView__close_mini");c.addEventListener("click",Oe.bind(window,x)),u.addEventListener("click",Oe.bind(window,x)),window.cur&&cur.destroy.push((()=>{document.removeEventListener("scroll",i),removeClass(document.body,"article_body_with_transition")})),z.isStandalone&&(window.al=!1)}if(Te(n.classList.contains("article_dark")),z.preloadMoreHash||show(geByClass1("article_layer_prev_next")),z.isWebView){var d=geByClass1("article");addClass(d,"article_webview")}z.isWebView&&z.audioBridge&&(window.audioplayer={playPause:function(e,t){var n=gpeByClass("audio_item",e.target);if(G&&G!=n&&(removeClass(G,"ai_playing"),G=!1),X&&(removeClass(X,"article_object_audioplaylist_playing"),X=!1),hasClass(n,"ai_playing"))o().send("audioPause",{}),removeClass(n,"ai_playing");else{var i=fe(t,ce),r=ce;-1==i&&(r.unshift(t),i=0),o().send("audioPlay",{audioIds:r,pos:i}),addClass(n,"ai_playing"),G=n}return cancelEvent(e),!1}}),z.isWebView?(o().send("articleReady"),window.addEventListener("VKWebAppEvent",(e=>{var t=e.detail||{};switch(t.type){case"articleOwnerSubscribed":var n=t.ownerId,i=t.isSubscribed;(0,s.each)(ue,((e,t)=>{var r=t.getArticle();if(r.owner_id==n)return r.is_subscribed_to_owner=i,!1}));break;case"articleBookmarked":var r=t.articleOwnerId+"_"+t.articleId,a=Le(r);a&&(a.is_faved=t.isBookmarked);var o=we(r);(0,s.each)(o,((e,n)=>{toggleClass(n,"_active",!!t.isBookmarked)}));break;case"articleWebViewShow":Re(t);break;case"articleWebViewClose":Oe(x);break;case"didShareArticle":var l=t.articleRawId,c=t.shareType;if(!c)break;Oe(c,l);break;case"articleMentionClick":var u=t.articleRawId;Oe(A,u);break;case"articleTtsBtnClicked":!function(e,t){if(t||!(0,re.partConfigEnabled)("longread_tts_no_stream_error"))Se(e),Ee(e,!0,t);else{if(ke(e,""),document.getElementById("marusia_outdated_app"))return;(0,ie.AlertBox)(getLang("mobile_marusia_outdated_app_text"),getLang("mobile_marusia_outdated_app_header"),void 0,{id:"marusia_outdated_app",button_label:getLang("mobile_marusia_outdated_app_button"),class:"AlertBox_MarusiaOutdated",href:browser.ios?"https://vk.cc/iphone":"https://vk.cc/android",skipDomInsert:!0})}}(t.articleRawId,t.supportStreaming);break;case"articleTtsResume":!function(e,t){Se(e),Ee(e,!1,t)}(t.articleRawId,t.supportStreaming);break;case"articleTtsProgress":!function(e,t){var n=Pe(e);n&&n.highlightProgress(t)}(t.articleRawId,t.progress);break;case"articleTtsEnd":!function(e){Se(e)}(t.articleRawId);break;default:var d=t.index;if(void 0===d)return;oe&&ae&&oe.changeCarouselPosition(domData(ae,"carousel-id"),d,!0,!1)}})),ye(e,!0)):ye(e,!1)},fave:function(e,t,n,i,r){var a=!hasClass(e,"_active");ajax.post("article.php",{act:"fave",url:t,add:(0,s.intval)(a),hash:n}),ue.forEach((e=>{var n=e.getArticle();n.url==t&&(n.is_faved=a)})),N(a?"fave":"unfave",i),Ie(r,a),z.isWebView?function(e){var t=Le(e);t&&(JSON.stringify({article:Ne(t)}),o().send("articleBookmarked",{article:Ne(t)}))}(r):Share&&Share.setBookmarkState(r,a)},toggleButton:Ie,share:function(e,t,n){return function(e){var t=Le(e),n=z.clientVersion;if(t)if(n){var i={type:"article",data:Ne(t)};o().send("share",i)}else{var r={article:Ne(t)};o().send("articleShare",r)}}(t),!1},subscribe:function(e,t,n){ajax.post("article.php",{act:"subscribe",owner_id:t,hash:n},{onDone:(t,n)=>{toggleClass(e,"articleView__subscribed",t),e.innerHTML=n}})},toggleDarkMode:function(e){Y||(Y=setTimeout((()=>{var t=geByClass1("articleView__layout");toggleClass(t,"article_dark",e),toggleClass(document.body,"article_dark",e);var n=t.classList.contains("article_dark");Y=!1,void 0!==e||z.isWebView||ajax.post("article.php",{act:"set_dark_mode",dark:(0,s.intval)(n)});var i=geByClass1("articleMenu");i&&Unfold.setTitle(i,"dark_mode",n?getLang("mobile_articles_menu_dark_disable"):getLang("mobile_articles_menu_dark")),Oe(n?I:T),Te(n)}),e?0:10))},onWebViewShow:Re,sendStats:Oe,audioPlayPlaylist:function(e,t,n){var i=gpeByClass("article_object_audioplaylist_webview",e);if(G&&(removeClass(G,"ai_playing"),G=!1),X){var r=X;if(removeClass(r,"article_object_audioplaylist_playing"),X=!1,r==i)return o().send("audioPause",{}),cancelEvent(n)}var a=fe(t,ce),s=ce;return-1==a&&(s.unshift(t),a=0),o().send("audioPlay",{audioIds:s,pos:a}),addClass(i,"article_object_audioplaylist_playing"),X=i,cancelEvent(n)},onAudioStateChanged:function(e,t){G&&(removeClass(G,"ai_playing"),G=!1),X&&(removeClass(X,"article_object_audioplaylist_playing"),X=!1),e=(e=e.split("_"))[0]+"_"+e[1];var n=ge("audio"+e);n&&toggleClass(n,"ai_playing","play"==t);for(var i=geByClass("_article_object_audioplaylist_webview"),r=0;r<i.length;r++){if((domData(i[r],"ids")||"").split(",").indexOf(e)>=0&&"play"==t){addClass(i[r],"article_object_audioplaylist_playing"),X=i[r];break}}}}},35749:function(e,t,n){"use strict";n.d(t,{AlertBox:function(){return l}});var i=n(20848),r=n(39871),a=n(16800),o=n(81294),s=n(62641);function l(e,t,n,l){void 0===l&&(l={});var c=(0,i.ceFromString)(r.default.html((0,a.default)({id:l.id,class:(0,s.classNames)("AlertBox",l.class),scrollable:!0,header:{title:t||(0,s.getLang)("mobile_warning_header")},content:[e,{class:"Popup__buttons",inner:[(0,o.default)({onClick:n||"Popup.close(this)",use_native_onclick:!0,class:"Popup__button",theme:"regular",url:l.href,inner:l.button_label||r.default.wrap((0,s.getLang)("mobile_close"))})]}]})));l.skipDomInsert||domInsert(document.body,c),a.default.open(c,!0)}window.page&&page.onChange((()=>{$$(".AlertBox").forEach((e=>a.default.close(e)))})),window.AlertBox=l},40983:function(e,t,n){"use strict";n.d(t,{Confirm:function(){return l}});var i=n(39871),r=n(16800),a=n(62641),o=n(81294),s=n(71437);function l(e,t,n,s){void 0===s&&(s={});var l=i.default.preactElemFromTemplate((0,r.default)({id:s.id,class:(0,a.classNames)("Confirm",s.class),scrollable:!0,header:{title:s.title||(0,a.getLang)("mobile_warning_header")},on_overlay_click_native:n,content:[e,{class:"Popup__buttons",inner:[(0,o.default)({onClick:t,use_native_onclick:!0,class:"Popup__button",theme:s.theme_accept_btn||"regular",url:s.yes_href,inner:s.yes_label||(0,a.getLang)("mobile_continue")}),(0,o.default)({onClick:n||"Popup.close(this, event)",use_native_onclick:!0,class:"Popup__button",theme:s.theme_close_btn||"secondary",url:s.no_href,inner:s.no_label||(0,a.getLang)("mobile_cancel")})]}]}));return r.default.open(l,!0,{withoutCloning:!0})}window.page&&window.page.onChange((()=>{(0,s.$$)(".Confirm").forEach((e=>r.default.close(e)))})),window.Confirm=l},12023:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{QueueManager:function(){return QueueManager}});var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(85863),_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20848),QUEUE_CREATION_TIME_INDEX=0,QUEUE_TIMESTAMP_INDEX=1,QUEUE_KEY_INDEX=2,QUEUE_CALLBACK_INDEX=3,QUEUE_KEEP_ALIVE_INDEX=4,INCORRECT_KEY_OR_TIMESTAMP_ERROR_CODE=2,KEY_IS_BLOCKED_BY_ANOTHER_REQUEST_ERROR_CODE=4,TRANSPORT_FRAME_ID="queue_transport_frame";class QueueManager{static addQueue(e,t){QueueManager.initialized&&(QueueManager.queues[e.key]=[vkNow(),e.ts,e.key,t,!!e.keepAlive])}static deleteQueue(e){delete QueueManager.queues[e]}static start(){QueueManager.initialized&&!QueueManager.started&&(QueueManager.createFrame(QueueManager.check),QueueManager.started=!0)}static stop(){QueueManager.initialized&&QueueManager.started&&(QueueManager.closeFrame(),QueueManager.started=!1)}static check(){var params={act:"a_check",ts:curNotifier.timestamp,key:curNotifier.key,id:curNotifier.uid,wait:25},addQueues=[],now=vkNow();Object.keys(QueueManager.queues).forEach((e=>{var t=QueueManager.queues[e],n=t[QUEUE_CREATION_TIME_INDEX],i=t[QUEUE_TIMESTAMP_INDEX];now-n>3e4&&!e.match(/nccts/)&&!t[QUEUE_KEEP_ALIVE_INDEX]?delete QueueManager.queues[t]:(params.ts+="_"+i,params.key+=e,addQueues.push(e))})),curNotifier.lpMakeRequest&&curNotifier.lpMakeRequest(curNotifier.frame_url,params,(text=>{try{var response=eval("("+text+")"),main_response=response,addResponse,addQueue,busy=0;if(isArray(response))for(main_response=response.shift(),curNotifier.timestamp=main_response.ts;(addResponse=response.shift())&&(addQueue=addQueues.shift(),addQueue);)addResponse.failed!==INCORRECT_KEY_OR_TIMESTAMP_ERROR_CODE||addResponse.err!==KEY_IS_BLOCKED_BY_ANOTHER_REQUEST_ERROR_CODE?addResponse.failed?delete QueueManager.queues[addQueue]:QueueManager.callQueue(addQueue,addResponse):busy|=1;else if(response.failed)for(;addQueue=addQueues.shift();)delete QueueManager.queues[addQueue];busy||(clearTimeout(curNotifier.lpCheckTO),curNotifier.lpCheckTO=setTimeout(QueueManager.check.bind(this),curNotifier.request_timeout||1e3),curNotifier.error_timeout=Math.max(1,(curNotifier.error_timeout||1)/1.5))}catch(e){curNotifier.error_timeout=curNotifier.error_timeout||1,clearTimeout(curNotifier.lp_error_to),curNotifier.lp_error_to=setTimeout(QueueManager.check.bind(this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2)}}),(()=>!0))}static init(e){window.curNotifier=(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__.default)({},e),QueueManager.initialized=!0,delete curNotifier.makeRequest}static createFrame(e){re(TRANSPORT_FRAME_ID),QueueManager.frame=(0,_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_0__.createIframe)({id:TRANSPORT_FRAME_ID,name:TRANSPORT_FRAME_ID,src:window.curNotifier.frame_path,ariaHidden:!0});var t=setInterval((()=>{curNotifier.lpMakeRequest&&(clearInterval(t),e())}),500);setTimeout((()=>clearInterval(t)),1e4)}static closeFrame(){QueueManager.frame.parentNode.removeChild(QueueManager.frame)}static callQueue(e,t){var n=QueueManager.queues[e];if(Array.isArray(n)&&n.length){n[QUEUE_TIMESTAMP_INDEX]=t.ts;var i=n[QUEUE_CALLBACK_INDEX];isFunction(i)&&i(n[QUEUE_KEY_INDEX],t)}}}QueueManager.queues={},QueueManager.frame=null,QueueManager.started=!1,QueueManager.initialized=!1,window.QueueManager=QueueManager},2375:function(e,t){"use strict";var n={_def_opts:{enableHighAccuracy:!0,maximumAge:3e5,timeout:6e4},_provider:null,initW3C:function(){n._provider=navigator.geolocation,n.getCurrentPosition=function(e,t,i){n._provider.getCurrentPosition((function(t){void 0!==t.latitude?e(extend(t,{coords:extend(t.coords||{},{latitude:t.latitude,longitude:t.longitude})})):e(t)}),t,i)}},initGears:function(){var{google:e}=window;n._provider=e.gears.factory.create("beta.geolocation")},initSymbian:function(){var{device:e}=window;n._provider=e.getServiceObject("Service.Location","ILocation"),n.getCurrentPosition=function(e,t){n._provider.ILocation.GetLocation({LocationInformationClass:"BasicLocationInformation"},(function(n,i,r){4==i?t({code:2,message:"Position unavailable"}):e({timestamp:null,coords:{latitude:r.ReturnValue.Latitude,longitude:r.ReturnValue.Longitude,altitude:r.ReturnValue.Altitude,heading:r.ReturnValue.Heading}})}))}},initPalm:function(){n.getCurrentPosition=function(e,t,n){var i={};n&&(n.enableHighAccuracy&&1==n.enableHighAccuracy&&(i.accuracy=1),n.maximumAge&&(i.maximumAge=n.maximumAge),n.responseTime&&(n.responseTime<5?i.responseTime=1:n.responseTime<20?i.responseTime=2:i.timeout=3));var{Mojo:r}=window;new r.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:i,onSuccess:function(t){e({timestamp:t.timestamp,coords:{latitude:t.latitude,longitude:t.longitude,heading:t.heading}})},onFailure:function(e){1==e.errorCode?t({code:3,message:"Timeout"}):2==e.errorCode?t({code:2,message:"Position unavailable"}):t({code:0,message:"Unknown Error: webOS-code"+e.errorCode})}})}},getCurrentPosition:function(e,t,i){n._provider.getCurrentPosition(e,t,extend(n._def_opts,i||{}))},init:function(){var{google:e,device:t,Mojo:i}=window;try{var r="undefined";if(typeof navigator.geolocation!==r)n.initW3C();else if(typeof window.google!==r&&typeof e.gears!==r)n.initGears();else if(typeof t!==r&&typeof t.getServiceObject!==r)n.initSymbian();else{if(typeof i===r||"Mojo.Service.Request"==typeof i.Service.Request)return!1;n.initPalm()}}catch(e){return!1}return!0}};window.geo=n,t.default=n},94365:function(e,t,n){"use strict";n.d(t,{alLoadingFix:function(){return o}});var i=n(52822),r=n(20848),a=n(48328);function o(e,t){t=t||"al_loading";var n=(0,r.geByClass1)(t)||(0,r.ge)(t);if(n){var o;if(!n&&!(0,r.hasClass)("BottomMenu__preloader",n))if("al_loading"!==t||!(null==(o=window)?void 0:o.getComputedStyle(n).getPropertyValue("--content_area_height"))){var s=document.getElementById("m").offsetHeight||0,l=document.getElementById("mfoot")&&document.getElementById("mfoot").offsetHeight||0;e=(0,r.getCh)()-s+l-16}n.style.height=e+"px",n.innerHTML=Wd.html((0,i.default)((0,a.getLoading40Icon)())),(0,r.addClass)(t,n)}}window.alLoadingFix=o},11911:function(e,t,n){"use strict";n.d(t,{IPHONE_SAFARI_BOTTOM_BAR:function(){return a},IPHONE_X_SAFARI_BOTTOM_BAR:function(){return o},IPHONE_KEYBOARD_REJECT_OFFSET:function(){return s},IOS_15_BOTTOM_NAVBAR_OFFSET:function(){return l},IOS_NO_KEYBOARD_ALLOWED_OFFSET:function(){return c},isIPad:function(){return _},isIPhone:function(){return h},isIOS:function(){return p},iosMajor:function(){return i},iosMinor:function(){return r},isWKWebView:function(){return m},isScrollBasedViewport:function(){return v},isIPhoneX:function(){return g},isIOSChrome:function(){return w},isLandscapePhone:function(){return b}});var i,r,a=45,o=85,s=180,l=48,c=70,u=navigator.userAgent.toLowerCase(),d=function(e){var t=!/ipad|iphone|ipod/.test(e);if(/mac os/.test(e)&&t&&"boolean"==typeof navigator.standalone)return!0;return!1}(u),_=d||-1!==u.indexOf("ipad"),h=!_&&-1!==u.search(/iphone|ipod/),p=h||_,f=p&&navigator.userAgent.match(/OS ([\d_]+) like Mac OS X/i);d&&(i=13,r=0),f&&(f=f[1].split("_"),i=+f[0],r=+f[1]),f=null;var v=i<13&&!(11===i&&r<3),m=p&&function(e){if(window.webkit&&window.webkit.messageHandlers)return!0;var t=/constructor/i.test(window.HTMLElement),n=!!window.indexedDB;if(-1===e.indexOf("safari")||-1===e.indexOf("version")||navigator.standalone){if(!n&&t||!window.statusbar||!window.statusbar.visible);else if(!t||n)return!0}else;return!1}(u),g=p&&375===screen.width&&812===screen.height&&3===window.devicePixelRatio,w=-1!==u.search(/crios/i);function b(){return 90===Math.abs(window.orientation)&&!_}},33155:function(e,t,n){"use strict";n.d(t,{default:function(){return u}});var i={};function r(e){return e.replace(/^\s+(<)/,"$1").replace(/(>)\s+$/,"$1")}function a(e,t){return e+'="'+t+'"'}function o(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a(e,s(n))}}function s(e){return e[0]+"("+e.slice(1).map(l).join(", ")+")"}function l(e){return"number"==typeof e||"event"===e||"this"===e?e:JSON.stringify(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,t){var n=[];return"string"==typeof t&&(t={[t]:!0}),Object.keys(t).forEach((i=>{var r=t[i];!0===r?n.push(e+"_"+i):r&&n.push(e+"_"+i+"_"+r)})),n}Object.assign(i,{html:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var a="";return e.forEach(((e,t)=>{var i=n[t];a+=r(e)+(i||0===i?i:"")})),a}}),Object.assign(i,{attr:a,onBlur:o("onblur"),onClick:o("onclick"),onFocus:o("onfocus"),onInput:o("oninput"),onKeyDown:o("onkeydown"),onKeyPress:o("onkeypress"),onKeyUp:o("onkeyup"),onMouseDown:o("onmousedown"),onMouseUp:o("onmouseup"),onScroll:o("onscroll"),onSubmit:o("onsubmit"),onTouchEnd:o("ontouchend"),onTouchMove:o("ontouchmove"),onTouchStart:o("ontouchstart"),onWheel:o("onwheel"),onChange:o("onchange")}),Object.assign(i,{list:function(e,t){void 0===t&&(t=null);Array.isArray(e)||(e=[e]);return t?e.map(t).join(""):e.join("")}}),Object.assign(i,{class:function(){for(var e=[],t=null,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return i.forEach((n=>{"string"==typeof n?(e.push(n),t=n):n&&(e=e.concat(c(t,n)))})),e.join(" ")},parseClass:function(e,t){var n={};return t.trim().split(/\s+/).forEach((t=>{if(t!==e){var i=t.replace(e+"_","").split("_");n[i[0]]=!(i.length>1)||i[1]}})),n}});var u=i;window.q=i},63848:function(e,t,n){"use strict";n.d(t,{expandPopup:function(){return f},isTabbing:function(){return d},onTransitionEnd:function(){return v},setFocusTrap:function(){return h},withFocusBack:function(){return p}});var i=n(20848);n(71437);var r=n(11911),a=["a[href]","area[href]",'input:not([disabled]):not([hidden]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([hidden]):not([aria-hidden])","textarea:not([disabled])","button:not([disabled])","iframe","audio","video","[contenteditable]",'[tabindex]:not([tabindex="-1"])'];var o=32,s=13,l=27,c=9;function u(){document.body.classList.add("tabbing")}function d(){return document.body.classList.contains("tabbing")}function _(e,t,n){void 0===n&&(n={}),e._enteredA11yElementKeyDownHandler&&document.removeEventListener("keydown",e._enteredA11yElementKeyDownHandler);var r=document.activeElement,o=!1;function s(t){if(t&&s.exitIntent&&!1===s.exitIntent(t))t.preventDefault();else if(!o){o=!0;var c=(0,i.scrollTop)(),d=Array.from(e.querySelectorAll(a.join()));document.activeElement&&!d.includes(document.activeElement)||(r&&function(e,t){t&&(u(),t.preventDefault());var n=!1;null!=e.getAttribute("tabindex")&&(n=!0);n||e.setAttribute("tabindex",0);e.focus(),setTimeout((()=>{n||e.removeAttribute("tabindex")}))}(r),(0,i.scrollTop)(c)),document.removeEventListener("keydown",l),n.onExit&&n.onExit()}}function l(e){e.ctrlKey||e.altKey||e.metaKey||t({event:e,exit:s.bind(null,e)})}return document.addEventListener("keydown",l),e._enteredA11yElementKeyDownHandler=l,s}function h(e){if(r.isIOS&&r.iosMajor>8)return!1;if(!e)throw new Error("A11y: No element passed to setFocusTrap");var t=Array.from(e.querySelectorAll(a.join()));if(!(t=t.filter((e=>null!==e.offsetParent))).length)return!1;var n=t[0],i=t[t.length-1],o=_(e,(e=>{var{event:t,exit:r}=e;t.keyCode===c&&(t.shiftKey?document.activeElement===n&&(t.preventDefault(),i.focus()):document.activeElement===i&&(t.preventDefault(),n.focus())),t.keyCode===l&&r()}));return cur.destroy.push((()=>{o()})),setTimeout((()=>{n.focus()})),o}function p(e,t){var n=function(e){if(document.body.contains(e))return()=>e.focus()}(e);return()=>{n(),null==t||t()}}function f(e){if(!e)throw new Error("A11y: No element passed to expandPopup");if(!e.getAttribute("aria-haspopup"))throw new Error("A11y: No `aria-haspopup` attribute on expanded element");if(null==e.getAttribute("aria-expanded"))throw new Error("A11y: No `aria-expanded` attribute on expanded element");if(null==e.getAttribute("aria-controls"))throw new Error("A11y: No `aria-controls` attribute on expanded element");if(!document.getElementById(e.getAttribute("aria-controls")))throw new Error("A11y: No element that the `aria-controls` refers to. Try to call `expandPopup` _after_ appending a popup");return e.setAttribute("aria-expanded",!0),_(e,(e=>{var{event:t,exit:n}=e;t.keyCode===l&&n()}),{onExit:()=>{e.setAttribute("aria-expanded",!1)}})}function v(e,t){var n,i;void 0===t&&(t={});var r=null!=(n=t.startThreshold)?n:10,a=null!=(i=t.ignoreBubbledEvents)&&i;return new Promise((t=>{var n=setTimeout((()=>{e.removeEventListener("transitionrun",i),t()}),r),i=r=>{if(a&&r.target!==r.currentTarget)return!1;clearTimeout(n),e.removeEventListener("transitionrun",i);var o=n=>{if(a&&n.target!==n.currentTarget)return!1;e.removeEventListener("transitionend",o),t()};e.addEventListener("transitionend",o,!1)};e.addEventListener("transitionrun",i,!1)}))}document._buttonA11yFix||(document._buttonA11yFix=!0,(0,i.addEvent)(window,"keydown",(e=>{e.keyCode===c&&u()}),{passive:!0}),(0,i.addEvent)(window,"mousedown touchstart",(()=>{document.body.classList.remove("tabbing")}),{capture:!0,passive:!0}),document.addEventListener("keydown",(e=>{e.ctrlKey||e.altKey||e.metaKey||(e.keyCode!==s&&e.keyCode!==o||"button"!==e.target.getAttribute("role")||(e.target.click(),e.preventDefault()),e.keyCode!==o||"checkbox"!==e.target.getAttribute("role")&&"radio"!==e.target.getAttribute("role")||(e.target.click(),e.preventDefault()))})))},9458:function(e,t,n){"use strict";n.d(t,{isStandalone:function(){return _}});var i=n(61540),r="SW: serviceWorker is unavailable";class a{constructor(){this.registration=null,this._handlers=[],this.params=null}static isSupported(){try{return!(!window.fetch||window.fetch.polyfill&&!window.fetch.forcedPolyfill||!navigator.serviceWorker)}catch(e){return!1}}listenMessages(){navigator.serviceWorker.addEventListener("message",this._onmessage.bind(this))}register(e){if(!a.isSupported())return Promise.reject(r);var t=e&&e.url;return t?(this.params=e,navigator.serviceWorker.register(t,{scope:"/",updateViaCache:"none"}).then(function(e){return this.registration||(this.registration=e),e}.bind(this))):Promise.reject("SW: incorrect url")}getRegistration(){return a.isSupported()?navigator.serviceWorker.ready.then(function(e){return this.registration||(this.registration=e),e}.bind(this)):Promise.reject(r)}unregister(){this.registration&&this.registration.unregister(),this._handlers.forEach((e=>e[0].removeEventListener(e[1],e[2]))),this._handlers=[]}update(){this.registration&&this.registration.update()}getParams(){return this.params||{}}_addEventListener(e,t,n,i){void 0===i&&(i=!0);var r=!1;this._handlers.forEach((function(i){i[0]===e&&i[1]===t&&i[2]===n&&(r=!0)})),r&&!i||(this._handlers.push([e,t,n]),e.addEventListener(t,n))}action_devicePixelRatio(){return window.devicePixelRatio}action_pushHash(){return this.getParams().push_hash}storePushHash(){var e=this.getParams().push_hash;this.action("storePushHash",{hash:e})}action(e,t){var n=null;return n=Array.isArray(e)?e:[[e,t]],this._message({actions:n}).then((e=>e.answers?Promise.resolve(1===n.length?e.answers[0]:e.answers):Promise.reject(new Error("ServiceWorker answer is incorrect"))))}_message(e){return this.getRegistration().then((()=>new Promise(function(t,n){var i=new MessageChannel;i.port1.onmessage=function(e){this._messageCheck(e)?t(e.data.data):n(new Error("ServiceWorker message is incorrect"))}.bind(this),this.registration.active.postMessage(this._messageWrap(e),[i.port2])}.bind(this))))}_onmessage(e){if(this._messageCheck(e)){var t=e.data.data;if(t.actions&&Array.isArray(t.actions)){var n=[];t.actions.forEach(function(t){var i="action_"+t[0],r=t[1],a=this[i]?this[i](r,e):void 0;a instanceof Promise||(a=Promise.resolve(a)),n.push(a)}.bind(this)),Promise.all(n).then(function(t){var n={};t.forEach(((e,t)=>{void 0!==e&&(n[t]=e)})),Object.keys(n).length&&e.ports[0].postMessage(this._messageWrap({answers:n}))}.bind(this))}}}_messageCheck(e){return(""===e.origin||e.origin.match(i.VK_ORIGIN_REGEX_STRICT))&&e.data&&e.data.data&&"sw"===e.data.type}_messageWrap(e){return{type:"sw",data:e}}}a.SW_NOT_AVAILABLE_ERROR=r;var o,s=n(11911),l=function(){if(!("fetch"in window))return function(){};var e=["standalone","fullscreen","minimal-ui"],t="#ffffff",n=128,i=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple");function r(e,t,n){void 0===n&&(n=!1);var i=a(e);if((i.drawImage(e,0,0),!n)&&255==i.getImageData(0,0,1,1).data[3])return null;return i.globalCompositeOperation="destination-over",i.fillStyle=t,i.fillRect(0,0,e.width,e.height),i.canvas.toDataURL()}function a(e){var{width:t,height:n}=void 0===e?{width:1,height:1}:e,i=document.createElement("canvas");return i.width=t,i.height=n,i.getContext("2d")}return function(){if(i){var o=document.head.querySelector('link[rel="manifest"]'),l=o?o.href:"",c=function(e){for(var t=function(t){var n=e[t];try{return new URL("",n),{v:e=>new URL(e,n).toString()}}catch(e){}},n=0;n<e.length;++n){var i=t(n);if("object"==typeof i)return i.v}return e=>e}([l,window.location]);Promise.resolve().then((()=>{if(!l)throw'can\'t find <link rel="manifest" href=".." />\'';var e={};return"use-credentials"===l.crossOrigin&&(e.credentials="include"),window.fetch(l,e)})).then((e=>e.json())).then((i=>function(i,o){var l=(i.icons||[]).filter((e=>"apple-splashscreen"===e.purpose));l.sort(((e,t)=>parseInt(t.sizes,10)-parseInt(e.sizes,10)));var c=l.map((e=>({href:o(e.src),sizes:e.sizes}))),u=i.display,d=-1!==e.indexOf(u);(function(e){var t=function(e){var t=a();return t.fillStyle=e,t.fillRect(0,0,1,1),t.getImageData(0,0,1,1).data}(e).map((e=>{var t=e/255;return t<.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),n=.2126*t[0]+.7152*t[1]+.0722*t[2];Math.abs(1.05/(n+.05))})(i.background_color||t),i.name||i.short_name||document.title;navigator.standalone||(_="apple-mobile-web-app-capable",(h=d)&&(!0===h&&(h="yes"),function(e,t){var n=document.createElement(e);for(var i in t)n.setAttribute(i,t[i]);document.head.appendChild(n)}("meta",{name:_,content:h})));var _,h;function p(e,r,o){var{width:s,height:l}=e,c=window.devicePixelRatio,u=a({width:s*c,height:l*c});if(u.scale(c,c),u.fillStyle=i.background_color||t,u.fillRect(0,0,s,l),u.translate(s/2,(l-32)/2),o){var d=o.width/c,_=o.height/c;_>n&&(d/=_/n,_=n),d>=48&&_>=48&&(u.drawImage(o,d/-2,_/-2,d,_),u.translate(0,_/2+32))}var h=document.createElement("link");return h.setAttribute("rel","apple-touch-startup-image"),h.setAttribute("media","screen and (orientation: "+r+")"),h.setAttribute("href",u.canvas.toDataURL()),h}var f=new Set;function v(e){var t=p(window.screen,"portrait",e),n=p({width:window.screen.height,height:s.isIPad?window.screen.height:window.screen.width},"landscape",e);f.forEach((e=>e.remove())),document.head.appendChild(t),document.head.appendChild(n),f.add(t),f.add(n)}if(v(null),!c.length)return;var m=c[0],g=new Image;g.crossOrigin="anonymous",g.onload=()=>{if(v(g),i.background_color){var e=r(g,i.background_color);null!==e&&(m.href=e,c.slice(1).forEach((e=>{var t=new Image;t.crossOrigin="anonymous",t.onload=()=>{var n=r(t,i.background_color,!0);e.href=n},t.src=e.href})))}},g.src=m.href}(i,c))).catch((e=>console.warn("pwacompat.js error",e)))}}}(),c=n(53843),u=new a;window.sw_client=u,window.SWClient=a,window.initPushNotifier=function(){try{window.PushNotifier=c.default,window.pushNotifier=new c.default(u,a)}catch(e){}};var d=!1;function _(){return d}function h(){window.vk&&window.vk.sw&&(u.register(window.vk.sw).then((e=>{u.storePushHash()}),(e=>{if(e!==a.SW_NOT_AVAILABLE_ERROR)throw e})),a.isSupported()&&navigator.serviceWorker.getRegistration().then((e=>{!function(e){if(void 0===o&&(o=!(!a.isSupported()||!navigator.serviceWorker.controller)),!o)return;e&&e.active&&e.installing&&e.installing.postMessage({action:"activate"})}(e)})),l())}!function(){if(!window.addEventListener)return;(function(){if(d=!0===navigator.standalone||window.matchMedia&&matchMedia("(display-mode: standalone)").matches,!history.replaceState)return;var e=location.search;if((e=(e=(e=e.replace(/(\?|&)mode\=([^&]+)(&)?/,"$1")).replace(/(\?|&)__appshell_fallback\=([^&]+)(&)?/,"$1")).replace(/(\?|&)+$/,""))!==location.search){var t=location.pathname+e+location.hash;history.replaceState(null,"",t)}})(),function(){if(!a.isSupported())return;u.listenMessages()}(),window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault()})),window.addEventListener("appinstalled",(()=>{statlogsValueEvent("pwa_installed_event",1)})),"complete"===document.readyState?h():window.addEventListener("load",(()=>{h()}))}()},53843:function(e,t,n){"use strict";n.d(t,{default:function(){return h}});var i=n(19331);function r(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t),i=new Uint8Array(n.length),r=0;r<n.length;++r)i[r]=n.charCodeAt(r);return i}var a=n(22463),o=n(26330),s="push_notifier_endpoint",l="push_notifier_subscribed_ts";class c{constructor(e,t){this.sw=e,this.SWClient=t,vk.id&&this.canBeEnabled().then((e=>{e&&(this.listenPermission(),this.loadEndpoint()&&this.update().then(this.checkMessageState.bind(this)))}))}static getPermission(){return Notification.permission}cleanNotification(){this.sw.action("cleanNotification")}canBeEnabled(){return Promise.resolve(this.isSupported())}isSupported(){return"PushManager"in window&&"Notification"in window&&this.SWClient.isSupported()}loadEndpoint(){return o.default.get(s+vk.id)||!1}saveEndpoint(e){o.default.set(s+vk.id,e||!1)}action(e,t){return this.sw.action(e,t)}_needupdate(e){var t=Date.now(),n=this.loadEndpoint(),i=o.default.get(l+vk.id),r=!1;return(n!==e.endpoint||!i||t-i>6e4)&&(o.default.set(l+vk.id,t),r=!0),r}listenPermission(){(0,i.partConfigEnabled)("push_notifier")&&navigator.permissions&&navigator.permissions.query&&navigator.permissions.query({name:"notifications"}).then((e=>{e.onchange=()=>this.update()}))}update(){return this.updatePermission().then((e=>e===c.PUSH_NOTIFIER_PERMISSION_GRANTED?this.subscribe().catch((e=>{e!==c.SUBSCRIBE_ERROR_NETWORK&&(0,a.error)("can not update subscribe")})):Promise.reject("premession_not_granted"))).catch(a.error)}updatePermission(){var e=c.getPermission();if(e!==c.PUSH_NOTIFIER_PERMISSION_GRANTED){var t=this.loadEndpoint();if(t)return this.unsubscribe(t).then((()=>e))}return Promise.resolve(e)}processSubscribe(e){return e.subscribe({userVisibleOnly:!0,applicationServerKey:r(c.SERVER_KEY)})}setupSubscription(){return new Promise(((e,t)=>{var n=c.getPermission(),i=()=>{this.subscribe(!0).then((()=>{e()})).catch((()=>{t()}))};n!==c.PUSH_NOTIFIER_PERMISSION_DENIED?n!==c.PUSH_NOTIFIER_PERMISSION_GRANTED?n===c.PUSH_NOTIFIER_PERMISSION_DEFAULT&&this.requestPermission().then((e=>{e===c.PUSH_NOTIFIER_PERMISSION_GRANTED?i():t()})):i():t(c.PUSH_NOTIFIER_BLOCKED_BY_BROWSER_SETTINGS)}))}subscribe(e){return this.sw.getRegistration().then((e=>{var t=e.pushManager;return t.getSubscription().then((e=>{if(e){var{expirationTime:n}=e;return n&&Date.now()>n-432e6?this.unsubscribe(this.loadEndpoint()).then((()=>this.processSubscribe(t))):e}return this.processSubscribe(t)}))})).then((t=>new Promise(((n,i)=>{if(e||this._needupdate(t)){var r=t.getKey("p256dh"),a=t.getKey("auth");window.ajax.post(c.SERVER_URL,{act:"a_subscribe",hash:this.sw.getParams().push_hash,endpoint:t.endpoint,key:r?btoa(String.fromCharCode.apply(null,new Uint8Array(t.getKey("p256dh")))):null,token:a?btoa(String.fromCharCode.apply(null,new Uint8Array(t.getKey("auth")))):null},{onDone:e=>{e?(this.saveEndpoint(t.endpoint),n()):i()},onFail:()=>(i(c.SUBSCRIBE_ERROR_NETWORK),!0)})}else n()}))))}unsubscribe(e){return this.sw.register().then((t=>t.pushManager.getSubscription().then((t=>t?t.unsubscribe().then((t=>t?new Promise(((t,n)=>{ajax.post(c.SERVER_URL,{act:"a_unsubscribe",endpoint:e},{onDone:e=>{e?(this.saveEndpoint(!1),t()):n()}})})):Promise.reject("ERROR: can not unsubscribe"))):(this.saveEndpoint(!1),Promise.reject("ERROR: no subscription"))))))}requestPermission(){var e=c.getPermission();return e===c.PUSH_NOTIFIER_PERMISSION_DEFAULT?new Promise((function(e,t){var n=Notification.requestPermission((function(t){e(t)}));n instanceof Promise&&n.then(e,t)})):Promise.resolve(e)}checkMessageState(){return new Promise((e=>setTimeout(e,5e3))).then((()=>this.action("getMessagesMetaData"))).then((e=>"object"==typeof e&&Object.keys(e).length?new Promise(((t,n)=>{window.ajax.post(c.SERVER_URL,{act:"a_update_messages_state",data:Object.entries(e)},{onDone:e=>{e?t(e):n("ERROR: act error")},onFail:()=>(n("ERROR: network error"),!0)})})):Promise.resolve({}))).then((e=>{try{return JSON.parse(e)}catch(e){return{}}})).then((e=>this.action("updateMessageNotifications",e))).catch((e=>(0,a.error)(e)))}}c.SERVER_KEY="BPrntRk2W1_ISFwlgY-vz9tQDg9i1oSQ3-N8xyjdbNAbIOdZIGFdh5FlO7zn730UwU9Sayoec-Fpqq4JZFTyv60",c.SERVER_URL="push_notifier",c.PUSH_NOTIFIER_PERMISSION_GRANTED="granted",c.PUSH_NOTIFIER_PERMISSION_DEFAULT="default",c.PUSH_NOTIFIER_PERMISSION_DENIED="denied",c.PUSH_NOTIFIER_BLOCKED_BY_BROWSER_SETTINGS="BLOCKED_BY_BROWSER_SETTINGS",c.SUBSCRIBE_ERROR_NETWORK="SUBSCRIBE_ERROR_NETWORK";var u=c,d=n(95001);class _ extends u{constructor(e,t){super(e,t),vk.id&&this.canBeEnabled().then((e=>{e&&(this.updateHeadClass(),this.handlerMessagesLP=this.handlerMessagesLP.bind(this),page.onChange((()=>this.updateHeadClass())))}))}canBeEnabled(){return super.canBeEnabled().then((e=>e?_.isNativeAppInstalled().then((e=>!e)):Promise.resolve(!1)))}isSupported(){return super.isSupported()&&(browser.chrome||browser.mozilla)}updateHeadClass(){var e=u.getPermission();document.head&&(removeClass(document.head,"push_notifier_"+u.PUSH_NOTIFIER_PERMISSION_GRANTED),removeClass(document.head,"push_notifier_"+u.PUSH_NOTIFIER_PERMISSION_DENIED),removeClass(document.head,"push_notifier_"+u.PUSH_NOTIFIER_PERMISSION_DEFAULT),e&&addClass(document.head,"push_notifier_"+e),addClass(document.head,"push_notifier_supported"))}handlerMessagesLP(e,t){this.sw.action("removeMessageNotification",{peerId:t,msgId:e})}cleanNotification(){this.sw.action("cleanNotification")}removeLongPollListener(){this.lp&&this.lp.off(),this.lp=null}addLongPollListener(){window.isNewMail&&window.isNewLongpoll&&!this.lp&&(this.lp=window.im.onMsgReadByMe(this.handlerMessagesLP))}static isNativeAppInstalled(){var e=Date.now(),t=o.default.get(_.PUSH_NOTIFIER_LS_KEY_RELATED_APPS_TS),n=o.default.get(_.PUSH_NOTIFIER_LS_KEY_RELATED_APPS);return new Promise((i=>{null!==n&&t&&e-t<_.PUSH_NOTIFIER_LS_TTL_RELATED_APPS?i(!!n):"getInstalledRelatedApps"in navigator?navigator.getInstalledRelatedApps().then((t=>{var n=Object.values(t).some((e=>"com.vkontakte.android"===e.id));o.default.set(_.PUSH_NOTIFIER_LS_KEY_RELATED_APPS_TS,e),o.default.set(_.PUSH_NOTIFIER_LS_KEY_RELATED_APPS,n),i(n)})).catch((()=>{i(!1)})):i(!1)}))}update(){return super.update().then((()=>{this.updateHeadClass(),this.addLongPollListener()}))}unsubscribe(e){return super.unsubscribe(e).then((()=>this.removeLongPollListener()))}}_.PUSH_NOTIFIER_LS_KEY_RELATED_APPS="push_notifier_related_apps",_.PUSH_NOTIFIER_LS_KEY_RELATED_APPS_TS="push_notifier_related_apps_ts",_.PUSH_NOTIFIER_LS_TTL_RELATED_APPS=d.HOUR/2;var h=_},99997:function(e,t){"use strict";t.default=function(e){void 0===e&&(e={});var t=["AudioPlaylistRoot",e.class].filter((e=>e)).join(" "),n={"data-playlist-id":e.playlist_id};e.hasMore&&(n["data-has-more"]=!0);return{attrs:n,inner:e.inner,class:t}}},48572:function(e,t,n){"use strict";var i=n(95040),r=n(33155);function a(){var e=(0,i.default)(["\n    <",' class="','" '," ",">\n      ","\n    </",">\n  "]);return a=function(){return e},e}t.default=function(e){void 0===e&&(e={});var t,n,i=r.default.list(e.inner);e.url?(t="a",n=r.default.attr("href",e.url)):(t=e.tag||"div",n="");return r.default.html(a(),t,e.mix,n,e.attrs,i,t)}},43186:function(e,t,n){"use strict";var i=n(48572);t.default=i.default,window.Brick=i.default},42541:function(e,t,n){"use strict";n.d(t,{default:function(){return h}});var i=n(20848),r=n(88833),a=n(39871),o={setChecked:function(e,t){void 0===t&&(t=!0);d(e).checked=t},isChecked:function(e){return d(e).checked}},s=o;o._onChange=u;var l=".Control",c=".Control__native";function u(e,t){a.default.handle(t,{$control:e.closest(l),name:e.name,checked:e.checked,value:e.value})}function d(e){return e.$(c)}var _=(0,i.extend)(r.default,s),h=_;window.Control=_},63846:function(e,t,n){"use strict";n.d(t,{default:function(){return o}});var i=function(e){return Wd.html({inner:["empty"===e.value?" ":e.value],class:[Bem.class("Oval",{type:e.gray?"minor":e.type,hidden:r(e.value)},"_"),e.mix],tag:"div"})};function r(e){return"empty"!==e&&(!e||e<=0)}Object.assign(i,{setValue:function(e,t){if(!e)return;var n=r(t);e.innerText="empty"===t?" ":t,e.classList.toggle(a,n)}});var a="Oval_hidden";var o=i;Object.assign(window,{Oval:i,Oval_isHidden:r})},53765:function(e,t,n){"use strict";n.d(t,{Popup:function(){return l},replacePopup:function(){return y},openPopup:function(){return b},closePopup:function(){return S}});var i=n(90616),r=n(39871),a=n(71437),o=n(15247),s=n(20848),l=(n(81294),{open:b,close:S});l._onOverlayClick=g;var c="Popup",u="Popup_open",d="Popup_hasScroll",_="ScrollView",h="Popup--closing",p={open:"."+u,popup:"."+c,wrap:"."+"Popup__wrap",content:"."+"Popup__content",scroll:".Popup__scroll",header:".Popup__header",footer:".Popup__footer"},f=!1,v={},m=[];function g(e,t,n){var i=e.closest(p.popup);(0,s.isFunction)(t)?t({$popup:i}):t&&r.default.handle(t,{$popup:i}),n&&S(i)}function w(e,t){var n=e.$(p.header),i=e.$(p.footer);t.scrollHeight-6>t.offsetHeight?((0,s.addClass)(e,d),(0,s.addClass)(t,_)):((0,s.removeClass)(e,d),(0,s.removeClass)(t,_),t.scrollTop=0);var r=(0,s.getCh)(),a=0,o=0;n&&(a=n.offsetHeight),i&&(o=i.offsetHeight);var l=Math.min(r-a-o-100,420);(0,s.setStyle)(t,"max-height",l+"px")}function b(e,t,n){void 0===n&&(n={});var{hash:r,oncloseCallback:a,withoutCloning:o}=n;if(E(e),f=Boolean(n.forceScrollDisable),t){if(!o){var l=e;(e=l.cloneNode(!0)).original=l}e.appendedToBody=!0,e.withoutCloning=o,document.body.appendChild(e)}e.classList.add(u);var c=e.$(p.scroll);if((0,i.disableBodyScroll)(e,{forceScrollDisable:f}),a&&m.push([e,a]),c){if(w(e,c),e.onResizeHandler=()=>{w(e,c)},(0,s.addEvent)(window,"resize",e.onResizeHandler),!window.MutationObserver)return e;e.scrollContentObserver=new MutationObserver(e.onResizeHandler),e.scrollContentObserver.observe(c,{childList:!0,subtree:!0})}if(r){var d="#pop_"+r,_=nav.cur.split("#")[0];nav.go(_+d,!1,{push_only:!0}),v[d]=e}return e}function y(e,t){return!!e&&(e.innerHTML=t.innerHTML,!0)}function S(e,t){void 0===t&&(t={});var{smooth:n,velocity:r,lastY:l}=t;if(e&&!e.classList.contains(c)&&(e=e.closest(p.popup)),e||(e=(0,a.$)(p.open)),e){var d=(0,a.$)(p.wrap,e),_=(0,a.$)(p.content,e);if(n&&r&&l){var v=(0,s.getH)(_),g=(v-l)*r.y;return g>=300&&(g=200),g=Math.max(150,Math.min(300,g)),s.setStyle.animate(d,"transform",{duration:g,func:"cubic-bezier(0.0, 0.0, 0.2, 1)"}),s.setStyle.transform(d,1,[0,v+"px"]),e.classList.add(h),setTimeout((()=>{S(e,{onClose:t.onClose})}),1.1*g)}if(n){e.classList.add(h);var w=(0,s.getH)(_);return s.setStyle.transform(d,1,[0,w+"px"]),setTimeout((()=>{S(e,{onClose:t.onClose})}),200*1.1)}if(e.classList.remove(u),e.appendedToBody&&document.body.contains(e)&&(0,s.replace)(e,e.withoutCloning?e:e.original),e.classList.remove(h),s.setStyle.transform(d),(0,s.removeEvent)(window,"resize",e.onResizeHandler),e.scrollContentObserver&&e.scrollContentObserver.disconnect(),(0,a.$)(p.open)||(0,i.enableBodyScroll)(void 0,{forceScrollDisable:f}),nav.cur&&nav.cur.startsWith("#pop_")){var b=o.default.make(nav.path,qs2obj(nav.params));nav.set({nav:(0,s.extend)({},nav,{cur:nav.path,path:nav.path||"",push:b||""})})}var y,k=(y=e,(m.find((e=>e[0]===y))||[])[1]);k&&(k(),E(e)),t.onClose&&t.onClose(),window.cur&&window.cur.app&&window.cur.app.frame&&window.cur.app.frame.focus()}}function E(e){var t=m.findIndex((t=>t[0]===e));t>=0&&m.splice(t,1)}nav.onPopState&&nav.onPopState((()=>{var e=v[nav.cur];e&&(S(e),delete v[nav.cur])})),(0,s.addEvent)(window,"keydown",(e=>{var t=e.target&&e.target.closest(".Popup")||document.activeElement&&document.activeElement.closest(".Popup")||(0,a.$)(".Popup_open");if(t&&!t.classList.contains("ModalMenu")){var n=(0,a.$)(".Popup__overlay",t);if(27===e.keyCode)n&&n.onclick(null)}}))},16800:function(e,t,n){"use strict";var i=n(64485);t.default=function(e){void 0===e&&(e={});var t=[];if(e.on_overlay_click_native)t=e.on_overlay_click_native;else{var n=!0;"boolean"==typeof e.hide_on_overlay_click&&(n=e.hide_on_overlay_click),t=["Popup._onOverlayClick","this",e.on_overlay_click||null,n]}e.content||(e.content=e.inner);return{inner:[e.rel?e.rel:null,{class:"Popup__overlay",onclick:t,tag:"div"},{inner:[{inner:[e.header?{inner:[e.header.title?{inner:[e.header.title],class:"Popup__headerTitle",tag:"div"}:null,e.header.corner?{inner:[e.header.corner.text],class:["Popup__headerCorner",e.header.corner.class],href:e.header.corner.url,onclick:e.header.corner.onclick,tag:"a"}:null],class:"Popup__header",tag:"div"}:null,e.scrollable?{inner:[{inner:[e.content],class:"Popup__scrollContent",tag:"div"}],class:"Popup__scroll ScrollView",tag:"div"}:e.content,e.footer?{inner:[e.footer],class:"Popup__footer",tag:"div"}:null],class:"Popup__content",role:"dialog","aria-modal":"true",tag:"div"}],class:"Popup__wrap",tag:"div"}],id:e.id,attrs:e.attrs,class:[e.mix?e.mix:e.class,i.default.class("Popup",{open:e.open,scrollable:e.scrollable},"_")],tag:"div"}}},49598:function(e,t,n){"use strict";n.d(t,{closePopup:function(){return r.closePopup},openPopup:function(){return r.openPopup},replacePopup:function(){return r.replacePopup}});var i=n(16800),r=n(53765);Object.assign(i.default,r.Popup),i.default.close=r.closePopup,i.default.open=r.openPopup,window.Popup=i.default,t.default=i.default},52822:function(e,t,n){"use strict";n.d(t,{SVGIcon:function(){return i.SVGIcon}});var i=n(16603);t.default=i.SVGIcon,window.SVGIcon=i.SVGIcon},59336:function(e,t,n){"use strict";n.d(t,{Separator:function(){return i.default}});var i=n(19228);t.default=i.default},5732:function(e,t,n){"use strict";n.d(t,{default:function(){return C},getCurrentElementIndex:function(){return v},getElements:function(){return p}});var i=n(64485),r=n(62641);var a=function(e){var t=!!e.bullets,n=[i.default.class("Slider",{snapping:!!e.snapping}),e.class||e.mix],a=!e.snapping||t,o=e.snapping?"true":"false",s=a?"Slider._onWheel(event, this, "+o+", "+(t?"true":"false")+")":null,l=e.onScroll;if(t&&e.snapping){if((0,r.isString)(l)&&(l=l+";"+s),(0,r.isArray)(l))l=l[0]+"("+(0,r.arraySlice)((0,r.toArray)(l),1,l.length).join(",")+");"+s;l||(l=s)}var c=[];if(t&&(0,r.isArray)(e.inner))for(var u=0;u<e.inner.length;u++)c.push({class:i.default.class("Slider__bullet",{active:0===u}),tag:"div"});return{inner:[{inner:[{inner:[e.inner],class:"Slider__line",role:"presentation",tag:"div"}],"data-bullet-index":0,attrs:e.attrs,class:["Slider__scroll","_preventMenuOpen"],onwheel:s,onscroll:l,tag:"div"},t&&{inner:[c],class:"Slider__bullets",tag:"div"}],class:n,id:e.id,tag:"div"}},o=n(20848),s=n(71437),l=n(49265);window.Slider={scrollToElem:h,nextElem:m,prevElem:g},Slider._onWheel=b,onDOMReady(S),onDOMReady((()=>{onBodyResize(y)}));var c=".Slider",u=".Slider--snapping",d=".Slider__scroll",_=".Slider__line";function h(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n="center"),e){var i=e.closest(d),r=e.offsetLeft;"center"===n&&(r-=i.offsetWidth/2-e.offsetWidth/2);var a=0;if(window.getComputedStyle){var s=getComputedStyle(e);(s.scrollMarginLeft||s.scrollSnapMarginLeft)&&(a+=(0,o.toInt)(s.scrollMarginLeft||s.scrollSnapMarginLeft))}t&&i.scrollTo?((0,o.domData)(i,"left",r-a),i.scrollTo({left:r-a,behavior:"smooth"})):i.scrollLeft=r-a}}function p(e){return e=(0,o.ge)(e),(0,s.$)(_,e).childNodes}function f(e,t){return e&&t?e.scrollWidth-e.offsetWidth<=e.scrollLeft?t.length-1:Array.from(t).map(((t,n)=>({index:n,scrollLeft:Math.abs(t.offsetLeft-e.scrollLeft)}))).sort(((e,t)=>e.scrollLeft-t.scrollLeft))[0].index:0}function v(e,t){var n=(0,s.$)(d,e);return t||(t=p(e)),f(n,t)}function m(e,t,n){void 0===t&&(t=!1);var i=p(e=(0,o.ge)(e)),r=v(e,i),a=i[r+1];m&&(h(a,t,n),e.setAttribute("data-current",(r+1).toString()))}function g(e,t,n){void 0===t&&(t=!1);var i=p(e=(0,o.ge)(e)),r=v(e,i),a=i[r-1];a&&(h(a,t,n),e.setAttribute("data-current",(r-1).toString()))}var w=(0,o.throttle)((function(e){var t,n,i,r=e.getAttribute("data-bullet-index"),a=f(e,p(e));if(r!==a.toString()){var o=e.parentNode;if(o){var s=null==(t=o.querySelector(".Slider__bullets"))?void 0:t.childNodes;s&&(e.setAttribute("data-bullet-index",a),null==(n=s[Number(r)])||n.classList.remove("Slider__bullet--active"),null==(i=s[a])||i.classList.add("Slider__bullet--active"))}}}),200);function b(e,t,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=!1),i&&w(t),!n){e.preventDefault();var r=e.deltaX,a=e.deltaY;Math.abs(r)>Math.abs(a)&&(t.scrollLeft+=r)}}function y(){var e=(0,s.$$)(u);Array.from(e).forEach((e=>{var t=(0,s.$)(d,e);t.scrollLeft=t.scrollLeft}))}function S(){(l.default.ios||l.default.msie_edge)&&(onDOMReady(k),window.page&&window.page.onChange(k),window.MutationObserver&&onDOMReady((()=>{document.body&&new MutationObserver(E).observe(document.body,{subtree:!0,childList:!0})})))}function E(e){e.forEach((e=>{e.addedNodes.forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&e.$$(c).forEach(P)}))}))}function k(){(0,s.$$)(c).forEach(P)}function P(e){var t=getComputedStyle(e),n=Number(t.paddingTop.replace("px","")),i=Number(t.paddingBottom.replace("px",""));e.style.overflow="hidden",e.style.height=e.offsetHeight-n-i+"px",e.$(d).style.paddingBottom="20px"}var C=a;window.Slider=a,(0,o.extend)(a,{scrollToElem:h,nextElem:m,prevElem:g,_onWheel:b})},94374:function(e,t,n){"use strict";n.d(t,{init:function(){return C},close:function(){return T},SNACKBAR_POSITION_MAIL:function(){return _},SNACKBAR_TYPE_SUCCESS:function(){return g},SNACKBAR_TYPE_ERROR:function(){return w},SNACKBAR_TYPE_BOOKMARK:function(){return b},SNACKBAR_TYPE_BULLYING:function(){return y}});var i=n(85863),r=n(20848),a=n(71437),o=n(79764),s=n(12449),l=n(65256),c=n(41313),u=n(15247);window.Snackbar={init:C,close:T,_onActionClick:function(e,t){var n=m[t];if(!n)return void(0,r.hide)(t);var{callback:i,url:a}=n;i?"function"==typeof i?i.call(null,e,{id:t,url:a}):Wd.handle2(i,e,{id:t,url:a}):(0,r.hide)(t)},_onRestoreClick:function(e,t,n){var i=t.closest(".SnackbarItem"),a=(0,r.domData)(i,"snackbar-id"),s=m[a];e.stopPropagation(),e.preventDefault();var{callback:l}=s;l&&("function"==typeof l?l.call(null,e,{id:a,url:n}):Wd.handle2(l,e,{id:a,url:n}));T(a),o.default.click(n,null,{url_params:{_ajax:1,_snackbar:1}})}};var d="common",_="mail",h="SnackbarItem_added",p="SnackbarItem_removed",f="SnackbarItem--closing",v=0,m={},g=1,w=2,b=3,y=4,S="touchstart",E="touchmove",k="touchcancel touchend",P=[];function C(e){if(!l.SAKIntegration.isIntegrated){var t=isFinite(e.duration)?e.duration:5e3,n=v++,i=e.action&&e.action.callback,o=e.action&&e.action.url;e.position=e.position||d;var s=e.position;e.id=n,i&&!e.action.onclick&&(e.action.onclick=["Snackbar._onActionClick","event",n]),e.bottom&&(e.style="bottom: "+e.bottom+"px");var c,u=Wd.elem(SnackbarItem(e));return function(e,t){if(t.position===d)(0,r.append)(e,document.body);else if(t.position===_){var n="msg"===window.store.mail.cur.page?(0,a.$)(".messenger__layer_page .messenger__header"):(0,a.$)(".messenger__layer_convo .messenger__header");(0,r.append)(e,n)}setTimeout((()=>{e.classList.add(h)}),100)}(u,e),t&&(c=I(n,t)),(0,r.addEvent)(u,S,j,{passive:!0}),(0,r.addEvent)(u,E,D,{capture:!1}),(0,r.addEvent)(u,k,V,{passive:!0}),m[n]={id:n,timer:c,callback:i,url:o,duration:t,position:s},P.push(n),A(),n}l.SAKIntegration.sendMessage("show_snackbar",{type:e.type,text:e.text})}function A(){var e=(P=P.filter((e=>{var t=m[e],n=x(e);return!(!t||!n)}))).reduce(((e,t)=>{var n=m[t];return e[n.position]||(e[n.position]=[]),e[n.position].push(t),e}),{});Object.keys(e).forEach((t=>{var n=e[t],i=0,a=t===_?8:12;n.forEach(((e,n)=>{var o=x(e),s=(0,r.getH)(o);m[e].vertical=t===_?i:-i,r.setStyle.transform(o,1,[0,m[e].vertical]),i+=s+a}))}))}function I(e,t){return setTimeout((()=>{T(e,!1)}),t)}function T(e,t){var n=m[e],i=x(e);n&&(n.timer&&clearTimeout(n.timer),delete m[e]),i&&function(e,t){var n=600;if((0,r.removeEvent)(e,S,j,{passive:!0}),(0,r.removeEvent)(e,E,D,{capture:!1}),(0,r.removeEvent)(e,k,V,{passive:!0}),t)return(0,r.remove)(e),void A();e.classList.add(f);if(!e)return;e.classList.add(p),setTimeout((()=>{(0,r.remove)(e),A()}),n)}(i,t)}function x(e){return(0,a.$)(".SnackbarItem_"+e)}onDOMReady((()=>{onBodyResize(A)}));var R=!1,L=null,N=!1,O=0,B=!1,M=(0,r.getCw)();function j(e){if(M=(0,r.getCw)(),e.touches&&e.touches.length>1)R=!1;else{var t=e.target.closest(".SnackbarItem");t.classList.add("SnackbarItem--dragging");var n=(0,r.domData)(t,"snackbar-id");if(M>=s.DESKTOP_WIDTH&&(B=!0),m[n].position===_){B=!1;var i=(0,a.$)(".messenger");M=(0,r.getW)(i),m[n].parentXY=(0,r.getXY)(i)}else m[n].parentXY=(0,r.getXY)(bodyNode);m[n].timer&&clearTimeout(m[n].timer),L=e.touches[0],O=e.touches[0].clientX,R=!0,N=n,document.body.style.overflow="hidden"}}function D(e){var t=N;if(e.preventDefault(),e.touches&&e.touches.length>1)R=!1;else if(L&&R){var n=e.touches[0],i=e.target.closest(".SnackbarItem"),a=-(O-n.clientX);B&&(a=Math.min(a,0));var o=(0,r.getX)(i),s=((0,r.getW)(i)+a)/2+o-m[t].parentXY[0],l=s>=.95*M||s<=M/.95-M;m[t].canClose=l,r.setStyle.transform(i,1,[a,m[t].vertical])}}function V(e){var t=e.target.closest(".SnackbarItem");t.classList.remove("SnackbarItem--dragging");var n=(0,r.domData)(t,"snackbar-id"),i=m[n];if(m[n].dragging=!1,N=!1,document.body.style.overflow="visible",i.canClose){var a=(0,r.getX)(t)>0?(0,r.getCw)():-(0,r.getCw)();return(0,r.getCw)()>=s.DESKTOP_WIDTH&&(a=(0,r.getX)(t)>(0,r.getCw)()/2?(0,r.getCw)():-(0,r.getCw)()),r.setStyle.transform(t,1,[a,m[n].vertical||0]),void T(n)}m[n].timer=I(n,i.duration),t&&r.setStyle.transform(t,1,[0,m[n].vertical||0])}(0,c.onServerEvent)("Snackbar/show").watch((e=>{C(e);var t=u.default.make(nav.path,(0,i.default)({},nav.getQuery(),{m:null}));nav.set({replace:!0,nav:(0,r.extend)({},nav,{cur:t,path:nav.path||"",push:t||""})}),setTimeout((()=>{window.page.save(t,{st:(0,r.scrollTop)(),page:(0,a.$)("#m"),state:window.page.stash(),cur:window.cur,options:{replacePrevPage:!0}},!1)}));var n=(0,a.$)(".pcont .SnackbarItem--static");n&&n.innerText.includes(e.text)&&(0,r.remove)(n)}))},57141:function(e,t,n){"use strict";n.d(t,{SNACKBAR_POSITION_MAIL:function(){return _.SNACKBAR_POSITION_MAIL},SNACKBAR_TYPE_BOOKMARK:function(){return _.SNACKBAR_TYPE_BOOKMARK},SNACKBAR_TYPE_BULLYING:function(){return _.SNACKBAR_TYPE_BULLYING},SNACKBAR_TYPE_ERROR:function(){return _.SNACKBAR_TYPE_ERROR},SNACKBAR_TYPE_SUCCESS:function(){return _.SNACKBAR_TYPE_SUCCESS},close:function(){return _.close},init:function(){return _.init}});var i=n(64485),r=n(81294),a=n(52822),o=n(62641),s=n(45387),l=n(41679),c=n(64523),u=n(47575),d=function(e){void 0===e&&(e={});var t=e.position||"bottom",n=!(!e.type||e.image),d={class:i.default.class("SnackbarItem__cell",{left:!0,image:!!e.image,top:e.avatar&&"left"===e.avatar_position,icon:n},"_")},_={class:i.default.class("SnackbarItem__cell",{right:!0,avatar:!!e.avatar},"_")},h=!1,p=!1;if(e.type){h=!0;var f=null;switch(e.type){case 1:f=(0,a.default)((0,s.getSnackbarDone24Icon)());break;case 2:f=(0,a.default)((0,l.getSnackbarError24Icon)());break;case 3:f=(0,a.default)((0,c.getFavorites24Icon)());break;case 4:f=(0,a.default)((0,u.getErrorFill24Icon)())}d.inner={class:"SnackbarItem__icon",inner:f}}e.image&&(h=!0,d.inner={class:"SnackbarItem__image",inner:{tag:"img",src:e.image}});e.action&&(p=!0,_.inner=(0,r.default)({theme:"none",class:"SnackbarItem__action",url:e.action.url,target:e.action.target,on_click:e.action.onclick,use_native_onclick:!0,inner:Wd.wrap(e.action.text),attrs:e.action.attrs}));if(e.avatar){var v={tag:"img",class:"SnackbarItem__avatar",src:e.avatar};e.avatar_position&&"right"!==e.avatar_position?"left"===e.avatar_position&&(h=!0,d.inner=v):(p=!0,_.inner=v)}return{style:e.style?e.style:"",class:["SnackbarItem_"+e.id,"SnackbarItem--"+t+" ",i.default.class("SnackbarItem",{static:!!e.static,vertical:!!e.vertical,hasIcon:n}),e.className||e.class],attrs:{"data-snackbar-id":e.id},inner:[{class:"SnackbarItem__table",inner:[h?d:null,e.text?{class:i.default.class("SnackbarItem__cell",{text:!0},"_"),inner:{class:"SnackbarItem__text",inner:(0,o.isObject)(e.text)?e.text:Wd.wrap(e.text)}}:null,p?_:null]}]}};var _=n(94374);window.SnackbarItem=d},30675:function(e,t,n){"use strict";n.d(t,{default:function(){return c}});var i=n(64485),r=n(39871),a=n(43365),o=n(81294),s=n(59336),l=n(32144);var c=function(e){void 0===e&&(e={});var t=null;e.icon_raw?t=e.icon_raw:e.icon&&(t=(0,a.Icon)({class:"SplashScreen__icon",icon:e.icon,svg:e.is_svg_icon}));var n=r.default.wrap(e.more_text);"primary"!==e.more_type&&"regular"!==e.more_type&&"outlineMono"!==e.more_type||(n=(0,o.default)({inner:[e.more_text],theme:e.more_type,url:e.more_url,onClick:e.more_onclick,attrs:{ontouchend:e.more_ontouchend},use_native_onclick:e.more_native_onclick}),e.more_url=null);var c=[e.class,i.default.class("SplashScreen",e.mix||{},"_")];e.small&&c.push("SplashScreen--small");return[e.separator?(0,s.default)({hideOnDesktop:!e.separator_desktop}):null,{inner:[e.inner||[e.before,t,e.title?{inner:[r.default.wrap(e.title)],class:"SplashScreen__title",tag:"div"}:null,e.text?{inner:[r.default.wrap(e.text)],class:[e.text_class,"SplashScreen__text"],tag:"div"}:null,e.more_text?(0,l.CustomTag)({inner:[n],class:"SplashScreen__more",tag:e.more_url?"a":"div",href:e.more_url}):null,e.action_text?{inner:[{inner:[r.default.wrap(e.action_text)],class:"SplashScreen__actionButton",href:e.action_url,tag:"a"}],class:"SplashScreen__action",tag:"div"}:null]],class:c,tag:"div"}].filter((e=>e))}},90893:function(e,t,n){"use strict";n.d(t,{default:function(){return g},getNative:function(){return v},getValue:function(){return p},setPrefix:function(){return f}});var i=n(64485),r=n(62641),a=n(39871),o=function(e){void 0===e&&(e={});var t=e.style||[],n=e.class||e.mix,o=e.prefix,s=e.postfix,l=e.icon,c=function(e){var t=[];(0,r.isArray)(e.on_key_down)?(e.on_key_down.push("event"),t=e.on_key_down):e.on_key_down&&(t=[e.on_key_down,"event"]);var n=e.on_key_press,i="function"==typeof e.on_change,o="function"==typeof e.onblur,s="function"==typeof e.onfocus,l=(0,r.concatValues)("TextInput.onChange(event);",a.default.isAttrHandler("oninput",e.on_change)?a.default.prepareHandler(e.on_change):i?"":e.on_change),c=(0,r.concatValues)("TextInput.onBlur(event, this);",a.default.isAttrHandler("onblur",e.onblur)?a.default.prepareHandler(e.onblur):o?"":e.onblur),u=(0,r.concatValues)("TextInput.onFocus(event, this);",a.default.isAttrHandler("onfocus",e.onfocus)?a.default.prepareHandler(e.onfocus):s?"":e.onfocus);i&&(l=(0,r.preactCallback)([[l],[e.on_change]]));o&&(c=(0,r.preactCallback)([[l],[e.onblur]]));s&&(u=(0,r.preactCallback)([[l],[e.onfocus]]));return{class:"TextInput__native",id:e.id,type:e.type,name:e.name,value:e.value,spellcheck:e.spellcheck+"",placeholder:a.default.wrap(e.placeholder),autocapitalize:!1===e.autocapitalize?"off":null,autocomplete:!1===e.autocomplete?"off":e.autocomplete,tabindex:e.tabindex,readonly:e.readonly,disabled:e.disabled,oninput:l,onkeydown:t,onkeypress:n,onblur:c,onfocus:u,autofocus:e.autofocus,maxlength:e.maxlength,pattern:e.pattern,required:e.required,inputmode:e.inputmode,"aria-describedby":e["aria-describedby"],tag:"input"}}(e),u=e.error;u&&(t.error=!0);var d=!(o||s||l||"string"==typeof u);return{inner:[{inner:[d?c:[l?{inner:[l],class:"TextInput__icon",tag:"div"}:null,o?{inner:[o.text],class:[i.default.class("TextInput__prefix",{rightPadding:o.with_right_padding,gray:o.gray},"_"),o.mix],tag:"div"}:null,{inner:[c],class:"TextInput__nativeWrap",tag:"div"},s?{inner:[s.text],class:"TextInput__postfix",tag:"div"}:null]],class:"TextInput__content",tag:"div"},"string"==typeof u?{inner:[u],class:"TextInput__errorLabel",tag:"span"}:null],role:"presentational",class:[i.default.class("TextInput",{style_stretch:t.stretch,prefixed:!!o,withIcon:!!l,hidden:"hidden"===e.type,error:t.error,native:d,disabled:!!e.disabled||!!e.readonly},"_"),n],onclick:e.on_click,tag:"label"}};var s=n(71437),l=n(69161),c=n(20848),u=n(63848);Object.assign(o,{setPrefix:f,getValue:p,filter:function(e,t,n){if("number"===e){var i=(0,c.val)(n)+String.fromCharCode(t.which);(0,l.isNumber)(parseInt(i))||(0,c.cancelEvent)(t),(0,c.val)(n,(0,c.val)(n).split("").filter((e=>(0,l.isNumber)(+e))).join(""))}},onFocus:function(e,t){var n=t.closest(d);setTimeout((()=>{n.classList.add("TextInput--focused")}))},onBlur:function(e,t){var n,i=t.closest(d),r=null==(n=e.relatedTarget)?void 0:n.closest(d),a=(0,s.$)(_,i);if(i===r&&!(0,u.isTabbing)())return void a.focus();if(setTimeout((()=>{var e;"BUTTON"===(null==(e=document.activeElement)?void 0:e.tagName)&&i.contains(document.activeElement)&&(0,c.addEvent)(document.activeElement,"blur",m)})),r===i)return;setTimeout((()=>{i.classList.remove("TextInput--focused")}))},onChange:function(e){var{value:t}=e.target;e.target.closest(d).classList.toggle("TextInput--notEmpty",!!t)}});var d=".TextInput",_=".TextInput__native",h=".TextInput__prefix";function p(e){return e.$(_).value}function f(e,t){e.$(h).innerText=t}function v(e){return(0,s.$)(_,e)}function m(e){var t=e.target.closest(d);(0,c.removeEvent)(e.target,"blur",m),t&&t.classList.remove("TextInput--focused")}var g=o;window.TextInput=o},58208:function(e,t,n){"use strict";n.d(t,{default:function(){return T}});var i=n(33155),r=n(43186),a=n(43365),o=n(63846),s=n(36461),l=n(32144),c=n(62641),u=n(39871),d=function(e){var t="unfold-"+Date.now()+"-"+Math.round(9999*Math.random());e.uniqueId=t;var n=i.default.class(e.mix,"Unfold",{position:e.position,asIcon:!!e.icon||!!e.icon_html,open:e.opened,withTitle:!!e.title}),r=i.default.list(e.items,h);return u.default.html({inner:[(0,l.CustomTag)({inner:[_(e)],tag:e.triggerWrapperTag,class:"Unfold__trigger"}),{inner:[u.default.wrap(r)],id:t,class:["Unfold__popup","ScrollView",e.popup_class].filter((e=>e)).join(" "),tag:"ul"}],class:n,"data-name":e.name,onclick:e.onclick,tag:"div"})};function _(e){var t,n=e.title;if(e.icon)t=u.default.html((0,a.default)({icon:e.icon}));else if(e.icon_html)t=e.icon_html;else{for(var o=e.items,l=o.length,d="",_="",h=0;h<l;h++){var p=o[h];if(p&&p.active){d=p.text,_=p.activeCount;break}}t=[(0,r.default)({mix:"Unfold__triggerText",tag:"div",inner:u.default.html({inner:[n?[{inner:[n],class:"Unfold__triggerContentTitle",tag:"div"},{inner:[d],class:"Unfold__triggerContentSubTitle",tag:"div"}]:[d]],class:"Unfold__triggerContent",tag:"div"})}),!n&&_?(0,r.default)({mix:"Unfold__triggerTextCount",inner:_}):"",u.default.html({inner:[(0,s.Icon16Dropdown)()],class:"Unfold__triggerIcon",tag:"div"})],t=i.default.list(t)}var f=e.opened?e.close_url:e.open_url,v=(0,c.mergeObjects)({},e.trigger_attrs);return e.isDisabled&&(v.disabled=!0),{inner:[u.default.wrap(t)],type:"button","aria-haspopup":"true","aria-expanded":"false","aria-controls":e.uniqueId,href:f,class:"Unfold__trigger",onclick:["Unfold._onTriggerClick","this"],attrs:v,tag:"button"}}function h(e){if(!e)return"";var t="";e.svgIcon?t=u.default.html({inner:[e.svgIcon],class:"Unfold__itemIcon",tag:"div"}):e.icon&&(t="string"==typeof e.icon?u.default.html((0,a.default)({mix:"Unfold__itemIcon",icon:e.icon})):(0,r.default)({mix:i.default.class("Unfold__itemIcon"),inner:u.default.html(e.icon)})),e.attrs+=' data-name="'+e.name+'"',e.active&&(e.attrs+=' aria-current="true"'),e.preventNavigation&&(e.attrs+=' data-prevent-navigation="1"');var n=0===e.count||e.count;return(0,r.default)({inner:[t,(0,r.default)({inner:[e.text,n?(0,r.default)({mix:"Unfold__itemCountHidden",inner:e.count}):""],mix:"Unfold__itemText"}),n?(0,o.default)({mix:"Unfold__itemCount",gray:!0,value:e.count}):""],mix:i.default.class(e.mix,"_touched","replaceState","Unfold__item",{active:e.active,name:e.name,disabled:e.disabled,replaceState:e.replaceState}),url:e.url,tag:e.tag,attrs:e.attrs})}var p=n(20848),f=n(71437),v=n(49265),m=n(63848);Object.assign(d,{onOpen:befall.kind("unfoldName"),getByName:function(e){return(0,f.$)(C.unfoldByName(e))},setActive:A,setCount:function(e,t,n){var i=e.$(C.itemCountByName(t));o.default.setValue(i,n)},setTitle:function(e,t,n){e.$(C.itemByName(t)).$(C.itemText).innerText=n},toggleItemEnabled:function(e,t,n){void 0===n&&(n=!0);if(!e)return;var i=e.$(C.itemByName(t));i&&i.classList.toggle(w,!n)},changePosition:function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!1);var i;e.classList.remove(y,S,E,k),i=t?n?y:E:n?S:k;e.classList.add(i)}}),d._onTriggerClick=I;var g="Unfold__item_active",w="Unfold__item_disabled",b="Unfold_open",y="Unfold_position_topLeft",S="Unfold_position_topRight",E="Unfold_position_bottomLeft",k="Unfold_position_bottomRight",P="Unfold__item_replaceState",C={unfold:".Unfold",unfoldByName:e=>'.Unfold[data-name="'+e+'"]',itemActive:"."+g,itemByName:e=>".Unfold__item_name_"+e,itemCountByName:e=>C.itemByName(e)+" .Unfold__itemCount",item:".Unfold__item",itemDisabled:"."+w,triggerText:".Unfold__triggerText",itemText:".Unfold__itemText",popup:".Unfold__popup"};function A(e,t){var n,i;if(1===arguments.length?e=(i=e).closest(C.unfold):i=e.$(C.itemByName(t)),(n=e.$(C.itemActive))&&i){n.classList.remove(g),i.classList.add(g);var r=e.$(C.triggerText),a=i.$(C.itemText);r.innerText=a.textContent.trim()}}function I(e){var t=e.closest(C.unfold),n=v.isTouch?"touchend":"mousedown",i=v.isTouch?"touchend":"mouseup",r=!v.isTouch&&window.innerWidth<882,a=t.getAttribute("data-name"),o=!1;a&&d.onOpen(a)(),t.classList.add(b),document.addEventListener("touchmove",_,{passive:!0}),v.default.msie_mobile?document.addEventListener(i,h,!0):document.addEventListener(n,g,!0);var s=()=>{},l=()=>{},c=(0,f.$)(C.popup,t);function u(){t.classList.remove(b),document.removeEventListener("touchmove",_),document.removeEventListener(n,g,!0),document.removeEventListener(i,h,!0),(0,m.onTransitionEnd)(c).then((()=>{l&&l(),s&&s()}))}function _(e){e.target.closest(C.popup)||u(),o=!0}function h(){document.addEventListener(n,g,!0)}function g(e){if(o)o=!1;else{var t=e.target.closest(C.itemDisabled);if(!t){var n=e.target.closest(C.item+"[href]");if(n){if(v.default.safari&&v.default.safari_mobile&&v.default.version<9)setTimeout(u,500);else{(0,p.cancelEvent)(e);var i=(0,p.domData)(n,"prevent-navigation");if(i||nav.onBeforeGo((()=>{u()})),n.classList.contains(P))A(n.closest(C.unfold),(0,p.domData)(n,"name"));i?u():nav.go(n)}return}if(n=e.target.closest(C.item+"[onclick]")||e.target.closest(C.item+"[onmousedown]"))return void setTimeout(u);if(n=e.target.closest("label"+C.item))return void(v.default.safari&&v.default.safari_mobile&&v.default.version<9?setTimeout(u,500):setTimeout(u));if(n=e.target.closest("input[onchange]"))return void(v.default.safari&&v.default.safari_mobile&&v.default.version<9?setTimeout(u,500):setTimeout(u))}(v.isTouch||r||t)&&(e.preventDefault(),e.stopImmediatePropagation()),(r||!v.isTouch&&t)&&document.addEventListener("click",w,!0),t||u()}}function w(e){e.preventDefault(),e.stopImmediatePropagation(),document.removeEventListener("click",w,!0)}c&&(0,m.onTransitionEnd)(c).then((()=>{(l=(0,m.expandPopup)(e)).exitIntent=()=>!1,(s=(0,m.setFocusTrap)(c))&&(s.exitIntent=()=>(u(),!1))}))}var T=d;window.Unfold=d},63918:function(e,t,n){"use strict";var i=n(49598),r=n(81294),a=n(85703);t.default=function(e){var t=function(e){var{buttons:t}=e,n=Object.keys(t).map((n=>{var i=t[n],a=i.theme;a="yes"!==n||a?"secondary":"regular";var o={"data-key":n,"data-force":e.force?1:0};return(0,r.default)({inner:[i.text],theme:a,url:i.href,attrs:o,on_click:i.onClick||"ConfirmPopup.onButtonClick(this, event);",use_native_onclick:!0})}));return(0,a.BtnStack)({inner:[n]})}(e),n={title:e.title};return(0,i.default)({inner:[Wd.wrap(e.text),{inner:[t],class:"Popup__buttons",tag:"div"}],class:"ConfirmPopup",header:n,scrollable:!0,attrs:' data-use-navigation="'+!!e.useNavigation+'"',on_overlay_click_native:e.onOverlayClick||"ConfirmPopup.onOverlayClick(this, event);"})}},62124:function(e,t,n){"use strict";function i(e){return void 0===e&&(e={}),{inner:[e.inner],id:e.id,class:"FormLayout",action:e.action,method:e.method||"POST",onSubmit:e.onsubmit||e.onSubmit,noValidate:e.noValidate,tag:"form"}}n.d(t,{FormLayout:function(){return i}})},23634:function(e,t,n){"use strict";n.d(t,{default:function(){return a}});var i=n(64485),r=n(4726);var a=function(e){void 0===e&&(e={});var t=i.default.class("AlbumInfoRow",{withoutBottomBorder:e.withoutBottomBorder});return{inner:[{inner:[(0,r.Avatar)({mode:"both",backgroundTheme:e.id,text:e.name,size:40,src:e.avatar})],class:"AlbumInfoRow__avatar",href:e.author_url,onclick:"cancelEvent(event); nav.go(this);",tag:"a"},{inner:[{inner:[e.title],class:"AlbumInfoRow__title",href:e.url,tag:"a"},{inner:[e.subtitle],class:"AlbumInfoRow__subtitle",tag:"div"}],class:"AlbumInfoRow__content",tag:"div"}],class:t,onclick:"nav.go('"+e.url+"')",tag:"div"}}},12531:function(e,t,n){"use strict";n.d(t,{default:function(){return d},getDataFromDOM:function(){return u}});var i=n(52822),r=n(64485),a=n(36461),o=n(78102);var s=function(e){var t,n,s=e.album,l=s.url,c=s.title,u=s.photos_count_label,d=s.restriction,_="";if(d){var h={};h[d.type]=!0,_=r.default.class("AlbumItem__restriction",h)}if(t=e.emptyIcon?e.emptyIcon:(0,i.default)({icon:(0,o.getCameraOutline56Icon)()}),d&&"geo"===d.type)n={inner:[{inner:[(0,a.Icon56DoNotDisturbOutline)()],class:_,tag:"div"}],class:"AlbumItem__thumb",tag:"div"};else{var p=[r.default.class("AlbumItem__thumb",{blur:d&&"blur"===d.type})];n={inner:[!s||s.thumb||d?null:{inner:[t],class:"AlbumItem__emptyThumbIcon",tag:"div"},d&&d.type?{inner:[(0,a.Icon56HideOutline)()],class:_,tag:"div"}:null],class:p,"data-thumb-id":s.thumb_id,style:"background-image: url("+s.thumb+")",tag:"div"}}return{inner:[{inner:[n],class:"AlbumItem__thumbWrap",tag:"div"},{inner:[{inner:[c],class:"AlbumItemInfo__title",tag:"div"},{inner:[u],class:"AlbumItemInfo__subtitle",tag:"div"}],class:"AlbumItemInfo",tag:"div"}],href:l,class:"AlbumItem al_album",onclick:e.onClick,"data-count":s.count,tag:"a"}},l=n(20848),c=n(71437);function u(e){if(!e.classList.contains("AlbumItem"))return{};var t=(0,l.val)((0,c.$)(".AlbumItemInfo__title",e))||"",n=(0,l.val)((0,c.$)(".AlbumItemInfo__subtitle",e))||"",i=e.getAttribute("href"),r=(0,c.$)(".AlbumItem__thumb",e),a=/url\("(.*)"\)/.exec(r.style.backgroundImage),o=!!a&&a[1],s=(0,c.$)(".AlbumItem__restriction",e),u=!1;return s&&(s.classList.contains("AlbumItem__restriction--blur")?u={type:"blur"}:s.classList.contains("AlbumItem__restriction--geo")&&(u={type:"geo"})),{album:{title:Wd.wrap(t),photos_count_label:n,url:i,thumb:o,restriction:u},onClick:e.getAttribute("onclick")}}var d=s},88706:function(e,t,n){"use strict";n.d(t,{default:function(){return S},initAlbumPage:function(){return m}});var i=n(99667),r=n(30675),a=n(31931),o=n(64485),s=n(75377),l=n(34044);var c,u,d=function(e){void 0===e&&(e={});var t=window.lang,n=e.title||"",c=e.description||"",u=e.pretag,d=e.buttons||{},_=(e.photos||[]).map((e=>(0,i.default)({photo:e}))),h=null,p=(0,s.default)({inner:[_],class:"AlbumPage__photos",isReversedOrder:e.rev,isMainList:!0});h=e.is_loading?[(0,a.default)({mix:"al_loading",type:"pageLoader"}),p]:_.length?p:[(0,r.default)({small:!0,separator:!0,more_text:e.add_url&&e.is_owner?t.mobile_photos_placeholder_album_action:null,more_onclick:"return window.AlbumPage.add(event)",more_native_onclick:!0,more_type:"regular",more_url:e.add_url,text:t.mobile_photos_placeholder_album_text}),p];var f=o.default.class("AlbumPage",{withoutDescription:!c});return(0,l.default)({inner:[{inner:[{inner:[n],class:"AlbumPage__title",tag:"h2"},c&&{inner:[c],class:"AlbumPage__description",tag:"span"}],class:"AlbumPage__info",tag:"div"},d.prev,h,d.more,u],class:f})},_=n(20848),h=n(71437),p=n(64546),f=null,v=null;function m(){(0,h.$)(".AlbumPage")&&(w(),(0,_.onBodyScroll)(b),(0,_.onBodyScroll)(!0))}function g(){w()}function w(){f=null,c=0,v=null,u=""}function b(){if(f||(f=(0,h.$)(".AlbumPage__title"),c=(0,_.getH)(f)),v||(v=(0,h.$)(".header__title",(0,h.$)("#mhead"))),!v)return(0,_.onBodyScroll)("__clear",b);u||(u=(0,h.$)(".header__text",v));var e=Math.min(40,Math.max(0,(0,_.getY)(f)-c-(0,_.scrollTop)()));_.setStyle.transform(u,1,[0,e]),v.classList.toggle("header__title--initial-position",0===e)}window.AlbumPage={add:function(e){return!(0,_.checkEvent)(e)&&(window.ContextMenu.close(e.target),(0,p.openFilePicker)()?(0,_.cancelEvent)(e):void 0)}};var y=n(47023);y.default.getRouter().addRoute(/\/(?:album|tag)(-?\d+(?:_\d+)?)/,m,g),y.default.getRouter().addRoute(/\/(?:attachments\?act=choose_photo).*(?:album|tag)=(-?\d+(?:_\d+)?)/,m,g);var S=d},46153:function(e,t,n){"use strict";n.d(t,{default:function(){return h}});var i=n(30675),r=n(12531),a=n(72107),o=n(62641),s=n(5732);var l=function(e){void 0===e&&(e={});var t=window.lang,n=e.items||[],i=e.count||null,l=e.emptyIcon||null,c=e.href,u=e.header||t.mobile_photos_block_albums_title,d=n.map((e=>({inner:[(0,r.default)({album:e,emptyIcon:l})],class:"AlbumsBlock__album",tag:"div"}))),_={text:(0,o.getLang)("mobile_subheader_show_all"),class:"al_albums",url:c},h=(0,s.default)({inner:[{inner:[d],class:"AlbumsBlock__albums",tag:"div"}]});return{inner:[{name:"albums",tag:"a"},(0,a.default)({title:u,count:i,corner:_,content:h,no_border:!0,noShadow:!0})],class:"AlbumsBlock",tag:"div"}},c=n(99667),u=n(75377);var d=function(e){var t=window.lang,n=e.items||[],i=e.count||null,r=e.buttons||{},s=e.href,l=e.hide_header||!1,d=e.label||t.mobile_photos_block_photos_title,_=!!e.autoload,h=e.is_main,p=n.map((e=>(0,c.default)({photo:e}))),f=(0,u.default)({inner:[p],class:"PhotosBlock__photos",isReversedOrder:!0,isMainList:h}),v=null;return s&&(v={text:(0,o.getLang)("mobile_subheader_show_all"),class:"al_empty",url:s}),{inner:[h?{name:"photos",tag:"a"}:null,(0,a.default)({inner:[{inner:[r.prev,f,r.more],tag:"div"}],title:l?null:d,corner:v,count:i,noShadow:!0,no_border:!0})],class:(0,o.classNames)("PhotosBlock",{"PhotosBlock--autoload":_}),tag:"div"}},_=n(59336);var h=function(e){var t=window.lang,n=e.pretag,a=e.buttons||{},o=e.is_owner,s=[],c=e.section,u=e.albums,h=e.albums_count,p=e.albums_href,f=e.photos,v=e.photos_count,m=e.new_tags_photos,g=e.new_tags_count,w=e.new_tags_href,b=e.emptyIcon||null;if("all"===c){var y=u.map((e=>(0,r.default)({album:e,is_owner:o,emptyIcon:b})));y&&s.push({inner:[a.prev?a.prev:null,{inner:[y],class:"AlbumsPage__items album_items photos_page bl_cont",tag:"div"},a.more?a.more:null],tag:"div"})}else u&&u.length&&s.push(l({items:u,count:h,href:p})),m&&m.length&&s.push(d({label:t.mobile_photos_block_tags_title,items:m,count:g,href:w})),f&&f.length&&s.push(d({autoload:!0,is_main:!0,items:f,count:v,buttons:a}));if(!s.length){var S=o?t.mobile_albums_can_store_photos:t.mobile_albums_no_albums;return(0,i.default)({separator:!0,text:S,more_type:"primary",more_text:e.add_url?t.mobile_photos_placeholder_album_action:null,more_url:e.add_url})}return{inner:["all"!==c?(0,_.default)({hideOnDesktop:!0}):null,{inner:[s],class:"upanel bl_cont",tag:"div"},n],class:"AlbumsPage PageBlock PageBlock_bottomPadding",tag:"div"}}},99667:function(e,t,n){"use strict";var i=n(75341);t.default=i.default},53006:function(e,t,n){"use strict";n.d(t,{_PhotoviewPage_tags:function(){return h}});var i=n(72107),r=n(23634),a=n(62641),o=n(81294),s=n(85703),l=n(42541),c=n(31931),u=n(38869);function d(e){var t="wi_like_wrap";e.liked_people||(t+=" is_empty");var n="PhotoviewPage__description";return e.photo.description||(n+=" PhotoviewPage__description--empty"),{inner:[{inner:[Wd.wrap(e.photo.caption)],class:"PhotoviewPage__caption",tag:"div"},{inner:[Wd.wrap(e.photo.description)],class:n,tag:"div"},{inner:[e.liked_people?e.liked_people:null],class:t,tag:"div"},e.buttons?{inner:[{inner:[e.buttons],class:"wi_buttons",tag:"div"}],class:"wi_buttons_wrap",tag:"div"}:null,e.author,e.replies],class:"PhotoviewPage__footer",tag:"div"}}function _(e){var t=window.lang;return{inner:[{inner:[e.edit_data.rotate.can_rotate?(0,s.BtnStack)({inner:[(0,o.default)({inner:[t.mobile_photos_edit_rotate_left],url:e.edit_data.rotate.left,stretch:!0}),(0,o.default)({inner:[t.mobile_photos_edit_rotate_right],url:e.edit_data.rotate.right,stretch:!0})],nowrap:!0}):null,{inner:[{inner:[t.mobile_photos_edit_desc_label],class:"fi_label",tag:"dt"},{inner:[{inner:[e.photo.description],name:"text",class:"textfield",rows:"4",tag:"textarea"}],class:"iwrap",tag:"dd"}],class:"fi_row",tag:"dl"},{inner:[{inner:[t.mobile_photos_edit_album_label],class:"fi_label",tag:"dt"},{inner:[{inner:[e.edit_data.albums.map((e=>({inner:[e.name],selected:e.selected?"selected":null,value:e.id,tag:"option"})))],name:"aid",tag:"select"},{inner:[(0,l.default)({withoutWrap:!0,name:"cover",label:t.mobile_photos_edit_cover_label,type:"checkbox"})],class:"fi_subrow",tag:"div"}],class:"iwrap",tag:"dd"}],class:"fi_row",tag:"dl"},{inner:[(0,s.BtnStack)({inner:[(0,o.default)({inner:[t.mobile_photos_edit_save_btn],type:"submit"}),(0,o.default)({inner:[t.mobile_cancel],theme:"link",url:e.edit_data.back_url})]})],class:"fi_row",tag:"div"}],action:e.edit_data.action,method:"post",tag:"form"}],class:"form_item",tag:"div"}}function h(e){return void 0===e&&(e=[]),{inner:[Object.keys(e).map((t=>{var n=function(e){if(!(0,a.isArray)(e))return"";var t=e[0];return(0,a.isArray)(t)?"left: "+t[0]+"%; top: "+t[1]+"%; width: "+t[2]+"%; height: "+t[3]+"%":""}(e[t]);return{inner:[{class:"fill",tag:"div"}],class:"pv_tag",id:"pv_tag"+t,style:n,tag:"div"}}))],class:"PhotoviewPage__tags",tag:"div"}}t.default=function(e){void 0===e&&(e={});var t=e.info||{},n=e.photo||{},o=e.is_loading||!1,s=e.navigation_buttons||{},l=(0,a.concatValues)("PhotoviewPage ",e.class);e.info&&(e.author=(0,r.default)({url:t.url,author_url:t.author_url,avatar:t.avatar,name:t.name,id:t.id,title:t.title,subtitle:t.subtitle,withoutBottomBorder:!e.has_replies})),e.photo||(e.photo={}),e.photo.description||(e.photo.description="");var p,f="",v=null;o&&(l=(0,a.concatValues)(l," PhotoviewPage--skeleton"),n.width?f+=" width"+e.width+"px;":v=(0,c.default)({mix:"al_loading",type:"pageLoader"}));var m=["PhotoviewPage__photo"];e.photo.restriction&&("block"===e.photo.restriction.type?m.push("PhotoviewPage__photo--block"):"blur"===e.photo.restriction.type&&m.push("PhotoviewPage__photo--blur")),p=[{src:n.src,style:f,tag:"img"},h(e.tags)];var g,w=!!e.photo.restriction;return w&&((g=e.photo.restriction).width=e.width,g.height=e.height||e.width),(0,i.default)({inner:[{inner:[{inner:[v||{inner:[p],class:m,href:n.href,tag:"a"},{inner:[(0,u.default)(g)],class:"PhotoviewPage__restrictedInfo",style:w?"":"display: none;",tag:"div"},s],class:"PhotoviewPage__thumb",tag:"div"},e.edit_mode?_(e):d(e)],id:e.photo.id,tag:"div"}],class:l})}},70212:function(e,t,n){"use strict";var i=n(53006);t.default=i.default},38869:function(e,t,n){"use strict";n.d(t,{default:function(){return g}});var i=n(64485),r=n(30675),a=n(36461);var o=function(e){void 0===e&&(e={});var t={},n=e.raw||"",o=e.hash||"",s=e.text||"",l=e.restrictionId||0;"album"===(e.attachment_type||"")&&(e.height-=60),e.type&&"blur"!==e.type||(e.width>=250&&e.height>=250?e.type="blurWithText":e.type="blur"),("blur"===e.type||e.only_icon)&&(delete e.button,delete e.title),e.type&&(t[e.type]=!0);var c,u=i.default.class("PostPhotoRestriction",t);"blur"!==e.type&&"blurWithText"!==e.type||(c=e.width<100||e.height<100?(0,a.Icon28HideOutline)():(0,a.Icon56HideOutline)()),"block"===e.type&&(!e.forceText&&(e.width<300||e.height<250)&&(delete e.title,delete e.text),c=e.width<100||e.height<100?(0,a.Icon28BlockOutline)():(0,a.Icon56DoNotDisturbOutline)()),c={inner:[c],class:"SplashScreen__icon",tag:"div"},"block"!==e.type||e.title||(e.title=e.text);var d="PostPhotoRestriction.clear(this, event, '"+s+"', '"+e.button+"', '"+n+"', '"+o+"', '"+l+"')";return{inner:[{inner:[(0,r.default)({title:e.title,icon_raw:c,more_text:e.button,more_type:"outlineMono",more_onclick:d,more_ontouchend:d,more_native_onclick:!0})],class:"PostPhotoRestriction__splash",tag:"div"}],class:u,tag:"div"}},s=n(20848),l=n(75105),c=n(71437),u=n(49598),d=n(81294),_=n(40983),h=(0,l.default)(),p={};nav.onBeforeGo((()=>{(0,c.$$)(".Confirm[id^=restr]").forEach((e=>{v(e.id)}))}));var f={};function v(e){var t=(0,c.$)('[data-clear-id="'+e+'"]'),n=t&&(0,c.$)(".SplashScreen__more .Btn",t);f[e]&&(f[e].resolve({result:!1}),delete f[e]),u.default.close(document.getElementById(e)),n&&d.default.setLoading(n,!1)}var m=Object.assign(o,{clear:function(e,t,n,i,r,a){if(t&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()),a){e&&d.default.setLoading(e,!0,"white");var o="restr_"+(0,s.srand)();if(e){var l=e.closest(".PostPhotoRestriction");(0,s.domData)(l,"clear-id",o)}return function(e,t,n,i,r){window.clog("[PostPhotoRestriction] Show confirm to unblur "+i),(0,_.Confirm)(t,"PostPhotoRestriction.onClearConfirm('"+e+"', '"+i+"', '"+r+"')","PostPhotoRestriction.onClearDecline('"+e+"')",{id:e,ok_text:n})}(o,n,i,r,a),new Promise(((e,t)=>{f[o]={resolve:e,reject:t}}))}window.clog("[PostPhotoRestriction] No hash was provided")},onClearConfirm:function(e,t,n){u.default.close(document.getElementById(e)),window.ajax.post(t+"?act=unblur&hash="+n,{},{onDone(n,i){f[e]&&(f[e].resolve({result:!0,isFullyAvailable:n,unblurTypes:i}),delete f[e]);var r=(0,c.$)('[data-clear-id="'+e+'"]');if(r){var a=(0,c.$)(".SplashScreen__more .Btn",r);d.default.setLoading(a,!1),r.classList.add("PostPhotoRestriction--clear")}else window.clog("[PostPhotoRestriction] Can't find restriction el with clear id "+e);var o=/([a-z]*)(-?\d+)?(?:_(-?\d+))?/.exec(t),l=o[2],u=o[3],_=[];n&&Array.isArray(i)?(_=(0,c.$$)(".thumb_map_img--blur"),_=Array.prototype.filter.call(_,(e=>{var t=JSON.parse(e.getAttribute("data-restriction"))||{};return i.includes(parseInt(t.restrictionId))}))):(_.push((0,c.$)('.thumb_map_img--blur[data-id="'+l+"_"+u+'"]')),_.push((0,c.$)('.thumb_map_img--blur[href^="/photo'+l+"_"+u+'"]'))),_.forEach((e=>{if(e){e.classList.remove("thumb_map_img--blur");var t=(0,c.$)(".PostPhotoRestriction--blur,.PostPhotoRestriction--blurWithText",e);(0,s.re)(t)}})),n&&Array.isArray(i)&&i.forEach((e=>{p[""+e]=!0})),p[t]=!0,h(t);var v=[];n&&Array.isArray(i)?(v=(0,c.$$)(".PhotosPhotoItem__photo--blur"),v=Array.prototype.filter.call(v,(e=>{var t=JSON.parse((0,s.domData)(e,"restriction"))||{};return i.includes(parseInt(t.restrictionId))}))):v.push((0,c.$)('.PhotosPhotoItem__photo[data-id="'+t.replace("photo","")+'"]\n        ')),v.forEach((e=>{if(e){e.classList.remove("PhotosPhotoItem__photo--blur");var t=(0,c.$)(".PhotosPhotoItem__restriction",e);(0,s.re)(t)}}));var m=[];n&&Array.isArray(i)?(m=m.push(...(0,c.$$)(".AlbumItem__thumb--blur")),v=v.filter((e=>{var t=parseInt(e.getAttribute("data-restriction-id"));return i.includes(t)}))):m.push((0,c.$)('.AlbumItem__thumb--blur[data-thumb-id="'+t.replace("photo","")+'"]')),m.forEach((e=>{if(e){e.classList.remove("AlbumItem__thumb--blur");var t=(0,c.$)(".AlbumItem__restriction",e);(0,s.re)(t)}})),setTimeout((()=>{(0,s.remove)(r)}),500)}})},onClearDecline:v,isCleared:function(e,t){return!!p[e]||!!p[t]},onClear:h});window.PostPhotoRestriction=m;var g=m},65081:function(e,t,n){"use strict";var i=n(71437),r=n(39871),a=n(75105);window.Voting={cls:"Voting",setLoading:m,setHtml:function(e,t){p(e).forEach((e=>{e.outerHTML=t})),p(e).forEach((e=>{e.classList.add(l)})),setTimeout((()=>{p(e).forEach((e=>{e.classList.remove(l),Voting.onHtmlUpdate(e)}))}),30)},getVotingsById:p,onHtmlUpdate:(0,a.default)("$voting")},Voting._onSubmit=g,Voting._onSingleAnswerClick=v,Voting._onCheckboxClick=f,Voting._onRevoteClick=w;var o="_Voting_singleAnswerAction",s="Voting_loading",l="Voting_beforeAnimation",c="Voting_hasCheckedOptions",u=".Voting",d=e=>'.Voting[data-id="'+e+'"]',_=".Voting__option",h=".Voting__optionControl";function p(e){return(0,i.$$)(d(e))}function f(e){var t=e.closest(u),n=Array.from((0,i.$$)(h)).some((e=>e.checked));e.closest(_).setAttribute("aria-checked",e.checked),t.classList.toggle(c,n)}function v(e){var t=e.name,n=e.value,i=e.closest("form"),r=i.getAttribute("action");i[o]=r+"&"+t+"="+encodeURIComponent(n)}function m(e){e.classList.add(s)}function g(e,t,n){var i;if(e.preventDefault(),t[o])i=t[o],m(t);else{var a=Array.from(t.$$("input:checked"));if(0===a.length)return;var s=a[0].name,l=a.map((e=>e.value)).join(","),c=t.getAttribute("action"),u=c.includes("?")?"&":"?";m(t),i=""+c+u+s+"="+l+"&is_board="+t.$('input[name="is_board"]').value}r.default.handle(n,{$voting:t,url:i})}function w(e,t){var n=e.closest(u);r.default.handle(t,{$voting:n})}},26510:function(e,t,n){"use strict";var i=n(20848),r=(0,i.need)("Voting");function a(e){var{$voting:t,url:n}=e;s(t,n)}function o(e,t){var{$voting:n}=t;s(n,e,!0)}function s(e,t,n){var a=setTimeout((()=>{r.setLoading(e)}),140);window.ajax.post(t,{_ajax:1},{onDone(t,o){(0,i.domData)(e,"is-web-view")&&r._onPollChanged&&r._onPollChanged(e,n),clearTimeout(a),r.setHtml(t,o)}})}window.uVoting={},window.uVoting._onSubmit=a,window.uVoting._onRevoteClick=o},66760:function(e,t,n){"use strict";var i=n(36461),r=n(62641);t.default=function(e){void 0===e&&(e={});var t=null;e.bestFriendsOnly&&(t=(0,r.getLang)("mobile_wall_post_privacy_best_friends")),e.friendsOnly&&(t=(0,r.getLang)("mobile_wall_post_privacy_friends"));var n=e.bestFriendsOnly||e.friendsOnly?{inner:[(0,i.Icon12ChevronOutline)()],class:"PostPrivacyLabel__icon",tag:"div"}:null;return t||n?{inner:[t,n],class:(0,r.classNames)("PostPrivacyLabel",{"PostPrivacyLabel--friendsOnly":e.friendsOnly,"PostPrivacyLabel--bestFriendsOnly":e.bestFriendsOnly},"WithPostHeaderSubtitleDotSeparator"),onClick:e.onClick,attrs:e.attrs,tag:"div"}:null}},88379:function(e,t,n){"use strict";n.d(t,{default:function(){return c}});var i=n(85863),r=n(61508),a=n(26271),o=n(61540),s=n(21295),l=a.browser.iphone||a.browser.ipad||a.browser.ipod;function c(e){this.started=!1,this.is_idle=!0,this.activeTimeStart=null,this.cbActiveB=this.cbActive.bind(this),this.cbInactiveB=this.cbInactive.bind(this),this.onVisiblityChange=this.onVisiblityChange.bind(this),this.opts=(0,i.default)({triggerEvents:"mousemove keydown",onIdleCb:function(){},onUnIdleCb:function(){},focusElement:e.element,element:null,idleTimeout:3e4},e)}function u(e,t,n){(0,o.isMvk)()?window.addEvent(e,t,n,{passive:!0}):window.addEvent(e,t,n)}function d(e,t,n){(0,o.isMvk)()?window.removeEvent(e,t,n,{passive:!0}):window.removeEvent(e,t,n)}function _(){return document.visibilityState||document.webkitVisibilityState}function h(){var e="visibilitychange";return document.visibilityState||(document.webkitVisibilityState?e+="webkit":e=""),e}window.extend(c.prototype,r.default.prototype),window.extend(c.prototype,{stop:function(){this.started=!1,d(this.opts.element,this.opts.triggerEvents,this.cbActiveB),(0,o.isMvk)()&&this._isTopLevel()&&h()&&d(document,h(),this.onVisiblityChange),(0,o.isMvk)()&&l||(d(this.opts.focusElement,"focus",this.cbActiveB),d(this.opts.focusElement,"blur",this.cbInactiveB)),clearTimeout(this.setIdleTo),clearTimeout(this.checkIdleCbTo),clearTimeout(this.sendCbTO),this.is_idle=!0,this.opts.parentManager&&this.opts.parentManager.off("idle",this.cbInactiveB)},idle:function(e){this.is_idle=!0,e||this.opts.onIdleCb(),this.emit("idle")},unidle:function(e){this.is_idle=!1,e||this.opts.onUnIdleCb(),this.emit("unidle")},start:function(){this.started=!0,!(0,o.isMvk)()&&a.browser.mobile||(this.is_idle=!this._isFocused(),this.opts.parentManager&&this.opts.parentManager.on("idle",this.cbInactiveB),(0,o.isMvk)()&&this._isTopLevel()&&h()&&u(document,h(),this.onVisiblityChange),(0,o.isMvk)()&&l||(u(this.opts.focusElement,"focus",this.cbActiveB),u(this.opts.focusElement,"blur",this.cbInactiveB)),clearTimeout(this.checkIdleCbTo),this.checkIdleCb(),this.checkIdleCbTo=setTimeout(this.checkIdleCb.bind(this),this.opts.idleTimeout))},checkIdleCb:function(){this.started&&(u(this.opts.element,this.opts.triggerEvents,this.cbActiveB),clearTimeout(this.setIdleTo),this.setIdleTo=setTimeout(this.cbInactiveB,this.opts.idleTimeout))},cbActive:function(){this.started&&(this.activeTimeStart=(new Date).getTime(),clearTimeout(this.setIdleTo),this.is_idle&&(this.is_idle=!1,clearTimeout(this.sendCbTO),this.sendCbTO=setTimeout(function(){this.emit("unidle"),this.opts.onUnIdleCb&&this.opts.onUnIdleCb()}.bind(this),100)),d(this.opts.element,this.opts.triggerEvents,this.cbActiveB),clearTimeout(this.checkIdleCbTo),this.checkIdleCbTo=setTimeout(this.checkIdleCb.bind(this),this.opts.idleTimeout))},cbInactive:function(){this.started&&(s.screenWakeLocker.isLocked()||(this.activeTimeStart=null,this.is_idle||(this.is_idle=!0,clearTimeout(this.sendCbTO),this.sendCbTO=setTimeout(function(){this.emit("idle"),this.opts.onIdleCb&&this.opts.onIdleCb()}.bind(this),100)),clearTimeout(this.checkIdleCbTo),d(this.opts.element,this.opts.triggerEvents,this.cbActiveB),u(this.opts.element,this.opts.triggerEvents,this.cbActiveB),this.checkIdleCbTo=setTimeout(this.checkIdleCb,this.opts.idleTimeout)))},getActiveTime(){return!this.is_idle&&this.activeTimeStart?(new Date).getTime()-this.activeTimeStart:0},onVisiblityChange(){"visible"===_()?this.cbActiveB():this.cbInactiveB()},_isTopLevel(){var{focusElement:e}=this.opts;return e===window||e===document},_isFocused(){var{focusElement:e}=this.opts;if(this._isTopLevel()){var t=_();return"string"==typeof t&&"visible"===t}return document.activeElement===e}})},91040:function(e,t,n){"use strict";function i(e,t){return new Promise((n=>{setTimeout(n.bind(null,t),1e3*e)}))}function r(e,t,n){void 0===n&&(n=null);var r=0;return function a(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return Promise.resolve().then((()=>e(...s))).catch((e=>{if(++r<=t){var o="function"==typeof n?n(r):0;return 0===o?a(...s):i(o).then((()=>a(...s)))}throw e}))}}function a(e,t){var n,i=new Promise((i=>{n=i,setTimeout(i.bind(null,t),1e3*e)}));return{pause:()=>i,abort(){n(t)}}}n.d(t,{retryFn:function(){return r},abortablePause:function(){return a}})},95001:function(e,t,n){"use strict";n.d(t,{SECOND:function(){return i},HOUR:function(){return r},PUSH_NOTIFIER_PERMISSION_GRANTED:function(){return a},PUSH_NOTIFIER_PERMISSION_DEFAULT:function(){return o}});var i=1e3,r=60*(60*i),a="granted",o="default"},48658:function(e,t,n){"use strict";n.d(t,{replaceExtraHandler:function(){return o},_handleResponseExtraPayloads:function(){return s}});var i=n(61508),r=n(45582),a=function(){var e;if(window.ajax){var t=null===(e=window.ajax)||void 0===e?void 0:e.__extraEventEmitter;return t||(t=new i.default,window.ajax.__extraEventEmitter=t),t}},o=function(e,t){var n;return null===(n=a())||void 0===n||n.removeAllListeners(e),function(e,t){var n;return null===(n=a())||void 0===n||n.addListener(e,t),function(){var n;null===(n=a())||void 0===n||n.removeListener(e,t)}}(e,t)},s=function(e){var t;null!==(t=e)&&"object"==typeof t&&Object.keys(e).forEach((function(t){try{i=t,o=e[t],null==(s=a())||s.emit(i,o)}catch(e){var n={message:"Extra response error mvk",data:{extraKey:t}};(0,r.logError)(e,{environment:"ajax_request_mvk",breadcrumb:n}),console.error(e)}var i,o,s}))}},57274:function(e,t,n){"use strict";n.d(t,{apiRequest:function(){return E},getAPIDomains:function(){return y},initAPI:function(){return S}});var i,r=n(89798),a=n(79573),o=n(72947),s=n(49907),l=n(19331),c=6287487,u=7879029,d=!1,_=!1,h=!1,p=!1,f="QbYic1K3lEV5kTGiqlq2",v=function(e){_||((0,o.setLoginConfig)((0,a.__assign)({appId:c},e)),_=!0)},m=function(e,t,n,i){return _?(0,o.login)(e,t,n,i).then((function(e){return p=Boolean(e.access_token),e})).catch((function(e){if(console.error("[VKJS][AUTH]:",e),"unauthorized"===e.error&&"login_error"===e.type){var t=(0,l.partConfigEnabled)("loginvk_unauthorized_force_logout");if(console.error("[VKJS][AUTH]: logout "+(t?"enabled":"disabled")+" because ","loginvk_unauthorized_force_logout = ",t),t)return(0,o.removeLoginCache)(),window.location.href=window.vk.logoutUrl,new Promise((function(){}))}return(0,a.__assign)({access_token:"",error:!0},e)})):Promise.reject("[VKJS][LOGIN]: login didn't init. Use setLoginConfig function")},g=function(e){d?(0,s.setApiConfig)((0,a.__assign)({},e)):((0,s.setApiConfig)((0,a.__assign)({appId:c,version:"5.133",onTokenExpired:function(){return m("web_token",{},{},!0).then((function(e){return e.access_token||""}))}},e)),d=!0)},w=function(e,t,n,i){if(void 0===i&&(i={}),!d)return Promise.reject("[VKJS][API]: api didn't init. Use setApiConfig function");if(!h)return m("web_token").then((function(r){h=!0,g({accessToken:r.access_token});var o=p?t:(0,a.__assign)({client_secret:f},t);return(0,s.api)(e,o,n,i)}));var r=p?t:(0,a.__assign)({client_secret:f},t);return(0,s.api)(e,r,n,i)},b=n(7318);function y(){return window.vk.apiConfigDomains}function S(){if(!window.vkApi){window.vkApi||(window.vkApi={api:w,login:m,setLoginConfig:v,setApiConfig:g,removeLoginCache:o.removeLoginCache});var e=y(),t=e.apiDomain,n=e.loginDomain;(0,r.setApiConfig)({appId:u,version:"5.133",onCaptcha:b.handleAPICaptcha,onTokenExpired:function(){return function(e){void 0===e&&(e=!1);if(i)return i;return i=(0,r.login)("web_token",{},{},e).then((function(e){var t=e.access_token;return(0,r.setApiConfig)({accessToken:t}),e}))}(!0).then((function(e){return e.access_token}))},domain:t}),(0,r.setLoginConfig)({appId:u,domain:n})}}function E(e,t,n){return(0,r.api)(e,t,n).then(b.handleCaptchaSuccess)}},64485:function(e,t,n){"use strict";function i(e){return"number"==typeof e||"string"==typeof e&&!!e}n.d(t,{default:function(){return a}});var r={class:function(e,t,n){void 0===t&&(t={}),void 0===n&&(n="--");var r=[e];return Object.keys(t).forEach((function(a){if(i(a)){var o=t[a];!0===o?r.push(""+e+n+a):i(o)&&r.push(""+e+n+a+n+o)}})),r.join(" ")},setMod:function(e,t,n){var r,a=new RegExp("\\s*"+t+"(_[-a-zA-Z]+)?");r=!0===n?" "+t:i(n)?" "+t+"_"+n:"",a.test(e.className)?e.className=e.className.replace(a,r):e.className+=r}};window.Bem=r;var a=r},7318:function(e,t,n){"use strict";n.d(t,{handleAPICaptcha:function(){return s},handleAjaxCaptcha:function(){return o},handleCaptchaSuccess:function(){return c}});var i=n(80643),r=n(40906),a=new(function(){function e(){this._active=!1,this.tasks=[],this.taskResolvers=new Map,this.warnTimeoutID=0,this.isWarned=!1}return Object.defineProperty(e.prototype,"size",{get:function(){return this.tasks.length},enumerable:!1,configurable:!0}),e.prototype.addTask=function(e){var t=this;return this.tasks.push(e),new Promise((function(n,i){t.taskResolvers.set(e,{resolve:n,reject:i}),t._active||t.process()}))},e.prototype.process=function(){var e=this;window.clearTimeout(this.warnTimeoutID),this.isWarned&&(console.log("PromiseQueue has been continued processing. Queue size: %s",this.tasks.length.toString()),this.isWarned=!1);var t=this.tasks.shift();if(t){var n=this.taskResolvers.get(t);if(this.taskResolvers.delete(t),(0,r.isFunction)(t)&&n){this._active=!0;var i=t();i instanceof Promise?(i.then((function(e){return n.resolve(e)})).catch((function(){return n.reject()})).finally((function(){return e.process()})),this.warnTimeoutID=window.setTimeout((function(){var t="PromiseQueue handler has been running for more than %s seconds. Queue size: %s";e.isWarned=!0,console.warn(t,5,e.tasks.length.toString()),e.warnTimeoutID=window.setTimeout((function(){console.warn(t,20,e.tasks.length.toString())}),2e4)}),5e3)):(n.resolve(i),this.process())}else this.process()}else this._active=!1},e}());var o=function(e){return a.addTask((function(){return function(e){return l(),(0,i.showCaptcha)({captcha_img:e.img}).then((function(e){return{captcha_key:e}}))}(e)}))},s=function(e){return a.addTask((function(){return function(e){return l(),(0,i.showCaptcha)({captcha_img:e.captcha_img}).then((function(t){return{captcha_sid:e.captcha_sid,captcha_key:t}}))}(e)}))};function l(){return window.Captcha.stack++}window.Captcha={stack:0,handleAjaxCaptcha:o,getQueueSize:function(){return a.size}};var c=function(e){return window.Captcha.stack--,0===a.size&&window.Captcha.stack<=0&&(0,i.onCaptchaComplete)(),Promise.resolve(e)}},7846:function(e,t,n){"use strict";n.d(t,{withStatic:function(){return l},fetchMediaView:function(){return u},fetchAddQuestion:function(){return d},fetchShowQuestionsBox:function(){return _},fetchAddQuestionAnswerBox:function(){return h},fetchMiniAppsCatalog:function(){return p},fetchSearchAllCatalog:function(){return f},fetchAlbumUploadAdapter:function(){return v}});var i=n(79573),r=n(79957),a=n(91040),o=n(60847),s=n(34757);function l(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];(0,s.addStatic)(t).then((function(){return e.apply(void 0,(0,i.__spreadArray)([],(0,i.__read)(n),!1))}))}}function c(e,t,n){void 0===n&&(n=5),window.__chunks||(window.__chunks={});var i=window.__chunks[t];if(i)return i instanceof Promise?i:Promise.resolve(i);var s=1;return window.__chunks[t]=(0,a.retryFn)(e,n,(function(){return s++,1}))().then((function(e){return window.__chunks[t]=e,(0,r.statlogsValueEvent)("mvk_chunks_stat","success",t,s),e})).catch((function(e){throw(0,r.statlogsValueEvent)("mvk_chunks_stat","fail",t,e.name,o.default.getConnectionType()),delete window.__chunks[t],e})),window.__chunks[t]}function u(){return c((function(){return Promise.all([n.e(1777),n.e(4736),n.e(5456),n.e(5790),n.e(3898),n.e(5999),n.e(7673)]).then(n.bind(n,44174)).then((function(e){return(0,s.addStatic)(["vkui.css"]).then((function(){return e.init()}))}))}),"MediaView",5)}function d(){return c((function(){return Promise.all([n.e(1777),n.e(4736),n.e(5456),n.e(3898),n.e(9533)]).then(n.bind(n,19063)).then((function(e){return(0,s.addStatic)(["vkui.css"]).then((function(){return e.module}))}))}),"AddQuestion",5)}function _(){return c((function(){return Promise.all([n.e(1777),n.e(4736),n.e(5456),n.e(5790),n.e(3898),n.e(410),n.e(7798)]).then(n.bind(n,51872)).then((function(e){return(0,s.addStatic)(["vkui.css"]).then((function(){return e.showQuestionsBox}))}))}),"ShowQuestionsBox",5)}function h(){return c((function(){return Promise.all([n.e(1777),n.e(4736),n.e(5456),n.e(5790),n.e(3898),n.e(410),n.e(8285)]).then(n.bind(n,94845)).then((function(e){return(0,s.addStatic)(["vkui.css"]).then((function(){return e.module}))}))}),"AddQuestionAnswerBox",5)}function p(){return c((function(){return Promise.all([n.e(1777),n.e(4736),n.e(5456),n.e(5790),n.e(3898),n.e(307)]).then(n.bind(n,47610)).then((function(e){return e.module}))}),"MiniAppsCatalog",5)}function f(){return c((function(){return Promise.all([n.e(1777),n.e(4736),n.e(5456),n.e(5790),n.e(3898),n.e(2180)]).then(n.bind(n,42577)).then((function(e){return e.module}))}),"SearchCatalog",5)}function v(){return c((function(){return n.e(601).then(n.bind(n,98789)).then((function(e){return e}))}),"AlbumUploadAdapter",5)}},58776:function(e,t,n){"use strict";function i(e){var t={};return Array.from(e.elements).filter(a).forEach((function(e){if(e.name)switch(e.type){case"submit":break;case"radio":e instanceof HTMLInputElement&&e.checked&&(t[e.name]=e.value);break;case"checkbox":e instanceof HTMLInputElement&&e.checked&&(t[e.name]=r(e.name,e.value,t));break;default:t[e.name]=r(e.name,e.value,t)}})),t}function r(e,t,n){return n[e]?[e,t]:t}function a(e){return!(e instanceof HTMLButtonElement)}n.d(t,{getFormValues:function(){return i},filterFormFieldElements:function(){return a}})},69161:function(e,t,n){"use strict";function i(e){return"number"==typeof e&&!isNaN(e)}function r(e,t){return(e%t+t)%t}n.d(t,{isNumber:function(){return i},getCircularIndex:function(){return r}})},90616:function(e,t,n){"use strict";n.d(t,{disableBodyScroll:function(){return d},enableBodyScroll:function(){return _}});var i,r=n(20848),a=n(49265),o=n(69161),s=!1,l=null,c=null,u="fixed";function d(e,t){if(void 0===t&&(t={}),window.MutationObserver&&!s){window.storybook||window.nav.saveScrollPosition();var n,d=document.body,h=(0,r.scrollTop)(),p=d;if(l=p.style.overflow,s=!0,a.default.ios||a.default.ipad||(p.style.overflow="hidden"),t.forceScrollDisable&&(p.style.height="100%",document.documentElement.style.overflow="hidden"),c=new MutationObserver((function(){p.contains(e)||_()})),i=h,d){var f=!d.classList.contains(u);d.classList.add(u),f&&(0,r.setStyle)(d,{top:"-"+h+"px"}),n=(0,o.isNumber)(h)?h:void 0,a.default.safari&&(0,r.getCw)()<882&&document.scrollingElement&&(document.scrollingElement.scrollTop=h||0,setTimeout((function(){document.scrollingElement&&(document.scrollingElement.scrollTop=h||0)}),100),setTimeout((function(){document.scrollingElement&&(document.scrollingElement.scrollTop=h||0)}),300))}return c.observe(d,{attributes:!0,childList:!0,subtree:!0}),{bodyScrollTopBeforeOpen:n}}}function _(e,t){var n;if(void 0===t&&(t={}),window.MutationObserver){var a=null!==(n=null==t?void 0:t.bodyScrollTopBeforeOpen)&&void 0!==n?n:i,o=void 0===(null==t?void 0:t.bodyScrollTopBeforeOpen),d=document.body;if(s){if(d.style.overflow=l,(null==t?void 0:t.forceScrollDisable)&&(document.documentElement.style.overflow="initial"),null==c||c.disconnect(),d){var _=d.classList.contains(u);d.classList.remove(u),_&&void 0!==a&&((0,r.setStyle)(d,{top:""}),(0,r.scrollTop)(a))}s=!1,o&&(i=void 0)}}}},29441:function(e,t,n){"use strict";n.d(t,{getTimeFromStart:function(){return r}});var i=0;function r(){return window.performance?performance.now():i?Date.now()-i:0}window.onDOMReady((function(){i=Date.now()}))},51236:function(e,t,n){"use strict";n.d(t,{getStoryReportUrl:function(){return l},getStoryQuestionReportUrl:function(){return c},getArticleReportUrl:function(){return u}});var i=n(79573),r=n(19331),a=n(68040);function o(){return(0,r.partConfigEnabled)("mvk_vkui_reports")}function s(e,t){return"/vkui/reports/?"+(0,a.toQueryString)((0,i.__assign)((0,i.__assign)({},e),{back_url:t||window.location.href.replace(window.location.origin,"")}))}function l(e){var t=e.type,n=e.rawId,r=e.refrom;if(o()){var a=(0,i.__read)(n.split("_"),2);return s({type:t,owner_id:a[0],item_id:a[1]},r)}return"/reports?act=add&object="+(""+t+n)+"&refrom="+r}function c(e){var t=e.storyOwnerId,n=e.questionId,i=e.refrom;return o()?s({type:"story_question",owner_id:t,item_id:n},i):"/reports?act=add&object="+("story_question"+t+"_"+n)+"&refrom="+i}function u(e){var t=e.ownerId,n=e.articleId,i=e.accessHash,r=e.refrom;return o()?s({type:"article",owner_id:t,item_id:n},r):"/reports?act=add&object=article"+t+"_"+n+"_"+i+"&refrom="+r}},80681:function(e,t,n){"use strict";n.d(t,{Alert:function(){return s}});var i=n(79573),r=n(50805),a=n(62641),o=n(77237);function s(e){var t=e.title,n=e.text,s=e.children,l=(0,a.classNames)((0,o.getClassNameFromProps)(e),{Alert:!0,Alert_theme_error:"error"===e.theme,Alert_theme_warning:"warning"===e.theme,Alert_theme_info:"info"===e.theme});return(0,r.jsxs)("div",(0,i.__assign)({className:l},{children:[t?(0,r.jsx)("div",(0,i.__assign)({className:"Alert__title"},{children:t}),void 0):null,(0,r.jsx)("div",(0,i.__assign)({className:"Alert__description"},{children:n||s}),void 0)]}),void 0)}t.default=s},87978:function(e,t,n){"use strict";n.d(t,{Anchor:function(){return a}});var i=n(50805),r=n(62641);function a(e){return(0,i.jsx)("div",{className:(0,r.classNames)("Anchor",e.mix),id:e.id},void 0)}t.default=a},4726:function(e,t,n){"use strict";n.d(t,{Avatar:function(){return u}});var i=n(79573),r=n(50805),a=n(80580),o=n(36461),s=n(62641),l=n(52650),c=n(77237);function u(e){var t=e.children,n=(0,c.getChildrenFromProps)(e,t);n=n?(0,s.isObject)(n)?n:(0,a.wrap)(n):null;var u=null,h=null,p=null,f=!1,v=!!e.withStories,m=e.mode?(0,s.toString)(e.mode):"image",g=e.size||"inherit",w=e.src?(0,s.isArray)(e.src)?e.src:[e.src]:[],b=e.borderRadius||"full",y=Math.floor((0,s.toInt)(e.textLength||2)),S=1;e.backgroundTheme&&(S=Math.abs(e.backgroundTheme)>6?Math.abs(e.backgroundTheme)%6+1:e.backgroundTheme),S=Math.floor(S||1);var E="";E=(0,s.isArray)(e.mix)?s.classNames.apply(void 0,(0,i.__spreadArray)([],(0,i.__read)(e.mix),!1)):e.mix||"","text"===m?(u=(0,r.jsx)("div",(0,i.__assign)({className:"Avatar__text"},{children:_((0,s.toString)(e.text),y)}),void 0),f=!0):"image"===m?(h=d((0,s.toArray)(w)),w.length||n||(p=(0,r.jsx)("div",(0,i.__assign)({className:"Avatar__placeholder"},{children:(0,r.jsx)(o.Icon24Users,{},void 0)}),void 0)),f=!1):"both"===m&&(u=(0,r.jsx)("div",(0,i.__assign)({className:"Avatar__text"},{children:_(e.text,y)}),void 0),h=d(w),f=(0,s.isLiteModeEnabled)());var k=function(e,t,n,r,a,o,l,c){var u;void 0===e&&(e="image");var d=(0,s.isArray)(l)?s.classNames.apply(void 0,(0,i.__spreadArray)([],(0,i.__read)(l),!1)):l;return(0,s.classNames)("Avatar",!o&&"Avatar--loaded","Avatar--mode-"+e,"Avatar--images-"+n.toString(),"Avatar--borderRadius-"+((0,s.isString)(r)?r:(null==r?void 0:r.toString())||""),"Avatar--theme-"+a,d,((u={})["Avatar--size-"+(null==t?void 0:t.toString())]=!!t,u["Avatar--withStories"]=c,u))}(m,g,w.length,b,S,f,E,v);return(0,r.jsx)(l.CustomTag,(0,i.__assign)({tag:e.href?"a":"div",href:e.href?(0,s.toString)(e.href):void 0,className:k,attrs:(0,c.processLegacyAttrs)(e.attrs),role:"img"},{children:(0,r.jsxs)("div",(0,i.__assign)({className:"Avatar__content"},{children:[h,p,u,n]}),void 0)}),void 0)}function d(e){for(var t=[],n=e.length<=4?e.length:4,i=0;i<n;i++){var a=i+1;t.push((0,r.jsx)("div",{className:"Avatar__image Avatar__image-"+a,style:"background-image: url('"+e[i]+"')"},void 0))}return t}function _(e,t){void 0===t&&(t=2);for(var n="",i=(0,s.cleanName)((0,s.decodeHTMLEntities)((0,s.convertToUtf)(e||""))).split(" "),r=i.length,a=0;a<r;a++)n+=(0,s.mbSubstr)(i[a],0,1,"utf-8");return n=(0,s.mbSubstr)(n,0,t,"utf-8"),n=(0,s.convertToWin)(n)}window.Avatar=u},85703:function(e,t,n){"use strict";n.d(t,{BtnStack:function(){return l}});var i=n(79573),r=n(50805),a=n(62641),o=n(532),s=n(77237);function l(e){var t,n,l=e.children,c=(0,s.getChildrenFromProps)(e,l),u=(0,a.toArray)(e.btns||(c&&Array.isArray(c)?c:[c])||[]),d=e.mode||"horizontal",_=e.align||"start",h=(0,o.classNames)(((t={BtnStack:!0,BtnStack_stretchOnSmallScreens:e.stretch_on_small_screens,BtnStack_stretch:e.stretch,BtnStack_nowrap:e.nowrap})["BtnStack_align_"+_]=!0,t["BtnStack_mode_"+d]=!0,t)),p=null;return e.after&&(p=(0,r.jsx)("div",(0,i.__assign)({className:(0,o.classNames)((n={BtnStack__cell:!0},n[""+e.after_mix]=e.after_mix,n))},{children:e.after}),void 0)),(0,r.jsxs)("div",(0,i.__assign)({className:h},{children:[u.length?u:null,p]}),void 0)}},88833:function(e,t,n){"use strict";var i=n(79573),r=n(50805),a=n(77237),o=n(532),s=n(80580),l=n(36810);t.default=function(e){void 0===e&&(e={});var t=e.children,n=(0,a.getChildrenFromProps)(e,t),c=e.name,u=e.description,d=e.type,_=e.checked,h=e.disabled,p=e.input_id,f=e.withoutWrap,v=e.label||n,m=e.on_change||e.onChange,g=e.ariaHiddenLabel||"true",w="value"in e?e.value:"1",b=(0,o.classNames)("Control","Control_type_"+d,e.mix,(0,a.getClassNameFromProps)(e)),y=(0,a.processLegacyAttrs)(e.attrs),S="";"switcher"===d&&(S="switch");var E=c+"_"+w+"_label",k=(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{id:p,className:"Control__native",name:c,value:w,checked:!!_||void 0,disabled:!!h||void 0,type:"switcher"===d?"checkbox":d,onChange:m?(0,s.prepareHandler)(["Control._onChange","this",m]):void 0,"aria-labelledby":v?E:null,role:S},void 0),(0,r.jsx)("div",{className:"Control__icon"},void 0),(0,r.jsxs)("div",(0,i.__assign)({className:"Control__label"},{children:[(0,r.jsx)("span",(0,i.__assign)({id:E,"aria-hidden":g},{children:v}),void 0),u?(0,r.jsx)("div",(0,i.__assign)({className:"Control__description"},{children:u}),void 0):""]}),void 0)]},void 0)},void 0);return f?(0,r.jsx)("label",(0,i.__assign)({className:b,attrs:y},{children:k}),void 0):(0,r.jsx)(l.Row,(0,i.__assign)({tag:"label",role:"menuitem",className:b,attrs:y},{children:k}),void 0)}},32144:function(e,t,n){"use strict";n.d(t,{CustomTag:function(){return i.CustomTag}});var i=n(52650)},21081:function(e,t,n){"use strict";n.d(t,{Icon:function(){return s}});var i=n(50805),r=n(62641),a=n(41960),o=n(77237);function s(e){var t,n=e.icon;return(0,i.jsx)(a.MaybeLink,{className:(0,r.classNames)((0,o.getClassNameFromProps)(e)||e.mix,"Icon",(t={},t["Icon_"+n]=!0,t.Icon_active=e.active,t.Icon_blue=e.blue,t.Icon_bluer=e.bluer,t.Icon_dark=e.dark,t.Icon_selected=e.selected,t.Icon_small=e.small,t.Icon_white=e.white,t)),href:e.url,attrs:e.attrs},void 0)}},43365:function(e,t,n){"use strict";n.d(t,{Icon:function(){return i.Icon},default:function(){return r}});var i=n(21081);var r=i.Icon},41960:function(e,t,n){"use strict";n.d(t,{MaybeLink:function(){return s}});var i=n(79573),r=n(50805),a=n(52650),o=n(77237);function s(e){var t=e.tag;e.href&&!t&&(t="a");var n=e.children,s=(0,o.getChildrenFromProps)(e,n);return(0,r.jsx)(a.CustomTag,(0,i.__assign)({tag:t||"div"},e,{children:s}),void 0)}},72107:function(e,t,n){"use strict";n.d(t,{default:function(){return f}});var i=n(79573),r=n(50805),a=n(36810),o=n(87978),s=n(80681),l=n(62641),c=n(41960),u=n(52650),d=n(77237),_=n(80580);function h(e){return((0,l.isArray)(e)?(0,l.wdToFlatArray)(e):[e]).join("")}function p(e){var t=h(e);return!t||"<div></div>"===t}var f=function(e){var t,n;if(e.content_only)return{outerHTML:h(e.content)};var f=e.title,v=e.corner,m=e.children,g=(0,d.getChildrenFromProps)(e,m)||e.content,w=e.anchor,b=e.alert,y=e.attrs||{},S=e.noShadow,E=null!==e.count,k=e.theme||"gray";E&&(k="black");var P=e.pageBlock?"PageBlock PageBlock--separate":"",C=(0,r.jsx)(r.Fragment,{children:f},void 0);if(E){var A=(0,r.jsx)("span",(0,i.__assign)({className:"Pad__count"},{children:e.count}),void 0);C=(0,r.jsxs)(r.Fragment,{children:[C,A]},void 0)}var I=v&&(0,_.prepareHandler)(v.onclick)||"";return(0,r.jsxs)(u.CustomTag,(0,i.__assign)({tag:e.tag,attrs:(0,d.processLegacyAttrs)(y),className:(0,l.classNames)("Pad",(t={Pad_empty:p(g),Pad_noBorder:e.no_border,Pad_noCapsTitle:e.no_caps_for_title,Pad_style_extraTopPadding:null===(n=e.style)||void 0===n?void 0:n.extra_top_padding,Pad_noShadow:S},t["Pad_theme_"+k]=!!k,t),(0,d.getClassNameFromProps)(e)||e.mix,P),ref:e.ref,"data-id":e.name||e.id},{children:[w?(0,r.jsx)(o.Anchor,{mix:"Pad__anchor",id:w},void 0):null,b?(0,r.jsx)(a.Row,(0,i.__assign)({style:{tiny_padding_bottom:!0}},{children:(0,r.jsx)(s.Alert,(0,i.__assign)({className:"Pad__alert",theme:e.alert_theme},{children:b}),void 0)}),void 0):null,f?(0,r.jsxs)(a.Row,(0,i.__assign)({className:"Pad__header"},{children:[e.isHeaderPage?(0,r.jsx)("h1",(0,i.__assign)({className:"Pad__title"},{children:C}),void 0):(0,r.jsx)("h3",(0,i.__assign)({className:"Pad__title"},{children:C}),void 0),v&&(0,r.jsx)(c.MaybeLink,(0,i.__assign)({href:v.url,onClickUnsafe:I,attrs:v.attrs,className:(0,l.classNames)("Pad__corner",(0,d.getClassNameFromProps)(e.corner||{}))},{children:v.text}),void 0)]}),void 0):null,f?(0,r.jsx)("div",(0,i.__assign)({className:(0,l.classNames)("Pad__content",e.content_mix)},{children:g}),void 0):g]}),void 0)}},34044:function(e,t,n){"use strict";n.d(t,{default:function(){return s}});var i=n(79573),r=n(50805),a=n(62641),o=n(77237);var s=function(e){var t=e.children,n=(0,o.getChildrenFromProps)(e,t),s=!e.separate&&!!e.row,l=(0,a.classNames)("PageBlock",{"PageBlock--row":s,"PageBlock--separate":e.separate,"PageBlock--transparent":e.transparent},(0,o.getClassNameFromProps)(e));return(0,r.jsx)("div",(0,i.__assign)({className:l},{children:n}),void 0)}},36810:function(e,t,n){"use strict";n.d(t,{Row:function(){return d}});var i=n(79573),r=n(50805),a=n(87978),o=n(21081),s=n(80580),l=n(62641),c=n(77237),u=n(52650);function d(e){var t=e.children,n=e.content||(0,c.getChildrenFromProps)(e,t),d=e.anchor,_=e.attrs||{},h=e.style||{},p=e.url,f=!(!p||h.no_go_icon||e.count),v=e.tag;v||(v=p?"a":"div");var m=e.left?(0,r.jsx)("div",(0,i.__assign)({className:"Row__left"},{children:e.left}),void 0):null;m||e.icon&&(m=(0,r.jsx)("div",(0,i.__assign)({className:(0,l.classNames)("Row__left","Row__icon",e.icon_class)},{children:e.icon}),void 0));var g=e.right?(0,r.jsx)("div",(0,i.__assign)({className:"Row__right"},{children:e.right}),void 0):null;g||(f?g=(0,r.jsx)("div",(0,i.__assign)({className:"Row__right"},{children:(0,r.jsx)(o.Icon,{mix:"Row__right",icon:"chevron_right"},void 0)}),void 0):e.count&&(g=(0,r.jsx)("div",(0,i.__assign)({className:"Row__right Row__count"},{children:e.count}),void 0)));var w=(0,c.getClassNameFromProps)(e)||(0,s.prepareClass)(e.mix);return(0,r.jsxs)(u.CustomTag,(0,i.__assign)({tag:v,className:(0,l.classNames)(w,"Row",{Row_style_withBorder:h.with_border,Row_style_withBorderForce:h.with_border_force,Row_style_withHover:h.with_hover,Row_style_smallPaddings:h.small_paddings,Row_style_noPaddingTop:h.no_padding_top,Row_style_noPaddingBottom:h.no_padding_bottom,Row_style_tinyPaddingTop:h.tiny_padding_top,Row_style_tinyPaddingBottom:h.tiny_padding_bottom,Row_paddingTop_short:h.padding_top_short}),attrs:(0,c.processLegacyAttrs)(_),href:p,role:e.role},{children:[d?(0,r.jsx)(a.Anchor,{id:d},void 0):null,m,(0,r.jsx)("div",(0,i.__assign)({className:"Row__in"},{children:n}),void 0),g]}),void 0)}t.default=d},19228:function(e,t,n){"use strict";n.d(t,{Separator:function(){return o}});var i=n(50805),r=n(62641),a=n(77237);function o(e){return void 0===e&&(e={}),(0,i.jsx)("div",{className:(0,r.classNames)("Separator",{"Separator--hideOnDesktop":e.hideOnDesktop,"Separator--noOffset":e.noOffset,"Separator--gray":e.gray},(0,a.getClassNameFromProps)(e))},void 0)}t.default=o},64901:function(e,t,n){"use strict";n.d(t,{Spinner:function(){return c}});var i=n(79573),r=n(50805),a=n(21081),o=n(16603),s=n(48328),l=n(62641);function c(e){void 0===e&&(e={});var t=e.mix||"",n="pageLoader"===(e.type||"gray"),c=(0,l.classNames)(t,"Spinner",{"Spinner--pageLoader":n,"Spinner--hidden":e.isHidden,"Spinner--fixed":e.isFixed});return n?(0,r.jsx)("div",(0,i.__assign)({className:c},{children:(0,r.jsx)(o.SVGIcon,{icon:(0,s.getLoading40Icon)()},void 0)}),void 0):(0,r.jsx)(a.Icon,{mix:c,icon:"spinner"},void 0)}},31931:function(e,t,n){"use strict";n.d(t,{default:function(){return o},hide:function(){return a}});var i=n(64901),r=n(40906);function a(e){(0,r.isElement)(e)&&(e.classList.contains("Spinner--hidden")||e.classList.add("Spinner--hidden"))}var o=i.Spinner},80643:function(e,t,n){"use strict";n.d(t,{onCaptchaComplete:function(){return m},showCaptcha:function(){return f}});var i=n(49598),r=n(81294),a=n(62124),o=n(63735),s=n(90893),l=n(64485);var c=function(e){void 0===e&&(e={});var t={};t[e.mode||"vertical"]=!0;var n=l.default.class("FormLayoutGroup",t);return e.class&&(n+=" "+e.class),{inner:[e.inner],class:n,tag:"div"}},u=n(85703);var d=n(39871),_=n(68673),h=n(58776),p=n(71437);function f(e){void 0===e&&(e={});var t=d.default.elem(function(e){var t=window.lang;return(0,i.default)({inner:[{inner:[(0,a.FormLayout)({inner:[c({inner:[(0,o.FormItem)({inner:[{class:"captcha_img",src:e.captcha_img,alt:"",tag:"img"}]}),(0,o.FormItem)({inner:[(0,s.default)({name:"sig",placeholder:t.mobile_captcha_enter_code})]}),(0,u.BtnStack)({inner:[(0,r.default)({inner:[t.mobile_captcha_send_btn],onClick:["CaptchaPopup.onSend"]}),(0,r.default)({inner:[t.mobile_cancel],theme:"secondary",onClick:["CaptchaPopup.onHide"]})],mode:"vertical",stretch:!0})]})]})],class:"Popup__buttons",tag:"div"}],class:"CaptchaPopup",scrollable:!0,on_overlay_click:["CaptchaPopup.onHide","this"]})}(e));window.CaptchaPopup.shownCaptchaPromise&&(window.CaptchaPopup.shownCaptchaPromise.reject(),window.CaptchaPopup.shownCaptchaPromise=null);var n=new Promise((function(e,n){window.CaptchaPopup.shownCaptchaPromise={resolve:e,reject:n},(0,i.replacePopup)((0,p.$)(".CaptchaPopup"),t)||(0,i.openPopup)(t,!0,{})}));return n.catch((function(){(0,i.closePopup)()})),n}function v(){window.CaptchaPopup.shownCaptchaPromise&&(window.CaptchaPopup.shownCaptchaPromise.reject(),window.CaptchaPopup.shownCaptchaPromise=null)}function m(){window.CaptchaPopup.shownCaptchaPromise=null;var e=(0,p.$)(".CaptchaPopup");e&&(0,i.closePopup)(e)}window.CaptchaPopup||(window.CaptchaPopup={onHide:v,onSend:function(e){var t=e.$btn;if((0,_.setLoading)(t,!0),!t.form)return v();var n=(0,h.getFormValues)(t.form);return window.CaptchaPopup.shownCaptchaPromise?(window.CaptchaPopup.shownCaptchaPromise.resolve(n.sig||""),!1):void 0},shownCaptchaPromise:null})},63735:function(e,t,n){"use strict";n.d(t,{FormItem:function(){return s}});var i=n(79573),r=n(50805),a=n(532),o=n(77237);function s(e){var t=e.name,n=e.children,s=(0,o.getChildrenFromProps)(e,n)||e.inner;return(0,r.jsxs)("div",(0,i.__assign)({className:(0,a.classNames)("FormItem",{"FormItem--error":"error"===e.status,"FormItem--withAsterisk":e.isWithAsterisk},e.className||e.class),"data-name":t},{children:[(0,r.jsx)("div",(0,i.__assign)({className:(0,a.classNames)("FormItem__top",{"FormItem__top--hidden":!e.top}),id:t?t+"-top":void 0},{children:e.top||""}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:"FormItem__in"},{children:s}),void 0),(0,r.jsx)("div",(0,i.__assign)({className:(0,a.classNames)("FormItem__bottom",{"FormItem__bottom--hidden":!e.bottom}),id:t?t+"-bottom":void 0},{children:e.bottom||""}),void 0)]}),void 0)}},64546:function(e,t,n){"use strict";n.d(t,{createAdapterContext:function(){return T},openFilePicker:function(){return A},setupUploadHandlers:function(){return P},showUploadFinishSnackbar:function(){return k}});var i=n(79573),r=n(50805),a=n(71437),o=n(20848),s=n(99667),l=n(39871),c=n(62641),u=n(48743),d=n(57274),_=n(7846),h=n(57141),p=n(70162),f=n(63918),v=n(61805),m=n.n(v);function g(e){var t="__cb_"+m()();function n(){delete window[t]}return window[t]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];n(),e.apply(void 0,(0,i.__spreadArray)([],(0,i.__read)(t),!1))},{name:t,destroy:n}}var w=n(53765);function b(){return(0,a.$)(".photos_page")}function y(){var e=b();e&&function(e){void 0===e&&(e=!1);var t=b();if(t&&t.parentElement){var n=(0,a.$)(".SplashScreen",t.parentElement);n&&(0,o.setStyle)(n,{display:e?"flex":"none"})}}(0===(0,a.$$)(".PhotosPhotoItem",e).length)}function S(){var e=b();return!!e&&"1"===e.dataset.rev}function E(){if(S())return!0;var e=b();return!(!e||!e.parentElement)&&!(0,a.$)(".show_more_wrap",e.parentElement)}function k(e,t){var n=e+t;0===t?(0,h.init)({text:(0,o.langNumeric)(e,(0,c.getLang)("photos_successfully_added","raw")),type:h.SNACKBAR_TYPE_SUCCESS}):n>1?(0,h.init)({text:(0,p.langReplace)((0,o.langNumeric)(t,(0,c.getLang)("mobile_photos_upload_error_X","raw")),{count:(e+t).toString()}),type:h.SNACKBAR_TYPE_ERROR}):(0,h.init)({text:(0,c.getLang)("mobile_photos_upload_error"),type:h.SNACKBAR_TYPE_ERROR})}function P(e){var t,n=function(e,t){var n,r=[];function a(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var s=(0,i.__read)(t,3)[2];if(!(null==s?void 0:s.need_restore)||!(null==s?void 0:s.no_push)){n&&(0,w.openPopup)(n);var u=g((function(){var e;o(),(e=window.nav).go.apply(e,(0,i.__spreadArray)([],(0,i.__read)(t),!1))})),d=u.name,_=u.destroy;r.push(_);var h=(0,f.default)({title:(0,c.getLang)("mobile_warning_header"),text:e,buttons:{yes:{text:(0,c.getLang)("mobile_continue"),onClick:d},no:{text:(0,c.getLang)("mobile_cancel")}}});return n=(0,w.openPopup)((0,l.elem)(h),!0),!0}o(!0)}function o(e){void 0===e&&(e=!1),r.forEach((function(e){return e()})),r=[],window.nav.onBeforeGo.off(a),window.cur.isNavigationConfirmEnabled=!1,n&&(0,w.closePopup)(n),null==t||t({is_force:e})}return window.nav.onBeforeGo(a),window.cur.isNavigationConfirmEnabled=!0,function(){o()}}((0,c.getLang)("mobile_photos_upload_exit_confirm"),(function(e){return e.is_force&&(0,h.init)({type:h.SNACKBAR_TYPE_ERROR,text:(0,c.getLang)("mobile_photos_upload_exit_error")})})),r=(window.cur.preventRestore=!0,function(){delete window.cur.preventRestore});function a(){n(),e.cancelled=!0}return null===(t=window.cur.destroy)||void 0===t||t.push(a),function(){a(),r()}}function C(e){var t=(0,c.getState)("photo_upload_data");if(t){var n=t.owner_id,i=t.album_id,r=!E(),a=T(n,i),o=P(a);(0,_.fetchAlbumUploadAdapter)().then((function(t){return(0,t.startUpload)(a,e).then((function(e){var t=e.success,n=e.failed;(r||0!==n)&&k(t,n)}))})).catch((function(e){throw(0,h.init)({text:(0,c.getLang)("mobile_unknown_error"),type:h.SNACKBAR_TYPE_ERROR}),e})).finally((function(){o()}))}}function A(){(0,_.fetchAlbumUploadAdapter)();var e=function(){var e=b();if(!e)return null;var t=(0,a.$)("#photos_list_upload",e);if(t)return t;var n=document.createElement("input");return n.id="photos_list_upload",n.hidden=!0,n.multiple=!0,n.type="file",n.accept="image/jpeg,image/png,image/gif,image/heic,image/heif,image/webp",n.addEventListener("change",(function(e){var t;return C((0,i.__spreadArray)([],(0,i.__read)(null===(t=e.target)||void 0===t?void 0:t.files),!1))})),e.appendChild(n),n}();return!!e&&(e.click(),!0)}function I(e){return(0,a.$)('[data-upload-id="'+e+'"]')}function T(e,t){var n=!0;return{owner_id:e,album_id:t,getUploadServer:function(){return(0,d.apiRequest)("photos.getUploadServer",{album_id:t,group_id:u.Ranges.isCommunityPeer(e)?-e:0}).then((function(e){return e.upload_url}))},isReversedOrder:S,insertTempElement:function(e){var t=function(e){var t=(0,a.$)(".photos_page");if(!t||!E())return!1;var n=(0,l.elem)((0,r.jsx)(s.default,{is_loading:!0,attrs:{"data-upload-id":e,"aria-hidden":!0},photo:{src:""}},void 0));return S()?t.prepend(n):t.append(n),!0}(e);return t?(y(),n&&!S()&&window.scrollTo(0,document.documentElement.scrollHeight),n=!1,t):t},removeTempElement:function(e){(0,o.remove)(I(e)),y()},replaceTempElement:function(e,t){!function(e,t){var n=I(e);n&&(0,o.replace)(t,n)}(e,t)}}}},75377:function(e,t,n){"use strict";n.d(t,{default:function(){return s}});var i=n(79573),r=n(50805),a=n(62641),o=n(77237);var s=function(e){var t=e.children,n=(0,o.getChildrenFromProps)(e,t);return(0,r.jsx)("div",(0,i.__assign)({className:(0,a.classNames)((0,o.getClassNameFromProps)(e),{photos_page:e.isMainList}),"data-rev":e.isReversedOrder?"1":"0"},{children:n}),void 0)}},75341:function(e,t,n){"use strict";var i=n(79573),r=n(50805),a=(n(80580),n(62641)),o=n(36461),s=n(64901),l=n(77237),c=n(41960);t.default=function(e){var t=e.photo,n=e.is_loading,u=e.attrs,d=t.restriction,_=t.onclick,h=(0,r.jsx)("div",{},void 0);return h=n?(0,r.jsx)(s.Spinner,{},void 0):d&&"block"===d.type?(0,r.jsx)("div",(0,i.__assign)({className:"_image PhotosPhotoItem__photo"},{children:(0,r.jsx)("div",(0,i.__assign)({className:"PhotosPhotoItem__restriction PhotosPhotoItem__restriction--doNotDisturb"},{children:(0,r.jsx)(o.Icon56DoNotDisturbOutline,{},void 0)}),void 0)}),void 0):(0,r.jsx)("div",(0,i.__assign)({style:"background-image: url("+t.src+")",attrs:(0,l.processLegacyAttrs)(t.attrs),className:(0,a.classNames)("PhotosPhotoItem__photo","_image",{"PhotosPhotoItem__photo--blur":d&&"blur"===d.type})},{children:d&&d.type?(0,r.jsx)("div",(0,i.__assign)({className:"PhotosPhotoItem__restriction PhotosPhotoItem__restriction--hide"},{children:(0,r.jsx)(o.Icon56HideOutline,{},void 0)}),void 0):null}),void 0),(0,r.jsx)(c.MaybeLink,(0,i.__assign)({href:t.href,className:(0,a.classNames)("PhotosPhotoItem",t.class,{"PhotosPhotoItem--loading":n}),onClickUnsafe:_,attrs:(0,l.processLegacyAttrs)(u)},{children:h}),void 0)}},89798:function(e,t,n){"use strict";n.d(t,{setLoginConfig:function(){return i},setApiConfig:function(){return r},api:function(){return a},login:function(){return o}});var i=function(e){return window.vkApi?window.vkApi.setLoginConfig(e):console.error("[VKJS]: setLoginConfig didn't allowed. Use makeAuthAndApiGlobal function")},r=function(e){return window.vkApi?window.vkApi.setApiConfig(e):console.error("[VKJS]: setApiConfig didn't allowed. Use makeAuthAndApiGlobal function")},a=function(e,t,n,i){return void 0===i&&(i={}),window.vkApi?window.vkApi.api(e,t,n,i):Promise.reject("[VKJS][API]: api didn't allowed. Use makeAuthAndApiGlobal function")},o=function(e,t,n,i){return window.vkApi?window.vkApi.login(e,t,n,i):Promise.reject("[VKJS]: login didn't allowed. Use makeAuthAndApiGlobal function")}},21295:function(e,t,n){"use strict";n.d(t,{screenWakeLocker:function(){return i}});var i=new(function(){function e(){this.onVisibilityChange=this._onVisibilityChange.bind(this)}return e.prototype._onVisibilityChange=function(){this.wakeLockSentinel&&"visible"===document.visibilityState&&this.lock().then((function(){})).catch(console.error)},e.prototype.requestWakeLock=function(){var e=this;return navigator.wakeLock?this.wakeLockSentinel?Promise.resolve():navigator.wakeLock.request("screen").then((function(t){e.wakeLockSentinel=t})):Promise.reject()},e.prototype.isLocked=function(){return!!this.wakeLockSentinel&&!this.wakeLockSentinel.released},e.prototype.lock=function(){var e=this;return this.requestWakeLock().then((function(){e.wakeLockSentinel&&document.addEventListener("visibilitychange",e.onVisibilityChange)})).catch((function(){}))},e.prototype.unlock=function(){var e=this;return this.wakeLockSentinel?(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.wakeLockSentinel.release().finally((function(){e.wakeLockSentinel=null}))):Promise.resolve()},e}())},38736:function(e,t,n){"use strict";n.d(t,{processWaf:function(){return u},processFetchWaf:function(){return d}});var i=n(19331),r=n(61540),a="X-WAF-Redirect";function o(){return(0,i.partConfigEnabled)((0,r.isMvk)()?"mvk_waf_ajax_request_enabled":"waf_ajax_request_enabled")}function s(e){return void 0===e&&(e=""),o()&&""!==e}var l=!1;function c(){l||(l=!0,location.reload())}function u(e){if(!o())return!1;var t=!1;if(e instanceof XMLHttpRequest){var n=void 0;try{n=e.getResponseHeader(a)}catch(e){}t=s(n||"")}else e&&(t=function(e){return o()&&429===e.status&&"429.html"===e.source}(e));return t&&c(),t}function d(e){if(!o())return!1;if(!e)return!1;var t=!1;try{s(e.headers.get(a)||""||"")&&(t=!0)}catch(e){}return t&&c(),t}},70162:function(e,t,n){"use strict";n.d(t,{langNumeric:function(){return r},langSex:function(){return a},langStr:function(){return o},langReplace:function(){return s},langTag:function(){return l}});var i=n(40906);function r(e,t,n){var r,a=window.langConfig;if(!t||!a){if(!(0,i.isNumeric)(e)){var o=new Error("Non-numeric value passed to langNumeric");throw console.log(e,o),o}return String(e)}Array.isArray(t)?(r=t[1],e!=Math.floor(e)?r=t[a.numRules.float]:(a.numRules.int||[]).some((function(n){if("*"===n[0])return r=t[n[2]],!0;var i=n[0]?e%n[0]:e;return Array.isArray(n[1])&&n[1].includes(i)?(r=t[n[2]],!0):void 0}))):r=t;var s=String(e);if(n){for(var l=s.split("."),c=[],u=l[0].length-3;u>-3;u-=3)c.unshift(l[0].slice(u>0?u:0,u+3));l[0]=c.join(a.numDel),s=l.join(a.numDec)}return r=(r||"%s").replace("%s",s)}function a(e,t){if(!Array.isArray(t))return t;var n=t[1],i=window.langConfig;return i?(i.sexRules&&i.sexRules.some((function(i){return"*"===i[0]||Number(e)===Number(i[0])&&t[i[1]]?(n=t[i[1]],!0):void 0})),n):n}function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=String(e),r=0;r<t.length;r+=2){var a=t[r];if(null!=a){var o=String(t[r]).startsWith("%")?t[r]:"{"+t[r]+"}";i=i.replace(o,t[r+1])}}return i}function s(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i="{"+n+"}";e=e.replace(i,t[n])}return e}function l(e,t,n,i){return void 0===i&&(i="tag"),n=(n=n.replace("{"+i+"}",e)).replace("{/"+i+"}",t)}},70313:function(e,t,n){"use strict";n.d(t,{loadScript:function(){return r}});var i=n(79573);function r(e,t){var n,r,a,o=t.timeout,s=t.onLoad,l=t.onError,c=document.createElement("script");if(c.addEventListener("load",f),c.addEventListener("readystatechange",f),c.addEventListener("error",v),t.attributes)try{for(var u=(0,i.__values)(Object.entries(t.attributes)),d=u.next();!d.done;d=u.next()){var _=(0,i.__read)(d.value,2),h=_[0],p=_[1];null==p||("boolean"==typeof p?c.toggleAttribute(h,p):c.setAttribute(h,p))}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}function f(){c.readyState&&"loaded"!==c.readyState&&"complete"!==c.readyState||(m(),s&&s())}function v(){m(),l&&l()}function m(){clearTimeout(a),c.removeEventListener("load",f),c.removeEventListener("readystatechange",f),c.removeEventListener("error",v)}return c.src=e,document.head.appendChild(c),o&&(a=setTimeout(v,o)),{destroy:function(){m()}}}}}]);